import{h as Py,d as cL,m as pz,o as bz,c as wz,i as Sz,j as Cz,k as hL}from"./index-2419965a.js";var Le=function(e){try{return!!e()}catch{return!0}},_z=Le,kd=!_z(function(){var e=function(){}.bind();return typeof e!="function"||e.hasOwnProperty("prototype")}),dL=kd,vL=Function.prototype,wS=vL.call,Oz=dL&&vL.bind.bind(wS,wS),Ve=dL?Oz:function(e){return function(){return wS.apply(e,arguments)}},yL=Ve,Rz=yL({}.toString),Ez=yL("".slice),Nn=function(e){return Ez(Rz(e),8,-1)},Tz=Ve,kz=Le,Pz=Nn,Bp=Object,$z=Tz("".split),Pd=kz(function(){return!Bp("z").propertyIsEnumerable(0)})?function(e){return Pz(e)=="String"?$z(e,""):Bp(e)}:Bp,dn=function(e){return e==null},Az=dn,Iz=TypeError,Or=function(e){if(Az(e))throw Iz("Can't call method on "+e);return e},Mz=Pd,xz=Or,Lr=function(e){return Mz(xz(e))},wv=function(e){return e&&e.Math==Math&&e},ct=wv(typeof globalThis=="object"&&globalThis)||wv(typeof window=="object"&&window)||wv(typeof self=="object"&&self)||wv(typeof Py=="object"&&Py)||function(){return this}()||Py||Function("return this")(),gL={exports:{}},Dz=!1,sk=ct,Nz=Object.defineProperty,dR=function(e,t){try{Nz(sk,e,{value:t,configurable:!0,writable:!0})}catch{sk[e]=t}return t},Hz=ct,Lz=dR,uk="__core-js_shared__",jz=Hz[uk]||Lz(uk,{}),vR=jz,fk=vR;(gL.exports=function(e,t){return fk[e]||(fk[e]=t!==void 0?t:{})})("versions",[]).push({version:"3.32.0",mode:"global",copyright:"Â© 2014-2023 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.32.0/LICENSE",source:"https://github.com/zloirock/core-js"});var of=gL.exports,Fz=Or,Bz=Object,Rr=function(e){return Bz(Fz(e))},Vz=Ve,Wz=Rr,Uz=Vz({}.hasOwnProperty),kt=Object.hasOwn||function(t,r){return Uz(Wz(t),r)},zz=Ve,Yz=0,Gz=Math.random(),Kz=zz(1 .toString),Mm=function(e){return"Symbol("+(e===void 0?"":e)+")_"+Kz(++Yz+Gz,36)},Ba=typeof navigator<"u"&&String(navigator.userAgent)||"",mL=ct,Vp=Ba,ck=mL.process,hk=mL.Deno,dk=ck&&ck.versions||hk&&hk.version,vk=dk&&dk.v8,on,mg;vk&&(on=vk.split("."),mg=on[0]>0&&on[0]<4?1:+(on[0]+on[1]));!mg&&Vp&&(on=Vp.match(/Edge\/(\d+)/),(!on||on[1]>=74)&&(on=Vp.match(/Chrome\/(\d+)/),on&&(mg=+on[1])));var $d=mg,yk=$d,qz=Le,Xz=ct,Zz=Xz.String,af=!!Object.getOwnPropertySymbols&&!qz(function(){var e=Symbol();return!Zz(e)||!(Object(e)instanceof Symbol)||!Symbol.sham&&yk&&yk<41}),Qz=af,pL=Qz&&!Symbol.sham&&typeof Symbol.iterator=="symbol",Jz=ct,eY=of,gk=kt,tY=Mm,rY=af,nY=pL,xl=Jz.Symbol,Wp=eY("wks"),oY=nY?xl.for||xl:xl&&xl.withoutSetter||tY,mt=function(e){return gk(Wp,e)||(Wp[e]=rY&&gk(xl,e)?xl[e]:oY("Symbol."+e)),Wp[e]},SS=typeof document=="object"&&document.all,iY=typeof SS>"u"&&SS!==void 0,bL={all:SS,IS_HTMLDDA:iY},wL=bL,aY=wL.all,St=wL.IS_HTMLDDA?function(e){return typeof e=="function"||e===aY}:function(e){return typeof e=="function"},mk=St,SL=bL,lY=SL.all,Lt=SL.IS_HTMLDDA?function(e){return typeof e=="object"?e!==null:mk(e)||e===lY}:function(e){return typeof e=="object"?e!==null:mk(e)},sY=Lt,uY=String,fY=TypeError,Mt=function(e){if(sY(e))return e;throw fY(uY(e)+" is not an object")},yR={},cY=Le,jt=!cY(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!=7}),hY=jt,dY=Le,CL=hY&&dY(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!=42}),yr={},vY=ct,pk=Lt,CS=vY.document,yY=pk(CS)&&pk(CS.createElement),xm=function(e){return yY?CS.createElement(e):{}},gY=jt,mY=Le,pY=xm,_L=!gY&&!mY(function(){return Object.defineProperty(pY("div"),"a",{get:function(){return 7}}).a!=7}),bY=kd,Sv=Function.prototype.call,Ut=bY?Sv.bind(Sv):function(){return Sv.apply(Sv,arguments)},Up=ct,wY=St,SY=function(e){return wY(e)?e:void 0},No=function(e,t){return arguments.length<2?SY(Up[e]):Up[e]&&Up[e][t]},CY=Ve,Ci=CY({}.isPrototypeOf),_Y=No,OY=St,RY=Ci,EY=pL,TY=Object,Ad=EY?function(e){return typeof e=="symbol"}:function(e){var t=_Y("Symbol");return OY(t)&&RY(t.prototype,TY(e))},kY=String,lf=function(e){try{return kY(e)}catch{return"Object"}},PY=St,$Y=lf,AY=TypeError,Va=function(e){if(PY(e))return e;throw AY($Y(e)+" is not a function")},IY=Va,MY=dn,Wa=function(e,t){var r=e[t];return MY(r)?void 0:IY(r)},zp=Ut,Yp=St,Gp=Lt,xY=TypeError,OL=function(e,t){var r,n;if(t==="string"&&Yp(r=e.toString)&&!Gp(n=zp(r,e))||Yp(r=e.valueOf)&&!Gp(n=zp(r,e))||t!=="string"&&Yp(r=e.toString)&&!Gp(n=zp(r,e)))return n;throw xY("Can't convert object to primitive value")},DY=Ut,bk=Lt,wk=Ad,NY=Wa,HY=OL,LY=mt,jY=TypeError,FY=LY("toPrimitive"),RL=function(e,t){if(!bk(e)||wk(e))return e;var r=NY(e,FY),n;if(r){if(t===void 0&&(t="default"),n=DY(r,e,t),!bk(n)||wk(n))return n;throw jY("Can't convert object to primitive value")}return t===void 0&&(t="number"),HY(e,t)},BY=RL,VY=Ad,Dm=function(e){var t=BY(e,"string");return VY(t)?t:t+""},WY=jt,UY=_L,zY=CL,Cv=Mt,Sk=Dm,YY=TypeError,Kp=Object.defineProperty,GY=Object.getOwnPropertyDescriptor,qp="enumerable",Xp="configurable",Zp="writable";yr.f=WY?zY?function(t,r,n){if(Cv(t),r=Sk(r),Cv(n),typeof t=="function"&&r==="prototype"&&"value"in n&&Zp in n&&!n[Zp]){var o=GY(t,r);o&&o[Zp]&&(t[r]=n.value,n={configurable:Xp in n?n[Xp]:o[Xp],enumerable:qp in n?n[qp]:o[qp],writable:!1})}return Kp(t,r,n)}:Kp:function(t,r,n){if(Cv(t),r=Sk(r),Cv(n),UY)try{return Kp(t,r,n)}catch{}if("get"in n||"set"in n)throw YY("Accessors not supported");return"value"in n&&(t[r]=n.value),t};var KY=Math.ceil,qY=Math.floor,XY=Math.trunc||function(t){var r=+t;return(r>0?qY:KY)(r)},ZY=XY,_i=function(e){var t=+e;return t!==t||t===0?0:ZY(t)},QY=_i,JY=Math.max,eG=Math.min,Id=function(e,t){var r=QY(e);return r<0?JY(r+t,0):eG(r,t)},tG=_i,rG=Math.min,Ua=function(e){return e>0?rG(tG(e),9007199254740991):0},nG=Ua,Kr=function(e){return nG(e.length)},oG=Lr,iG=Id,aG=Kr,Ck=function(e){return function(t,r,n){var o=oG(t),i=aG(o),a=iG(n,i),l;if(e&&r!=r){for(;i>a;)if(l=o[a++],l!=l)return!0}else for(;i>a;a++)if((e||a in o)&&o[a]===r)return e||a||0;return!e&&-1}},gR={includes:Ck(!0),indexOf:Ck(!1)},Md={},lG=Ve,Qp=kt,sG=Lr,uG=gR.indexOf,fG=Md,_k=lG([].push),EL=function(e,t){var r=sG(e),n=0,o=[],i;for(i in r)!Qp(fG,i)&&Qp(r,i)&&_k(o,i);for(;t.length>n;)Qp(r,i=t[n++])&&(~uG(o,i)||_k(o,i));return o},mR=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],cG=EL,hG=mR,xd=Object.keys||function(t){return cG(t,hG)},dG=jt,vG=CL,yG=yr,gG=Mt,mG=Lr,pG=xd;yR.f=dG&&!vG?Object.defineProperties:function(t,r){gG(t);for(var n=mG(r),o=pG(r),i=o.length,a=0,l;i>a;)yG.f(t,l=o[a++],n[l]);return t};var bG=No,TL=bG("document","documentElement"),wG=of,SG=Mm,Ok=wG("keys"),Nm=function(e){return Ok[e]||(Ok[e]=SG(e))},CG=Mt,_G=yR,Rk=mR,OG=Md,RG=TL,EG=xm,TG=Nm,Ek=">",Tk="<",_S="prototype",OS="script",kL=TG("IE_PROTO"),Jp=function(){},PL=function(e){return Tk+OS+Ek+e+Tk+"/"+OS+Ek},kk=function(e){e.write(PL("")),e.close();var t=e.parentWindow.Object;return e=null,t},kG=function(){var e=EG("iframe"),t="java"+OS+":",r;return e.style.display="none",RG.appendChild(e),e.src=String(t),r=e.contentWindow.document,r.open(),r.write(PL("document.F=Object")),r.close(),r.F},_v,$y=function(){try{_v=new ActiveXObject("htmlfile")}catch{}$y=typeof document<"u"?document.domain&&_v?kk(_v):kG():kk(_v);for(var e=Rk.length;e--;)delete $y[_S][Rk[e]];return $y()};OG[kL]=!0;var sf=Object.create||function(t,r){var n;return t!==null?(Jp[_S]=CG(t),n=new Jp,Jp[_S]=null,n[kL]=t):n=$y(),r===void 0?n:_G.f(n,r)},PG=mt,$G=sf,AG=yr.f,RS=PG("unscopables"),ES=Array.prototype;ES[RS]==null&&AG(ES,RS,{configurable:!0,value:$G(null)});var Dd=function(e){ES[RS][e]=!0},Nd={},IG=ct,MG=St,Pk=IG.WeakMap,$L=MG(Pk)&&/native code/.test(String(Pk)),Hd=function(e,t){return{enumerable:!(e&1),configurable:!(e&2),writable:!(e&4),value:t}},xG=jt,DG=yr,NG=Hd,za=xG?function(e,t,r){return DG.f(e,t,NG(1,r))}:function(e,t,r){return e[t]=r,e},HG=$L,AL=ct,LG=Lt,jG=za,eb=kt,tb=vR,FG=Nm,BG=Md,$k="Object already initialized",TS=AL.TypeError,VG=AL.WeakMap,pg,Sc,bg,WG=function(e){return bg(e)?Sc(e):pg(e,{})},UG=function(e){return function(t){var r;if(!LG(t)||(r=Sc(t)).type!==e)throw TS("Incompatible receiver, "+e+" required");return r}};if(HG||tb.state){var yn=tb.state||(tb.state=new VG);yn.get=yn.get,yn.has=yn.has,yn.set=yn.set,pg=function(e,t){if(yn.has(e))throw TS($k);return t.facade=e,yn.set(e,t),t},Sc=function(e){return yn.get(e)||{}},bg=function(e){return yn.has(e)}}else{var Ja=FG("state");BG[Ja]=!0,pg=function(e,t){if(eb(e,Ja))throw TS($k);return t.facade=e,jG(e,Ja,t),t},Sc=function(e){return eb(e,Ja)?e[Ja]:{}},bg=function(e){return eb(e,Ja)}}var Ho={set:pg,get:Sc,has:bg,enforce:WG,getterFor:UG},Hn={},Ld={},IL={}.propertyIsEnumerable,ML=Object.getOwnPropertyDescriptor,zG=ML&&!IL.call({1:2},1);Ld.f=zG?function(t){var r=ML(this,t);return!!r&&r.enumerable}:IL;var YG=jt,GG=Ut,KG=Ld,qG=Hd,XG=Lr,ZG=Dm,QG=kt,JG=_L,Ak=Object.getOwnPropertyDescriptor;Hn.f=YG?Ak:function(t,r){if(t=XG(t),r=ZG(r),JG)try{return Ak(t,r)}catch{}if(QG(t,r))return qG(!GG(KG.f,t,r),t[r])};var xL={exports:{}},kS=jt,e3=kt,DL=Function.prototype,t3=kS&&Object.getOwnPropertyDescriptor,pR=e3(DL,"name"),r3=pR&&function(){}.name==="something",n3=pR&&(!kS||kS&&t3(DL,"name").configurable),jd={EXISTS:pR,PROPER:r3,CONFIGURABLE:n3},o3=Ve,i3=St,PS=vR,a3=o3(Function.toString);i3(PS.inspectSource)||(PS.inspectSource=function(e){return a3(e)});var NL=PS.inspectSource,bR=Ve,l3=Le,s3=St,Ov=kt,$S=jt,u3=jd.CONFIGURABLE,f3=NL,HL=Ho,c3=HL.enforce,h3=HL.get,Ik=String,Ay=Object.defineProperty,d3=bR("".slice),v3=bR("".replace),y3=bR([].join),g3=$S&&!l3(function(){return Ay(function(){},"length",{value:8}).length!==8}),m3=String(String).split("String"),p3=xL.exports=function(e,t,r){d3(Ik(t),0,7)==="Symbol("&&(t="["+v3(Ik(t),/^Symbol\(([^)]*)\)/,"$1")+"]"),r&&r.getter&&(t="get "+t),r&&r.setter&&(t="set "+t),(!Ov(e,"name")||u3&&e.name!==t)&&($S?Ay(e,"name",{value:t,configurable:!0}):e.name=t),g3&&r&&Ov(r,"arity")&&e.length!==r.arity&&Ay(e,"length",{value:r.arity});try{r&&Ov(r,"constructor")&&r.constructor?$S&&Ay(e,"prototype",{writable:!1}):e.prototype&&(e.prototype=void 0)}catch{}var n=c3(e);return Ov(n,"source")||(n.source=y3(m3,typeof t=="string"?t:"")),e};Function.prototype.toString=p3(function(){return s3(this)&&h3(this).source||f3(this)},"toString");var LL=xL.exports,b3=St,w3=yr,S3=LL,C3=dR,qr=function(e,t,r,n){n||(n={});var o=n.enumerable,i=n.name!==void 0?n.name:t;if(b3(r)&&S3(r,i,n),n.global)o?e[t]=r:C3(t,r);else{try{n.unsafe?e[t]&&(o=!0):delete e[t]}catch{}o?e[t]=r:w3.f(e,t,{value:r,enumerable:!1,configurable:!n.nonConfigurable,writable:!n.nonWritable})}return e},Ya={},_3=EL,O3=mR,R3=O3.concat("length","prototype");Ya.f=Object.getOwnPropertyNames||function(t){return _3(t,R3)};var Fd={};Fd.f=Object.getOwnPropertySymbols;var E3=No,T3=Ve,k3=Ya,P3=Fd,$3=Mt,A3=T3([].concat),jL=E3("Reflect","ownKeys")||function(t){var r=k3.f($3(t)),n=P3.f;return n?A3(r,n(t)):r},Mk=kt,I3=jL,M3=Hn,x3=yr,FL=function(e,t,r){for(var n=I3(t),o=x3.f,i=M3.f,a=0;a<n.length;a++){var l=n[a];!Mk(e,l)&&!(r&&Mk(r,l))&&o(e,l,i(t,l))}},D3=Le,N3=St,H3=/#|\.prototype\./,Bd=function(e,t){var r=j3[L3(e)];return r==B3?!0:r==F3?!1:N3(t)?D3(t):!!t},L3=Bd.normalize=function(e){return String(e).replace(H3,".").toLowerCase()},j3=Bd.data={},F3=Bd.NATIVE="N",B3=Bd.POLYFILL="P",Hm=Bd,rb=ct,V3=Hn.f,W3=za,U3=qr,z3=dR,Y3=FL,G3=Hm,$e=function(e,t){var r=e.target,n=e.global,o=e.stat,i,a,l,s,u,f;if(n?a=rb:o?a=rb[r]||z3(r,{}):a=(rb[r]||{}).prototype,a)for(l in t){if(u=t[l],e.dontCallGetSet?(f=V3(a,l),s=f&&f.value):s=a[l],i=G3(n?l:r+(o?".":"#")+l,e.forced),!i&&s!==void 0){if(typeof u==typeof s)continue;Y3(u,s)}(e.sham||s&&s.sham)&&W3(u,"sham",!0),U3(a,l,u,e)}},K3=Le,BL=!K3(function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype}),q3=kt,X3=St,Z3=Rr,Q3=Nm,J3=BL,xk=Q3("IE_PROTO"),AS=Object,eK=AS.prototype,Vd=J3?AS.getPrototypeOf:function(e){var t=Z3(e);if(q3(t,xk))return t[xk];var r=t.constructor;return X3(r)&&t instanceof r?r.prototype:t instanceof AS?eK:null},tK=Le,rK=St,nK=Lt,Dk=Vd,oK=qr,iK=mt,IS=iK("iterator"),VL=!1,Ta,nb,ob;[].keys&&(ob=[].keys(),"next"in ob?(nb=Dk(Dk(ob)),nb!==Object.prototype&&(Ta=nb)):VL=!0);var aK=!nK(Ta)||tK(function(){var e={};return Ta[IS].call(e)!==e});aK&&(Ta={});rK(Ta[IS])||oK(Ta,IS,function(){return this});var WL={IteratorPrototype:Ta,BUGGY_SAFARI_ITERATORS:VL},lK=yr.f,sK=kt,uK=mt,Nk=uK("toStringTag"),Lm=function(e,t,r){e&&!r&&(e=e.prototype),e&&!sK(e,Nk)&&lK(e,Nk,{configurable:!0,value:t})},fK=WL.IteratorPrototype,cK=sf,hK=Hd,dK=Lm,vK=Nd,yK=function(){return this},gK=function(e,t,r,n){var o=t+" Iterator";return e.prototype=cK(fK,{next:hK(+!n,r)}),dK(e,o,!1),vK[o]=yK,e},mK=Ve,pK=Va,bK=function(e,t,r){try{return mK(pK(Object.getOwnPropertyDescriptor(e,t)[r]))}catch{}},wK=St,SK=String,CK=TypeError,_K=function(e){if(typeof e=="object"||wK(e))return e;throw CK("Can't set "+SK(e)+" as a prototype")},OK=bK,RK=Mt,EK=_K,wR=Object.setPrototypeOf||("__proto__"in{}?function(){var e=!1,t={},r;try{r=OK(Object.prototype,"__proto__","set"),r(t,[]),e=t instanceof Array}catch{}return function(o,i){return RK(o),EK(i),e?r(o,i):o.__proto__=i,o}}():void 0),TK=$e,kK=Ut,UL=jd,PK=St,$K=gK,Hk=Vd,Lk=wR,AK=Lm,IK=za,ib=qr,MK=mt,xK=Nd,zL=WL,DK=UL.PROPER,NK=UL.CONFIGURABLE,jk=zL.IteratorPrototype,Rv=zL.BUGGY_SAFARI_ITERATORS,Cf=MK("iterator"),Fk="keys",_f="values",Bk="entries",HK=function(){return this},SR=function(e,t,r,n,o,i,a){$K(r,t,n);var l=function(w){if(w===o&&h)return h;if(!Rv&&w in f)return f[w];switch(w){case Fk:return function(){return new r(this,w)};case _f:return function(){return new r(this,w)};case Bk:return function(){return new r(this,w)}}return function(){return new r(this)}},s=t+" Iterator",u=!1,f=e.prototype,c=f[Cf]||f["@@iterator"]||o&&f[o],h=!Rv&&c||l(o),d=t=="Array"&&f.entries||c,v,y,p;if(d&&(v=Hk(d.call(new e)),v!==Object.prototype&&v.next&&(Hk(v)!==jk&&(Lk?Lk(v,jk):PK(v[Cf])||ib(v,Cf,HK)),AK(v,s,!0))),DK&&o==_f&&c&&c.name!==_f&&(NK?IK(f,"name",_f):(u=!0,h=function(){return kK(c,this)})),o)if(y={values:l(_f),keys:i?h:l(Fk),entries:l(Bk)},a)for(p in y)(Rv||u||!(p in f))&&ib(f,p,y[p]);else TK({target:t,proto:!0,forced:Rv||u},y);return f[Cf]!==h&&ib(f,Cf,h,{name:o}),xK[t]=h,y},CR=function(e,t){return{value:e,done:t}},LK=Lr,_R=Dd,Vk=Nd,YL=Ho,jK=yr.f,FK=SR,Ev=CR,BK=jt,GL="Array Iterator",VK=YL.set,WK=YL.getterFor(GL),UK=FK(Array,"Array",function(e,t){VK(this,{type:GL,target:LK(e),index:0,kind:t})},function(){var e=WK(this),t=e.target,r=e.kind,n=e.index++;return!t||n>=t.length?(e.target=void 0,Ev(void 0,!0)):r=="keys"?Ev(n,!1):r=="values"?Ev(t[n],!1):Ev([n,t[n]],!1)},"values"),Wk=Vk.Arguments=Vk.Array;_R("keys");_R("values");_R("entries");if(BK&&Wk.name!=="values")try{jK(Wk,"name",{value:"values"})}catch{}var zK=mt,YK=zK("toStringTag"),KL={};KL[YK]="z";var OR=String(KL)==="[object z]",GK=OR,KK=St,Iy=Nn,qK=mt,XK=qK("toStringTag"),ZK=Object,QK=Iy(function(){return arguments}())=="Arguments",JK=function(e,t){try{return e[t]}catch{}},jm=GK?Iy:function(e){var t,r,n;return e===void 0?"Undefined":e===null?"Null":typeof(r=JK(t=ZK(e),XK))=="string"?r:QK?Iy(t):(n=Iy(t))=="Object"&&KK(t.callee)?"Arguments":n},e4=OR,t4=jm,r4=e4?{}.toString:function(){return"[object "+t4(this)+"]"},n4=OR,o4=qr,i4=r4;n4||o4(Object.prototype,"toString",i4,{unsafe:!0});var qL={exports:{}},RR={},a4=Dm,l4=yr,s4=Hd,uf=function(e,t,r){var n=a4(t);n in e?l4.f(e,n,s4(0,r)):e[n]=r},Uk=Id,u4=Kr,f4=uf,c4=Array,h4=Math.max,ER=function(e,t,r){for(var n=u4(e),o=Uk(t,n),i=Uk(r===void 0?n:r,n),a=c4(h4(i-o,0)),l=0;o<i;o++,l++)f4(a,l,e[o]);return a.length=l,a},d4=Nn,v4=Lr,XL=Ya.f,y4=ER,ZL=typeof window=="object"&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],g4=function(e){try{return XL(e)}catch{return y4(ZL)}};RR.f=function(t){return ZL&&d4(t)=="Window"?g4(t):XL(v4(t))};var m4=Le,p4=m4(function(){if(typeof ArrayBuffer=="function"){var e=new ArrayBuffer(8);Object.isExtensible(e)&&Object.defineProperty(e,"a",{value:8})}}),b4=Le,w4=Lt,S4=Nn,zk=p4,My=Object.isExtensible,C4=b4(function(){My(1)}),_4=C4||zk?function(t){return!w4(t)||zk&&S4(t)=="ArrayBuffer"?!1:My?My(t):!0}:My,O4=Le,TR=!O4(function(){return Object.isExtensible(Object.preventExtensions({}))}),R4=$e,E4=Ve,T4=Md,k4=Lt,kR=kt,P4=yr.f,Yk=Ya,$4=RR,PR=_4,A4=Mm,I4=TR,QL=!1,Ao=A4("meta"),M4=0,$R=function(e){P4(e,Ao,{value:{objectID:"O"+M4++,weakData:{}}})},x4=function(e,t){if(!k4(e))return typeof e=="symbol"?e:(typeof e=="string"?"S":"P")+e;if(!kR(e,Ao)){if(!PR(e))return"F";if(!t)return"E";$R(e)}return e[Ao].objectID},D4=function(e,t){if(!kR(e,Ao)){if(!PR(e))return!0;if(!t)return!1;$R(e)}return e[Ao].weakData},N4=function(e){return I4&&QL&&PR(e)&&!kR(e,Ao)&&$R(e),e},H4=function(){L4.enable=function(){},QL=!0;var e=Yk.f,t=E4([].splice),r={};r[Ao]=1,e(r).length&&(Yk.f=function(n){for(var o=e(n),i=0,a=o.length;i<a;i++)if(o[i]===Ao){t(o,i,1);break}return o},R4({target:"Object",stat:!0,forced:!0},{getOwnPropertyNames:$4.f}))},L4=qL.exports={enable:H4,fastKey:x4,getWeakData:D4,onFreeze:N4};T4[Ao]=!0;var Wd=qL.exports,j4=Nn,F4=Ve,Ud=function(e){if(j4(e)==="Function")return F4(e)},Gk=Ud,B4=Va,V4=kd,W4=Gk(Gk.bind),zd=function(e,t){return B4(e),t===void 0?e:V4?W4(e,t):function(){return e.apply(t,arguments)}},U4=mt,z4=Nd,Y4=U4("iterator"),G4=Array.prototype,JL=function(e){return e!==void 0&&(z4.Array===e||G4[Y4]===e)},K4=jm,Kk=Wa,q4=dn,X4=Nd,Z4=mt,Q4=Z4("iterator"),AR=function(e){if(!q4(e))return Kk(e,Q4)||Kk(e,"@@iterator")||X4[K4(e)]},J4=Ut,e6=Va,t6=Mt,r6=lf,n6=AR,o6=TypeError,ej=function(e,t){var r=arguments.length<2?n6(e):t;if(e6(r))return t6(J4(r,e));throw o6(r6(e)+" is not iterable")},i6=Ut,qk=Mt,a6=Wa,tj=function(e,t,r){var n,o;qk(e);try{if(n=a6(e,"return"),!n){if(t==="throw")throw r;return r}n=i6(n,e)}catch(i){o=!0,n=i}if(t==="throw")throw r;if(o)throw n;return qk(n),r},l6=zd,s6=Ut,u6=Mt,f6=lf,c6=JL,h6=Kr,Xk=Ci,d6=ej,v6=AR,Zk=tj,y6=TypeError,xy=function(e,t){this.stopped=e,this.result=t},Qk=xy.prototype,IR=function(e,t,r){var n=r&&r.that,o=!!(r&&r.AS_ENTRIES),i=!!(r&&r.IS_RECORD),a=!!(r&&r.IS_ITERATOR),l=!!(r&&r.INTERRUPTED),s=l6(t,n),u,f,c,h,d,v,y,p=function(S){return u&&Zk(u,"normal",S),new xy(!0,S)},w=function(S){return o?(u6(S),l?s(S[0],S[1],p):s(S[0],S[1])):l?s(S,p):s(S)};if(i)u=e.iterator;else if(a)u=e;else{if(f=v6(e),!f)throw y6(f6(e)+" is not iterable");if(c6(f)){for(c=0,h=h6(e);h>c;c++)if(d=w(e[c]),d&&Xk(Qk,d))return d;return new xy(!1)}u=d6(e,f)}for(v=i?e.next:u.next;!(y=s6(v,u)).done;){try{d=w(y.value)}catch(S){Zk(u,"throw",S)}if(typeof d=="object"&&d&&Xk(Qk,d))return d}return new xy(!1)},g6=Ci,m6=TypeError,MR=function(e,t){if(g6(t,e))return e;throw m6("Incorrect invocation")},p6=mt,rj=p6("iterator"),nj=!1;try{var b6=0,Jk={next:function(){return{done:!!b6++}},return:function(){nj=!0}};Jk[rj]=function(){return this},Array.from(Jk,function(){throw 2})}catch{}var oj=function(e,t){if(!t&&!nj)return!1;var r=!1;try{var n={};n[rj]=function(){return{next:function(){return{done:r=!0}}}},e(n)}catch{}return r},w6=St,S6=Lt,eP=wR,xR=function(e,t,r){var n,o;return eP&&w6(n=t.constructor)&&n!==r&&S6(o=n.prototype)&&o!==r.prototype&&eP(e,o),e},C6=$e,_6=ct,O6=Ve,tP=Hm,R6=qr,E6=Wd,T6=IR,k6=MR,P6=St,$6=dn,ab=Lt,lb=Le,A6=oj,I6=Lm,M6=xR,Fm=function(e,t,r){var n=e.indexOf("Map")!==-1,o=e.indexOf("Weak")!==-1,i=n?"set":"add",a=_6[e],l=a&&a.prototype,s=a,u={},f=function(w){var S=O6(l[w]);R6(l,w,w=="add"?function(P){return S(this,P===0?0:P),this}:w=="delete"?function(C){return o&&!ab(C)?!1:S(this,C===0?0:C)}:w=="get"?function(P){return o&&!ab(P)?void 0:S(this,P===0?0:P)}:w=="has"?function(P){return o&&!ab(P)?!1:S(this,P===0?0:P)}:function(P,R){return S(this,P===0?0:P,R),this})},c=tP(e,!P6(a)||!(o||l.forEach&&!lb(function(){new a().entries().next()})));if(c)s=r.getConstructor(t,e,n,i),E6.enable();else if(tP(e,!0)){var h=new s,d=h[i](o?{}:-0,1)!=h,v=lb(function(){h.has(1)}),y=A6(function(w){new a(w)}),p=!o&&lb(function(){for(var w=new a,S=5;S--;)w[i](S,S);return!w.has(-0)});y||(s=t(function(w,S){k6(w,l);var C=M6(new a,w,s);return $6(S)||T6(S,C[i],{that:C,AS_ENTRIES:n}),C}),s.prototype=l,l.constructor=s),(v||p)&&(f("delete"),f("has"),n&&f("get")),(p||d)&&f(i),o&&l.clear&&delete l.clear}return u[e]=s,C6({global:!0,constructor:!0,forced:s!=a},u),I6(s,e),o||r.setStrong(s,e,n),s},rP=LL,x6=yr,Yd=function(e,t,r){return r.get&&rP(r.get,t,{getter:!0}),r.set&&rP(r.set,t,{setter:!0}),x6.f(e,t,r)},D6=qr,DR=function(e,t,r){for(var n in t)D6(e,n,t[n],r);return e},N6=No,H6=Yd,L6=mt,j6=jt,nP=L6("species"),ij=function(e){var t=N6(e);j6&&t&&!t[nP]&&H6(t,nP,{configurable:!0,get:function(){return this}})},F6=sf,B6=Yd,oP=DR,V6=zd,W6=MR,U6=dn,z6=IR,Y6=SR,Tv=CR,G6=ij,Of=jt,iP=Wd.fastKey,aj=Ho,aP=aj.set,sb=aj.getterFor,lj={getConstructor:function(e,t,r,n){var o=e(function(u,f){W6(u,i),aP(u,{type:t,index:F6(null),first:void 0,last:void 0,size:0}),Of||(u.size=0),U6(f)||z6(f,u[n],{that:u,AS_ENTRIES:r})}),i=o.prototype,a=sb(t),l=function(u,f,c){var h=a(u),d=s(u,f),v,y;return d?d.value=c:(h.last=d={index:y=iP(f,!0),key:f,value:c,previous:v=h.last,next:void 0,removed:!1},h.first||(h.first=d),v&&(v.next=d),Of?h.size++:u.size++,y!=="F"&&(h.index[y]=d)),u},s=function(u,f){var c=a(u),h=iP(f),d;if(h!=="F")return c.index[h];for(d=c.first;d;d=d.next)if(d.key==f)return d};return oP(i,{clear:function(){for(var f=this,c=a(f),h=c.index,d=c.first;d;)d.removed=!0,d.previous&&(d.previous=d.previous.next=void 0),delete h[d.index],d=d.next;c.first=c.last=void 0,Of?c.size=0:f.size=0},delete:function(u){var f=this,c=a(f),h=s(f,u);if(h){var d=h.next,v=h.previous;delete c.index[h.index],h.removed=!0,v&&(v.next=d),d&&(d.previous=v),c.first==h&&(c.first=d),c.last==h&&(c.last=v),Of?c.size--:f.size--}return!!h},forEach:function(f){for(var c=a(this),h=V6(f,arguments.length>1?arguments[1]:void 0),d;d=d?d.next:c.first;)for(h(d.value,d.key,this);d&&d.removed;)d=d.previous},has:function(f){return!!s(this,f)}}),oP(i,r?{get:function(f){var c=s(this,f);return c&&c.value},set:function(f,c){return l(this,f===0?0:f,c)}}:{add:function(f){return l(this,f=f===0?0:f,f)}}),Of&&B6(i,"size",{configurable:!0,get:function(){return a(this).size}}),o},setStrong:function(e,t,r){var n=t+" Iterator",o=sb(t),i=sb(n);Y6(e,t,function(a,l){aP(this,{type:n,target:a,state:o(a),kind:l,last:void 0})},function(){for(var a=i(this),l=a.kind,s=a.last;s&&s.removed;)s=s.previous;return!a.target||!(a.last=s=s?s.next:a.state.first)?(a.target=void 0,Tv(void 0,!0)):l=="keys"?Tv(s.key,!1):l=="values"?Tv(s.value,!1):Tv([s.key,s.value],!1)},r?"entries":"values",!r,!0),G6(t)}},K6=Fm,q6=lj;K6("Set",function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}},q6);var X6=jm,Z6=String,Ft=function(e){if(X6(e)==="Symbol")throw TypeError("Cannot convert a Symbol value to a string");return Z6(e)},NR=Ve,Q6=_i,J6=Ft,e8=Or,t8=NR("".charAt),lP=NR("".charCodeAt),r8=NR("".slice),sP=function(e){return function(t,r){var n=J6(e8(t)),o=Q6(r),i=n.length,a,l;return o<0||o>=i?e?"":void 0:(a=lP(n,o),a<55296||a>56319||o+1===i||(l=lP(n,o+1))<56320||l>57343?e?t8(n,o):a:e?r8(n,o,o+2):(a-55296<<10)+(l-56320)+65536)}},HR={codeAt:sP(!1),charAt:sP(!0)},n8=HR.charAt,o8=Ft,sj=Ho,i8=SR,uP=CR,uj="String Iterator",a8=sj.set,l8=sj.getterFor(uj);i8(String,"String",function(e){a8(this,{type:uj,string:o8(e),index:0})},function(){var t=l8(this),r=t.string,n=t.index,o;return n>=r.length?uP(void 0,!0):(o=n8(r,n),t.index+=o.length,uP(o,!1))});var fj={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0},s8=xm,ub=s8("span").classList,fP=ub&&ub.constructor&&ub.constructor.prototype,cj=fP===Object.prototype?void 0:fP,cP=ct,hj=fj,u8=cj,Jf=UK,fb=za,dj=mt,cb=dj("iterator"),hP=dj("toStringTag"),hb=Jf.values,vj=function(e,t){if(e){if(e[cb]!==hb)try{fb(e,cb,hb)}catch{e[cb]=hb}if(e[hP]||fb(e,hP,t),hj[t]){for(var r in Jf)if(e[r]!==Jf[r])try{fb(e,r,Jf[r])}catch{e[r]=Jf[r]}}}};for(var db in hj)vj(cP[db]&&cP[db].prototype,db);vj(u8,"DOMTokenList");var f8=$e,c8=gR.includes,h8=Le,d8=Dd,v8=h8(function(){return!Array(1).includes()});f8({target:"Array",proto:!0,forced:v8},{includes:function(t){return c8(this,t,arguments.length>1?arguments[1]:void 0)}});d8("includes");var dP=lf,y8=TypeError,yj=function(e,t){if(!delete e[t])throw y8("Cannot delete property "+dP(t)+" of "+dP(e))},vP=ER,g8=Math.floor,MS=function(e,t){var r=e.length,n=g8(r/2);return r<8?m8(e,t):p8(e,MS(vP(e,0,n),t),MS(vP(e,n),t),t)},m8=function(e,t){for(var r=e.length,n=1,o,i;n<r;){for(i=n,o=e[n];i&&t(e[i-1],o)>0;)e[i]=e[--i];i!==n++&&(e[i]=o)}return e},p8=function(e,t,r,n){for(var o=t.length,i=r.length,a=0,l=0;a<o||l<i;)e[a+l]=a<o&&l<i?n(t[a],r[l])<=0?t[a++]:r[l++]:a<o?t[a++]:r[l++];return e},b8=MS,w8=Le,ff=function(e,t){var r=[][e];return!!r&&w8(function(){r.call(null,t||function(){return 1},1)})},S8=Ba,yP=S8.match(/firefox\/(\d+)/i),C8=!!yP&&+yP[1],_8=Ba,O8=/MSIE|Trident/.test(_8),R8=Ba,gP=R8.match(/AppleWebKit\/(\d+)\./),E8=!!gP&&+gP[1],T8=$e,gj=Ve,k8=Va,P8=Rr,mP=Kr,$8=yj,pP=Ft,LR=Le,A8=b8,I8=ff,bP=C8,M8=O8,wP=$d,SP=E8,ri=[],CP=gj(ri.sort),x8=gj(ri.push),D8=LR(function(){ri.sort(void 0)}),N8=LR(function(){ri.sort(null)}),H8=I8("sort"),mj=!LR(function(){if(wP)return wP<70;if(!(bP&&bP>3)){if(M8)return!0;if(SP)return SP<603;var e="",t,r,n,o;for(t=65;t<76;t++){switch(r=String.fromCharCode(t),t){case 66:case 69:case 70:case 72:n=3;break;case 68:case 71:n=4;break;default:n=2}for(o=0;o<47;o++)ri.push({k:r+o,v:n})}for(ri.sort(function(i,a){return a.v-i.v}),o=0;o<ri.length;o++)r=ri[o].k.charAt(0),e.charAt(e.length-1)!==r&&(e+=r);return e!=="DGBEFHACIJK"}}),L8=D8||!N8||!H8||!mj,j8=function(e){return function(t,r){return r===void 0?-1:t===void 0?1:e!==void 0?+e(t,r)||0:pP(t)>pP(r)?1:-1}};T8({target:"Array",proto:!0,forced:L8},{sort:function(t){t!==void 0&&k8(t);var r=P8(this);if(mj)return t===void 0?CP(r):CP(r,t);var n=[],o=mP(r),i,a;for(a=0;a<o;a++)a in r&&x8(n,r[a]);for(A8(n,j8(t)),i=mP(n),a=0;a<i;)r[a]=n[a++];for(;a<o;)$8(r,a++);return r}});var F8=Nn,cf=Array.isArray||function(t){return F8(t)=="Array"},B8=jt,V8=cf,W8=TypeError,U8=Object.getOwnPropertyDescriptor,z8=B8&&!function(){if(this!==void 0)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(e){return e instanceof TypeError}}(),Y8=z8?function(e,t){if(V8(e)&&!U8(e,"length").writable)throw W8("Cannot set read only .length");return e.length=t}:function(e,t){return e.length=t},G8=TypeError,K8=9007199254740991,pj=function(e){if(e>K8)throw G8("Maximum allowed index exceeded");return e},q8=Ve,X8=Le,bj=St,Z8=jm,Q8=No,J8=NL,wj=function(){},e5=[],Sj=Q8("Reflect","construct"),jR=/^\s*(?:class|function)\b/,t5=q8(jR.exec),r5=!jR.exec(wj),Rf=function(t){if(!bj(t))return!1;try{return Sj(wj,e5,t),!0}catch{return!1}},Cj=function(t){if(!bj(t))return!1;switch(Z8(t)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return r5||!!t5(jR,J8(t))}catch{return!0}};Cj.sham=!0;var Bm=!Sj||X8(function(){var e;return Rf(Rf.call)||!Rf(Object)||!Rf(function(){e=!0})||e})?Cj:Rf,_P=cf,n5=Bm,o5=Lt,i5=mt,a5=i5("species"),OP=Array,l5=function(e){var t;return _P(e)&&(t=e.constructor,n5(t)&&(t===OP||_P(t.prototype))?t=void 0:o5(t)&&(t=t[a5],t===null&&(t=void 0))),t===void 0?OP:t},s5=l5,FR=function(e,t){return new(s5(e))(t===0?0:t)},u5=Le,f5=mt,c5=$d,h5=f5("species"),Gd=function(e){return c5>=51||!u5(function(){var t=[],r=t.constructor={};return r[h5]=function(){return{foo:1}},t[e](Boolean).foo!==1})},d5=$e,v5=Rr,y5=Id,g5=_i,m5=Kr,p5=Y8,b5=pj,w5=FR,S5=uf,vb=yj,C5=Gd,_5=C5("splice"),O5=Math.max,R5=Math.min;d5({target:"Array",proto:!0,forced:!_5},{splice:function(t,r){var n=v5(this),o=m5(n),i=y5(t,o),a=arguments.length,l,s,u,f,c,h;for(a===0?l=s=0:a===1?(l=0,s=o-i):(l=a-2,s=R5(O5(g5(r),0),o-i)),b5(o+l-s),u=w5(n,s),f=0;f<s;f++)c=i+f,c in n&&S5(u,f,n[c]);if(u.length=s,l<s){for(f=i;f<o-s;f++)c=f+s,h=f+l,c in n?n[h]=n[c]:vb(n,h);for(f=o;f>o-s+l;f--)vb(n,f-1)}else if(l>s)for(f=o-s;f>i;f--)c=f+s-1,h=f+l-1,c in n?n[h]=n[c]:vb(n,h);for(f=0;f<l;f++)n[f+i]=arguments[f+2];return p5(n,o-s+l),u}});var E5=Lt,T5=Math.floor,k5=Number.isInteger||function(t){return!E5(t)&&isFinite(t)&&T5(t)===t},P5=$e,$5=k5;P5({target:"Number",stat:!0},{isInteger:$5});var A5=ct,_j=A5,I5=Ve,Oj=I5(1 .valueOf),Rj=`	
\v\f\r Â áââââââââââââ¯âã\u2028\u2029\uFEFF`,M5=Ve,x5=Or,D5=Ft,xS=Rj,RP=M5("".replace),N5=RegExp("^["+xS+"]+"),H5=RegExp("(^|[^"+xS+"])["+xS+"]+$"),yb=function(e){return function(t){var r=D5(x5(t));return e&1&&(r=RP(r,N5,"")),e&2&&(r=RP(r,H5,"$1")),r}},Ej={start:yb(1),end:yb(2),trim:yb(3)},L5=$e,Tj=Dz,j5=jt,kj=ct,Pj=_j,$j=Ve,F5=Hm,EP=kt,B5=xR,V5=Ci,W5=Ad,Aj=RL,U5=Le,z5=Ya.f,Y5=Hn.f,G5=yr.f,K5=Oj,q5=Ej.trim,Vm="Number",Ll=kj[Vm];Pj[Vm];var BR=Ll.prototype,X5=kj.TypeError,Z5=$j("".slice),kv=$j("".charCodeAt),Q5=function(e){var t=Aj(e,"number");return typeof t=="bigint"?t:J5(t)},J5=function(e){var t=Aj(e,"number"),r,n,o,i,a,l,s,u;if(W5(t))throw X5("Cannot convert a Symbol value to a number");if(typeof t=="string"&&t.length>2){if(t=q5(t),r=kv(t,0),r===43||r===45){if(n=kv(t,2),n===88||n===120)return NaN}else if(r===48){switch(kv(t,1)){case 66:case 98:o=2,i=49;break;case 79:case 111:o=8,i=55;break;default:return+t}for(a=Z5(t,2),l=a.length,s=0;s<l;s++)if(u=kv(a,s),u<48||u>i)return NaN;return parseInt(a,o)}}return+t},VR=F5(Vm,!Ll(" 0o1")||!Ll("0b1")||Ll("+0x1")),e7=function(e){return V5(BR,e)&&U5(function(){K5(e)})},Wm=function(t){var r=arguments.length<1?0:Ll(Q5(t));return e7(this)?B5(Object(r),this,Wm):r};Wm.prototype=BR;VR&&!Tj&&(BR.constructor=Wm);L5({global:!0,constructor:!0,wrap:!0,forced:VR},{Number:Wm});var t7=function(e,t){for(var r=j5?z5(t):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,isFinite,isInteger,isNaN,isSafeInteger,parseFloat,parseInt,fromString,range".split(","),n=0,o;r.length>n;n++)EP(t,o=r[n])&&!EP(e,o)&&G5(e,o,Y5(t,o))};(VR||Tj)&&t7(Pj[Vm],Ll);var r7=Ve,Kd=r7([].slice),n7=$e,TP=cf,o7=Bm,i7=Lt,kP=Id,a7=Kr,l7=Lr,s7=uf,u7=mt,f7=Gd,c7=Kd,h7=f7("slice"),d7=u7("species"),gb=Array,v7=Math.max;n7({target:"Array",proto:!0,forced:!h7},{slice:function(t,r){var n=l7(this),o=a7(n),i=kP(t,o),a=kP(r===void 0?o:r,o),l,s,u;if(TP(n)&&(l=n.constructor,o7(l)&&(l===gb||TP(l.prototype))?l=void 0:i7(l)&&(l=l[d7],l===null&&(l=void 0)),l===gb||l===void 0))return c7(n,i,a);for(s=new(l===void 0?gb:l)(v7(a-i,0)),u=0;i<a;i++,u++)i in n&&s7(s,u,n[i]);return s.length=u,s}});var y7=$e,g7=Le,m7=cf,p7=Lt,b7=Rr,w7=Kr,PP=pj,$P=uf,S7=FR,C7=Gd,_7=mt,O7=$d,Ij=_7("isConcatSpreadable"),R7=O7>=51||!g7(function(){var e=[];return e[Ij]=!1,e.concat()[0]!==e}),E7=function(e){if(!p7(e))return!1;var t=e[Ij];return t!==void 0?!!t:m7(e)},T7=!R7||!C7("concat");y7({target:"Array",proto:!0,arity:1,forced:T7},{concat:function(t){var r=b7(this),n=S7(r,0),o=0,i,a,l,s,u;for(i=-1,l=arguments.length;i<l;i++)if(u=i===-1?r:arguments[i],E7(u))for(s=w7(u),PP(o+s),a=0;a<s;a++,o++)a in u&&$P(n,o,u[a]);else PP(o+1),$P(n,o++,u);return n.length=o,n}});var k7=Rr,AP=Id,P7=Kr,$7=function(t){for(var r=k7(this),n=P7(r),o=arguments.length,i=AP(o>1?arguments[1]:void 0,n),a=o>2?arguments[2]:void 0,l=a===void 0?n:AP(a,n);l>i;)r[i++]=t;return r},A7=$e,I7=$7,M7=Dd;A7({target:"Array",proto:!0},{fill:I7});M7("fill");var x7=zd,D7=Ve,N7=Pd,H7=Rr,L7=Kr,j7=FR,IP=D7([].push),Vo=function(e){var t=e==1,r=e==2,n=e==3,o=e==4,i=e==6,a=e==7,l=e==5||i;return function(s,u,f,c){for(var h=H7(s),d=N7(h),v=x7(u,f),y=L7(d),p=0,w=c||j7,S=t?w(s,y):r||a?w(s,0):void 0,C,P;y>p;p++)if((l||p in d)&&(C=d[p],P=v(C,p,h),e))if(t)S[p]=P;else if(P)switch(e){case 3:return!0;case 5:return C;case 6:return p;case 2:IP(S,C)}else switch(e){case 4:return!1;case 7:IP(S,C)}return i?-1:n||o?o:S}},Ga={forEach:Vo(0),map:Vo(1),filter:Vo(2),some:Vo(3),every:Vo(4),find:Vo(5),findIndex:Vo(6),filterReject:Vo(7)},F7=$e,B7=Ga.map,V7=Gd,W7=V7("map");F7({target:"Array",proto:!0,forced:!W7},{map:function(t){return B7(this,t,arguments.length>1?arguments[1]:void 0)}});var U7=Mt,Mj=function(){var e=U7(this),t="";return e.hasIndices&&(t+="d"),e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.dotAll&&(t+="s"),e.unicode&&(t+="u"),e.unicodeSets&&(t+="v"),e.sticky&&(t+="y"),t},WR=Le,z7=ct,UR=z7.RegExp,zR=WR(function(){var e=UR("a","y");return e.lastIndex=2,e.exec("abcd")!=null}),Y7=zR||WR(function(){return!UR("a","y").sticky}),G7=zR||WR(function(){var e=UR("^r","gy");return e.lastIndex=2,e.exec("str")!=null}),YR={BROKEN_CARET:G7,MISSED_STICKY:Y7,UNSUPPORTED_Y:zR},K7=Le,q7=ct,X7=q7.RegExp,xj=K7(function(){var e=X7(".","s");return!(e.dotAll&&e.exec(`
`)&&e.flags==="s")}),Z7=Le,Q7=ct,J7=Q7.RegExp,Dj=Z7(function(){var e=J7("(?<a>b)","g");return e.exec("b").groups.a!=="b"||"b".replace(e,"$<a>c")!=="bc"}),Dl=Ut,Um=Ve,e9=Ft,t9=Mj,r9=YR,n9=of,o9=sf,i9=Ho.get,a9=xj,l9=Dj,s9=n9("native-string-replace",String.prototype.replace),wg=RegExp.prototype.exec,DS=wg,u9=Um("".charAt),f9=Um("".indexOf),c9=Um("".replace),mb=Um("".slice),NS=function(){var e=/a/,t=/b*/g;return Dl(wg,e,"a"),Dl(wg,t,"a"),e.lastIndex!==0||t.lastIndex!==0}(),Nj=r9.BROKEN_CARET,HS=/()??/.exec("")[1]!==void 0,h9=NS||HS||Nj||a9||l9;h9&&(DS=function(t){var r=this,n=i9(r),o=e9(t),i=n.raw,a,l,s,u,f,c,h;if(i)return i.lastIndex=r.lastIndex,a=Dl(DS,i,o),r.lastIndex=i.lastIndex,a;var d=n.groups,v=Nj&&r.sticky,y=Dl(t9,r),p=r.source,w=0,S=o;if(v&&(y=c9(y,"y",""),f9(y,"g")===-1&&(y+="g"),S=mb(o,r.lastIndex),r.lastIndex>0&&(!r.multiline||r.multiline&&u9(o,r.lastIndex-1)!==`
`)&&(p="(?: "+p+")",S=" "+S,w++),l=new RegExp("^(?:"+p+")",y)),HS&&(l=new RegExp("^"+p+"$(?!\\s)",y)),NS&&(s=r.lastIndex),u=Dl(wg,v?l:r,S),v?u?(u.input=mb(u.input,w),u[0]=mb(u[0],w),u.index=r.lastIndex,r.lastIndex+=u[0].length):r.lastIndex=0:NS&&u&&(r.lastIndex=r.global?u.index+u[0].length:s),HS&&u&&u.length>1&&Dl(s9,u[0],l,function(){for(f=1;f<arguments.length-2;f++)arguments[f]===void 0&&(u[f]=void 0)}),u&&d)for(u.groups=c=o9(null),f=0;f<d.length;f++)h=d[f],c[h[0]]=u[h[1]];return u});var zm=DS,d9=$e,MP=zm;d9({target:"RegExp",proto:!0,forced:/./.exec!==MP},{exec:MP});var v9=kd,Hj=Function.prototype,xP=Hj.apply,DP=Hj.call,Ka=typeof Reflect=="object"&&Reflect.apply||(v9?DP.bind(xP):function(){return DP.apply(xP,arguments)}),NP=Ud,HP=qr,y9=zm,LP=Le,Lj=mt,g9=za,m9=Lj("species"),pb=RegExp.prototype,Ym=function(e,t,r,n){var o=Lj(e),i=!LP(function(){var u={};return u[o]=function(){return 7},""[e](u)!=7}),a=i&&!LP(function(){var u=!1,f=/a/;return e==="split"&&(f={},f.constructor={},f.constructor[m9]=function(){return f},f.flags="",f[o]=/./[o]),f.exec=function(){return u=!0,null},f[o](""),!u});if(!i||!a||r){var l=NP(/./[o]),s=t(o,""[e],function(u,f,c,h,d){var v=NP(u),y=f.exec;return y===y9||y===pb.exec?i&&!d?{done:!0,value:l(f,c,h)}:{done:!0,value:v(c,f,h)}:{done:!1}});HP(String.prototype,e,s[0]),HP(pb,o,s[1])}n&&g9(pb[o],"sham",!0)},p9=HR.charAt,GR=function(e,t,r){return t+(r?p9(e,t).length:1)},KR=Ve,b9=Rr,w9=Math.floor,bb=KR("".charAt),S9=KR("".replace),wb=KR("".slice),C9=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,_9=/\$([$&'`]|\d{1,2})/g,O9=function(e,t,r,n,o,i){var a=r+e.length,l=n.length,s=_9;return o!==void 0&&(o=b9(o),s=C9),S9(i,s,function(u,f){var c;switch(bb(f,0)){case"$":return"$";case"&":return e;case"`":return wb(t,0,r);case"'":return wb(t,a);case"<":c=o[wb(f,1,-1)];break;default:var h=+f;if(h===0)return u;if(h>l){var d=w9(h/10);return d===0?u:d<=l?n[d-1]===void 0?bb(f,1):n[d-1]+bb(f,1):u}c=n[h-1]}return c===void 0?"":c})},jP=Ut,R9=Mt,E9=St,T9=Nn,k9=zm,P9=TypeError,Gm=function(e,t){var r=e.exec;if(E9(r)){var n=jP(r,e,t);return n!==null&&R9(n),n}if(T9(e)==="RegExp")return jP(k9,e,t);throw P9("RegExp#exec called on incompatible receiver")},$9=Ka,FP=Ut,Km=Ve,A9=Ym,I9=Le,M9=Mt,x9=St,D9=dn,N9=_i,H9=Ua,el=Ft,L9=Or,j9=GR,F9=Wa,B9=O9,V9=Gm,W9=mt,LS=W9("replace"),U9=Math.max,z9=Math.min,Y9=Km([].concat),Sb=Km([].push),BP=Km("".indexOf),VP=Km("".slice),G9=function(e){return e===void 0?e:String(e)},K9=function(){return"a".replace(/./,"$0")==="$0"}(),WP=function(){return/./[LS]?/./[LS]("a","$0")==="":!1}(),q9=!I9(function(){var e=/./;return e.exec=function(){var t=[];return t.groups={a:"7"},t},"".replace(e,"$<a>")!=="7"});A9("replace",function(e,t,r){var n=WP?"$":"$0";return[function(i,a){var l=L9(this),s=D9(i)?void 0:F9(i,LS);return s?FP(s,i,l,a):FP(t,el(l),i,a)},function(o,i){var a=M9(this),l=el(o);if(typeof i=="string"&&BP(i,n)===-1&&BP(i,"$<")===-1){var s=r(t,a,l,i);if(s.done)return s.value}var u=x9(i);u||(i=el(i));var f=a.global;if(f){var c=a.unicode;a.lastIndex=0}for(var h=[];;){var d=V9(a,l);if(d===null||(Sb(h,d),!f))break;var v=el(d[0]);v===""&&(a.lastIndex=j9(l,H9(a.lastIndex),c))}for(var y="",p=0,w=0;w<h.length;w++){d=h[w];for(var S=el(d[0]),C=U9(z9(N9(d.index),l.length),0),P=[],R=1;R<d.length;R++)Sb(P,G9(d[R]));var W=d.groups;if(u){var Y=Y9([S],P,C,l);W!==void 0&&Sb(Y,W);var q=el($9(i,void 0,Y))}else q=B9(S,l,C,P,W,i);C>=p&&(y+=VP(l,p,C)+q,p=C+S.length)}return y+VP(l,p)}]},!q9||!K9||WP);var X9=$e,Z9=Ga.filter,Q9=Gd,J9=Q9("filter");X9({target:"Array",proto:!0,forced:!J9},{filter:function(t){return Z9(this,t,arguments.length>1?arguments[1]:void 0)}});var eq=Mt,tq=tj,rq=function(e,t,r,n){try{return n?t(eq(r)[0],r[1]):t(r)}catch(o){tq(e,"throw",o)}},nq=zd,oq=Ut,iq=Rr,aq=rq,lq=JL,sq=Bm,uq=Kr,UP=uf,fq=ej,cq=AR,zP=Array,hq=function(t){var r=iq(t),n=sq(this),o=arguments.length,i=o>1?arguments[1]:void 0,a=i!==void 0;a&&(i=nq(i,o>2?arguments[2]:void 0));var l=cq(r),s=0,u,f,c,h,d,v;if(l&&!(this===zP&&lq(l)))for(h=fq(r,l),d=h.next,f=n?new this:[];!(c=oq(d,h)).done;s++)v=a?aq(h,i,[c.value,s],!0):c.value,UP(f,s,v);else for(u=uq(r),f=n?new this(u):zP(u);u>s;s++)v=a?i(r[s],s):r[s],UP(f,s,v);return f.length=s,f},dq=$e,vq=hq,yq=oj,gq=!yq(function(e){Array.from(e)});dq({target:"Array",stat:!0,forced:gq},{from:vq});var mq=$e,pq=Ud,bq=gR.indexOf,wq=ff,jS=pq([].indexOf),jj=!!jS&&1/jS([1],1,-0)<0,Sq=jj||!wq("indexOf");mq({target:"Array",proto:!0,forced:Sq},{indexOf:function(t){var r=arguments.length>1?arguments[1]:void 0;return jj?jS(this,t,r)||0:bq(this,t,r)}});var Cq=$e,_q=Ve,Oq=cf,Rq=_q([].reverse),YP=[1,2];Cq({target:"Array",proto:!0,forced:String(YP)===String(YP.reverse())},{reverse:function(){return Oq(this)&&(this.length=this.length),Rq(this)}});var Eq=Ga.forEach,Tq=ff,kq=Tq("forEach"),Pq=kq?[].forEach:function(t){return Eq(this,t,arguments.length>1?arguments[1]:void 0)},GP=ct,KP=fj,$q=cj,Cb=Pq,Aq=za,Fj=function(e){if(e&&e.forEach!==Cb)try{Aq(e,"forEach",Cb)}catch{e.forEach=Cb}};for(var _b in KP)KP[_b]&&Fj(GP[_b]&&GP[_b].prototype);Fj($q);var Iq=typeof Bun=="function"&&Bun&&typeof Bun.version=="string",Mq=TypeError,Bj=function(e,t){if(e<t)throw Mq("Not enough arguments");return e},Vj=ct,xq=Ka,Dq=St,Nq=Iq,Hq=Ba,Lq=Kd,jq=Bj,Fq=Vj.Function,Bq=/MSIE .\./.test(Hq)||Nq&&function(){var e=Vj.Bun.version.split(".");return e.length<3||e[0]==0&&(e[1]<3||e[1]==3&&e[2]==0)}(),qR=function(e,t){var r=t?2:1;return Bq?function(n,o){var i=jq(arguments.length,1)>r,a=Dq(n)?n:Fq(n),l=i?Lq(arguments,r):[],s=i?function(){xq(a,this,l)}:a;return t?e(s,o):e(s)}:e},Vq=$e,Wj=ct,Wq=qR,qP=Wq(Wj.setInterval,!0);Vq({global:!0,bind:!0,forced:Wj.setInterval!==qP},{setInterval:qP});var Uq=$e,Uj=ct,zq=qR,XP=zq(Uj.setTimeout,!0);Uq({global:!0,bind:!0,forced:Uj.setTimeout!==XP},{setTimeout:XP});var Yq=Ba,Gq=/(?:ipad|iphone|ipod).*applewebkit/i.test(Yq),Kq=Nn,zj=typeof process<"u"&&Kq(process)=="process",Nr=ct,qq=Ka,Xq=zd,ZP=St,Zq=kt,Yj=Le,QP=TL,Qq=Kd,JP=xm,Jq=Bj,eX=Gq,tX=zj,FS=Nr.setImmediate,BS=Nr.clearImmediate,rX=Nr.process,Ob=Nr.Dispatch,nX=Nr.Function,e$=Nr.MessageChannel,oX=Nr.String,Rb=0,ac={},t$="onreadystatechange",Cc,ki,Eb,Tb;Yj(function(){Cc=Nr.location});var XR=function(e){if(Zq(ac,e)){var t=ac[e];delete ac[e],t()}},kb=function(e){return function(){XR(e)}},r$=function(e){XR(e.data)},n$=function(e){Nr.postMessage(oX(e),Cc.protocol+"//"+Cc.host)};(!FS||!BS)&&(FS=function(t){Jq(arguments.length,1);var r=ZP(t)?t:nX(t),n=Qq(arguments,1);return ac[++Rb]=function(){qq(r,void 0,n)},ki(Rb),Rb},BS=function(t){delete ac[t]},tX?ki=function(e){rX.nextTick(kb(e))}:Ob&&Ob.now?ki=function(e){Ob.now(kb(e))}:e$&&!eX?(Eb=new e$,Tb=Eb.port2,Eb.port1.onmessage=r$,ki=Xq(Tb.postMessage,Tb)):Nr.addEventListener&&ZP(Nr.postMessage)&&!Nr.importScripts&&Cc&&Cc.protocol!=="file:"&&!Yj(n$)?(ki=n$,Nr.addEventListener("message",r$,!1)):t$ in JP("script")?ki=function(e){QP.appendChild(JP("script"))[t$]=function(){QP.removeChild(this),XR(e)}}:ki=function(e){setTimeout(kb(e),0)});var Gj={set:FS,clear:BS},iX=$e,aX=ct,o$=Gj.clear;iX({global:!0,bind:!0,enumerable:!0,forced:aX.clearImmediate!==o$},{clearImmediate:o$});var lX=$e,Kj=ct,i$=Gj.set,sX=qR,a$=Kj.setImmediate?sX(i$,!1):i$;lX({global:!0,bind:!0,enumerable:!0,forced:Kj.setImmediate!==a$},{setImmediate:a$});var uX=Fm,fX=lj;uX("Map",function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}},fX);var ZR={},cX=mt;ZR.f=cX;var l$=_j,hX=kt,dX=ZR,vX=yr.f,QR=function(e){var t=l$.Symbol||(l$.Symbol={});hX(t,e)||vX(t,e,{value:dX.f(e)})},yX=Ut,gX=No,mX=mt,pX=qr,qj=function(){var e=gX("Symbol"),t=e&&e.prototype,r=t&&t.valueOf,n=mX("toPrimitive");t&&!t[n]&&pX(t,n,function(o){return yX(r,this)},{arity:1})},qm=$e,JR=ct,eE=Ut,bX=Ve,Jl=jt,es=af,wX=Le,Xt=kt,SX=Ci,VS=Mt,Xm=Lr,tE=Dm,CX=Ft,WS=Hd,_c=sf,Xj=xd,_X=Ya,Zj=RR,OX=Fd,Qj=Hn,Jj=yr,RX=yR,eF=Ld,Pb=qr,EX=Yd,rE=of,TX=Nm,tF=Md,s$=Mm,kX=mt,PX=ZR,$X=QR,AX=qj,IX=Lm,rF=Ho,Zm=Ga.forEach,Sr=TX("hidden"),Qm="Symbol",Oc="prototype",MX=rF.set,u$=rF.getterFor(Qm),zr=Object[Oc],Ca=JR.Symbol,ec=Ca&&Ca[Oc],xX=JR.TypeError,$b=JR.QObject,nF=Qj.f,Gi=Jj.f,oF=Zj.f,DX=eF.f,iF=bX([].push),Io=rE("symbols"),qd=rE("op-symbols"),NX=rE("wks"),US=!$b||!$b[Oc]||!$b[Oc].findChild,zS=Jl&&wX(function(){return _c(Gi({},"a",{get:function(){return Gi(this,"a",{value:7}).a}})).a!=7})?function(e,t,r){var n=nF(zr,t);n&&delete zr[t],Gi(e,t,r),n&&e!==zr&&Gi(zr,t,n)}:Gi,Ab=function(e,t){var r=Io[e]=_c(ec);return MX(r,{type:Qm,tag:e,description:t}),Jl||(r.description=t),r},Jm=function(t,r,n){t===zr&&Jm(qd,r,n),VS(t);var o=tE(r);return VS(n),Xt(Io,o)?(n.enumerable?(Xt(t,Sr)&&t[Sr][o]&&(t[Sr][o]=!1),n=_c(n,{enumerable:WS(0,!1)})):(Xt(t,Sr)||Gi(t,Sr,WS(1,{})),t[Sr][o]=!0),zS(t,o,n)):Gi(t,o,n)},nE=function(t,r){VS(t);var n=Xm(r),o=Xj(n).concat(sF(n));return Zm(o,function(i){(!Jl||eE(YS,n,i))&&Jm(t,i,n[i])}),t},HX=function(t,r){return r===void 0?_c(t):nE(_c(t),r)},YS=function(t){var r=tE(t),n=eE(DX,this,r);return this===zr&&Xt(Io,r)&&!Xt(qd,r)?!1:n||!Xt(this,r)||!Xt(Io,r)||Xt(this,Sr)&&this[Sr][r]?n:!0},aF=function(t,r){var n=Xm(t),o=tE(r);if(!(n===zr&&Xt(Io,o)&&!Xt(qd,o))){var i=nF(n,o);return i&&Xt(Io,o)&&!(Xt(n,Sr)&&n[Sr][o])&&(i.enumerable=!0),i}},lF=function(t){var r=oF(Xm(t)),n=[];return Zm(r,function(o){!Xt(Io,o)&&!Xt(tF,o)&&iF(n,o)}),n},sF=function(e){var t=e===zr,r=oF(t?qd:Xm(e)),n=[];return Zm(r,function(o){Xt(Io,o)&&(!t||Xt(zr,o))&&iF(n,Io[o])}),n};es||(Ca=function(){if(SX(ec,this))throw xX("Symbol is not a constructor");var t=!arguments.length||arguments[0]===void 0?void 0:CX(arguments[0]),r=s$(t),n=function(o){this===zr&&eE(n,qd,o),Xt(this,Sr)&&Xt(this[Sr],r)&&(this[Sr][r]=!1),zS(this,r,WS(1,o))};return Jl&&US&&zS(zr,r,{configurable:!0,set:n}),Ab(r,t)},ec=Ca[Oc],Pb(ec,"toString",function(){return u$(this).tag}),Pb(Ca,"withoutSetter",function(e){return Ab(s$(e),e)}),eF.f=YS,Jj.f=Jm,RX.f=nE,Qj.f=aF,_X.f=Zj.f=lF,OX.f=sF,PX.f=function(e){return Ab(kX(e),e)},Jl&&(EX(ec,"description",{configurable:!0,get:function(){return u$(this).description}}),Pb(zr,"propertyIsEnumerable",YS,{unsafe:!0})));qm({global:!0,constructor:!0,wrap:!0,forced:!es,sham:!es},{Symbol:Ca});Zm(Xj(NX),function(e){$X(e)});qm({target:Qm,stat:!0,forced:!es},{useSetter:function(){US=!0},useSimple:function(){US=!1}});qm({target:"Object",stat:!0,forced:!es,sham:!Jl},{create:HX,defineProperty:Jm,defineProperties:nE,getOwnPropertyDescriptor:aF});qm({target:"Object",stat:!0,forced:!es},{getOwnPropertyNames:lF});AX();IX(Ca,Qm);tF[Sr]=!0;var LX=af,uF=LX&&!!Symbol.for&&!!Symbol.keyFor,jX=$e,FX=No,BX=kt,VX=Ft,fF=of,WX=uF,Ib=fF("string-to-symbol-registry"),UX=fF("symbol-to-string-registry");jX({target:"Symbol",stat:!0,forced:!WX},{for:function(e){var t=VX(e);if(BX(Ib,t))return Ib[t];var r=FX("Symbol")(t);return Ib[t]=r,UX[r]=t,r}});var zX=$e,YX=kt,GX=Ad,KX=lf,qX=of,XX=uF,f$=qX("symbol-to-string-registry");zX({target:"Symbol",stat:!0,forced:!XX},{keyFor:function(t){if(!GX(t))throw TypeError(KX(t)+" is not a symbol");if(YX(f$,t))return f$[t]}});var ZX=Ve,c$=cf,QX=St,h$=Nn,JX=Ft,d$=ZX([].push),eZ=function(e){if(QX(e))return e;if(c$(e)){for(var t=e.length,r=[],n=0;n<t;n++){var o=e[n];typeof o=="string"?d$(r,o):(typeof o=="number"||h$(o)=="Number"||h$(o)=="String")&&d$(r,JX(o))}var i=r.length,a=!0;return function(l,s){if(a)return a=!1,s;if(c$(this))return s;for(var u=0;u<i;u++)if(r[u]===l)return s}}},tZ=$e,cF=No,hF=Ka,rZ=Ut,Xd=Ve,dF=Le,v$=St,y$=Ad,vF=Kd,nZ=eZ,oZ=af,iZ=String,ai=cF("JSON","stringify"),Pv=Xd(/./.exec),g$=Xd("".charAt),aZ=Xd("".charCodeAt),lZ=Xd("".replace),sZ=Xd(1 .toString),uZ=/[\uD800-\uDFFF]/g,m$=/^[\uD800-\uDBFF]$/,p$=/^[\uDC00-\uDFFF]$/,b$=!oZ||dF(function(){var e=cF("Symbol")();return ai([e])!="[null]"||ai({a:e})!="{}"||ai(Object(e))!="{}"}),w$=dF(function(){return ai("\uDF06\uD834")!=='"\\udf06\\ud834"'||ai("\uDEAD")!=='"\\udead"'}),fZ=function(e,t){var r=vF(arguments),n=nZ(t);if(!(!v$(n)&&(e===void 0||y$(e))))return r[1]=function(o,i){if(v$(n)&&(i=rZ(n,this,iZ(o),i)),!y$(i))return i},hF(ai,null,r)},cZ=function(e,t,r){var n=g$(r,t-1),o=g$(r,t+1);return Pv(m$,e)&&!Pv(p$,o)||Pv(p$,e)&&!Pv(m$,n)?"\\u"+sZ(aZ(e,0),16):e};ai&&tZ({target:"JSON",stat:!0,arity:3,forced:b$||w$},{stringify:function(t,r,n){var o=vF(arguments),i=hF(b$?fZ:ai,null,o);return w$&&typeof i=="string"?lZ(i,uZ,cZ):i}});var hZ=$e,dZ=af,vZ=Le,yF=Fd,yZ=Rr,gZ=!dZ||vZ(function(){yF.f(1)});hZ({target:"Object",stat:!0,forced:gZ},{getOwnPropertySymbols:function(t){var r=yF.f;return r?r(yZ(t)):[]}});var mZ=$e,pZ=jt,bZ=ct,$v=Ve,wZ=kt,SZ=St,CZ=Ci,_Z=Ft,OZ=Yd,RZ=FL,Qn=bZ.Symbol,Pi=Qn&&Qn.prototype;if(pZ&&SZ(Qn)&&(!("description"in Pi)||Qn().description!==void 0)){var S$={},Av=function(){var t=arguments.length<1||arguments[0]===void 0?void 0:_Z(arguments[0]),r=CZ(Pi,this)?new Qn(t):t===void 0?Qn():Qn(t);return t===""&&(S$[r]=!0),r};RZ(Av,Qn),Av.prototype=Pi,Pi.constructor=Av;var EZ=String(Qn("test"))=="Symbol(test)",TZ=$v(Pi.valueOf),kZ=$v(Pi.toString),PZ=/^Symbol\((.*)\)[^)]+$/,$Z=$v("".replace),AZ=$v("".slice);OZ(Pi,"description",{configurable:!0,get:function(){var t=TZ(this);if(wZ(S$,t))return"";var r=kZ(t),n=EZ?AZ(r,7,-1):$Z(r,PZ,"$1");return n===""?void 0:n}}),mZ({global:!0,constructor:!0,forced:!0},{Symbol:Av})}var IZ=QR;IZ("iterator");var MZ=Ut,xZ=kt,DZ=Ci,NZ=Mj,C$=RegExp.prototype,gF=function(e){var t=e.flags;return t===void 0&&!("flags"in C$)&&!xZ(e,"flags")&&DZ(C$,e)?MZ(NZ,e):t},HZ=jd.PROPER,LZ=qr,jZ=Mt,_$=Ft,FZ=Le,BZ=gF,oE="toString",VZ=RegExp.prototype,mF=VZ[oE],WZ=FZ(function(){return mF.call({source:"a",flags:"b"})!="/a/b"}),UZ=HZ&&mF.name!=oE;(WZ||UZ)&&LZ(RegExp.prototype,oE,function(){var t=jZ(this),r=_$(t.source),n=_$(BZ(t));return"/"+r+"/"+n},{unsafe:!0});var zZ=jt,YZ=jd.EXISTS,pF=Ve,GZ=Yd,bF=Function.prototype,KZ=pF(bF.toString),wF=/function\b(?:\s|\/\*[\S\s]*?\*\/|\/\/[^\n\r]*[\n\r]+)*([^\s(/]*)/,qZ=pF(wF.exec),XZ="name";zZ&&!YZ&&GZ(bF,XZ,{configurable:!0,get:function(){try{return qZ(wF,KZ(this))[1]}catch{return""}}});var ZZ=$e,QZ=Le,JZ=Rr,SF=Vd,eQ=BL,tQ=QZ(function(){SF(1)});ZZ({target:"Object",stat:!0,forced:tQ,sham:!eQ},{getPrototypeOf:function(t){return SF(JZ(t))}});var rQ=Lt,nQ=Nn,oQ=mt,iQ=oQ("match"),iE=function(e){var t;return rQ(e)&&((t=e[iQ])!==void 0?!!t:nQ(e)=="RegExp")},aQ=iE,lQ=TypeError,aE=function(e){if(aQ(e))throw lQ("The method doesn't accept regular expressions");return e},sQ=mt,uQ=sQ("match"),lE=function(e){var t=/./;try{"/./"[e](t)}catch{try{return t[uQ]=!1,"/./"[e](t)}catch{}}return!1},fQ=$e,cQ=Ve,hQ=aE,dQ=Or,O$=Ft,vQ=lE,yQ=cQ("".indexOf);fQ({target:"String",proto:!0,forced:!vQ("includes")},{includes:function(t){return!!~yQ(O$(dQ(this)),O$(hQ(t)),arguments.length>1?arguments[1]:void 0)}});var gQ=yr.f,mQ=function(e,t,r){r in e||gQ(e,r,{configurable:!0,get:function(){return t[r]},set:function(n){t[r]=n}})},pQ=jt,sE=ct,Zd=Ve,bQ=Hm,wQ=xR,SQ=za,CQ=Ya.f,R$=Ci,_Q=iE,E$=Ft,OQ=gF,CF=YR,RQ=mQ,EQ=qr,TQ=Le,kQ=kt,PQ=Ho.enforce,$Q=ij,AQ=mt,_F=xj,OF=Dj,IQ=AQ("match"),li=sE.RegExp,Pl=li.prototype,MQ=sE.SyntaxError,xQ=Zd(Pl.exec),Sg=Zd("".charAt),T$=Zd("".replace),k$=Zd("".indexOf),DQ=Zd("".slice),NQ=/^\?<[^\s\d!#%&*+<=>@^][^\s!#%&*+<=>@^]*>/,_a=/a/g,Mb=/a/g,HQ=new li(_a)!==_a,RF=CF.MISSED_STICKY,LQ=CF.UNSUPPORTED_Y,jQ=pQ&&(!HQ||RF||_F||OF||TQ(function(){return Mb[IQ]=!1,li(_a)!=_a||li(Mb)==Mb||li(_a,"i")!="/a/i"})),FQ=function(e){for(var t=e.length,r=0,n="",o=!1,i;r<=t;r++){if(i=Sg(e,r),i==="\\"){n+=i+Sg(e,++r);continue}!o&&i==="."?n+="[\\s\\S]":(i==="["?o=!0:i==="]"&&(o=!1),n+=i)}return n},BQ=function(e){for(var t=e.length,r=0,n="",o=[],i={},a=!1,l=!1,s=0,u="",f;r<=t;r++){if(f=Sg(e,r),f==="\\")f=f+Sg(e,++r);else if(f==="]")a=!1;else if(!a)switch(!0){case f==="[":a=!0;break;case f==="(":xQ(NQ,DQ(e,r+1))&&(r+=2,l=!0),n+=f,s++;continue;case(f===">"&&l):if(u===""||kQ(i,u))throw new MQ("Invalid capture group name");i[u]=!0,o[o.length]=[u,s],l=!1,u="";continue}l?u+=f:n+=f}return[n,o]};if(bQ("RegExp",jQ)){for(var $i=function(t,r){var n=R$(Pl,this),o=_Q(t),i=r===void 0,a=[],l=t,s,u,f,c,h,d;if(!n&&o&&i&&t.constructor===$i)return t;if((o||R$(Pl,t))&&(t=t.source,i&&(r=OQ(l))),t=t===void 0?"":E$(t),r=r===void 0?"":E$(r),l=t,_F&&"dotAll"in _a&&(u=!!r&&k$(r,"s")>-1,u&&(r=T$(r,/s/g,""))),s=r,RF&&"sticky"in _a&&(f=!!r&&k$(r,"y")>-1,f&&LQ&&(r=T$(r,/y/g,""))),OF&&(c=BQ(t),t=c[0],a=c[1]),h=wQ(li(t,r),n?this:Pl,$i),(u||f||a.length)&&(d=PQ(h),u&&(d.dotAll=!0,d.raw=$i(FQ(t),s)),f&&(d.sticky=!0),a.length&&(d.groups=a)),t!==l)try{SQ(h,"source",l===""?"(?:)":l)}catch{}return h},P$=CQ(li),$$=0;P$.length>$$;)RQ($i,li,P$[$$++]);Pl.constructor=$i,$i.prototype=Pl,EQ(sE,"RegExp",$i,{constructor:!0})}$Q("RegExp");var VQ=$e,WQ=Ve,UQ=Pd,zQ=Lr,YQ=ff,GQ=WQ([].join),KQ=UQ!=Object,qQ=KQ||!YQ("join",",");VQ({target:"Array",proto:!0,forced:qQ},{join:function(t){return GQ(zQ(this),t===void 0?",":t)}});var XQ=jd.PROPER,ZQ=Le,A$=Rj,I$="âÂá ",QQ=function(e){return ZQ(function(){return!!A$[e]()||I$[e]()!==I$||XQ&&A$[e].name!==e})},JQ=$e,eJ=Ej.trim,tJ=QQ;JQ({target:"String",proto:!0,forced:tJ("trim")},{trim:function(){return eJ(this)}});function GS(e){"@babel/helpers - typeof";return GS=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},GS(e)}function uE(e){return window.requestAnimationFrame(e)}function rJ(){return!!document.documentElement.classList}function nJ(){return!!document.createTextNode("test").textContent}function oJ(){return!!window.getComputedStyle}function Cg(e){window.cancelAnimationFrame(e)}function EF(){return"ontouchstart"in window}var KS;function iJ(){var e=document.createElement("TABLE");e.style.borderSpacing="0",e.style.borderWidth="0",e.style.padding="0";var t=document.createElement("TBODY");e.appendChild(t),t.appendChild(document.createElement("TR")),t.firstChild.appendChild(document.createElement("TD")),t.firstChild.firstChild.innerHTML="<tr><td>t<br>t</td></tr>";var r=document.createElement("CAPTION");r.innerHTML="c<br>c<br>c<br>c",r.style.padding="0",r.style.margin="0",e.insertBefore(r,t),document.body.appendChild(e),KS=e.offsetHeight<2*e.lastChild.offsetHeight,document.body.removeChild(e)}function TF(){return KS===void 0&&iJ(),KS}var tl;function aJ(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return tl||((typeof Intl>"u"?"undefined":GS(Intl))==="object"?tl=new Intl.Collator(e,t).compare:typeof String.prototype.localeCompare=="function"?tl=function(n,o){return"".concat(n).localeCompare(o)}:tl=function(n,o){return n===o?0:n>o?-1:1},tl)}var Ef;function lJ(){if(Ef!==void 0)return Ef;try{var e={get passive(){Ef=!0}};window.addEventListener("test",e,e),window.removeEventListener("test",e,e)}catch{Ef=!1}return Ef}var sJ=$e,uJ=Rr,kF=xd,fJ=Le,cJ=fJ(function(){kF(1)});sJ({target:"Object",stat:!0,forced:cJ},{keys:function(t){return kF(uJ(t))}});var hJ=QR,dJ=qj;hJ("toPrimitive");dJ();var vJ=Mt,yJ=OL,gJ=TypeError,mJ=function(e){if(vJ(this),e==="string"||e==="default")e="string";else if(e!=="number")throw gJ("Incorrect hint");return yJ(this,e)},pJ=kt,bJ=qr,wJ=mJ,SJ=mt,M$=SJ("toPrimitive"),x$=Date.prototype;pJ(x$,M$)||bJ(x$,M$,wJ);var CJ=Bm,_J=lf,OJ=TypeError,PF=function(e){if(CJ(e))return e;throw OJ(_J(e)+" is not a constructor")},D$=Mt,RJ=PF,EJ=dn,TJ=mt,kJ=TJ("species"),PJ=function(e,t){var r=D$(e).constructor,n;return r===void 0||EJ(n=D$(r)[kJ])?t:RJ(n)},$J=Ka,Tf=Ut,fE=Ve,AJ=Ym,IJ=Mt,MJ=dn,xJ=iE,N$=Or,DJ=PJ,NJ=GR,HJ=Ua,xb=Ft,LJ=Wa,H$=ER,L$=Gm,jJ=zm,FJ=YR,BJ=Le,rl=FJ.UNSUPPORTED_Y,j$=4294967295,VJ=Math.min,$F=[].push,WJ=fE(/./.exec),nl=fE($F),kf=fE("".slice),UJ=!BJ(function(){var e=/(?:)/,t=e.exec;e.exec=function(){return t.apply(this,arguments)};var r="ab".split(e);return r.length!==2||r[0]!=="a"||r[1]!=="b"});AJ("split",function(e,t,r){var n;return"abbc".split(/(b)*/)[1]=="c"||"test".split(/(?:)/,-1).length!=4||"ab".split(/(?:ab)*/).length!=2||".".split(/(.?)(.?)/).length!=4||".".split(/()()/).length>1||"".split(/.?/).length?n=function(o,i){var a=xb(N$(this)),l=i===void 0?j$:i>>>0;if(l===0)return[];if(o===void 0)return[a];if(!xJ(o))return Tf(t,a,o,l);for(var s=[],u=(o.ignoreCase?"i":"")+(o.multiline?"m":"")+(o.unicode?"u":"")+(o.sticky?"y":""),f=0,c=new RegExp(o.source,u+"g"),h,d,v;(h=Tf(jJ,c,a))&&(d=c.lastIndex,!(d>f&&(nl(s,kf(a,f,h.index)),h.length>1&&h.index<a.length&&$J($F,s,H$(h,1)),v=h[0].length,f=d,s.length>=l)));)c.lastIndex===h.index&&c.lastIndex++;return f===a.length?(v||!WJ(c,""))&&nl(s,""):nl(s,kf(a,f)),s.length>l?H$(s,0,l):s}:"0".split(void 0,0).length?n=function(o,i){return o===void 0&&i===0?[]:Tf(t,this,o,i)}:n=t,[function(i,a){var l=N$(this),s=MJ(i)?void 0:LJ(i,e);return s?Tf(s,i,l,a):Tf(n,xb(l),i,a)},function(o,i){var a=IJ(this),l=xb(o),s=r(n,a,l,i,n!==t);if(s.done)return s.value;var u=DJ(a,RegExp),f=a.unicode,c=(a.ignoreCase?"i":"")+(a.multiline?"m":"")+(a.unicode?"u":"")+(rl?"g":"y"),h=new u(rl?"^(?:"+a.source+")":a,c),d=i===void 0?j$:i>>>0;if(d===0)return[];if(l.length===0)return L$(h,l)===null?[l]:[];for(var v=0,y=0,p=[];y<l.length;){h.lastIndex=rl?0:y;var w=L$(h,rl?kf(l,y):l),S;if(w===null||(S=VJ(HJ(h.lastIndex+(rl?y:0)),l.length))===v)y=NJ(l,y,f);else{if(nl(p,kf(l,v,y)),p.length===d)return p;for(var C=1;C<=w.length-1;C++)if(nl(p,w[C]),p.length===d)return p;y=v=S}}return nl(p,kf(l,v)),p}]},!UJ,rl);function zJ(e){for(var t=e.length,r=0;r<t;)e[r]=[e[r]],r+=1}function F$(e,t){for(var r=t.length,n=0;n<r;)e.push(t[n]),n+=1}function Dy(e){var t=[];if(!e||e.length===0||!e[0]||e[0].length===0)return t;for(var r=e.length,n=e[0].length,o=0;o<r;o++)for(var i=0;i<n;i++)t[i]||(t[i]=[]),t[i][o]=e[o][i];return t}function nr(e,t,r,n){var o=-1,i=e,a=r;Array.isArray(e)||(i=Array.from(e));var l=i.length;for(n&&l&&(o+=1,a=i[o]),o+=1;o<l;)a=t(a,i[o],o,i),o+=1;return a}function Yr(e,t){var r=0,n=e;Array.isArray(e)||(n=Array.from(e));for(var o=n.length,i=[],a=-1;r<o;){var l=n[r];t(l,r,n)&&(a+=1,i[a]=l),r+=1}return i}function Ye(e,t){var r=0,n=e;Array.isArray(e)||(n=Array.from(e));for(var o=n.length,i=[],a=-1;r<o;){var l=n[r];a+=1,i[a]=t(l,r,n),r+=1}return i}function I(e,t){var r=0,n=e;Array.isArray(e)||(n=Array.from(e));for(var o=n.length;r<o&&t(n[r],r,n)!==!1;)r+=1;return e}function AF(e){var t=[];return I(e,function(r){t.indexOf(r)===-1&&t.push(r)}),t}function B$(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var n=[].concat(t),o=n[0],i=n.slice(1),a=o;return I(i,function(l){a=a.filter(function(s){return!l.includes(s)})}),a}function V$(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:" ";return e.split(t)}function W$(e,t,r){return t=YJ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function YJ(e){var t=GJ(e,"string");return Mo(t)==="symbol"?t:String(t)}function GJ(e,t){if(Mo(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Mo(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Mo(e){"@babel/helpers - typeof";return Mo=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Mo(e)}function Rc(e){var t;return Array.isArray(e)?t=e.length?new Array(e.length).fill(null):[]:(t={},Ke(e,function(r,n){n!=="__children"&&(r&&Mo(r)==="object"&&!Array.isArray(r)?t[n]=Rc(r):Array.isArray(r)?r.length&&Mo(r[0])==="object"&&!Array.isArray(r[0])?t[n]=[Rc(r[0])]:t[n]=[]:t[n]=null)})),t}function Oi(e,t){return t.prototype.constructor=t,e.prototype=new t,e.prototype.constructor=e,e}function Wt(e,t,r){var n=Array.isArray(r);return Ke(t,function(o,i){(n===!1||r.includes(i))&&(e[i]=o)}),e}function ep(e,t){Ke(t,function(r,n){t[n]&&Mo(t[n])==="object"?(e[n]||(Array.isArray(t[n])?e[n]=[]:Object.prototype.toString.call(t[n])==="[object Date]"?e[n]=t[n]:e[n]={}),ep(e[n],t[n])):e[n]=t[n]})}function dr(e){return Mo(e)==="object"?JSON.parse(JSON.stringify(e)):e}function _r(e){var t={};return Ke(e,function(r,n){t[n]=r}),t}function dt(e){e.MIXINS||(e.MIXINS=[]);for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return I(r,function(o){e.MIXINS.push(o.MIXIN_NAME),Ke(o,function(i,a){if(e.prototype[a]!==void 0)throw new Error("Mixin conflict. Property '".concat(a,"' already exist and cannot be overwritten."));if(typeof i=="function")e.prototype[a]=i;else{var l=function(f,c){var h="_".concat(f),d=function(y){var p=y;return(Array.isArray(p)||Ge(p))&&(p=dr(p)),p};return function(){return this[h]===void 0&&(this[h]=d(c)),this[h]}},s=function(f){var c="_".concat(f);return function(h){this[c]=h}};Object.defineProperty(e.prototype,a,{get:l(a,i),set:s(a),configurable:!0})}})}),e}function cE(e,t){return JSON.stringify(e)===JSON.stringify(t)}function Ge(e){return Object.prototype.toString.call(e)==="[object Object]"}function Lo(e,t,r,n){n.value=r,n.writable=n.writable!==!1,n.enumerable=n.enumerable!==!1,n.configurable=n.configurable!==!1,Object.defineProperty(e,t,n)}function Ke(e,t){for(var r in e)if((!e.hasOwnProperty||e.hasOwnProperty&&Object.prototype.hasOwnProperty.call(e,r))&&t(e[r],r,e)===!1)break;return e}function KJ(e,t){var r=t.split("."),n=e;return Ke(r,function(o){if(n=n[o],n===void 0)return n=void 0,!1}),n}function Db(e,t,r){var n=t.split("."),o=e;n.forEach(function(i,a){a!==n.length-1?(It(o,i)||(o[i]={}),o=o[i]):o[i]=r})}function hE(e){if(!Ge(e))return 0;var t=function r(n){var o=0;return Ge(n)?Ke(n,function(i,a){a!=="__children"&&(o+=r(i))}):o+=1,o};return t(e)}function ts(e){var t,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"value",n="_".concat(r),o=(t={_touched:!1},W$(t,n,e),W$(t,"isTouched",function(){return this._touched}),t);return Object.defineProperty(o,r,{get:function(){return this[n]},set:function(a){this._touched=!0,this[n]=a},enumerable:!0,configurable:!0}),o}function It(e,t){return Object.prototype.hasOwnProperty.call(e,t)}var wr=function(t){var r={value:!1};return r.test=function(n,o){r.value=t(n,o)},r},Ln={chrome:wr(function(e,t){return/Chrome/.test(e)&&/Google/.test(t)}),chromeWebKit:wr(function(e){return/CriOS/.test(e)}),edge:wr(function(e){return/Edge/.test(e)}),edgeWebKit:wr(function(e){return/EdgiOS/.test(e)}),firefox:wr(function(e){return/Firefox/.test(e)}),firefoxWebKit:wr(function(e){return/FxiOS/.test(e)}),ie:wr(function(e){return/Trident/.test(e)}),ie9:wr(function(){return!!document.documentMode}),mobile:wr(function(e){return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(e)}),safari:wr(function(e,t){return/Safari/.test(e)&&/Apple Computer/.test(t)})},Qd={mac:wr(function(e){return/^Mac/.test(e)}),win:wr(function(e){return/^Win/.test(e)}),linux:wr(function(e){return/^Linux/.test(e)}),ios:wr(function(e){return/iPhone|iPad|iPod/i.test(e)})};function qJ(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=e.userAgent,r=t===void 0?navigator.userAgent:t,n=e.vendor,o=n===void 0?navigator.vendor:n;Ke(Ln,function(i){var a=i.test;return void a(r,o)})}function XJ(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=e.platform,r=t===void 0?navigator.platform:t;Ke(Qd,function(n){var o=n.test;return void o(r)})}qJ();XJ();function IF(){return Ln.chrome.value}function ZJ(){return Ln.chromeWebKit.value}function Nb(){return Ln.firefox.value}function QJ(){return Ln.firefoxWebKit.value}function JJ(){return Ln.safari.value}function eee(){return Ln.edge.value}function tee(){return Ln.ie.value}function ree(){return Ln.ie9.value}function An(){return Ln.mobile.value}function MF(){return Qd.ios.value}function xF(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:navigator,t=e.maxTouchPoints;return t>2&&Qd.mac.value}function U$(){return Qd.win.value}function z$(){return Qd.mac.value}/*! @license DOMPurify 2.4.7 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/2.4.7/LICENSE */function ei(e){"@babel/helpers - typeof";return ei=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ei(e)}function qS(e,t){return qS=Object.setPrototypeOf||function(n,o){return n.__proto__=o,n},qS(e,t)}function nee(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ny(e,t,r){return nee()?Ny=Reflect.construct:Ny=function(o,i,a){var l=[null];l.push.apply(l,i);var s=Function.bind.apply(o,l),u=new s;return a&&qS(u,a.prototype),u},Ny.apply(null,arguments)}function rn(e){return oee(e)||iee(e)||aee(e)||lee()}function oee(e){if(Array.isArray(e))return XS(e)}function iee(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function aee(e,t){if(e){if(typeof e=="string")return XS(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return XS(e,t)}}function XS(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function lee(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var see=Object.hasOwnProperty,Y$=Object.setPrototypeOf,uee=Object.isFrozen,fee=Object.getPrototypeOf,cee=Object.getOwnPropertyDescriptor,vr=Object.freeze,fn=Object.seal,hee=Object.create,DF=typeof Reflect<"u"&&Reflect,_g=DF.apply,ZS=DF.construct;_g||(_g=function(t,r,n){return t.apply(r,n)});vr||(vr=function(t){return t});fn||(fn=function(t){return t});ZS||(ZS=function(t,r){return Ny(t,rn(r))});var dee=Gr(Array.prototype.forEach),G$=Gr(Array.prototype.pop),Pf=Gr(Array.prototype.push),Hy=Gr(String.prototype.toLowerCase),Hb=Gr(String.prototype.toString),vee=Gr(String.prototype.match),Jr=Gr(String.prototype.replace),yee=Gr(String.prototype.indexOf),gee=Gr(String.prototype.trim),lr=Gr(RegExp.prototype.test),Lb=mee(TypeError);function Gr(e){return function(t){for(var r=arguments.length,n=new Array(r>1?r-1:0),o=1;o<r;o++)n[o-1]=arguments[o];return _g(e,t,n)}}function mee(e){return function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return ZS(e,r)}}function qe(e,t,r){var n;r=(n=r)!==null&&n!==void 0?n:Hy,Y$&&Y$(e,null);for(var o=t.length;o--;){var i=t[o];if(typeof i=="string"){var a=r(i);a!==i&&(uee(t)||(t[o]=a),i=a)}e[i]=!0}return e}function Ai(e){var t=hee(null),r;for(r in e)_g(see,e,[r])===!0&&(t[r]=e[r]);return t}function Iv(e,t){for(;e!==null;){var r=cee(e,t);if(r){if(r.get)return Gr(r.get);if(typeof r.value=="function")return Gr(r.value)}e=fee(e)}function n(o){return console.warn("fallback value for",o),null}return n}var K$=vr(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),jb=vr(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),Fb=vr(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),pee=vr(["animate","color-profile","cursor","discard","fedropshadow","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),Bb=vr(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover"]),bee=vr(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),q$=vr(["#text"]),X$=vr(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),Vb=vr(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),Z$=vr(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),Mv=vr(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),wee=fn(/\{\{[\w\W]*|[\w\W]*\}\}/gm),See=fn(/<%[\w\W]*|[\w\W]*%>/gm),Cee=fn(/\${[\w\W]*}/gm),_ee=fn(/^data-[\-\w.\u00B7-\uFFFF]/),Oee=fn(/^aria-[\-\w]+$/),Ree=fn(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),Eee=fn(/^(?:\w+script|data):/i),Tee=fn(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),kee=fn(/^html$/i),Pee=function(){return typeof window>"u"?null:window},$ee=function(t,r){if(ei(t)!=="object"||typeof t.createPolicy!="function")return null;var n=null,o="data-tt-policy-suffix";r.currentScript&&r.currentScript.hasAttribute(o)&&(n=r.currentScript.getAttribute(o));var i="dompurify"+(n?"#"+n:"");try{return t.createPolicy(i,{createHTML:function(l){return l},createScriptURL:function(l){return l}})}catch{return console.warn("TrustedTypes policy "+i+" could not be created."),null}};function NF(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Pee(),t=function(H){return NF(H)};if(t.version="2.4.7",t.removed=[],!e||!e.document||e.document.nodeType!==9)return t.isSupported=!1,t;var r=e.document,n=e.document,o=e.DocumentFragment,i=e.HTMLTemplateElement,a=e.Node,l=e.Element,s=e.NodeFilter,u=e.NamedNodeMap,f=u===void 0?e.NamedNodeMap||e.MozNamedAttrMap:u,c=e.HTMLFormElement,h=e.DOMParser,d=e.trustedTypes,v=l.prototype,y=Iv(v,"cloneNode"),p=Iv(v,"nextSibling"),w=Iv(v,"childNodes"),S=Iv(v,"parentNode");if(typeof i=="function"){var C=n.createElement("template");C.content&&C.content.ownerDocument&&(n=C.content.ownerDocument)}var P=$ee(d,r),R=P?P.createHTML(""):"",W=n,Y=W.implementation,q=W.createNodeIterator,G=W.createDocumentFragment,X=W.getElementsByTagName,Q=r.importNode,oe={};try{oe=Ai(n).documentMode?n.documentMode:{}}catch{}var J={};t.isSupported=typeof S=="function"&&Y&&Y.createHTMLDocument!==void 0&&oe!==9;var ue=wee,de=See,Oe=Cee,be=_ee,$=Oee,k=Eee,g=Tee,m=Ree,b=null,E=qe({},[].concat(rn(K$),rn(jb),rn(Fb),rn(Bb),rn(q$))),O=null,F=qe({},[].concat(rn(X$),rn(Vb),rn(Z$),rn(Mv))),x=Object.seal(Object.create(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),K=null,Z=null,te=!0,ie=!0,se=!1,Se=!0,we=!1,U=!1,De=!1,Fe=!1,ke=!1,Ae=!1,Pe=!1,_=!0,T=!1,A="user-content-",j=!0,M=!1,B={},N=null,D=qe({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),V=null,L=qe({},["audio","video","img","source","image","track"]),z=null,le=qe({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),me="http://www.w3.org/1998/Math/MathML",Re="http://www.w3.org/2000/svg",Ne="http://www.w3.org/1999/xhtml",Xe=Ne,at=!1,We=null,Ie=qe({},[me,Re,Ne],Hb),Me,ar=["application/xhtml+xml","text/html"],xt="text/html",Be,Qe=null,pt=n.createElement("form"),lt=function(H){return H instanceof RegExp||H instanceof Function},st=function(H){Qe&&Qe===H||((!H||ei(H)!=="object")&&(H={}),H=Ai(H),Me=ar.indexOf(H.PARSER_MEDIA_TYPE)===-1?Me=xt:Me=H.PARSER_MEDIA_TYPE,Be=Me==="application/xhtml+xml"?Hb:Hy,b="ALLOWED_TAGS"in H?qe({},H.ALLOWED_TAGS,Be):E,O="ALLOWED_ATTR"in H?qe({},H.ALLOWED_ATTR,Be):F,We="ALLOWED_NAMESPACES"in H?qe({},H.ALLOWED_NAMESPACES,Hb):Ie,z="ADD_URI_SAFE_ATTR"in H?qe(Ai(le),H.ADD_URI_SAFE_ATTR,Be):le,V="ADD_DATA_URI_TAGS"in H?qe(Ai(L),H.ADD_DATA_URI_TAGS,Be):L,N="FORBID_CONTENTS"in H?qe({},H.FORBID_CONTENTS,Be):D,K="FORBID_TAGS"in H?qe({},H.FORBID_TAGS,Be):{},Z="FORBID_ATTR"in H?qe({},H.FORBID_ATTR,Be):{},B="USE_PROFILES"in H?H.USE_PROFILES:!1,te=H.ALLOW_ARIA_ATTR!==!1,ie=H.ALLOW_DATA_ATTR!==!1,se=H.ALLOW_UNKNOWN_PROTOCOLS||!1,Se=H.ALLOW_SELF_CLOSE_IN_ATTR!==!1,we=H.SAFE_FOR_TEMPLATES||!1,U=H.WHOLE_DOCUMENT||!1,ke=H.RETURN_DOM||!1,Ae=H.RETURN_DOM_FRAGMENT||!1,Pe=H.RETURN_TRUSTED_TYPE||!1,Fe=H.FORCE_BODY||!1,_=H.SANITIZE_DOM!==!1,T=H.SANITIZE_NAMED_PROPS||!1,j=H.KEEP_CONTENT!==!1,M=H.IN_PLACE||!1,m=H.ALLOWED_URI_REGEXP||m,Xe=H.NAMESPACE||Ne,x=H.CUSTOM_ELEMENT_HANDLING||{},H.CUSTOM_ELEMENT_HANDLING&&lt(H.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(x.tagNameCheck=H.CUSTOM_ELEMENT_HANDLING.tagNameCheck),H.CUSTOM_ELEMENT_HANDLING&&lt(H.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(x.attributeNameCheck=H.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),H.CUSTOM_ELEMENT_HANDLING&&typeof H.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(x.allowCustomizedBuiltInElements=H.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),we&&(ie=!1),Ae&&(ke=!0),B&&(b=qe({},rn(q$)),O=[],B.html===!0&&(qe(b,K$),qe(O,X$)),B.svg===!0&&(qe(b,jb),qe(O,Vb),qe(O,Mv)),B.svgFilters===!0&&(qe(b,Fb),qe(O,Vb),qe(O,Mv)),B.mathMl===!0&&(qe(b,Bb),qe(O,Z$),qe(O,Mv))),H.ADD_TAGS&&(b===E&&(b=Ai(b)),qe(b,H.ADD_TAGS,Be)),H.ADD_ATTR&&(O===F&&(O=Ai(O)),qe(O,H.ADD_ATTR,Be)),H.ADD_URI_SAFE_ATTR&&qe(z,H.ADD_URI_SAFE_ATTR,Be),H.FORBID_CONTENTS&&(N===D&&(N=Ai(N)),qe(N,H.FORBID_CONTENTS,Be)),j&&(b["#text"]=!0),U&&qe(b,["html","head","body"]),b.table&&(qe(b,["tbody"]),delete K.tbody),vr&&vr(H),Qe=H)},Je=qe({},["mi","mo","mn","ms","mtext"]),Bo=qe({},["foreignobject","desc","title","annotation-xml"]),Lp=qe({},["title","style","font","a","script"]),Ti=qe({},jb);qe(Ti,Fb),qe(Ti,pee);var wf=qe({},Bb);qe(wf,bee);var yz=function(H){var ae=S(H);(!ae||!ae.tagName)&&(ae={namespaceURI:Xe,tagName:"template"});var he=Hy(H.tagName),ot=Hy(ae.tagName);return We[H.namespaceURI]?H.namespaceURI===Re?ae.namespaceURI===Ne?he==="svg":ae.namespaceURI===me?he==="svg"&&(ot==="annotation-xml"||Je[ot]):!!Ti[he]:H.namespaceURI===me?ae.namespaceURI===Ne?he==="math":ae.namespaceURI===Re?he==="math"&&Bo[ot]:!!wf[he]:H.namespaceURI===Ne?ae.namespaceURI===Re&&!Bo[ot]||ae.namespaceURI===me&&!Je[ot]?!1:!wf[he]&&(Lp[he]||!Ti[he]):!!(Me==="application/xhtml+xml"&&We[H.namespaceURI]):!1},Bn=function(H){Pf(t.removed,{element:H});try{H.parentNode.removeChild(H)}catch{try{H.outerHTML=R}catch{H.remove()}}},jp=function(H,ae){try{Pf(t.removed,{attribute:ae.getAttributeNode(H),from:ae})}catch{Pf(t.removed,{attribute:null,from:ae})}if(ae.removeAttribute(H),H==="is"&&!O[H])if(ke||Ae)try{Bn(ae)}catch{}else try{ae.setAttribute(H,"")}catch{}},tk=function(H){var ae,he;if(Fe)H="<remove></remove>"+H;else{var ot=vee(H,/^[\r\n\t ]+/);he=ot&&ot[0]}Me==="application/xhtml+xml"&&Xe===Ne&&(H='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+H+"</body></html>");var mr=P?P.createHTML(H):H;if(Xe===Ne)try{ae=new h().parseFromString(mr,Me)}catch{}if(!ae||!ae.documentElement){ae=Y.createDocument(Xe,"template",null);try{ae.documentElement.innerHTML=at?R:mr}catch{}}var Jt=ae.body||ae.documentElement;return H&&he&&Jt.insertBefore(n.createTextNode(he),Jt.childNodes[0]||null),Xe===Ne?X.call(ae,U?"html":"body")[0]:U?ae.documentElement:Jt},rk=function(H){return q.call(H.ownerDocument||H,H,s.SHOW_ELEMENT|s.SHOW_COMMENT|s.SHOW_TEXT,null,!1)},gz=function(H){return H instanceof c&&(typeof H.nodeName!="string"||typeof H.textContent!="string"||typeof H.removeChild!="function"||!(H.attributes instanceof f)||typeof H.removeAttribute!="function"||typeof H.setAttribute!="function"||typeof H.namespaceURI!="string"||typeof H.insertBefore!="function"||typeof H.hasChildNodes!="function")},Sf=function(H){return ei(a)==="object"?H instanceof a:H&&ei(H)==="object"&&typeof H.nodeType=="number"&&typeof H.nodeName=="string"},Vn=function(H,ae,he){J[H]&&dee(J[H],function(ot){ot.call(t,ae,he,Qe)})},nk=function(H){var ae;if(Vn("beforeSanitizeElements",H,null),gz(H)||lr(/[\u0080-\uFFFF]/,H.nodeName))return Bn(H),!0;var he=Be(H.nodeName);if(Vn("uponSanitizeElement",H,{tagName:he,allowedTags:b}),H.hasChildNodes()&&!Sf(H.firstElementChild)&&(!Sf(H.content)||!Sf(H.content.firstElementChild))&&lr(/<[/\w]/g,H.innerHTML)&&lr(/<[/\w]/g,H.textContent)||he==="select"&&lr(/<template/i,H.innerHTML))return Bn(H),!0;if(!b[he]||K[he]){if(!K[he]&&ik(he)&&(x.tagNameCheck instanceof RegExp&&lr(x.tagNameCheck,he)||x.tagNameCheck instanceof Function&&x.tagNameCheck(he)))return!1;if(j&&!N[he]){var ot=S(H)||H.parentNode,mr=w(H)||H.childNodes;if(mr&&ot)for(var Jt=mr.length,Qt=Jt-1;Qt>=0;--Qt)ot.insertBefore(y(mr[Qt],!0),p(H))}return Bn(H),!0}return H instanceof l&&!yz(H)||(he==="noscript"||he==="noembed"||he==="noframes")&&lr(/<\/no(script|embed|frames)/i,H.innerHTML)?(Bn(H),!0):(we&&H.nodeType===3&&(ae=H.textContent,ae=Jr(ae,ue," "),ae=Jr(ae,de," "),ae=Jr(ae,Oe," "),H.textContent!==ae&&(Pf(t.removed,{element:H.cloneNode()}),H.textContent=ae)),Vn("afterSanitizeElements",H,null),!1)},ok=function(H,ae,he){if(_&&(ae==="id"||ae==="name")&&(he in n||he in pt))return!1;if(!(ie&&!Z[ae]&&lr(be,ae))){if(!(te&&lr($,ae))){if(!O[ae]||Z[ae]){if(!(ik(H)&&(x.tagNameCheck instanceof RegExp&&lr(x.tagNameCheck,H)||x.tagNameCheck instanceof Function&&x.tagNameCheck(H))&&(x.attributeNameCheck instanceof RegExp&&lr(x.attributeNameCheck,ae)||x.attributeNameCheck instanceof Function&&x.attributeNameCheck(ae))||ae==="is"&&x.allowCustomizedBuiltInElements&&(x.tagNameCheck instanceof RegExp&&lr(x.tagNameCheck,he)||x.tagNameCheck instanceof Function&&x.tagNameCheck(he))))return!1}else if(!z[ae]){if(!lr(m,Jr(he,g,""))){if(!((ae==="src"||ae==="xlink:href"||ae==="href")&&H!=="script"&&yee(he,"data:")===0&&V[H])){if(!(se&&!lr(k,Jr(he,g,"")))){if(he)return!1}}}}}}return!0},ik=function(H){return H.indexOf("-")>0},ak=function(H){var ae,he,ot,mr;Vn("beforeSanitizeAttributes",H,null);var Jt=H.attributes;if(Jt){var Qt={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:O};for(mr=Jt.length;mr--;){ae=Jt[mr];var bv=ae,Gt=bv.name,Fp=bv.namespaceURI;if(he=Gt==="value"?ae.value:gee(ae.value),ot=Be(Gt),Qt.attrName=ot,Qt.attrValue=he,Qt.keepAttr=!0,Qt.forceKeepAttr=void 0,Vn("uponSanitizeAttribute",H,Qt),he=Qt.attrValue,!Qt.forceKeepAttr&&(jp(Gt,H),!!Qt.keepAttr)){if(!Se&&lr(/\/>/i,he)){jp(Gt,H);continue}we&&(he=Jr(he,ue," "),he=Jr(he,de," "),he=Jr(he,Oe," "));var lk=Be(H.nodeName);if(ok(lk,ot,he)){if(T&&(ot==="id"||ot==="name")&&(jp(Gt,H),he=A+he),P&&ei(d)==="object"&&typeof d.getAttributeType=="function"&&!Fp)switch(d.getAttributeType(lk,ot)){case"TrustedHTML":{he=P.createHTML(he);break}case"TrustedScriptURL":{he=P.createScriptURL(he);break}}try{Fp?H.setAttributeNS(Fp,Gt,he):H.setAttribute(Gt,he),G$(t.removed)}catch{}}}}Vn("afterSanitizeAttributes",H,null)}},mz=function Ee(H){var ae,he=rk(H);for(Vn("beforeSanitizeShadowDOM",H,null);ae=he.nextNode();)Vn("uponSanitizeShadowNode",ae,null),!nk(ae)&&(ae.content instanceof o&&Ee(ae.content),ak(ae));Vn("afterSanitizeShadowDOM",H,null)};return t.sanitize=function(Ee){var H=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},ae,he,ot,mr,Jt;if(at=!Ee,at&&(Ee="<!-->"),typeof Ee!="string"&&!Sf(Ee))if(typeof Ee.toString=="function"){if(Ee=Ee.toString(),typeof Ee!="string")throw Lb("dirty is not a string, aborting")}else throw Lb("toString is not a function");if(!t.isSupported){if(ei(e.toStaticHTML)==="object"||typeof e.toStaticHTML=="function"){if(typeof Ee=="string")return e.toStaticHTML(Ee);if(Sf(Ee))return e.toStaticHTML(Ee.outerHTML)}return Ee}if(De||st(H),t.removed=[],typeof Ee=="string"&&(M=!1),M){if(Ee.nodeName){var Qt=Be(Ee.nodeName);if(!b[Qt]||K[Qt])throw Lb("root node is forbidden and cannot be sanitized in-place")}}else if(Ee instanceof a)ae=tk("<!---->"),he=ae.ownerDocument.importNode(Ee,!0),he.nodeType===1&&he.nodeName==="BODY"||he.nodeName==="HTML"?ae=he:ae.appendChild(he);else{if(!ke&&!we&&!U&&Ee.indexOf("<")===-1)return P&&Pe?P.createHTML(Ee):Ee;if(ae=tk(Ee),!ae)return ke?null:Pe?R:""}ae&&Fe&&Bn(ae.firstChild);for(var bv=rk(M?Ee:ae);ot=bv.nextNode();)ot.nodeType===3&&ot===mr||nk(ot)||(ot.content instanceof o&&mz(ot.content),ak(ot),mr=ot);if(mr=null,M)return Ee;if(ke){if(Ae)for(Jt=G.call(ae.ownerDocument);ae.firstChild;)Jt.appendChild(ae.firstChild);else Jt=ae;return(O.shadowroot||O.shadowrootmod)&&(Jt=Q.call(r,Jt,!0)),Jt}var Gt=U?ae.outerHTML:ae.innerHTML;return U&&b["!doctype"]&&ae.ownerDocument&&ae.ownerDocument.doctype&&ae.ownerDocument.doctype.name&&lr(kee,ae.ownerDocument.doctype.name)&&(Gt="<!DOCTYPE "+ae.ownerDocument.doctype.name+`>
`+Gt),we&&(Gt=Jr(Gt,ue," "),Gt=Jr(Gt,de," "),Gt=Jr(Gt,Oe," ")),P&&Pe?P.createHTML(Gt):Gt},t.setConfig=function(Ee){st(Ee),De=!0},t.clearConfig=function(){Qe=null,De=!1},t.isValidAttribute=function(Ee,H,ae){Qe||st({});var he=Be(Ee),ot=Be(H);return ok(he,ot,ae)},t.addHook=function(Ee,H){typeof H=="function"&&(J[Ee]=J[Ee]||[],Pf(J[Ee],H))},t.removeHook=function(Ee){if(J[Ee])return G$(J[Ee])},t.removeHooks=function(Ee){J[Ee]&&(J[Ee]=[])},t.removeAllHooks=function(){J={}},t}var Aee=NF(),Iee=$e,Mee=TR,xee=Le,Dee=Lt,Nee=Wd.onFreeze,QS=Object.freeze,Hee=xee(function(){QS(1)});Iee({target:"Object",stat:!0,forced:Hee,sham:!Mee},{freeze:function(t){return QS&&Dee(t)?QS(Nee(t)):t}});var Lee=$e,jee=HR.codeAt;Lee({target:"String",proto:!0},{codePointAt:function(t){return jee(this,t)}});var Fee=_i,Bee=Ft,Vee=Or,Wee=RangeError,dE=function(t){var r=Bee(Vee(this)),n="",o=Fee(t);if(o<0||o==1/0)throw Wee("Wrong number of repetitions");for(;o>0;(o>>>=1)&&(r+=r))o&1&&(n+=r);return n},HF=Ve,Uee=Ua,Q$=Ft,zee=dE,Yee=Or,Gee=HF(zee),Kee=HF("".slice),qee=Math.ceil,J$=function(e){return function(t,r,n){var o=Q$(Yee(t)),i=Uee(r),a=o.length,l=n===void 0?" ":Q$(n),s,u;return i<=a||l==""?o:(s=i-a,u=Gee(l,qee(s/l.length)),u.length>s&&(u=Kee(u,0,s)),e?o+u:u+o)}},Xee={start:J$(!1),end:J$(!0)},Zee=Ba,Qee=/Version\/10(?:\.\d+){1,2}(?: [\w./]+)?(?: Mobile\/\w+)? Safari\//.test(Zee),Jee=$e,ete=Xee.start,tte=Qee;Jee({target:"String",proto:!0,forced:tte},{padStart:function(t){return ete(this,t,arguments.length>1?arguments[1]:void 0)}});//! moment.js
//! version : 2.29.4
//! authors : Tim Wood, Iskren Chernev, Moment.js contributors
//! license : MIT
//! momentjs.com
var LF;function ee(){return LF.apply(null,arguments)}function rte(e){LF=e}function cn(e){return e instanceof Array||Object.prototype.toString.call(e)==="[object Array]"}function Oa(e){return e!=null&&Object.prototype.toString.call(e)==="[object Object]"}function rt(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function vE(e){if(Object.getOwnPropertyNames)return Object.getOwnPropertyNames(e).length===0;var t;for(t in e)if(rt(e,t))return!1;return!0}function br(e){return e===void 0}function xo(e){return typeof e=="number"||Object.prototype.toString.call(e)==="[object Number]"}function Jd(e){return e instanceof Date||Object.prototype.toString.call(e)==="[object Date]"}function jF(e,t){var r=[],n,o=e.length;for(n=0;n<o;++n)r.push(t(e[n],n));return r}function ni(e,t){for(var r in t)rt(t,r)&&(e[r]=t[r]);return rt(t,"toString")&&(e.toString=t.toString),rt(t,"valueOf")&&(e.valueOf=t.valueOf),e}function jn(e,t,r,n){return uB(e,t,r,n,!0).utc()}function nte(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidEra:null,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],era:null,meridiem:null,rfc2822:!1,weekdayMismatch:!1}}function Ue(e){return e._pf==null&&(e._pf=nte()),e._pf}var JS;Array.prototype.some?JS=Array.prototype.some:JS=function(e){var t=Object(this),r=t.length>>>0,n;for(n=0;n<r;n++)if(n in t&&e.call(this,t[n],n,t))return!0;return!1};function yE(e){if(e._isValid==null){var t=Ue(e),r=JS.call(t.parsedDateParts,function(o){return o!=null}),n=!isNaN(e._d.getTime())&&t.overflow<0&&!t.empty&&!t.invalidEra&&!t.invalidMonth&&!t.invalidWeekday&&!t.weekdayMismatch&&!t.nullInput&&!t.invalidFormat&&!t.userInvalidated&&(!t.meridiem||t.meridiem&&r);if(e._strict&&(n=n&&t.charsLeftOver===0&&t.unusedTokens.length===0&&t.bigHour===void 0),Object.isFrozen==null||!Object.isFrozen(e))e._isValid=n;else return n}return e._isValid}function tp(e){var t=jn(NaN);return e!=null?ni(Ue(t),e):Ue(t).userInvalidated=!0,t}var eA=ee.momentProperties=[],Wb=!1;function gE(e,t){var r,n,o,i=eA.length;if(br(t._isAMomentObject)||(e._isAMomentObject=t._isAMomentObject),br(t._i)||(e._i=t._i),br(t._f)||(e._f=t._f),br(t._l)||(e._l=t._l),br(t._strict)||(e._strict=t._strict),br(t._tzm)||(e._tzm=t._tzm),br(t._isUTC)||(e._isUTC=t._isUTC),br(t._offset)||(e._offset=t._offset),br(t._pf)||(e._pf=Ue(t)),br(t._locale)||(e._locale=t._locale),i>0)for(r=0;r<i;r++)n=eA[r],o=t[n],br(o)||(e[n]=o);return e}function ev(e){gE(this,e),this._d=new Date(e._d!=null?e._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),Wb===!1&&(Wb=!0,ee.updateOffset(this),Wb=!1)}function hn(e){return e instanceof ev||e!=null&&e._isAMomentObject!=null}function FF(e){ee.suppressDeprecationWarnings===!1&&typeof console<"u"&&console.warn&&console.warn("Deprecation warning: "+e)}function Xr(e,t){var r=!0;return ni(function(){if(ee.deprecationHandler!=null&&ee.deprecationHandler(null,e),r){var n=[],o,i,a,l=arguments.length;for(i=0;i<l;i++){if(o="",typeof arguments[i]=="object"){o+=`
[`+i+"] ";for(a in arguments[0])rt(arguments[0],a)&&(o+=a+": "+arguments[0][a]+", ");o=o.slice(0,-2)}else o=arguments[i];n.push(o)}FF(e+`
Arguments: `+Array.prototype.slice.call(n).join("")+`
`+new Error().stack),r=!1}return t.apply(this,arguments)},t)}var tA={};function BF(e,t){ee.deprecationHandler!=null&&ee.deprecationHandler(e,t),tA[e]||(FF(t),tA[e]=!0)}ee.suppressDeprecationWarnings=!1;ee.deprecationHandler=null;function Fn(e){return typeof Function<"u"&&e instanceof Function||Object.prototype.toString.call(e)==="[object Function]"}function ote(e){var t,r;for(r in e)rt(e,r)&&(t=e[r],Fn(t)?this[r]=t:this["_"+r]=t);this._config=e,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)}function eC(e,t){var r=ni({},e),n;for(n in t)rt(t,n)&&(Oa(e[n])&&Oa(t[n])?(r[n]={},ni(r[n],e[n]),ni(r[n],t[n])):t[n]!=null?r[n]=t[n]:delete r[n]);for(n in e)rt(e,n)&&!rt(t,n)&&Oa(e[n])&&(r[n]=ni({},r[n]));return r}function mE(e){e!=null&&this.set(e)}var tC;Object.keys?tC=Object.keys:tC=function(e){var t,r=[];for(t in e)rt(e,t)&&r.push(t);return r};var ite={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"};function ate(e,t,r){var n=this._calendar[e]||this._calendar.sameElse;return Fn(n)?n.call(t,r):n}function Mn(e,t,r){var n=""+Math.abs(e),o=t-n.length,i=e>=0;return(i?r?"+":"":"-")+Math.pow(10,Math.max(0,o)).toString().substr(1)+n}var pE=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,xv=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,Ub={},jl={};function Te(e,t,r,n){var o=n;typeof n=="string"&&(o=function(){return this[n]()}),e&&(jl[e]=o),t&&(jl[t[0]]=function(){return Mn(o.apply(this,arguments),t[1],t[2])}),r&&(jl[r]=function(){return this.localeData().ordinal(o.apply(this,arguments),e)})}function lte(e){return e.match(/\[[\s\S]/)?e.replace(/^\[|\]$/g,""):e.replace(/\\/g,"")}function ste(e){var t=e.match(pE),r,n;for(r=0,n=t.length;r<n;r++)jl[t[r]]?t[r]=jl[t[r]]:t[r]=lte(t[r]);return function(o){var i="",a;for(a=0;a<n;a++)i+=Fn(t[a])?t[a].call(o,e):t[a];return i}}function Ly(e,t){return e.isValid()?(t=VF(t,e.localeData()),Ub[t]=Ub[t]||ste(t),Ub[t](e)):e.localeData().invalidDate()}function VF(e,t){var r=5;function n(o){return t.longDateFormat(o)||o}for(xv.lastIndex=0;r>=0&&xv.test(e);)e=e.replace(xv,n),xv.lastIndex=0,r-=1;return e}var ute={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};function fte(e){var t=this._longDateFormat[e],r=this._longDateFormat[e.toUpperCase()];return t||!r?t:(this._longDateFormat[e]=r.match(pE).map(function(n){return n==="MMMM"||n==="MM"||n==="DD"||n==="dddd"?n.slice(1):n}).join(""),this._longDateFormat[e])}var cte="Invalid date";function hte(){return this._invalidDate}var dte="%d",vte=/\d{1,2}/;function yte(e){return this._ordinal.replace("%d",e)}var gte={future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",w:"a week",ww:"%d weeks",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function mte(e,t,r,n){var o=this._relativeTime[r];return Fn(o)?o(e,t,r,n):o.replace(/%d/i,e)}function pte(e,t){var r=this._relativeTime[e>0?"future":"past"];return Fn(r)?r(t):r.replace(/%s/i,t)}var lc={};function or(e,t){var r=e.toLowerCase();lc[r]=lc[r+"s"]=lc[t]=e}function Zr(e){return typeof e=="string"?lc[e]||lc[e.toLowerCase()]:void 0}function bE(e){var t={},r,n;for(n in e)rt(e,n)&&(r=Zr(n),r&&(t[r]=e[n]));return t}var WF={};function ir(e,t){WF[e]=t}function bte(e){var t=[],r;for(r in e)rt(e,r)&&t.push({unit:r,priority:WF[r]});return t.sort(function(n,o){return n.priority-o.priority}),t}function rp(e){return e%4===0&&e%100!==0||e%400===0}function Ur(e){return e<0?Math.ceil(e)||0:Math.floor(e)}function Ze(e){var t=+e,r=0;return t!==0&&isFinite(t)&&(r=Ur(t)),r}function hf(e,t){return function(r){return r!=null?(UF(this,e,r),ee.updateOffset(this,t),this):Og(this,e)}}function Og(e,t){return e.isValid()?e._d["get"+(e._isUTC?"UTC":"")+t]():NaN}function UF(e,t,r){e.isValid()&&!isNaN(r)&&(t==="FullYear"&&rp(e.year())&&e.month()===1&&e.date()===29?(r=Ze(r),e._d["set"+(e._isUTC?"UTC":"")+t](r,e.month(),sp(r,e.month()))):e._d["set"+(e._isUTC?"UTC":"")+t](r))}function wte(e){return e=Zr(e),Fn(this[e])?this[e]():this}function Ste(e,t){if(typeof e=="object"){e=bE(e);var r=bte(e),n,o=r.length;for(n=0;n<o;n++)this[r[n].unit](e[r[n].unit])}else if(e=Zr(e),Fn(this[e]))return this[e](t);return this}var zF=/\d/,jr=/\d\d/,YF=/\d{3}/,wE=/\d{4}/,np=/[+-]?\d{6}/,Ct=/\d\d?/,GF=/\d\d\d\d?/,KF=/\d\d\d\d\d\d?/,op=/\d{1,3}/,SE=/\d{1,4}/,ip=/[+-]?\d{1,6}/,df=/\d+/,ap=/[+-]?\d+/,Cte=/Z|[+-]\d\d:?\d\d/gi,lp=/Z|[+-]\d\d(?::?\d\d)?/gi,_te=/[+-]?\d+(\.\d{1,3})?/,tv=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i,Rg;Rg={};function pe(e,t,r){Rg[e]=Fn(t)?t:function(n,o){return n&&r?r:t}}function Ote(e,t){return rt(Rg,e)?Rg[e](t._strict,t._locale):new RegExp(Rte(e))}function Rte(e){return Dr(e.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(t,r,n,o,i){return r||n||o||i}))}function Dr(e){return e.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}var rC={};function ht(e,t){var r,n=t,o;for(typeof e=="string"&&(e=[e]),xo(t)&&(n=function(i,a){a[t]=Ze(i)}),o=e.length,r=0;r<o;r++)rC[e[r]]=n}function rv(e,t){ht(e,function(r,n,o,i){o._w=o._w||{},t(r,o._w,o,i)})}function Ete(e,t,r){t!=null&&rt(rC,e)&&rC[e](t,r._a,r,e)}var rr=0,no=1,Pn=2,zt=3,sn=4,oo=5,qi=6,Tte=7,kte=8;function Pte(e,t){return(e%t+t)%t}var Nt;Array.prototype.indexOf?Nt=Array.prototype.indexOf:Nt=function(e){var t;for(t=0;t<this.length;++t)if(this[t]===e)return t;return-1};function sp(e,t){if(isNaN(e)||isNaN(t))return NaN;var r=Pte(t,12);return e+=(t-r)/12,r===1?rp(e)?29:28:31-r%7%2}Te("M",["MM",2],"Mo",function(){return this.month()+1});Te("MMM",0,0,function(e){return this.localeData().monthsShort(this,e)});Te("MMMM",0,0,function(e){return this.localeData().months(this,e)});or("month","M");ir("month",8);pe("M",Ct);pe("MM",Ct,jr);pe("MMM",function(e,t){return t.monthsShortRegex(e)});pe("MMMM",function(e,t){return t.monthsRegex(e)});ht(["M","MM"],function(e,t){t[no]=Ze(e)-1});ht(["MMM","MMMM"],function(e,t,r,n){var o=r._locale.monthsParse(e,n,r._strict);o!=null?t[no]=o:Ue(r).invalidMonth=e});var $te="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),qF="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),XF=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,Ate=tv,Ite=tv;function Mte(e,t){return e?cn(this._months)?this._months[e.month()]:this._months[(this._months.isFormat||XF).test(t)?"format":"standalone"][e.month()]:cn(this._months)?this._months:this._months.standalone}function xte(e,t){return e?cn(this._monthsShort)?this._monthsShort[e.month()]:this._monthsShort[XF.test(t)?"format":"standalone"][e.month()]:cn(this._monthsShort)?this._monthsShort:this._monthsShort.standalone}function Dte(e,t,r){var n,o,i,a=e.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],n=0;n<12;++n)i=jn([2e3,n]),this._shortMonthsParse[n]=this.monthsShort(i,"").toLocaleLowerCase(),this._longMonthsParse[n]=this.months(i,"").toLocaleLowerCase();return r?t==="MMM"?(o=Nt.call(this._shortMonthsParse,a),o!==-1?o:null):(o=Nt.call(this._longMonthsParse,a),o!==-1?o:null):t==="MMM"?(o=Nt.call(this._shortMonthsParse,a),o!==-1?o:(o=Nt.call(this._longMonthsParse,a),o!==-1?o:null)):(o=Nt.call(this._longMonthsParse,a),o!==-1?o:(o=Nt.call(this._shortMonthsParse,a),o!==-1?o:null))}function Nte(e,t,r){var n,o,i;if(this._monthsParseExact)return Dte.call(this,e,t,r);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),n=0;n<12;n++){if(o=jn([2e3,n]),r&&!this._longMonthsParse[n]&&(this._longMonthsParse[n]=new RegExp("^"+this.months(o,"").replace(".","")+"$","i"),this._shortMonthsParse[n]=new RegExp("^"+this.monthsShort(o,"").replace(".","")+"$","i")),!r&&!this._monthsParse[n]&&(i="^"+this.months(o,"")+"|^"+this.monthsShort(o,""),this._monthsParse[n]=new RegExp(i.replace(".",""),"i")),r&&t==="MMMM"&&this._longMonthsParse[n].test(e))return n;if(r&&t==="MMM"&&this._shortMonthsParse[n].test(e))return n;if(!r&&this._monthsParse[n].test(e))return n}}function ZF(e,t){var r;if(!e.isValid())return e;if(typeof t=="string"){if(/^\d+$/.test(t))t=Ze(t);else if(t=e.localeData().monthsParse(t),!xo(t))return e}return r=Math.min(e.date(),sp(e.year(),t)),e._d["set"+(e._isUTC?"UTC":"")+"Month"](t,r),e}function QF(e){return e!=null?(ZF(this,e),ee.updateOffset(this,!0),this):Og(this,"Month")}function Hte(){return sp(this.year(),this.month())}function Lte(e){return this._monthsParseExact?(rt(this,"_monthsRegex")||JF.call(this),e?this._monthsShortStrictRegex:this._monthsShortRegex):(rt(this,"_monthsShortRegex")||(this._monthsShortRegex=Ate),this._monthsShortStrictRegex&&e?this._monthsShortStrictRegex:this._monthsShortRegex)}function jte(e){return this._monthsParseExact?(rt(this,"_monthsRegex")||JF.call(this),e?this._monthsStrictRegex:this._monthsRegex):(rt(this,"_monthsRegex")||(this._monthsRegex=Ite),this._monthsStrictRegex&&e?this._monthsStrictRegex:this._monthsRegex)}function JF(){function e(a,l){return l.length-a.length}var t=[],r=[],n=[],o,i;for(o=0;o<12;o++)i=jn([2e3,o]),t.push(this.monthsShort(i,"")),r.push(this.months(i,"")),n.push(this.months(i,"")),n.push(this.monthsShort(i,""));for(t.sort(e),r.sort(e),n.sort(e),o=0;o<12;o++)t[o]=Dr(t[o]),r[o]=Dr(r[o]);for(o=0;o<24;o++)n[o]=Dr(n[o]);this._monthsRegex=new RegExp("^("+n.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+r.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+t.join("|")+")","i")}Te("Y",0,0,function(){var e=this.year();return e<=9999?Mn(e,4):"+"+e});Te(0,["YY",2],0,function(){return this.year()%100});Te(0,["YYYY",4],0,"year");Te(0,["YYYYY",5],0,"year");Te(0,["YYYYYY",6,!0],0,"year");or("year","y");ir("year",1);pe("Y",ap);pe("YY",Ct,jr);pe("YYYY",SE,wE);pe("YYYYY",ip,np);pe("YYYYYY",ip,np);ht(["YYYYY","YYYYYY"],rr);ht("YYYY",function(e,t){t[rr]=e.length===2?ee.parseTwoDigitYear(e):Ze(e)});ht("YY",function(e,t){t[rr]=ee.parseTwoDigitYear(e)});ht("Y",function(e,t){t[rr]=parseInt(e,10)});function sc(e){return rp(e)?366:365}ee.parseTwoDigitYear=function(e){return Ze(e)+(Ze(e)>68?1900:2e3)};var eB=hf("FullYear",!0);function Fte(){return rp(this.year())}function Bte(e,t,r,n,o,i,a){var l;return e<100&&e>=0?(l=new Date(e+400,t,r,n,o,i,a),isFinite(l.getFullYear())&&l.setFullYear(e)):l=new Date(e,t,r,n,o,i,a),l}function Ec(e){var t,r;return e<100&&e>=0?(r=Array.prototype.slice.call(arguments),r[0]=e+400,t=new Date(Date.UTC.apply(null,r)),isFinite(t.getUTCFullYear())&&t.setUTCFullYear(e)):t=new Date(Date.UTC.apply(null,arguments)),t}function Eg(e,t,r){var n=7+t-r,o=(7+Ec(e,0,n).getUTCDay()-t)%7;return-o+n-1}function tB(e,t,r,n,o){var i=(7+r-n)%7,a=Eg(e,n,o),l=1+7*(t-1)+i+a,s,u;return l<=0?(s=e-1,u=sc(s)+l):l>sc(e)?(s=e+1,u=l-sc(e)):(s=e,u=l),{year:s,dayOfYear:u}}function Tc(e,t,r){var n=Eg(e.year(),t,r),o=Math.floor((e.dayOfYear()-n-1)/7)+1,i,a;return o<1?(a=e.year()-1,i=o+$o(a,t,r)):o>$o(e.year(),t,r)?(i=o-$o(e.year(),t,r),a=e.year()+1):(a=e.year(),i=o),{week:i,year:a}}function $o(e,t,r){var n=Eg(e,t,r),o=Eg(e+1,t,r);return(sc(e)-n+o)/7}Te("w",["ww",2],"wo","week");Te("W",["WW",2],"Wo","isoWeek");or("week","w");or("isoWeek","W");ir("week",5);ir("isoWeek",5);pe("w",Ct);pe("ww",Ct,jr);pe("W",Ct);pe("WW",Ct,jr);rv(["w","ww","W","WW"],function(e,t,r,n){t[n.substr(0,1)]=Ze(e)});function Vte(e){return Tc(e,this._week.dow,this._week.doy).week}var Wte={dow:0,doy:6};function Ute(){return this._week.dow}function zte(){return this._week.doy}function Yte(e){var t=this.localeData().week(this);return e==null?t:this.add((e-t)*7,"d")}function Gte(e){var t=Tc(this,1,4).week;return e==null?t:this.add((e-t)*7,"d")}Te("d",0,"do","day");Te("dd",0,0,function(e){return this.localeData().weekdaysMin(this,e)});Te("ddd",0,0,function(e){return this.localeData().weekdaysShort(this,e)});Te("dddd",0,0,function(e){return this.localeData().weekdays(this,e)});Te("e",0,0,"weekday");Te("E",0,0,"isoWeekday");or("day","d");or("weekday","e");or("isoWeekday","E");ir("day",11);ir("weekday",11);ir("isoWeekday",11);pe("d",Ct);pe("e",Ct);pe("E",Ct);pe("dd",function(e,t){return t.weekdaysMinRegex(e)});pe("ddd",function(e,t){return t.weekdaysShortRegex(e)});pe("dddd",function(e,t){return t.weekdaysRegex(e)});rv(["dd","ddd","dddd"],function(e,t,r,n){var o=r._locale.weekdaysParse(e,n,r._strict);o!=null?t.d=o:Ue(r).invalidWeekday=e});rv(["d","e","E"],function(e,t,r,n){t[n]=Ze(e)});function Kte(e,t){return typeof e!="string"?e:isNaN(e)?(e=t.weekdaysParse(e),typeof e=="number"?e:null):parseInt(e,10)}function qte(e,t){return typeof e=="string"?t.weekdaysParse(e)%7||7:isNaN(e)?null:e}function CE(e,t){return e.slice(t,7).concat(e.slice(0,t))}var Xte="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),rB="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),Zte="Su_Mo_Tu_We_Th_Fr_Sa".split("_"),Qte=tv,Jte=tv,ere=tv;function tre(e,t){var r=cn(this._weekdays)?this._weekdays:this._weekdays[e&&e!==!0&&this._weekdays.isFormat.test(t)?"format":"standalone"];return e===!0?CE(r,this._week.dow):e?r[e.day()]:r}function rre(e){return e===!0?CE(this._weekdaysShort,this._week.dow):e?this._weekdaysShort[e.day()]:this._weekdaysShort}function nre(e){return e===!0?CE(this._weekdaysMin,this._week.dow):e?this._weekdaysMin[e.day()]:this._weekdaysMin}function ore(e,t,r){var n,o,i,a=e.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],n=0;n<7;++n)i=jn([2e3,1]).day(n),this._minWeekdaysParse[n]=this.weekdaysMin(i,"").toLocaleLowerCase(),this._shortWeekdaysParse[n]=this.weekdaysShort(i,"").toLocaleLowerCase(),this._weekdaysParse[n]=this.weekdays(i,"").toLocaleLowerCase();return r?t==="dddd"?(o=Nt.call(this._weekdaysParse,a),o!==-1?o:null):t==="ddd"?(o=Nt.call(this._shortWeekdaysParse,a),o!==-1?o:null):(o=Nt.call(this._minWeekdaysParse,a),o!==-1?o:null):t==="dddd"?(o=Nt.call(this._weekdaysParse,a),o!==-1||(o=Nt.call(this._shortWeekdaysParse,a),o!==-1)?o:(o=Nt.call(this._minWeekdaysParse,a),o!==-1?o:null)):t==="ddd"?(o=Nt.call(this._shortWeekdaysParse,a),o!==-1||(o=Nt.call(this._weekdaysParse,a),o!==-1)?o:(o=Nt.call(this._minWeekdaysParse,a),o!==-1?o:null)):(o=Nt.call(this._minWeekdaysParse,a),o!==-1||(o=Nt.call(this._weekdaysParse,a),o!==-1)?o:(o=Nt.call(this._shortWeekdaysParse,a),o!==-1?o:null))}function ire(e,t,r){var n,o,i;if(this._weekdaysParseExact)return ore.call(this,e,t,r);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),n=0;n<7;n++){if(o=jn([2e3,1]).day(n),r&&!this._fullWeekdaysParse[n]&&(this._fullWeekdaysParse[n]=new RegExp("^"+this.weekdays(o,"").replace(".","\\.?")+"$","i"),this._shortWeekdaysParse[n]=new RegExp("^"+this.weekdaysShort(o,"").replace(".","\\.?")+"$","i"),this._minWeekdaysParse[n]=new RegExp("^"+this.weekdaysMin(o,"").replace(".","\\.?")+"$","i")),this._weekdaysParse[n]||(i="^"+this.weekdays(o,"")+"|^"+this.weekdaysShort(o,"")+"|^"+this.weekdaysMin(o,""),this._weekdaysParse[n]=new RegExp(i.replace(".",""),"i")),r&&t==="dddd"&&this._fullWeekdaysParse[n].test(e))return n;if(r&&t==="ddd"&&this._shortWeekdaysParse[n].test(e))return n;if(r&&t==="dd"&&this._minWeekdaysParse[n].test(e))return n;if(!r&&this._weekdaysParse[n].test(e))return n}}function are(e){if(!this.isValid())return e!=null?this:NaN;var t=this._isUTC?this._d.getUTCDay():this._d.getDay();return e!=null?(e=Kte(e,this.localeData()),this.add(e-t,"d")):t}function lre(e){if(!this.isValid())return e!=null?this:NaN;var t=(this.day()+7-this.localeData()._week.dow)%7;return e==null?t:this.add(e-t,"d")}function sre(e){if(!this.isValid())return e!=null?this:NaN;if(e!=null){var t=qte(e,this.localeData());return this.day(this.day()%7?t:t-7)}else return this.day()||7}function ure(e){return this._weekdaysParseExact?(rt(this,"_weekdaysRegex")||_E.call(this),e?this._weekdaysStrictRegex:this._weekdaysRegex):(rt(this,"_weekdaysRegex")||(this._weekdaysRegex=Qte),this._weekdaysStrictRegex&&e?this._weekdaysStrictRegex:this._weekdaysRegex)}function fre(e){return this._weekdaysParseExact?(rt(this,"_weekdaysRegex")||_E.call(this),e?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(rt(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=Jte),this._weekdaysShortStrictRegex&&e?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)}function cre(e){return this._weekdaysParseExact?(rt(this,"_weekdaysRegex")||_E.call(this),e?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(rt(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=ere),this._weekdaysMinStrictRegex&&e?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)}function _E(){function e(f,c){return c.length-f.length}var t=[],r=[],n=[],o=[],i,a,l,s,u;for(i=0;i<7;i++)a=jn([2e3,1]).day(i),l=Dr(this.weekdaysMin(a,"")),s=Dr(this.weekdaysShort(a,"")),u=Dr(this.weekdays(a,"")),t.push(l),r.push(s),n.push(u),o.push(l),o.push(s),o.push(u);t.sort(e),r.sort(e),n.sort(e),o.sort(e),this._weekdaysRegex=new RegExp("^("+o.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+n.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+r.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+t.join("|")+")","i")}function OE(){return this.hours()%12||12}function hre(){return this.hours()||24}Te("H",["HH",2],0,"hour");Te("h",["hh",2],0,OE);Te("k",["kk",2],0,hre);Te("hmm",0,0,function(){return""+OE.apply(this)+Mn(this.minutes(),2)});Te("hmmss",0,0,function(){return""+OE.apply(this)+Mn(this.minutes(),2)+Mn(this.seconds(),2)});Te("Hmm",0,0,function(){return""+this.hours()+Mn(this.minutes(),2)});Te("Hmmss",0,0,function(){return""+this.hours()+Mn(this.minutes(),2)+Mn(this.seconds(),2)});function nB(e,t){Te(e,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),t)})}nB("a",!0);nB("A",!1);or("hour","h");ir("hour",13);function oB(e,t){return t._meridiemParse}pe("a",oB);pe("A",oB);pe("H",Ct);pe("h",Ct);pe("k",Ct);pe("HH",Ct,jr);pe("hh",Ct,jr);pe("kk",Ct,jr);pe("hmm",GF);pe("hmmss",KF);pe("Hmm",GF);pe("Hmmss",KF);ht(["H","HH"],zt);ht(["k","kk"],function(e,t,r){var n=Ze(e);t[zt]=n===24?0:n});ht(["a","A"],function(e,t,r){r._isPm=r._locale.isPM(e),r._meridiem=e});ht(["h","hh"],function(e,t,r){t[zt]=Ze(e),Ue(r).bigHour=!0});ht("hmm",function(e,t,r){var n=e.length-2;t[zt]=Ze(e.substr(0,n)),t[sn]=Ze(e.substr(n)),Ue(r).bigHour=!0});ht("hmmss",function(e,t,r){var n=e.length-4,o=e.length-2;t[zt]=Ze(e.substr(0,n)),t[sn]=Ze(e.substr(n,2)),t[oo]=Ze(e.substr(o)),Ue(r).bigHour=!0});ht("Hmm",function(e,t,r){var n=e.length-2;t[zt]=Ze(e.substr(0,n)),t[sn]=Ze(e.substr(n))});ht("Hmmss",function(e,t,r){var n=e.length-4,o=e.length-2;t[zt]=Ze(e.substr(0,n)),t[sn]=Ze(e.substr(n,2)),t[oo]=Ze(e.substr(o))});function dre(e){return(e+"").toLowerCase().charAt(0)==="p"}var vre=/[ap]\.?m?\.?/i,yre=hf("Hours",!0);function gre(e,t,r){return e>11?r?"pm":"PM":r?"am":"AM"}var iB={calendar:ite,longDateFormat:ute,invalidDate:cte,ordinal:dte,dayOfMonthOrdinalParse:vte,relativeTime:gte,months:$te,monthsShort:qF,week:Wte,weekdays:Xte,weekdaysMin:Zte,weekdaysShort:rB,meridiemParse:vre},_t={},$f={},kc;function mre(e,t){var r,n=Math.min(e.length,t.length);for(r=0;r<n;r+=1)if(e[r]!==t[r])return r;return n}function rA(e){return e&&e.toLowerCase().replace("_","-")}function pre(e){for(var t=0,r,n,o,i;t<e.length;){for(i=rA(e[t]).split("-"),r=i.length,n=rA(e[t+1]),n=n?n.split("-"):null;r>0;){if(o=up(i.slice(0,r).join("-")),o)return o;if(n&&n.length>=r&&mre(i,n)>=r-1)break;r--}t++}return kc}function bre(e){return e.match("^[^/\\\\]*$")!=null}function up(e){var t=null,r;if(_t[e]===void 0&&typeof module<"u"&&module&&module.exports&&bre(e))try{t=kc._abbr,r=require,r("./locale/"+e),si(t)}catch{_t[e]=null}return _t[e]}function si(e,t){var r;return e&&(br(t)?r=jo(e):r=RE(e,t),r?kc=r:typeof console<"u"&&console.warn&&console.warn("Locale "+e+" not found. Did you forget to load it?")),kc._abbr}function RE(e,t){if(t!==null){var r,n=iB;if(t.abbr=e,_t[e]!=null)BF("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),n=_t[e]._config;else if(t.parentLocale!=null)if(_t[t.parentLocale]!=null)n=_t[t.parentLocale]._config;else if(r=up(t.parentLocale),r!=null)n=r._config;else return $f[t.parentLocale]||($f[t.parentLocale]=[]),$f[t.parentLocale].push({name:e,config:t}),null;return _t[e]=new mE(eC(n,t)),$f[e]&&$f[e].forEach(function(o){RE(o.name,o.config)}),si(e),_t[e]}else return delete _t[e],null}function wre(e,t){if(t!=null){var r,n,o=iB;_t[e]!=null&&_t[e].parentLocale!=null?_t[e].set(eC(_t[e]._config,t)):(n=up(e),n!=null&&(o=n._config),t=eC(o,t),n==null&&(t.abbr=e),r=new mE(t),r.parentLocale=_t[e],_t[e]=r),si(e)}else _t[e]!=null&&(_t[e].parentLocale!=null?(_t[e]=_t[e].parentLocale,e===si()&&si(e)):_t[e]!=null&&delete _t[e]);return _t[e]}function jo(e){var t;if(e&&e._locale&&e._locale._abbr&&(e=e._locale._abbr),!e)return kc;if(!cn(e)){if(t=up(e),t)return t;e=[e]}return pre(e)}function Sre(){return tC(_t)}function EE(e){var t,r=e._a;return r&&Ue(e).overflow===-2&&(t=r[no]<0||r[no]>11?no:r[Pn]<1||r[Pn]>sp(r[rr],r[no])?Pn:r[zt]<0||r[zt]>24||r[zt]===24&&(r[sn]!==0||r[oo]!==0||r[qi]!==0)?zt:r[sn]<0||r[sn]>59?sn:r[oo]<0||r[oo]>59?oo:r[qi]<0||r[qi]>999?qi:-1,Ue(e)._overflowDayOfYear&&(t<rr||t>Pn)&&(t=Pn),Ue(e)._overflowWeeks&&t===-1&&(t=Tte),Ue(e)._overflowWeekday&&t===-1&&(t=kte),Ue(e).overflow=t),e}var Cre=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,_re=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d|))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,Ore=/Z|[+-]\d\d(?::?\d\d)?/,Dv=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/],["YYYYMM",/\d{6}/,!1],["YYYY",/\d{4}/,!1]],zb=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],Rre=/^\/?Date\((-?\d+)/i,Ere=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/,Tre={UT:0,GMT:0,EDT:-4*60,EST:-5*60,CDT:-5*60,CST:-6*60,MDT:-6*60,MST:-7*60,PDT:-7*60,PST:-8*60};function aB(e){var t,r,n=e._i,o=Cre.exec(n)||_re.exec(n),i,a,l,s,u=Dv.length,f=zb.length;if(o){for(Ue(e).iso=!0,t=0,r=u;t<r;t++)if(Dv[t][1].exec(o[1])){a=Dv[t][0],i=Dv[t][2]!==!1;break}if(a==null){e._isValid=!1;return}if(o[3]){for(t=0,r=f;t<r;t++)if(zb[t][1].exec(o[3])){l=(o[2]||" ")+zb[t][0];break}if(l==null){e._isValid=!1;return}}if(!i&&l!=null){e._isValid=!1;return}if(o[4])if(Ore.exec(o[4]))s="Z";else{e._isValid=!1;return}e._f=a+(l||"")+(s||""),kE(e)}else e._isValid=!1}function kre(e,t,r,n,o,i){var a=[Pre(e),qF.indexOf(t),parseInt(r,10),parseInt(n,10),parseInt(o,10)];return i&&a.push(parseInt(i,10)),a}function Pre(e){var t=parseInt(e,10);return t<=49?2e3+t:t<=999?1900+t:t}function $re(e){return e.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function Are(e,t,r){if(e){var n=rB.indexOf(e),o=new Date(t[0],t[1],t[2]).getDay();if(n!==o)return Ue(r).weekdayMismatch=!0,r._isValid=!1,!1}return!0}function Ire(e,t,r){if(e)return Tre[e];if(t)return 0;var n=parseInt(r,10),o=n%100,i=(n-o)/100;return i*60+o}function lB(e){var t=Ere.exec($re(e._i)),r;if(t){if(r=kre(t[4],t[3],t[2],t[5],t[6],t[7]),!Are(t[1],r,e))return;e._a=r,e._tzm=Ire(t[8],t[9],t[10]),e._d=Ec.apply(null,e._a),e._d.setUTCMinutes(e._d.getUTCMinutes()-e._tzm),Ue(e).rfc2822=!0}else e._isValid=!1}function Mre(e){var t=Rre.exec(e._i);if(t!==null){e._d=new Date(+t[1]);return}if(aB(e),e._isValid===!1)delete e._isValid;else return;if(lB(e),e._isValid===!1)delete e._isValid;else return;e._strict?e._isValid=!1:ee.createFromInputFallback(e)}ee.createFromInputFallback=Xr("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(e){e._d=new Date(e._i+(e._useUTC?" UTC":""))});function $l(e,t,r){return e??t??r}function xre(e){var t=new Date(ee.now());return e._useUTC?[t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate()]:[t.getFullYear(),t.getMonth(),t.getDate()]}function TE(e){var t,r,n=[],o,i,a;if(!e._d){for(o=xre(e),e._w&&e._a[Pn]==null&&e._a[no]==null&&Dre(e),e._dayOfYear!=null&&(a=$l(e._a[rr],o[rr]),(e._dayOfYear>sc(a)||e._dayOfYear===0)&&(Ue(e)._overflowDayOfYear=!0),r=Ec(a,0,e._dayOfYear),e._a[no]=r.getUTCMonth(),e._a[Pn]=r.getUTCDate()),t=0;t<3&&e._a[t]==null;++t)e._a[t]=n[t]=o[t];for(;t<7;t++)e._a[t]=n[t]=e._a[t]==null?t===2?1:0:e._a[t];e._a[zt]===24&&e._a[sn]===0&&e._a[oo]===0&&e._a[qi]===0&&(e._nextDay=!0,e._a[zt]=0),e._d=(e._useUTC?Ec:Bte).apply(null,n),i=e._useUTC?e._d.getUTCDay():e._d.getDay(),e._tzm!=null&&e._d.setUTCMinutes(e._d.getUTCMinutes()-e._tzm),e._nextDay&&(e._a[zt]=24),e._w&&typeof e._w.d<"u"&&e._w.d!==i&&(Ue(e).weekdayMismatch=!0)}}function Dre(e){var t,r,n,o,i,a,l,s,u;t=e._w,t.GG!=null||t.W!=null||t.E!=null?(i=1,a=4,r=$l(t.GG,e._a[rr],Tc(wt(),1,4).year),n=$l(t.W,1),o=$l(t.E,1),(o<1||o>7)&&(s=!0)):(i=e._locale._week.dow,a=e._locale._week.doy,u=Tc(wt(),i,a),r=$l(t.gg,e._a[rr],u.year),n=$l(t.w,u.week),t.d!=null?(o=t.d,(o<0||o>6)&&(s=!0)):t.e!=null?(o=t.e+i,(t.e<0||t.e>6)&&(s=!0)):o=i),n<1||n>$o(r,i,a)?Ue(e)._overflowWeeks=!0:s!=null?Ue(e)._overflowWeekday=!0:(l=tB(r,n,o,i,a),e._a[rr]=l.year,e._dayOfYear=l.dayOfYear)}ee.ISO_8601=function(){};ee.RFC_2822=function(){};function kE(e){if(e._f===ee.ISO_8601){aB(e);return}if(e._f===ee.RFC_2822){lB(e);return}e._a=[],Ue(e).empty=!0;var t=""+e._i,r,n,o,i,a,l=t.length,s=0,u,f;for(o=VF(e._f,e._locale).match(pE)||[],f=o.length,r=0;r<f;r++)i=o[r],n=(t.match(Ote(i,e))||[])[0],n&&(a=t.substr(0,t.indexOf(n)),a.length>0&&Ue(e).unusedInput.push(a),t=t.slice(t.indexOf(n)+n.length),s+=n.length),jl[i]?(n?Ue(e).empty=!1:Ue(e).unusedTokens.push(i),Ete(i,n,e)):e._strict&&!n&&Ue(e).unusedTokens.push(i);Ue(e).charsLeftOver=l-s,t.length>0&&Ue(e).unusedInput.push(t),e._a[zt]<=12&&Ue(e).bigHour===!0&&e._a[zt]>0&&(Ue(e).bigHour=void 0),Ue(e).parsedDateParts=e._a.slice(0),Ue(e).meridiem=e._meridiem,e._a[zt]=Nre(e._locale,e._a[zt],e._meridiem),u=Ue(e).era,u!==null&&(e._a[rr]=e._locale.erasConvertYear(u,e._a[rr])),TE(e),EE(e)}function Nre(e,t,r){var n;return r==null?t:e.meridiemHour!=null?e.meridiemHour(t,r):(e.isPM!=null&&(n=e.isPM(r),n&&t<12&&(t+=12),!n&&t===12&&(t=0)),t)}function Hre(e){var t,r,n,o,i,a,l=!1,s=e._f.length;if(s===0){Ue(e).invalidFormat=!0,e._d=new Date(NaN);return}for(o=0;o<s;o++)i=0,a=!1,t=gE({},e),e._useUTC!=null&&(t._useUTC=e._useUTC),t._f=e._f[o],kE(t),yE(t)&&(a=!0),i+=Ue(t).charsLeftOver,i+=Ue(t).unusedTokens.length*10,Ue(t).score=i,l?i<n&&(n=i,r=t):(n==null||i<n||a)&&(n=i,r=t,a&&(l=!0));ni(e,r||t)}function Lre(e){if(!e._d){var t=bE(e._i),r=t.day===void 0?t.date:t.day;e._a=jF([t.year,t.month,r,t.hour,t.minute,t.second,t.millisecond],function(n){return n&&parseInt(n,10)}),TE(e)}}function jre(e){var t=new ev(EE(sB(e)));return t._nextDay&&(t.add(1,"d"),t._nextDay=void 0),t}function sB(e){var t=e._i,r=e._f;return e._locale=e._locale||jo(e._l),t===null||r===void 0&&t===""?tp({nullInput:!0}):(typeof t=="string"&&(e._i=t=e._locale.preparse(t)),hn(t)?new ev(EE(t)):(Jd(t)?e._d=t:cn(r)?Hre(e):r?kE(e):Fre(e),yE(e)||(e._d=null),e))}function Fre(e){var t=e._i;br(t)?e._d=new Date(ee.now()):Jd(t)?e._d=new Date(t.valueOf()):typeof t=="string"?Mre(e):cn(t)?(e._a=jF(t.slice(0),function(r){return parseInt(r,10)}),TE(e)):Oa(t)?Lre(e):xo(t)?e._d=new Date(t):ee.createFromInputFallback(e)}function uB(e,t,r,n,o){var i={};return(t===!0||t===!1)&&(n=t,t=void 0),(r===!0||r===!1)&&(n=r,r=void 0),(Oa(e)&&vE(e)||cn(e)&&e.length===0)&&(e=void 0),i._isAMomentObject=!0,i._useUTC=i._isUTC=o,i._l=r,i._i=e,i._f=t,i._strict=n,jre(i)}function wt(e,t,r,n){return uB(e,t,r,n,!1)}var Bre=Xr("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var e=wt.apply(null,arguments);return this.isValid()&&e.isValid()?e<this?this:e:tp()}),Vre=Xr("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var e=wt.apply(null,arguments);return this.isValid()&&e.isValid()?e>this?this:e:tp()});function fB(e,t){var r,n;if(t.length===1&&cn(t[0])&&(t=t[0]),!t.length)return wt();for(r=t[0],n=1;n<t.length;++n)(!t[n].isValid()||t[n][e](r))&&(r=t[n]);return r}function Wre(){var e=[].slice.call(arguments,0);return fB("isBefore",e)}function Ure(){var e=[].slice.call(arguments,0);return fB("isAfter",e)}var zre=function(){return Date.now?Date.now():+new Date},Af=["year","quarter","month","week","day","hour","minute","second","millisecond"];function Yre(e){var t,r=!1,n,o=Af.length;for(t in e)if(rt(e,t)&&!(Nt.call(Af,t)!==-1&&(e[t]==null||!isNaN(e[t]))))return!1;for(n=0;n<o;++n)if(e[Af[n]]){if(r)return!1;parseFloat(e[Af[n]])!==Ze(e[Af[n]])&&(r=!0)}return!0}function Gre(){return this._isValid}function Kre(){return vn(NaN)}function fp(e){var t=bE(e),r=t.year||0,n=t.quarter||0,o=t.month||0,i=t.week||t.isoWeek||0,a=t.day||0,l=t.hour||0,s=t.minute||0,u=t.second||0,f=t.millisecond||0;this._isValid=Yre(t),this._milliseconds=+f+u*1e3+s*6e4+l*1e3*60*60,this._days=+a+i*7,this._months=+o+n*3+r*12,this._data={},this._locale=jo(),this._bubble()}function jy(e){return e instanceof fp}function nC(e){return e<0?Math.round(-1*e)*-1:Math.round(e)}function qre(e,t,r){var n=Math.min(e.length,t.length),o=Math.abs(e.length-t.length),i=0,a;for(a=0;a<n;a++)(r&&e[a]!==t[a]||!r&&Ze(e[a])!==Ze(t[a]))&&i++;return i+o}function cB(e,t){Te(e,0,0,function(){var r=this.utcOffset(),n="+";return r<0&&(r=-r,n="-"),n+Mn(~~(r/60),2)+t+Mn(~~r%60,2)})}cB("Z",":");cB("ZZ","");pe("Z",lp);pe("ZZ",lp);ht(["Z","ZZ"],function(e,t,r){r._useUTC=!0,r._tzm=PE(lp,e)});var Xre=/([\+\-]|\d\d)/gi;function PE(e,t){var r=(t||"").match(e),n,o,i;return r===null?null:(n=r[r.length-1]||[],o=(n+"").match(Xre)||["-",0,0],i=+(o[1]*60)+Ze(o[2]),i===0?0:o[0]==="+"?i:-i)}function $E(e,t){var r,n;return t._isUTC?(r=t.clone(),n=(hn(e)||Jd(e)?e.valueOf():wt(e).valueOf())-r.valueOf(),r._d.setTime(r._d.valueOf()+n),ee.updateOffset(r,!1),r):wt(e).local()}function oC(e){return-Math.round(e._d.getTimezoneOffset())}ee.updateOffset=function(){};function Zre(e,t,r){var n=this._offset||0,o;if(!this.isValid())return e!=null?this:NaN;if(e!=null){if(typeof e=="string"){if(e=PE(lp,e),e===null)return this}else Math.abs(e)<16&&!r&&(e=e*60);return!this._isUTC&&t&&(o=oC(this)),this._offset=e,this._isUTC=!0,o!=null&&this.add(o,"m"),n!==e&&(!t||this._changeInProgress?vB(this,vn(e-n,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,ee.updateOffset(this,!0),this._changeInProgress=null)),this}else return this._isUTC?n:oC(this)}function Qre(e,t){return e!=null?(typeof e!="string"&&(e=-e),this.utcOffset(e,t),this):-this.utcOffset()}function Jre(e){return this.utcOffset(0,e)}function ene(e){return this._isUTC&&(this.utcOffset(0,e),this._isUTC=!1,e&&this.subtract(oC(this),"m")),this}function tne(){if(this._tzm!=null)this.utcOffset(this._tzm,!1,!0);else if(typeof this._i=="string"){var e=PE(Cte,this._i);e!=null?this.utcOffset(e):this.utcOffset(0,!0)}return this}function rne(e){return this.isValid()?(e=e?wt(e).utcOffset():0,(this.utcOffset()-e)%60===0):!1}function nne(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function one(){if(!br(this._isDSTShifted))return this._isDSTShifted;var e={},t;return gE(e,this),e=sB(e),e._a?(t=e._isUTC?jn(e._a):wt(e._a),this._isDSTShifted=this.isValid()&&qre(e._a,t.toArray())>0):this._isDSTShifted=!1,this._isDSTShifted}function ine(){return this.isValid()?!this._isUTC:!1}function ane(){return this.isValid()?this._isUTC:!1}function hB(){return this.isValid()?this._isUTC&&this._offset===0:!1}var lne=/^(-|\+)?(?:(\d*)[. ])?(\d+):(\d+)(?::(\d+)(\.\d*)?)?$/,sne=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function vn(e,t){var r=e,n=null,o,i,a;return jy(e)?r={ms:e._milliseconds,d:e._days,M:e._months}:xo(e)||!isNaN(+e)?(r={},t?r[t]=+e:r.milliseconds=+e):(n=lne.exec(e))?(o=n[1]==="-"?-1:1,r={y:0,d:Ze(n[Pn])*o,h:Ze(n[zt])*o,m:Ze(n[sn])*o,s:Ze(n[oo])*o,ms:Ze(nC(n[qi]*1e3))*o}):(n=sne.exec(e))?(o=n[1]==="-"?-1:1,r={y:Ii(n[2],o),M:Ii(n[3],o),w:Ii(n[4],o),d:Ii(n[5],o),h:Ii(n[6],o),m:Ii(n[7],o),s:Ii(n[8],o)}):r==null?r={}:typeof r=="object"&&("from"in r||"to"in r)&&(a=une(wt(r.from),wt(r.to)),r={},r.ms=a.milliseconds,r.M=a.months),i=new fp(r),jy(e)&&rt(e,"_locale")&&(i._locale=e._locale),jy(e)&&rt(e,"_isValid")&&(i._isValid=e._isValid),i}vn.fn=fp.prototype;vn.invalid=Kre;function Ii(e,t){var r=e&&parseFloat(e.replace(",","."));return(isNaN(r)?0:r)*t}function nA(e,t){var r={};return r.months=t.month()-e.month()+(t.year()-e.year())*12,e.clone().add(r.months,"M").isAfter(t)&&--r.months,r.milliseconds=+t-+e.clone().add(r.months,"M"),r}function une(e,t){var r;return e.isValid()&&t.isValid()?(t=$E(t,e),e.isBefore(t)?r=nA(e,t):(r=nA(t,e),r.milliseconds=-r.milliseconds,r.months=-r.months),r):{milliseconds:0,months:0}}function dB(e,t){return function(r,n){var o,i;return n!==null&&!isNaN(+n)&&(BF(t,"moment()."+t+"(period, number) is deprecated. Please use moment()."+t+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),i=r,r=n,n=i),o=vn(r,n),vB(this,o,e),this}}function vB(e,t,r,n){var o=t._milliseconds,i=nC(t._days),a=nC(t._months);e.isValid()&&(n=n??!0,a&&ZF(e,Og(e,"Month")+a*r),i&&UF(e,"Date",Og(e,"Date")+i*r),o&&e._d.setTime(e._d.valueOf()+o*r),n&&ee.updateOffset(e,i||a))}var fne=dB(1,"add"),cne=dB(-1,"subtract");function yB(e){return typeof e=="string"||e instanceof String}function hne(e){return hn(e)||Jd(e)||yB(e)||xo(e)||vne(e)||dne(e)||e===null||e===void 0}function dne(e){var t=Oa(e)&&!vE(e),r=!1,n=["years","year","y","months","month","M","days","day","d","dates","date","D","hours","hour","h","minutes","minute","m","seconds","second","s","milliseconds","millisecond","ms"],o,i,a=n.length;for(o=0;o<a;o+=1)i=n[o],r=r||rt(e,i);return t&&r}function vne(e){var t=cn(e),r=!1;return t&&(r=e.filter(function(n){return!xo(n)&&yB(e)}).length===0),t&&r}function yne(e){var t=Oa(e)&&!vE(e),r=!1,n=["sameDay","nextDay","lastDay","nextWeek","lastWeek","sameElse"],o,i;for(o=0;o<n.length;o+=1)i=n[o],r=r||rt(e,i);return t&&r}function gne(e,t){var r=e.diff(t,"days",!0);return r<-6?"sameElse":r<-1?"lastWeek":r<0?"lastDay":r<1?"sameDay":r<2?"nextDay":r<7?"nextWeek":"sameElse"}function mne(e,t){arguments.length===1&&(arguments[0]?hne(arguments[0])?(e=arguments[0],t=void 0):yne(arguments[0])&&(t=arguments[0],e=void 0):(e=void 0,t=void 0));var r=e||wt(),n=$E(r,this).startOf("day"),o=ee.calendarFormat(this,n)||"sameElse",i=t&&(Fn(t[o])?t[o].call(this,r):t[o]);return this.format(i||this.localeData().calendar(o,this,wt(r)))}function pne(){return new ev(this)}function bne(e,t){var r=hn(e)?e:wt(e);return this.isValid()&&r.isValid()?(t=Zr(t)||"millisecond",t==="millisecond"?this.valueOf()>r.valueOf():r.valueOf()<this.clone().startOf(t).valueOf()):!1}function wne(e,t){var r=hn(e)?e:wt(e);return this.isValid()&&r.isValid()?(t=Zr(t)||"millisecond",t==="millisecond"?this.valueOf()<r.valueOf():this.clone().endOf(t).valueOf()<r.valueOf()):!1}function Sne(e,t,r,n){var o=hn(e)?e:wt(e),i=hn(t)?t:wt(t);return this.isValid()&&o.isValid()&&i.isValid()?(n=n||"()",(n[0]==="("?this.isAfter(o,r):!this.isBefore(o,r))&&(n[1]===")"?this.isBefore(i,r):!this.isAfter(i,r))):!1}function Cne(e,t){var r=hn(e)?e:wt(e),n;return this.isValid()&&r.isValid()?(t=Zr(t)||"millisecond",t==="millisecond"?this.valueOf()===r.valueOf():(n=r.valueOf(),this.clone().startOf(t).valueOf()<=n&&n<=this.clone().endOf(t).valueOf())):!1}function _ne(e,t){return this.isSame(e,t)||this.isAfter(e,t)}function One(e,t){return this.isSame(e,t)||this.isBefore(e,t)}function Rne(e,t,r){var n,o,i;if(!this.isValid())return NaN;if(n=$E(e,this),!n.isValid())return NaN;switch(o=(n.utcOffset()-this.utcOffset())*6e4,t=Zr(t),t){case"year":i=Fy(this,n)/12;break;case"month":i=Fy(this,n);break;case"quarter":i=Fy(this,n)/3;break;case"second":i=(this-n)/1e3;break;case"minute":i=(this-n)/6e4;break;case"hour":i=(this-n)/36e5;break;case"day":i=(this-n-o)/864e5;break;case"week":i=(this-n-o)/6048e5;break;default:i=this-n}return r?i:Ur(i)}function Fy(e,t){if(e.date()<t.date())return-Fy(t,e);var r=(t.year()-e.year())*12+(t.month()-e.month()),n=e.clone().add(r,"months"),o,i;return t-n<0?(o=e.clone().add(r-1,"months"),i=(t-n)/(n-o)):(o=e.clone().add(r+1,"months"),i=(t-n)/(o-n)),-(r+i)||0}ee.defaultFormat="YYYY-MM-DDTHH:mm:ssZ";ee.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";function Ene(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function Tne(e){if(!this.isValid())return null;var t=e!==!0,r=t?this.clone().utc():this;return r.year()<0||r.year()>9999?Ly(r,t?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ"):Fn(Date.prototype.toISOString)?t?this.toDate().toISOString():new Date(this.valueOf()+this.utcOffset()*60*1e3).toISOString().replace("Z",Ly(r,"Z")):Ly(r,t?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")}function kne(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var e="moment",t="",r,n,o,i;return this.isLocal()||(e=this.utcOffset()===0?"moment.utc":"moment.parseZone",t="Z"),r="["+e+'("]',n=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY",o="-MM-DD[T]HH:mm:ss.SSS",i=t+'[")]',this.format(r+n+o+i)}function Pne(e){e||(e=this.isUtc()?ee.defaultFormatUtc:ee.defaultFormat);var t=Ly(this,e);return this.localeData().postformat(t)}function $ne(e,t){return this.isValid()&&(hn(e)&&e.isValid()||wt(e).isValid())?vn({to:this,from:e}).locale(this.locale()).humanize(!t):this.localeData().invalidDate()}function Ane(e){return this.from(wt(),e)}function Ine(e,t){return this.isValid()&&(hn(e)&&e.isValid()||wt(e).isValid())?vn({from:this,to:e}).locale(this.locale()).humanize(!t):this.localeData().invalidDate()}function Mne(e){return this.to(wt(),e)}function gB(e){var t;return e===void 0?this._locale._abbr:(t=jo(e),t!=null&&(this._locale=t),this)}var mB=Xr("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(e){return e===void 0?this.localeData():this.locale(e)});function pB(){return this._locale}var Tg=1e3,Fl=60*Tg,kg=60*Fl,bB=(365*400+97)*24*kg;function Bl(e,t){return(e%t+t)%t}function wB(e,t,r){return e<100&&e>=0?new Date(e+400,t,r)-bB:new Date(e,t,r).valueOf()}function SB(e,t,r){return e<100&&e>=0?Date.UTC(e+400,t,r)-bB:Date.UTC(e,t,r)}function xne(e){var t,r;if(e=Zr(e),e===void 0||e==="millisecond"||!this.isValid())return this;switch(r=this._isUTC?SB:wB,e){case"year":t=r(this.year(),0,1);break;case"quarter":t=r(this.year(),this.month()-this.month()%3,1);break;case"month":t=r(this.year(),this.month(),1);break;case"week":t=r(this.year(),this.month(),this.date()-this.weekday());break;case"isoWeek":t=r(this.year(),this.month(),this.date()-(this.isoWeekday()-1));break;case"day":case"date":t=r(this.year(),this.month(),this.date());break;case"hour":t=this._d.valueOf(),t-=Bl(t+(this._isUTC?0:this.utcOffset()*Fl),kg);break;case"minute":t=this._d.valueOf(),t-=Bl(t,Fl);break;case"second":t=this._d.valueOf(),t-=Bl(t,Tg);break}return this._d.setTime(t),ee.updateOffset(this,!0),this}function Dne(e){var t,r;if(e=Zr(e),e===void 0||e==="millisecond"||!this.isValid())return this;switch(r=this._isUTC?SB:wB,e){case"year":t=r(this.year()+1,0,1)-1;break;case"quarter":t=r(this.year(),this.month()-this.month()%3+3,1)-1;break;case"month":t=r(this.year(),this.month()+1,1)-1;break;case"week":t=r(this.year(),this.month(),this.date()-this.weekday()+7)-1;break;case"isoWeek":t=r(this.year(),this.month(),this.date()-(this.isoWeekday()-1)+7)-1;break;case"day":case"date":t=r(this.year(),this.month(),this.date()+1)-1;break;case"hour":t=this._d.valueOf(),t+=kg-Bl(t+(this._isUTC?0:this.utcOffset()*Fl),kg)-1;break;case"minute":t=this._d.valueOf(),t+=Fl-Bl(t,Fl)-1;break;case"second":t=this._d.valueOf(),t+=Tg-Bl(t,Tg)-1;break}return this._d.setTime(t),ee.updateOffset(this,!0),this}function Nne(){return this._d.valueOf()-(this._offset||0)*6e4}function Hne(){return Math.floor(this.valueOf()/1e3)}function Lne(){return new Date(this.valueOf())}function jne(){var e=this;return[e.year(),e.month(),e.date(),e.hour(),e.minute(),e.second(),e.millisecond()]}function Fne(){var e=this;return{years:e.year(),months:e.month(),date:e.date(),hours:e.hours(),minutes:e.minutes(),seconds:e.seconds(),milliseconds:e.milliseconds()}}function Bne(){return this.isValid()?this.toISOString():null}function Vne(){return yE(this)}function Wne(){return ni({},Ue(this))}function Une(){return Ue(this).overflow}function zne(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}}Te("N",0,0,"eraAbbr");Te("NN",0,0,"eraAbbr");Te("NNN",0,0,"eraAbbr");Te("NNNN",0,0,"eraName");Te("NNNNN",0,0,"eraNarrow");Te("y",["y",1],"yo","eraYear");Te("y",["yy",2],0,"eraYear");Te("y",["yyy",3],0,"eraYear");Te("y",["yyyy",4],0,"eraYear");pe("N",AE);pe("NN",AE);pe("NNN",AE);pe("NNNN",roe);pe("NNNNN",noe);ht(["N","NN","NNN","NNNN","NNNNN"],function(e,t,r,n){var o=r._locale.erasParse(e,n,r._strict);o?Ue(r).era=o:Ue(r).invalidEra=e});pe("y",df);pe("yy",df);pe("yyy",df);pe("yyyy",df);pe("yo",ooe);ht(["y","yy","yyy","yyyy"],rr);ht(["yo"],function(e,t,r,n){var o;r._locale._eraYearOrdinalRegex&&(o=e.match(r._locale._eraYearOrdinalRegex)),r._locale.eraYearOrdinalParse?t[rr]=r._locale.eraYearOrdinalParse(e,o):t[rr]=parseInt(e,10)});function Yne(e,t){var r,n,o,i=this._eras||jo("en")._eras;for(r=0,n=i.length;r<n;++r){switch(typeof i[r].since){case"string":o=ee(i[r].since).startOf("day"),i[r].since=o.valueOf();break}switch(typeof i[r].until){case"undefined":i[r].until=1/0;break;case"string":o=ee(i[r].until).startOf("day").valueOf(),i[r].until=o.valueOf();break}}return i}function Gne(e,t,r){var n,o,i=this.eras(),a,l,s;for(e=e.toUpperCase(),n=0,o=i.length;n<o;++n)if(a=i[n].name.toUpperCase(),l=i[n].abbr.toUpperCase(),s=i[n].narrow.toUpperCase(),r)switch(t){case"N":case"NN":case"NNN":if(l===e)return i[n];break;case"NNNN":if(a===e)return i[n];break;case"NNNNN":if(s===e)return i[n];break}else if([a,l,s].indexOf(e)>=0)return i[n]}function Kne(e,t){var r=e.since<=e.until?1:-1;return t===void 0?ee(e.since).year():ee(e.since).year()+(t-e.offset)*r}function qne(){var e,t,r,n=this.localeData().eras();for(e=0,t=n.length;e<t;++e)if(r=this.clone().startOf("day").valueOf(),n[e].since<=r&&r<=n[e].until||n[e].until<=r&&r<=n[e].since)return n[e].name;return""}function Xne(){var e,t,r,n=this.localeData().eras();for(e=0,t=n.length;e<t;++e)if(r=this.clone().startOf("day").valueOf(),n[e].since<=r&&r<=n[e].until||n[e].until<=r&&r<=n[e].since)return n[e].narrow;return""}function Zne(){var e,t,r,n=this.localeData().eras();for(e=0,t=n.length;e<t;++e)if(r=this.clone().startOf("day").valueOf(),n[e].since<=r&&r<=n[e].until||n[e].until<=r&&r<=n[e].since)return n[e].abbr;return""}function Qne(){var e,t,r,n,o=this.localeData().eras();for(e=0,t=o.length;e<t;++e)if(r=o[e].since<=o[e].until?1:-1,n=this.clone().startOf("day").valueOf(),o[e].since<=n&&n<=o[e].until||o[e].until<=n&&n<=o[e].since)return(this.year()-ee(o[e].since).year())*r+o[e].offset;return this.year()}function Jne(e){return rt(this,"_erasNameRegex")||IE.call(this),e?this._erasNameRegex:this._erasRegex}function eoe(e){return rt(this,"_erasAbbrRegex")||IE.call(this),e?this._erasAbbrRegex:this._erasRegex}function toe(e){return rt(this,"_erasNarrowRegex")||IE.call(this),e?this._erasNarrowRegex:this._erasRegex}function AE(e,t){return t.erasAbbrRegex(e)}function roe(e,t){return t.erasNameRegex(e)}function noe(e,t){return t.erasNarrowRegex(e)}function ooe(e,t){return t._eraYearOrdinalRegex||df}function IE(){var e=[],t=[],r=[],n=[],o,i,a=this.eras();for(o=0,i=a.length;o<i;++o)t.push(Dr(a[o].name)),e.push(Dr(a[o].abbr)),r.push(Dr(a[o].narrow)),n.push(Dr(a[o].name)),n.push(Dr(a[o].abbr)),n.push(Dr(a[o].narrow));this._erasRegex=new RegExp("^("+n.join("|")+")","i"),this._erasNameRegex=new RegExp("^("+t.join("|")+")","i"),this._erasAbbrRegex=new RegExp("^("+e.join("|")+")","i"),this._erasNarrowRegex=new RegExp("^("+r.join("|")+")","i")}Te(0,["gg",2],0,function(){return this.weekYear()%100});Te(0,["GG",2],0,function(){return this.isoWeekYear()%100});function cp(e,t){Te(0,[e,e.length],0,t)}cp("gggg","weekYear");cp("ggggg","weekYear");cp("GGGG","isoWeekYear");cp("GGGGG","isoWeekYear");or("weekYear","gg");or("isoWeekYear","GG");ir("weekYear",1);ir("isoWeekYear",1);pe("G",ap);pe("g",ap);pe("GG",Ct,jr);pe("gg",Ct,jr);pe("GGGG",SE,wE);pe("gggg",SE,wE);pe("GGGGG",ip,np);pe("ggggg",ip,np);rv(["gggg","ggggg","GGGG","GGGGG"],function(e,t,r,n){t[n.substr(0,2)]=Ze(e)});rv(["gg","GG"],function(e,t,r,n){t[n]=ee.parseTwoDigitYear(e)});function ioe(e){return CB.call(this,e,this.week(),this.weekday(),this.localeData()._week.dow,this.localeData()._week.doy)}function aoe(e){return CB.call(this,e,this.isoWeek(),this.isoWeekday(),1,4)}function loe(){return $o(this.year(),1,4)}function soe(){return $o(this.isoWeekYear(),1,4)}function uoe(){var e=this.localeData()._week;return $o(this.year(),e.dow,e.doy)}function foe(){var e=this.localeData()._week;return $o(this.weekYear(),e.dow,e.doy)}function CB(e,t,r,n,o){var i;return e==null?Tc(this,n,o).year:(i=$o(e,n,o),t>i&&(t=i),coe.call(this,e,t,r,n,o))}function coe(e,t,r,n,o){var i=tB(e,t,r,n,o),a=Ec(i.year,0,i.dayOfYear);return this.year(a.getUTCFullYear()),this.month(a.getUTCMonth()),this.date(a.getUTCDate()),this}Te("Q",0,"Qo","quarter");or("quarter","Q");ir("quarter",7);pe("Q",zF);ht("Q",function(e,t){t[no]=(Ze(e)-1)*3});function hoe(e){return e==null?Math.ceil((this.month()+1)/3):this.month((e-1)*3+this.month()%3)}Te("D",["DD",2],"Do","date");or("date","D");ir("date",9);pe("D",Ct);pe("DD",Ct,jr);pe("Do",function(e,t){return e?t._dayOfMonthOrdinalParse||t._ordinalParse:t._dayOfMonthOrdinalParseLenient});ht(["D","DD"],Pn);ht("Do",function(e,t){t[Pn]=Ze(e.match(Ct)[0])});var _B=hf("Date",!0);Te("DDD",["DDDD",3],"DDDo","dayOfYear");or("dayOfYear","DDD");ir("dayOfYear",4);pe("DDD",op);pe("DDDD",YF);ht(["DDD","DDDD"],function(e,t,r){r._dayOfYear=Ze(e)});function doe(e){var t=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return e==null?t:this.add(e-t,"d")}Te("m",["mm",2],0,"minute");or("minute","m");ir("minute",14);pe("m",Ct);pe("mm",Ct,jr);ht(["m","mm"],sn);var voe=hf("Minutes",!1);Te("s",["ss",2],0,"second");or("second","s");ir("second",15);pe("s",Ct);pe("ss",Ct,jr);ht(["s","ss"],oo);var yoe=hf("Seconds",!1);Te("S",0,0,function(){return~~(this.millisecond()/100)});Te(0,["SS",2],0,function(){return~~(this.millisecond()/10)});Te(0,["SSS",3],0,"millisecond");Te(0,["SSSS",4],0,function(){return this.millisecond()*10});Te(0,["SSSSS",5],0,function(){return this.millisecond()*100});Te(0,["SSSSSS",6],0,function(){return this.millisecond()*1e3});Te(0,["SSSSSSS",7],0,function(){return this.millisecond()*1e4});Te(0,["SSSSSSSS",8],0,function(){return this.millisecond()*1e5});Te(0,["SSSSSSSSS",9],0,function(){return this.millisecond()*1e6});or("millisecond","ms");ir("millisecond",16);pe("S",op,zF);pe("SS",op,jr);pe("SSS",op,YF);var oi,OB;for(oi="SSSS";oi.length<=9;oi+="S")pe(oi,df);function goe(e,t){t[qi]=Ze(("0."+e)*1e3)}for(oi="S";oi.length<=9;oi+="S")ht(oi,goe);OB=hf("Milliseconds",!1);Te("z",0,0,"zoneAbbr");Te("zz",0,0,"zoneName");function moe(){return this._isUTC?"UTC":""}function poe(){return this._isUTC?"Coordinated Universal Time":""}var ne=ev.prototype;ne.add=fne;ne.calendar=mne;ne.clone=pne;ne.diff=Rne;ne.endOf=Dne;ne.format=Pne;ne.from=$ne;ne.fromNow=Ane;ne.to=Ine;ne.toNow=Mne;ne.get=wte;ne.invalidAt=Une;ne.isAfter=bne;ne.isBefore=wne;ne.isBetween=Sne;ne.isSame=Cne;ne.isSameOrAfter=_ne;ne.isSameOrBefore=One;ne.isValid=Vne;ne.lang=mB;ne.locale=gB;ne.localeData=pB;ne.max=Vre;ne.min=Bre;ne.parsingFlags=Wne;ne.set=Ste;ne.startOf=xne;ne.subtract=cne;ne.toArray=jne;ne.toObject=Fne;ne.toDate=Lne;ne.toISOString=Tne;ne.inspect=kne;typeof Symbol<"u"&&Symbol.for!=null&&(ne[Symbol.for("nodejs.util.inspect.custom")]=function(){return"Moment<"+this.format()+">"});ne.toJSON=Bne;ne.toString=Ene;ne.unix=Hne;ne.valueOf=Nne;ne.creationData=zne;ne.eraName=qne;ne.eraNarrow=Xne;ne.eraAbbr=Zne;ne.eraYear=Qne;ne.year=eB;ne.isLeapYear=Fte;ne.weekYear=ioe;ne.isoWeekYear=aoe;ne.quarter=ne.quarters=hoe;ne.month=QF;ne.daysInMonth=Hte;ne.week=ne.weeks=Yte;ne.isoWeek=ne.isoWeeks=Gte;ne.weeksInYear=uoe;ne.weeksInWeekYear=foe;ne.isoWeeksInYear=loe;ne.isoWeeksInISOWeekYear=soe;ne.date=_B;ne.day=ne.days=are;ne.weekday=lre;ne.isoWeekday=sre;ne.dayOfYear=doe;ne.hour=ne.hours=yre;ne.minute=ne.minutes=voe;ne.second=ne.seconds=yoe;ne.millisecond=ne.milliseconds=OB;ne.utcOffset=Zre;ne.utc=Jre;ne.local=ene;ne.parseZone=tne;ne.hasAlignedHourOffset=rne;ne.isDST=nne;ne.isLocal=ine;ne.isUtcOffset=ane;ne.isUtc=hB;ne.isUTC=hB;ne.zoneAbbr=moe;ne.zoneName=poe;ne.dates=Xr("dates accessor is deprecated. Use date instead.",_B);ne.months=Xr("months accessor is deprecated. Use month instead",QF);ne.years=Xr("years accessor is deprecated. Use year instead",eB);ne.zone=Xr("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",Qre);ne.isDSTShifted=Xr("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",one);function boe(e){return wt(e*1e3)}function woe(){return wt.apply(null,arguments).parseZone()}function RB(e){return e}var nt=mE.prototype;nt.calendar=ate;nt.longDateFormat=fte;nt.invalidDate=hte;nt.ordinal=yte;nt.preparse=RB;nt.postformat=RB;nt.relativeTime=mte;nt.pastFuture=pte;nt.set=ote;nt.eras=Yne;nt.erasParse=Gne;nt.erasConvertYear=Kne;nt.erasAbbrRegex=eoe;nt.erasNameRegex=Jne;nt.erasNarrowRegex=toe;nt.months=Mte;nt.monthsShort=xte;nt.monthsParse=Nte;nt.monthsRegex=jte;nt.monthsShortRegex=Lte;nt.week=Vte;nt.firstDayOfYear=zte;nt.firstDayOfWeek=Ute;nt.weekdays=tre;nt.weekdaysMin=nre;nt.weekdaysShort=rre;nt.weekdaysParse=ire;nt.weekdaysRegex=ure;nt.weekdaysShortRegex=fre;nt.weekdaysMinRegex=cre;nt.isPM=dre;nt.meridiem=gre;function Pg(e,t,r,n){var o=jo(),i=jn().set(n,t);return o[r](i,e)}function EB(e,t,r){if(xo(e)&&(t=e,e=void 0),e=e||"",t!=null)return Pg(e,t,r,"month");var n,o=[];for(n=0;n<12;n++)o[n]=Pg(e,n,r,"month");return o}function ME(e,t,r,n){typeof e=="boolean"?(xo(t)&&(r=t,t=void 0),t=t||""):(t=e,r=t,e=!1,xo(t)&&(r=t,t=void 0),t=t||"");var o=jo(),i=e?o._week.dow:0,a,l=[];if(r!=null)return Pg(t,(r+i)%7,n,"day");for(a=0;a<7;a++)l[a]=Pg(t,(a+i)%7,n,"day");return l}function Soe(e,t){return EB(e,t,"months")}function Coe(e,t){return EB(e,t,"monthsShort")}function _oe(e,t,r){return ME(e,t,r,"weekdays")}function Ooe(e,t,r){return ME(e,t,r,"weekdaysShort")}function Roe(e,t,r){return ME(e,t,r,"weekdaysMin")}si("en",{eras:[{since:"0001-01-01",until:1/0,offset:1,name:"Anno Domini",narrow:"AD",abbr:"AD"},{since:"0000-12-31",until:-1/0,offset:1,name:"Before Christ",narrow:"BC",abbr:"BC"}],dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(e){var t=e%10,r=Ze(e%100/10)===1?"th":t===1?"st":t===2?"nd":t===3?"rd":"th";return e+r}});ee.lang=Xr("moment.lang is deprecated. Use moment.locale instead.",si);ee.langData=Xr("moment.langData is deprecated. Use moment.localeData instead.",jo);var Wn=Math.abs;function Eoe(){var e=this._data;return this._milliseconds=Wn(this._milliseconds),this._days=Wn(this._days),this._months=Wn(this._months),e.milliseconds=Wn(e.milliseconds),e.seconds=Wn(e.seconds),e.minutes=Wn(e.minutes),e.hours=Wn(e.hours),e.months=Wn(e.months),e.years=Wn(e.years),this}function TB(e,t,r,n){var o=vn(t,r);return e._milliseconds+=n*o._milliseconds,e._days+=n*o._days,e._months+=n*o._months,e._bubble()}function Toe(e,t){return TB(this,e,t,1)}function koe(e,t){return TB(this,e,t,-1)}function oA(e){return e<0?Math.floor(e):Math.ceil(e)}function Poe(){var e=this._milliseconds,t=this._days,r=this._months,n=this._data,o,i,a,l,s;return e>=0&&t>=0&&r>=0||e<=0&&t<=0&&r<=0||(e+=oA(iC(r)+t)*864e5,t=0,r=0),n.milliseconds=e%1e3,o=Ur(e/1e3),n.seconds=o%60,i=Ur(o/60),n.minutes=i%60,a=Ur(i/60),n.hours=a%24,t+=Ur(a/24),s=Ur(kB(t)),r+=s,t-=oA(iC(s)),l=Ur(r/12),r%=12,n.days=t,n.months=r,n.years=l,this}function kB(e){return e*4800/146097}function iC(e){return e*146097/4800}function $oe(e){if(!this.isValid())return NaN;var t,r,n=this._milliseconds;if(e=Zr(e),e==="month"||e==="quarter"||e==="year")switch(t=this._days+n/864e5,r=this._months+kB(t),e){case"month":return r;case"quarter":return r/3;case"year":return r/12}else switch(t=this._days+Math.round(iC(this._months)),e){case"week":return t/7+n/6048e5;case"day":return t+n/864e5;case"hour":return t*24+n/36e5;case"minute":return t*1440+n/6e4;case"second":return t*86400+n/1e3;case"millisecond":return Math.floor(t*864e5)+n;default:throw new Error("Unknown unit "+e)}}function Aoe(){return this.isValid()?this._milliseconds+this._days*864e5+this._months%12*2592e6+Ze(this._months/12)*31536e6:NaN}function Fo(e){return function(){return this.as(e)}}var Ioe=Fo("ms"),Moe=Fo("s"),xoe=Fo("m"),Doe=Fo("h"),Noe=Fo("d"),Hoe=Fo("w"),Loe=Fo("M"),joe=Fo("Q"),Foe=Fo("y");function Boe(){return vn(this)}function Voe(e){return e=Zr(e),this.isValid()?this[e+"s"]():NaN}function qa(e){return function(){return this.isValid()?this._data[e]:NaN}}var Woe=qa("milliseconds"),Uoe=qa("seconds"),zoe=qa("minutes"),Yoe=qa("hours"),Goe=qa("days"),Koe=qa("months"),qoe=qa("years");function Xoe(){return Ur(this.days()/7)}var Jn=Math.round,Nl={ss:44,s:45,m:45,h:22,d:26,w:null,M:11};function Zoe(e,t,r,n,o){return o.relativeTime(t||1,!!r,e,n)}function Qoe(e,t,r,n){var o=vn(e).abs(),i=Jn(o.as("s")),a=Jn(o.as("m")),l=Jn(o.as("h")),s=Jn(o.as("d")),u=Jn(o.as("M")),f=Jn(o.as("w")),c=Jn(o.as("y")),h=i<=r.ss&&["s",i]||i<r.s&&["ss",i]||a<=1&&["m"]||a<r.m&&["mm",a]||l<=1&&["h"]||l<r.h&&["hh",l]||s<=1&&["d"]||s<r.d&&["dd",s];return r.w!=null&&(h=h||f<=1&&["w"]||f<r.w&&["ww",f]),h=h||u<=1&&["M"]||u<r.M&&["MM",u]||c<=1&&["y"]||["yy",c],h[2]=t,h[3]=+e>0,h[4]=n,Zoe.apply(null,h)}function Joe(e){return e===void 0?Jn:typeof e=="function"?(Jn=e,!0):!1}function eie(e,t){return Nl[e]===void 0?!1:t===void 0?Nl[e]:(Nl[e]=t,e==="s"&&(Nl.ss=t-1),!0)}function tie(e,t){if(!this.isValid())return this.localeData().invalidDate();var r=!1,n=Nl,o,i;return typeof e=="object"&&(t=e,e=!1),typeof e=="boolean"&&(r=e),typeof t=="object"&&(n=Object.assign({},Nl,t),t.s!=null&&t.ss==null&&(n.ss=t.s-1)),o=this.localeData(),i=Qoe(this,!r,n,o),r&&(i=o.pastFuture(+this,i)),o.postformat(i)}var Yb=Math.abs;function ol(e){return(e>0)-(e<0)||+e}function hp(){if(!this.isValid())return this.localeData().invalidDate();var e=Yb(this._milliseconds)/1e3,t=Yb(this._days),r=Yb(this._months),n,o,i,a,l=this.asSeconds(),s,u,f,c;return l?(n=Ur(e/60),o=Ur(n/60),e%=60,n%=60,i=Ur(r/12),r%=12,a=e?e.toFixed(3).replace(/\.?0+$/,""):"",s=l<0?"-":"",u=ol(this._months)!==ol(l)?"-":"",f=ol(this._days)!==ol(l)?"-":"",c=ol(this._milliseconds)!==ol(l)?"-":"",s+"P"+(i?u+i+"Y":"")+(r?u+r+"M":"")+(t?f+t+"D":"")+(o||n||e?"T":"")+(o?c+o+"H":"")+(n?c+n+"M":"")+(e?c+a+"S":"")):"P0D"}var et=fp.prototype;et.isValid=Gre;et.abs=Eoe;et.add=Toe;et.subtract=koe;et.as=$oe;et.asMilliseconds=Ioe;et.asSeconds=Moe;et.asMinutes=xoe;et.asHours=Doe;et.asDays=Noe;et.asWeeks=Hoe;et.asMonths=Loe;et.asQuarters=joe;et.asYears=Foe;et.valueOf=Aoe;et._bubble=Poe;et.clone=Boe;et.get=Voe;et.milliseconds=Woe;et.seconds=Uoe;et.minutes=zoe;et.hours=Yoe;et.days=Goe;et.weeks=Xoe;et.months=Koe;et.years=qoe;et.humanize=tie;et.toISOString=hp;et.toString=hp;et.toJSON=hp;et.locale=gB;et.localeData=pB;et.toIsoString=Xr("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",hp);et.lang=mB;Te("X",0,0,"unix");Te("x",0,0,"valueOf");pe("x",ap);pe("X",_te);ht("X",function(e,t,r){r._d=new Date(parseFloat(e)*1e3)});ht("x",function(e,t,r){r._d=new Date(Ze(e))});//! moment.js
ee.version="2.29.4";rte(wt);ee.fn=ne;ee.min=Wre;ee.max=Ure;ee.now=zre;ee.utc=jn;ee.unix=boe;ee.months=Soe;ee.isDate=Jd;ee.locale=si;ee.invalid=tp;ee.duration=vn;ee.isMoment=hn;ee.weekdays=_oe;ee.parseZone=woe;ee.localeData=jo;ee.isDuration=jy;ee.monthsShort=Coe;ee.weekdaysMin=Roe;ee.defineLocale=RE;ee.updateLocale=wre;ee.locales=Sre;ee.weekdaysShort=Ooe;ee.normalizeUnits=Zr;ee.relativeTimeRounding=Joe;ee.relativeTimeThreshold=eie;ee.calendarFormat=gne;ee.prototype=ne;ee.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"GGGG-[W]WW",MONTH:"YYYY-MM"};const rie=Object.freeze(Object.defineProperty({__proto__:null,default:ee},Symbol.toStringTag,{value:"Module"}));function ft(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];var o=nr(e,function(i,a,l){var s=a.replace(/\r?\n\s*/g,""),u=r[l]?r[l]:"";return i+s+u},"");return o.trim()}var iA,aA,lA,sA,uA,fA;function Vl(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function aC(e){"@babel/helpers - typeof";return aC=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},aC(e)}function Ht(e){var t;switch(aC(e)){case"string":case"number":t="".concat(e);break;case"object":t=e===null?"":e.toString();break;case"undefined":t="";break;default:t=e.toString();break}return t}function ye(e){return typeof e<"u"}function gt(e){return typeof e>"u"}function Yt(e){return e===null||e===""||gt(e)}function nie(e){return Object.prototype.toString.call(e)==="[object RegExp]"}var tc="length",uc=function(t){return parseInt(t,16)},cA=function(t){return parseInt(t,10)},$g=function(t,r,n){return t.substr(r,n)},fc=function(t){return t.codePointAt(0)-65},lC=function(t){return"".concat(t).replace(/\-/g,"")},oie=function(t){return uc($g(lC(t),uc("12"),fc("F")))/(uc($g(lC(t),fc("B"),~~![][tc]))||9)},iie=function(){return typeof location<"u"&&/^([a-z0-9\-]+\.)?\x68\x61\x6E\x64\x73\x6F\x6E\x74\x61\x62\x6C\x65\x2E\x63\x6F\x6D$/i.test(location.host)},hA=!1,dA={invalid:function(){return ft(iA||(iA=Vl([`
    The license key for Handsontable is invalid. 
    If you need any help, contact us at support@handsontable.com.`],[`
    The license key for Handsontable is invalid.\\x20
    If you need any help, contact us at support@handsontable.com.`])))},expired:function(t){var r=t.keyValidityDate,n=t.hotVersion;return ft(aA||(aA=Vl([`
    The license key for Handsontable expired on `,`, and is not valid for the installed 
    version `,`. Renew your license key at handsontable.com or downgrade to a version released prior 
    to `,". If you need any help, contact us at sales@handsontable.com."],[`
    The license key for Handsontable expired on `,`, and is not valid for the installed\\x20
    version `,`. Renew your license key at handsontable.com or downgrade to a version released prior\\x20
    to `,". If you need any help, contact us at sales@handsontable.com."])),r,n,r)},missing:function(){return ft(lA||(lA=Vl([`
    The license key for Handsontable is missing. Use your purchased key to activate the product. 
    Alternatively, you can activate Handsontable to use for non-commercial purposes by 
    passing the key: 'non-commercial-and-evaluation'. If you need any help, contact 
    us at support@handsontable.com.`],[`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\\x20
    passing the key: 'non-commercial-and-evaluation'. If you need any help, contact\\x20
    us at support@handsontable.com.`])))},non_commercial:function(){return""}},vA={invalid:function(){return ft(sA||(sA=Vl([`
    The license key for Handsontable is invalid. 
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> on how to 
    install it properly or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`],[`
    The license key for Handsontable is invalid.\\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> on how to\\x20
    install it properly or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`])))},expired:function(t){var r=t.keyValidityDate,n=t.hotVersion;return ft(uA||(uA=Vl([`
    The license key for Handsontable expired on `,`, and is not valid for the installed 
    version `,`. <a href="https://handsontable.com/pricing" target="_blank">Renew</a> your 
    license key or downgrade to a version released prior to `,`. If you need any 
    help, contact us at <a href="mailto:sales@handsontable.com">sales@handsontable.com</a>.`],[`
    The license key for Handsontable expired on `,`, and is not valid for the installed\\x20
    version `,`. <a href="https://handsontable.com/pricing" target="_blank">Renew</a> your\\x20
    license key or downgrade to a version released prior to `,`. If you need any\\x20
    help, contact us at <a href="mailto:sales@handsontable.com">sales@handsontable.com</a>.`])),r,n,r)},missing:function(){return ft(fA||(fA=Vl([`
    The license key for Handsontable is missing. Use your purchased key to activate the product. 
    Alternatively, you can activate Handsontable to use for non-commercial purposes by 
    passing the key: 'non-commercial-and-evaluation'. 
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> about it in 
    the documentation or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`],[`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\\x20
    passing the key: 'non-commercial-and-evaluation'.\\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> about it in\\x20
    the documentation or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`])))},non_commercial:function(){return""}};function aie(e,t){var r=!Yt(e),n=typeof e=="string"&&e.toLowerCase()==="non-commercial-and-evaluation",o="13.0.0",i,a="invalid",l="invalid";e=lC(e||"");var s=lie(e);if(r||n||s)if(s){var u=ee("22/06/2023","DD/MM/YYYY"),f=Math.floor(u.toDate().getTime()/864e5),c=oie(e);i=ee((c+1)*864e5,"x").format("MMMM DD, YYYY"),f>c?(a="expired",l="expired"):(a="valid",l="valid")}else n?(a="non_commercial",l="valid"):(a="invalid",l="invalid");else a="missing",l="missing";if(iie()&&(a="valid",l="valid"),!hA&&a!=="valid"){var h=dA[a]({keyValidityDate:i,hotVersion:o});h&&console[a==="non_commercial"?"info":"warn"](dA[a]({keyValidityDate:i,hotVersion:o})),hA=!0}if(l!=="valid"&&t.parentNode){var d=vA[l]({keyValidityDate:i,hotVersion:o});if(d){var v=document.createElement("div");v.className="hot-display-license-info",v.innerHTML=vA[l]({keyValidityDate:i,hotVersion:o}),t.parentNode.insertBefore(v,t.nextSibling)}}}function lie(e){var t=[][tc],r=t;if(e[tc]!==fc("Z"))return!1;for(var n="",o="B<H4P+".split(""),i=fc(o.shift());i;i=fc(o.shift()||"A"))--i<""[tc]?r=r|(cA("".concat(cA(uc(n)+(uc($g(e,Math.abs(i),2))+[]).padStart(2,"0"))))%97||2)>>1:n=$g(e,i,i?o[tc]===1?9:8:6);return r===t}function un(e){return e[0].toUpperCase()+e.substr(1)}function PB(){function e(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)}return e()+e()+e()+e()}function $B(e){return/^([0-9][0-9]?%$)|(^100%$)/.test(e)}function AB(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return"".concat(e).replace(/(?:\\)?\[([^[\]]+)]/g,function(r,n){return r.charAt(0)==="\\"?r.substr(1,r.length-1):t[n]===void 0?"":t[n]})}function yA(e){return xE("".concat(e),{ALLOWED_TAGS:[]})}function xE(e,t){return Aee.sanitize(e,t)}function gA(e){return cie(e)||fie(e)||uie(e)||sie()}function sie(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function uie(e,t){if(e){if(typeof e=="string")return sC(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return sC(e,t)}}function fie(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function cie(e){if(Array.isArray(e))return sC(e)}function sC(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function hie(e){for(var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=-1,n=null,o=e;o!==null;){if(r===t){n=o;break}o.host&&o.nodeType===Node.DOCUMENT_FRAGMENT_NODE?o=o.host:(r+=1,o=o.parentNode)}return n}function die(e){return Object.getPrototypeOf(e.parent)&&e.frameElement}function Ag(e){return die(e)&&e.parent}function Ra(e){for(var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>2?arguments[2]:void 0,n=Node,o=n.ELEMENT_NODE,i=n.DOCUMENT_FRAGMENT_NODE,a=e;a!=null&&a!==r;){var l=a,s=l.nodeType,u=l.nodeName;if(s===o&&(t.includes(u)||t.includes(a)))return a;var f=a,c=f.host;c&&s===i?a=c:a=a.parentNode}return null}function Nv(e,t,r){for(var n=[],o=e;o&&(o=Ra(o,t,r),!(!o||r&&!r.contains(o)));)n.push(o),o.host&&o.nodeType===Node.DOCUMENT_FRAGMENT_NODE?o=o.host:o=o.parentNode;var i=n.length;return i?n[i-1]:null}function Ea(e,t){var r=e.parentNode,n=[];for(typeof t=="string"?e.defaultView?n=Array.prototype.slice.call(e.querySelectorAll(t),0):n=Array.prototype.slice.call(e.ownerDocument.querySelectorAll(t),0):n.push(t);r!==null;){if(n.indexOf(r)>-1)return!0;r=r.parentNode}return!1}function vie(e){var t=0,r=e;if(r.previousSibling)for(;r=r.previousSibling;)t+=1;return t}function Mi(e,t,r){var n=r.parentElement.querySelector(".ht_clone_".concat(e));return n?n.contains(t):null}var uC,fC,cC;function Hv(e){return!e||!e.length?[]:e.filter(function(t){return!!t})}if(rJ()){var mA=function(t){var r=t.createElement("div");return r.classList.add("test","test2"),r.classList.contains("test2")};uC=function(t,r){return t.classList===void 0||typeof r!="string"||r===""?!1:t.classList.contains(r)},fC=function(t,r){var n=t.ownerDocument,o=r;if(typeof o=="string"&&(o=o.split(" ")),o=Hv(o),o.length>0)if(mA(n)){var i;(i=t.classList).add.apply(i,gA(o))}else for(var a=0;o[a];)t.classList.add(o[a]),a+=1},cC=function(t,r){var n=t.ownerDocument,o=r;if(typeof o=="string"&&(o=o.split(" ")),o=Hv(o),o.length>0)if(mA(n)){var i;(i=t.classList).remove.apply(i,gA(o))}else for(var a=0;o[a];)t.classList.remove(o[a]),a+=1}}else{var Gb=function(t){return new RegExp("(\\s|^)".concat(t,"(\\s|$)"))};uC=function(t,r){return t.className!==void 0&&Gb(r).test(t.className)},fC=function(t,r){var n=t.className,o=r;if(typeof o=="string"&&(o=o.split(" ")),o=Hv(o),n==="")n=o.join(" ");else for(var i=0;i<o.length;i++)o[i]&&!Gb(o[i]).test(n)&&(n+=" ".concat(o[i]));t.className=n},cC=function(t,r){var n=0,o=t.className,i=r;for(typeof i=="string"&&(i=i.split(" ")),i=Hv(i);i[n];)o=o.replace(Gb(i[n])," ").trim(),n+=1;t.className!==o&&(t.className=o)}}function xe(e,t){return uC(e,t)}function re(e,t){fC(e,t)}function He(e,t){cC(e,t)}function IB(e){if(e.nodeType===3)e.parentNode.removeChild(e);else if(["TABLE","THEAD","TBODY","TFOOT","TR"].indexOf(e.nodeName)>-1)for(var t=e.childNodes,r=t.length-1;r>=0;r--)IB(t[r])}function xn(e){for(var t;t=e.lastChild;)e.removeChild(t)}var yie=/(<(.*)>|&(.*);)/;function vf(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;yie.test(t)?e.innerHTML=r?xE(t):t:ka(e,t)}function ka(e,t){var r=e.firstChild;r&&r.nodeType===3&&r.nextSibling===null?nJ?r.textContent=t:r.data=t:(xn(e),e.appendChild(e.ownerDocument.createTextNode(t)))}function Pc(e){for(var t=e.ownerDocument.documentElement,r=e;r!==t;){if(r===null)return!1;if(r.nodeType===Node.DOCUMENT_FRAGMENT_NODE)if(r.host){if(r.host.impl)return Pc(r.host.impl);if(r.host)return Pc(r.host);throw new Error("Lost in Web Components world")}else return!1;else if(r.style&&r.style.display==="none")return!1;r=r.parentNode}return!0}function Vt(e){var t=e.ownerDocument,r=t.defaultView,n=t.documentElement,o=e,i,a,l,s;if(TF()&&o.firstChild&&o.firstChild.nodeName==="CAPTION")return s=o.getBoundingClientRect(),{top:s.top+(r.pageYOffset||n.scrollTop)-(n.clientTop||0),left:s.left+(r.pageXOffset||n.scrollLeft)-(n.clientLeft||0)};for(i=o.offsetLeft,a=o.offsetTop,l=o;(o=o.offsetParent)&&o!==t.body;)i+=o.offsetLeft,a+=o.offsetTop,l=o;return l&&l.style.position==="fixed"&&(i+=r.pageXOffset||n.scrollLeft,a+=r.pageYOffset||n.scrollTop),{left:i,top:a}}function $c(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window,t=e.scrollY;return t===void 0&&(t=e.document.documentElement.scrollTop),t}function rs(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window,t=e.scrollX;return t===void 0&&(t=e.document.documentElement.scrollLeft),t}function Ig(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return e===t?$c(t):e.scrollTop}function hC(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return e===t?rs(t):e.scrollLeft}function Mg(e){var t=e.ownerDocument,r=t?t.defaultView:void 0;t||(t=e.document?e.document:e,r=t.defaultView);for(var n=["auto","scroll"],o=oJ(),i=e.parentNode;i&&i.style&&t.body!==i;){var a=i.style,l=a.overflow,s=a.overflowX,u=a.overflowY;if([l,s,u].includes("scroll"))return i;if(o){var f=r.getComputedStyle(i);if(l=f.overflow,s=f.overflowX,u=f.overflowY,n.includes(l)||n.includes(s)||n.includes(u))return i}if(i.clientHeight<=i.scrollHeight+1&&(n.includes(u)||n.includes(l))||i.clientWidth<=i.scrollWidth+1&&(n.includes(s)||n.includes(l)))return i;i=i.parentNode}return r}function ns(e){for(var t=e.ownerDocument,r=t.defaultView,n=e.parentNode;n&&n.style&&t.body!==n;){if(n.style.overflow!=="visible"&&n.style.overflow!=="")return n;var o=Pa(n,r),i=["scroll","hidden","auto"],a=o.getPropertyValue("overflow"),l=o.getPropertyValue("overflow-y"),s=o.getPropertyValue("overflow-x");if(i.includes(a)||i.includes(l)||i.includes(s))return n;n=n.parentNode}return r}function Ac(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:window;if(e){if(e===r)return t==="width"?"".concat(r.innerWidth,"px"):t==="height"?"".concat(r.innerHeight,"px"):void 0}else return;var n=e.style[t];if(n!==""&&n!==void 0)return n;var o=Pa(e,r);if(o[t]!==""&&o[t]!==void 0)return o[t]}function Pa(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return e.currentStyle||t.getComputedStyle(e)}function ut(e){return e.offsetWidth}function Tt(e){return TF()&&e.firstChild&&e.firstChild.nodeName==="CAPTION"?e.offsetHeight+e.firstChild.offsetHeight:e.offsetHeight}function ii(e){return e.clientHeight||e.innerHeight}function By(e){return e.clientWidth||e.innerWidth}function MB(e){var t=e.ownerDocument;if(e.selectionStart)return e.selectionStart;if(t.selection){e.focus();var r=t.selection.createRange();if(r===null)return 0;var n=e.createTextRange(),o=n.duplicate();return n.moveToBookmark(r.getBookmark()),o.setEndPoint("EndToStart",n),o.text.length}return 0}function gie(e){var t=e.ownerDocument;if(e.selectionEnd)return e.selectionEnd;if(t.selection){var r=t.selection.createRange();if(r===null)return 0;var n=e.createTextRange();return n.text.indexOf(r.text)+r.text.length}return 0}function mie(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window,t=e.document,r="";return e.getSelection?r=e.getSelection().toString():t.selection&&t.selection.type!=="Control"&&(r=t.selection.createRange().text),r}function pA(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window,t=e.document;e.getSelection?e.getSelection().empty?e.getSelection().empty():e.getSelection().removeAllRanges&&e.getSelection().removeAllRanges():t.selection&&t.selection.empty()}function dp(e,t,r){if(r===void 0&&(r=t),e.setSelectionRange){e.focus();try{e.setSelectionRange(t,r)}catch{var n=e.parentNode,o=n.style.display;n.style.display="block",e.setSelectionRange(t,r),n.style.display=o}}}var Kb;function pie(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document,t=e.createElement("div");t.style.height="200px",t.style.width="100%";var r=e.createElement("div");r.style.boxSizing="content-box",r.style.height="150px",r.style.left="0px",r.style.overflow="hidden",r.style.position="absolute",r.style.top="0px",r.style.width="200px",r.style.visibility="hidden",r.appendChild(t),(e.body||e.documentElement).appendChild(r);var n=t.offsetWidth;r.style.overflow="scroll";var o=t.offsetWidth;return n===o&&(o=r.clientWidth),(e.body||e.documentElement).removeChild(r),n-o}function Zt(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;return Kb===void 0&&(Kb=pie(e)),Kb}function bie(e){return e.offsetWidth!==e.clientWidth}function wie(e){return e.offsetHeight!==e.clientHeight}function DE(e,t,r){ree()?(e.style.top=r,e.style.left=t):JJ()?e.style["-webkit-transform"]="translate3d(".concat(t,",").concat(r,",0)"):e.style.transform="translate3d(".concat(t,",").concat(r,",0)")}function vp(e){e.style.transform&&e.style.transform!==""?e.style.transform="":e.style["-webkit-transform"]&&e.style["-webkit-transform"]!==""&&(e.style["-webkit-transform"]="")}function xg(e){var t=["INPUT","SELECT","TEXTAREA"];return e&&(t.indexOf(e.nodeName)>-1||e.contentEditable==="true")}function NE(e){return xg(e)&&e.hasAttribute("data-hot-input")===!1}function Sie(e){var t=e.ownerDocument.activeElement;NE(t)||e.select()}function xB(e){return!e.parentNode}function Cie(e,t){var r=new IntersectionObserver(function(n,o){n.forEach(function(i){i.isIntersecting&&e.offsetParent!==null&&(t(),o.unobserve(e))})},{root:e.ownerDocument.body});r.observe(e)}function vt(e){return typeof e=="function"}function DB(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,r=null,n;function o(){for(var i=this,a=arguments.length,l=new Array(a),s=0;s<a;s++)l[s]=arguments[s];return r&&clearTimeout(r),r=setTimeout(function(){n=e.apply(i,l)},t),n}return o}function NB(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return function(){for(var i=arguments.length,a=new Array(i),l=0;l<i;l++)a[l]=arguments[l];return e.apply(this,r.concat(a))}}function _ie(e){var t=e.length;function r(n){return function(){for(var i=arguments.length,a=new Array(i),l=0;l<i;l++)a[l]=arguments[l];var s=n.concat(a),u;return s.length>=t?u=e.apply(this,s):u=r(s),u}}return r([])}function dC(e,t,r,n,o,i,a,l){return ye(l)?e.call(t,r,n,o,i,a,l):ye(a)?e.call(t,r,n,o,i,a):ye(i)?e.call(t,r,n,o,i):ye(o)?e.call(t,r,n,o):ye(n)?e.call(t,r,n):ye(r)?e.call(t,r):e.call(t)}var Oie=Ve,bA=DR,Lv=Wd.getWeakData,Rie=MR,Eie=Mt,Tie=dn,qb=Lt,kie=IR,HB=Ga,wA=kt,LB=Ho,Pie=LB.set,$ie=LB.getterFor,Aie=HB.find,Iie=HB.findIndex,Mie=Oie([].splice),xie=0,jv=function(e){return e.frozen||(e.frozen=new jB)},jB=function(){this.entries=[]},Xb=function(e,t){return Aie(e.entries,function(r){return r[0]===t})};jB.prototype={get:function(e){var t=Xb(this,e);if(t)return t[1]},has:function(e){return!!Xb(this,e)},set:function(e,t){var r=Xb(this,e);r?r[1]=t:this.entries.push([e,t])},delete:function(e){var t=Iie(this.entries,function(r){return r[0]===e});return~t&&Mie(this.entries,t,1),!!~t}};var FB={getConstructor:function(e,t,r,n){var o=e(function(s,u){Rie(s,i),Pie(s,{type:t,id:xie++,frozen:void 0}),Tie(u)||kie(u,s[n],{that:s,AS_ENTRIES:r})}),i=o.prototype,a=$ie(t),l=function(s,u,f){var c=a(s),h=Lv(Eie(u),!0);return h===!0?jv(c).set(u,f):h[c.id]=f,s};return bA(i,{delete:function(s){var u=a(this);if(!qb(s))return!1;var f=Lv(s);return f===!0?jv(u).delete(s):f&&wA(f,u.id)&&delete f[u.id]},has:function(u){var f=a(this);if(!qb(u))return!1;var c=Lv(u);return c===!0?jv(f).has(u):c&&wA(c,f.id)}}),bA(i,r?{get:function(u){var f=a(this);if(qb(u)){var c=Lv(u);return c===!0?jv(f).get(u):c?c[f.id]:void 0}},set:function(u,f){return l(this,u,f)}}:{add:function(u){return l(this,u,!0)}}),o}},Die=TR,SA=ct,Vy=Ve,CA=DR,Nie=Wd,Hie=Fm,BB=FB,Fv=Lt,Bv=Ho.enforce,Lie=Le,jie=$L,nv=Object,Fie=Array.isArray,Vv=nv.isExtensible,VB=nv.isFrozen,Bie=nv.isSealed,WB=nv.freeze,Vie=nv.seal,_A={},OA={},Wie=!SA.ActiveXObject&&"ActiveXObject"in SA,If,UB=function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}},zB=Hie("WeakMap",UB,BB),Al=zB.prototype,Wy=Vy(Al.set),Uie=function(){return Die&&Lie(function(){var e=WB([]);return Wy(new zB,e,1),!VB(e)})};if(jie)if(Wie){If=BB.getConstructor(UB,"WeakMap",!0),Nie.enable();var RA=Vy(Al.delete),Wv=Vy(Al.has),EA=Vy(Al.get);CA(Al,{delete:function(e){if(Fv(e)&&!Vv(e)){var t=Bv(this);return t.frozen||(t.frozen=new If),RA(this,e)||t.frozen.delete(e)}return RA(this,e)},has:function(t){if(Fv(t)&&!Vv(t)){var r=Bv(this);return r.frozen||(r.frozen=new If),Wv(this,t)||r.frozen.has(t)}return Wv(this,t)},get:function(t){if(Fv(t)&&!Vv(t)){var r=Bv(this);return r.frozen||(r.frozen=new If),Wv(this,t)?EA(this,t):r.frozen.get(t)}return EA(this,t)},set:function(t,r){if(Fv(t)&&!Vv(t)){var n=Bv(this);n.frozen||(n.frozen=new If),Wv(this,t)?Wy(this,t,r):n.frozen.set(t,r)}else Wy(this,t,r);return this}})}else Uie()&&CA(Al,{set:function(t,r){var n;return Fie(t)&&(VB(t)?n=_A:Bie(t)&&(n=OA)),Wy(this,t,r),n==_A&&WB(t),n==OA&&Vie(t),this}});var Ce={ALT:18,ARROW_DOWN:40,ARROW_LEFT:37,ARROW_RIGHT:39,ARROW_UP:38,AUDIO_DOWN:Nb()?182:174,AUDIO_MUTE:Nb()?181:173,AUDIO_UP:Nb()?183:175,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND_LEFT:91,COMMAND_RIGHT:93,COMMAND_FIREFOX:224,CONTROL:17,DELETE:46,END:35,ENTER:13,ESCAPE:27,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,F13:124,F14:125,F15:126,F16:127,F17:128,F18:129,F19:130,HOME:36,INSERT:45,MEDIA_NEXT:176,MEDIA_PLAY_PAUSE:179,MEDIA_PREV:177,MEDIA_STOP:178,NULL:0,NUM_LOCK:144,PAGE_DOWN:34,PAGE_UP:33,PAUSE:19,PERIOD:190,SCROLL_LOCK:145,SHIFT:16,SPACE:32,TAB:9,A:65,C:67,D:68,F:70,L:76,O:79,P:80,S:83,V:86,X:88,Y:89,Z:90},zie=[Ce.ALT,Ce.ARROW_DOWN,Ce.ARROW_LEFT,Ce.ARROW_RIGHT,Ce.ARROW_UP,Ce.AUDIO_DOWN,Ce.AUDIO_MUTE,Ce.AUDIO_UP,Ce.BACKSPACE,Ce.CAPS_LOCK,Ce.DELETE,Ce.END,Ce.ENTER,Ce.ESCAPE,Ce.F1,Ce.F2,Ce.F3,Ce.F4,Ce.F5,Ce.F6,Ce.F7,Ce.F8,Ce.F9,Ce.F10,Ce.F11,Ce.F12,Ce.F13,Ce.F14,Ce.F15,Ce.F16,Ce.F17,Ce.F18,Ce.F19,Ce.HOME,Ce.INSERT,Ce.MEDIA_NEXT,Ce.MEDIA_PLAY_PAUSE,Ce.MEDIA_PREV,Ce.MEDIA_STOP,Ce.NULL,Ce.NUM_LOCK,Ce.PAGE_DOWN,Ce.PAGE_UP,Ce.PAUSE,Ce.SCROLL_LOCK,Ce.SHIFT,Ce.TAB];function Yie(e){return e===32||e>=48&&e<=57||e>=96&&e<=111||e>=186&&e<=192||e>=219&&e<=222||e>=226||e>=65&&e<=90}function YB(e){return zie.includes(e)}function Gie(e){return[Ce.CONTROL,Ce.COMMAND_LEFT,Ce.COMMAND_RIGHT,Ce.COMMAND_FIREFOX].includes(e)}function Ic(e,t){var r=t.split("|"),n=!1;return I(r,function(o){if(e===Ce[o])return n=!0,!1}),n}function Dn(e){e.isImmediatePropagationEnabled=!1,e.cancelBubble=!0}function Il(e){return e.isImmediatePropagationEnabled===!1}function $a(e){return e.button===2}function HE(e){return e.button===0}function yt(){if(ye(console)){var e;(e=console).warn.apply(e,arguments)}}function LE(){if(ye(console)){var e;(e=console).error.apply(e,arguments)}}function Mc(e){"@babel/helpers - typeof";return Mc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Mc(e)}var TA;function Kie(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function kA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Xie(n.key),n)}}function qie(e,t,r){return t&&kA(e.prototype,t),r&&kA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Xie(e){var t=Zie(e,"string");return Mc(t)==="symbol"?t:String(t)}function Zie(e,t){if(Mc(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Mc(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Qie(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}var il=["afterCellMetaReset","afterChange","afterContextMenuDefaultOptions","beforeContextMenuSetItems","afterDropdownMenuDefaultOptions","beforeDropdownMenuSetItems","afterContextMenuHide","beforeContextMenuShow","afterContextMenuShow","afterCopyLimit","beforeCreateCol","afterColumnSequenceChange","afterCreateCol","beforeCreateRow","afterCreateRow","afterDeselect","afterDestroy","afterDocumentKeyDown","afterDrawSelection","beforeRemoveCellClassNames","afterGetCellMeta","afterGetColHeader","afterGetRowHeader","afterInit","afterLoadData","afterUpdateData","afterMomentumScroll","afterOnCellCornerMouseDown","afterOnCellCornerDblClick","afterOnCellMouseDown","afterOnCellMouseUp","afterOnCellContextMenu","afterOnCellMouseOver","afterOnCellMouseOut","afterRemoveCol","afterRemoveRow","beforeRenderer","afterRenderer","afterRowSequenceChange","afterScrollHorizontally","afterScrollVertically","afterSelection","afterSelectionByProp","afterSelectionEnd","afterSelectionEndByProp","afterSetCellMeta","afterRemoveCellMeta","afterSetDataAtCell","afterSetDataAtRowProp","afterSetSourceDataAtCell","afterUpdateSettings","afterValidate","beforeLanguageChange","afterLanguageChange","beforeAutofill","afterAutofill","beforeCellAlignment","beforeChange","beforeChangeRender","beforeDrawBorders","beforeGetCellMeta","beforeRemoveCellMeta","beforeInit","beforeInitWalkontable","beforeLoadData","beforeUpdateData","beforeKeyDown","beforeOnCellMouseDown","beforeOnCellMouseUp","beforeOnCellContextMenu","beforeOnCellMouseOver","beforeOnCellMouseOut","beforeRemoveCol","beforeRemoveRow","beforeViewRender","afterViewRender","beforeRender","afterRender","beforeSetCellMeta","beforeSetRangeStartOnly","beforeSetRangeStart","beforeSetRangeEnd","beforeTouchScroll","beforeValidate","beforeValueRender","construct","init","modifyColHeader","modifyColWidth","modifyRowHeader","modifyRowHeight","modifyData","modifySourceData","modifyRowData","modifyGetCellCoords","beforeHighlightingRowHeader","beforeHighlightingColumnHeader","persistentStateLoad","persistentStateReset","persistentStateSave","beforeColumnSort","afterColumnSort","modifyAutofillRange","modifyCopyableRange","beforeCut","afterCut","beforeCopy","afterCopy","beforePaste","afterPaste","beforeColumnFreeze","afterColumnFreeze","beforeColumnMove","afterColumnMove","beforeColumnUnfreeze","afterColumnUnfreeze","beforeRowMove","afterRowMove","beforeColumnResize","afterColumnResize","beforeRowResize","afterRowResize","afterGetColumnHeaderRenderers","afterGetRowHeaderRenderers","beforeStretchingColumnWidth","beforeFilter","afterFilter","afterFormulasValuesUpdate","afterNamedExpressionAdded","afterNamedExpressionRemoved","afterSheetAdded","afterSheetRenamed","afterSheetRemoved","modifyColumnHeaderHeight","modifyColumnHeaderValue","beforeUndo","beforeUndoStackChange","afterUndo","afterUndoStackChange","beforeRedo","beforeRedoStackChange","afterRedo","afterRedoStackChange","modifyRowHeaderWidth","modifyTransformStart","modifyTransformEnd","afterModifyTransformStart","afterModifyTransformEnd","afterViewportRowCalculatorOverride","afterViewportColumnCalculatorOverride","afterPluginsInitialized","beforeHideRows","afterHideRows","beforeUnhideRows","afterUnhideRows","beforeHideColumns","afterHideColumns","beforeUnhideColumns","afterUnhideColumns","beforeTrimRow","afterTrimRow","beforeUntrimRow","afterUntrimRow","beforeDropdownMenuShow","afterDropdownMenuShow","afterDropdownMenuHide","beforeAddChild","afterAddChild","beforeDetachChild","afterDetachChild","afterBeginEditing","beforeMergeCells","afterMergeCells","beforeUnmergeCells","afterUnmergeCells","afterListen","afterUnlisten","afterRefreshDimensions","beforeRefreshDimensions","beforeColumnCollapse","afterColumnCollapse","beforeColumnExpand","afterColumnExpand","modifyAutoColumnSizeSeed"],Jie=ft(TA||(TA=Qie([`The plugin hook "[hookName]" was removed in Handsontable [removedInVersion]. 
  Please consult release notes https://github.com/handsontable/handsontable/releases/tag/[removedInVersion] to 
  learn about the migration path.`],[`The plugin hook "[hookName]" was removed in Handsontable [removedInVersion].\\x20
  Please consult release notes https://github.com/handsontable/handsontable/releases/tag/[removedInVersion] to\\x20
  learn about the migration path.`]))),Zb=new Map([["modifyRow","8.0.0"],["modifyCol","8.0.0"],["unmodifyRow","8.0.0"],["unmodifyCol","8.0.0"],["skipLengthCache","8.0.0"],["hiddenColumn","8.0.0"],["hiddenRow","8.0.0"]]),Qb=new Map([]),GB=function(){function e(){Kie(this,e),this.globalBucket=this.createEmptyBucket()}return qie(e,[{key:"createEmptyBucket",value:function(){var r=Object.create(null);return I(il,function(n){return r[n]=[]}),r}},{key:"getBucket",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return r?(r.pluginHookBucket||(r.pluginHookBucket=this.createEmptyBucket()),r.pluginHookBucket):this.globalBucket}},{key:"add",value:function(r,n){var o=this,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;if(Array.isArray(n))I(n,function(s){return o.add(r,s,i)});else{Zb.has(r)&&yt(AB(Jie,{hookName:r,removedInVersion:Zb.get(r)})),Qb.has(r)&&yt(Qb.get(r));var a=this.getBucket(i);if(typeof a[r]>"u"&&(this.register(r),a[r]=[]),n.skip=!1,a[r].indexOf(n)===-1){var l=!1;n.initialHook&&I(a[r],function(s,u){if(s.initialHook)return a[r][u]=n,l=!0,!1}),l||a[r].push(n)}}return this}},{key:"once",value:function(r,n){var o=this,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;Array.isArray(n)?I(n,function(a){return o.once(r,a,i)}):(n.runOnce=!0,this.add(r,n,i))}},{key:"remove",value:function(r,n){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,i=this.getBucket(o);return typeof i[r]<"u"&&i[r].indexOf(n)>=0?(n.skip=!0,!0):!1}},{key:"has",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,o=this.getBucket(n);return!!(o[r]!==void 0&&o[r].length)}},{key:"run",value:function(r,n,o,i,a,l,s,u){{var f=this.globalBucket[n],c=f?f.length:0,h=0;if(c)for(;h<c;){if(!f[h]||f[h].skip){h+=1;continue}var d=dC(f[h],r,o,i,a,l,s,u);d!==void 0&&(o=d),f[h]&&f[h].runOnce&&this.remove(n,f[h]),h+=1}}{var v=this.getBucket(r)[n],y=v?v.length:0,p=0;if(y)for(;p<y;){if(!v[p]||v[p].skip){p+=1;continue}var w=dC(v[p],r,o,i,a,l,s,u);w!==void 0&&(o=w),v[p]&&v[p].runOnce&&this.remove(n,v[p],r),p+=1}}return o}},{key:"destroy",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;Ke(this.getBucket(r),function(n,o,i){return i[o].length=0})}},{key:"register",value:function(r){this.isRegistered(r)||il.push(r)}},{key:"deregister",value:function(r){this.isRegistered(r)&&il.splice(il.indexOf(r),1)}},{key:"isDeprecated",value:function(r){return Qb.has(r)||Zb.has(r)}},{key:"isRegistered",value:function(r){return il.indexOf(r)>=0}},{key:"getRegistered",value:function(){return il}}],[{key:"getSingleton",value:function(){return tae()}}]),e}(),eae=new GB;function tae(){return eae}const ge=GB;function PA(e){return iae(e)||oae(e)||nae(e)||rae()}function rae(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function nae(e,t){if(e){if(typeof e=="string")return vC(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return vC(e,t)}}function oae(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function iae(e){if(Array.isArray(e))return vC(e)}function vC(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var Jb=new Map;function Qr(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"common";Jb.has(e)||Jb.set(e,new Map);var t=Jb.get(e);function r(l,s){t.set(l,s)}function n(l){return t.get(l)}function o(l){return t.has(l)}function i(){return PA(t.keys())}function a(){return PA(t.values())}return{register:r,getItem:n,hasItem:o,getNames:i,getValues:a}}var yC=new WeakMap,ov=Qr("editors"),aae=ov.register,KB=ov.getItem,qB=ov.hasItem;ov.getNames;ov.getValues;function lae(e){var t={},r=e;this.getConstructor=function(){return e},this.getInstance=function(n){return n.guid in t||(t[n.guid]=new r(n)),t[n.guid]},ge.getSingleton().add("afterDestroy",function(){t[this.guid]=null})}function XB(e,t){var r;if(typeof e=="function")yC.get(e)||Ir(null,e),r=yC.get(e);else if(typeof e=="string")r=KB(e);else throw Error('Only strings and functions can be passed as "editor" parameter');if(!r)throw Error('No editor registered under name "'.concat(e,'"'));return r.getInstance(t)}function $A(e){if(typeof e=="function")return e;if(!qB(e))throw Error('No registered editor found under "'.concat(e,'" name'));return KB(e).getConstructor()}function Ir(e,t){e&&typeof e!="string"&&(t=e,e=t.EDITOR_TYPE);var r=new lae(t);typeof e=="string"&&aae(e,r),yC.set(t,r)}function xc(e){"@babel/helpers - typeof";return xc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},xc(e)}function sae(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function AA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,fae(n.key),n)}}function uae(e,t,r){return t&&AA(e.prototype,t),r&&AA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function fae(e){var t=cae(e,"string");return xc(t)==="symbol"?t:String(t)}function cae(e,t){if(xc(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(xc(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var hae=function(){function e(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;sae(this,e),this.context=t||this,this.context.eventListeners||(this.context.eventListeners=[])}return uae(e,[{key:"addEventListener",value:function(r,n,o){var i=this,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;function l(s){o.call(this,dae(s))}return typeof a!="boolean"&&!lJ()&&(a=!1),this.context.eventListeners.push({element:r,event:n,callback:o,callbackProxy:l,options:a,eventManager:this}),r.addEventListener(n,l,a),function(){i.removeEventListener(r,n,o)}}},{key:"removeEventListener",value:function(r,n,o){for(var i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,a=this.context.eventListeners.length,l;a;)if(a-=1,l=this.context.eventListeners[a],l.event===n&&l.element===r){if(o&&o!==l.callback||i&&l.eventManager!==this)continue;this.context.eventListeners.splice(a,1),l.element.removeEventListener(l.event,l.callbackProxy,l.options)}}},{key:"clearEvents",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.context)for(var n=this.context.eventListeners.length;n;){n-=1;var o=this.context.eventListeners[n];r&&o.eventManager!==this||(this.context.eventListeners.splice(n,1),o.element.removeEventListener(o.event,o.callbackProxy,o.options))}}},{key:"clear",value:function(){this.clearEvents()}},{key:"destroy",value:function(){this.clearEvents(),this.context=null}},{key:"destroyWithOwnEventsOnly",value:function(){this.clearEvents(!0),this.context=null}},{key:"fireEvent",value:function(r,n){var o=r.document,i=r;o||(o=r.ownerDocument?r.ownerDocument:r,i=o.defaultView);var a={bubbles:!0,cancelable:n!=="mousemove",view:i,detail:0,screenX:0,screenY:0,clientX:1,clientY:1,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0,relatedTarget:void 0},l;o.createEvent?(l=o.createEvent("MouseEvents"),l.initMouseEvent(n,a.bubbles,a.cancelable,a.view,a.detail,a.screenX,a.screenY,a.clientX,a.clientY,a.ctrlKey,a.altKey,a.shiftKey,a.metaKey,a.button,o.body.parentNode)):l=o.createEventObject(),r.dispatchEvent?r.dispatchEvent(l):r.fireEvent("on".concat(n),l)}}]),e}();function dae(e){var t=e.stopImmediatePropagation;return e.stopImmediatePropagation=function(){t.apply(this),Dn(this)},e}const Pt=hae;function Dc(e){"@babel/helpers - typeof";return Dc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Dc(e)}function vae(e,t){return pae(e)||mae(e,t)||gae(e,t)||yae()}function yae(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function gae(e,t){if(e){if(typeof e=="string")return IA(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return IA(e,t)}}function IA(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function mae(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function pae(e){if(Array.isArray(e))return e}function bae(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function MA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Sae(n.key),n)}}function wae(e,t,r){return t&&MA(e.prototype,t),r&&MA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Sae(e){var t=Cae(e,"string");return Dc(t)==="symbol"?t:String(t)}function Cae(e,t){if(Dc(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Dc(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var yp="editorManager.navigation",cc="editorManager.handlingEditor",gC=function(){function e(t,r,n){var o=this;bae(this,e),this.instance=t,this.tableMeta=r,this.selection=n,this.eventManager=new Pt(t),this.destroyed=!1,this.lock=!1,this.activeEditor=void 0,this.cellProperties=void 0;var i=this.instance.getShortcutManager();i.addContext("editor"),this.registerShortcuts(),this.instance.addHook("afterDocumentKeyDown",function(a){return o.onAfterDocumentKeyDown(a)}),this.eventManager.addEventListener(this.instance.rootDocument.documentElement,"compositionstart",function(a){!o.destroyed&&o.instance.isListening()&&o.openEditor("",a)}),this.instance.view._wt.update("onCellDblClick",function(a,l,s){return o.onCellDblClick(a,l,s)})}return wae(e,[{key:"registerShortcuts",value:function(){var r=this,n=this.instance.getShortcutManager(),o=n.getContext("grid"),i=n.getContext("editor"),a={group:cc};i.addShortcuts([{keys:[["Enter"],["Enter","Shift"],["Enter","Control/Meta"],["Enter","Control/Meta","Shift"]],callback:function(s,u){r.closeEditorAndSaveChanges(n.isCtrlPressed()),r.moveSelectionAfterEnter(u.includes("shift"))}},{keys:[["Escape"],["Escape","Control/Meta"]],callback:function(){r.closeEditorAndRestoreOriginalValue(n.isCtrlPressed()),r.activeEditor.focus()}}],a),o.addShortcuts([{keys:[["F2"]],callback:function(s){r.openEditor(null,s,!0)}},{keys:[["Backspace"],["Delete"]],callback:function(){r.instance.emptySelectedCells(),r.prepareEditor()}},{keys:[["Enter"],["Enter","Shift"]],callback:function(s,u){r.instance.getSettings().enterBeginsEditing?r.cellProperties.readOnly?r.moveSelectionAfterEnter():r.openEditor(null,s,!0):r.moveSelectionAfterEnter(u.includes("shift")),Dn(s)}}],a)}},{key:"lockEditor",value:function(){this.lock=!0}},{key:"unlockEditor",value:function(){this.lock=!1}},{key:"destroyEditor",value:function(r){this.lock||this.closeEditor(r)}},{key:"getActiveEditor",value:function(){return this.activeEditor}},{key:"prepareEditor",value:function(){var r=this;if(!this.lock){if(this.activeEditor&&this.activeEditor.isWaiting()){this.closeEditor(!1,!1,function(y){y&&r.prepareEditor()});return}var n=this.instance.getSelectedRangeLast().highlight,o=n.row,i=n.col,a=this.instance.runHooks("modifyGetCellCoords",o,i),l=o,s=i;if(Array.isArray(a)){var u=vae(a,2);l=u[0],s=u[1]}this.cellProperties=this.instance.getCellMeta(l,s);var f=this.instance.rootDocument.activeElement;if(f&&NE(f)&&f.blur(),!this.isCellEditable()){this.clearActiveEditor();return}var c=this.instance.getCell(o,i,!0);if(c){var h=this.instance.getCellEditor(this.cellProperties),d=this.instance.colToProp(s),v=this.instance.getSourceDataAtCell(this.instance.toPhysicalRow(l),s);this.activeEditor=XB(h,this.instance),this.activeEditor.prepare(o,i,d,c,v,this.cellProperties)}}}},{key:"isEditorOpened",value:function(){return this.activeEditor&&this.activeEditor.isOpened()}},{key:"openEditor",value:function(r,n){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(!this.isCellEditable()){this.clearActiveEditor();return}if(!this.activeEditor){var i=this.instance.getSelectedRangeLast().highlight,a=i.row,l=i.col,s=this.instance.rowIndexMapper.getRenderableFromVisualIndex(a),u=this.instance.columnIndexMapper.getRenderableFromVisualIndex(l);this.instance.view.scrollViewport(this.instance._createCellCoords(s,u)),this.instance.view.render(),this.prepareEditor()}this.activeEditor&&(o&&this.activeEditor.enableFullEditMode(),this.activeEditor.beginEditing(r,n))}},{key:"closeEditor",value:function(r,n,o){this.activeEditor?this.activeEditor.finishEditing(r,n,o):o&&o(!1)}},{key:"closeEditorAndSaveChanges",value:function(r){this.closeEditor(!1,r)}},{key:"closeEditorAndRestoreOriginalValue",value:function(r){this.closeEditor(!0,r)}},{key:"clearActiveEditor",value:function(){this.activeEditor=void 0}},{key:"isCellEditable",value:function(){var r=this.instance.getCellEditor(this.cellProperties),n=this.instance.getSelectedRangeLast().highlight,o=n.row,i=n.col,a=this.instance,l=a.rowIndexMapper,s=a.columnIndexMapper,u=l.isHidden(this.instance.toPhysicalRow(o))||s.isHidden(this.instance.toPhysicalColumn(i));return!(this.cellProperties.readOnly||!r||u)}},{key:"moveSelectionAfterEnter",value:function(r){var n=typeof this.tableMeta.enterMoves=="function"?this.tableMeta.enterMoves(event):this.tableMeta.enterMoves;r?this.selection.transformStart(-n.row,-n.col):this.selection.transformStart(n.row,n.col,!0)}},{key:"onAfterDocumentKeyDown",value:function(r){var n=this;if(this.instance.isListening()){var o=r.keyCode;if(this.selection.isSelected()){var i=(r.ctrlKey||r.metaKey)&&!r.altKey;if((!this.activeEditor||this.activeEditor&&!this.activeEditor.isWaiting())&&!YB(o)&&!Gie(o)&&!i&&!this.isEditorOpened()){var a=this.instance.getShortcutManager(),l=a.getContext("editor"),s={runOnlyIf:function(){return ye(n.instance.getSelected())},group:yp};l.addShortcuts([{keys:[["ArrowUp"]],callback:function(){n.instance.selection.transformStart(-1,0)}},{keys:[["ArrowDown"]],callback:function(){n.instance.selection.transformStart(1,0)}},{keys:[["ArrowLeft"]],callback:function(){n.instance.selection.transformStart(0,-1*n.instance.getDirectionFactor())}},{keys:[["ArrowRight"]],callback:function(){n.instance.selection.transformStart(0,n.instance.getDirectionFactor())}}],s),this.openEditor("",r)}}}}},{key:"onCellDblClick",value:function(r,n,o){o.nodeName==="TD"&&this.openEditor(null,r,!0)}},{key:"destroy",value:function(){this.destroyed=!0,this.eventManager.destroy()}}]),e}(),xA=new WeakMap;gC.getInstance=function(e,t,r){var n=xA.get(e);return n||(n=new gC(e,t,r),xA.set(e,n)),n};const _ae=gC;var Oae=$e,Rae=dE;Oae({target:"String",proto:!0},{repeat:Rae});var Eae=Ut,Tae=Ym,kae=Mt,Pae=dn,$ae=Ua,ew=Ft,Aae=Or,Iae=Wa,Mae=GR,DA=Gm;Tae("match",function(e,t,r){return[function(o){var i=Aae(this),a=Pae(o)?void 0:Iae(o,e);return a?Eae(a,o,i):new RegExp(o)[e](ew(i))},function(n){var o=kae(this),i=ew(n),a=r(t,o,i);if(a.done)return a.value;if(!o.global)return DA(o,i);var l=o.unicode;o.lastIndex=0;for(var s=[],u=0,f;(f=DA(o,i))!==null;){var c=ew(f[0]);s[u]=c,c===""&&(o.lastIndex=Mae(i,$ae(o.lastIndex),l)),u++}return u===0?null:s}]});var xae=Ka,Dae=Lr,Nae=_i,Hae=Kr,Lae=ff,jae=Math.min,mC=[].lastIndexOf,ZB=!!mC&&1/[1].lastIndexOf(1,-0)<0,Fae=Lae("lastIndexOf"),Bae=ZB||!Fae,Vae=Bae?function(t){if(ZB)return xae(mC,this,arguments)||0;var r=Dae(this),n=Hae(r),o=n-1;for(arguments.length>1&&(o=jae(o,Nae(arguments[1]))),o<0&&(o=n+o);o>=0;o--)if(o in r&&r[o]===t)return o||0;return-1}:mC,Wae=$e,NA=Vae;Wae({target:"Array",proto:!0,forced:NA!==[].lastIndexOf},{lastIndexOf:NA});var Uae=Va,zae=Rr,Yae=Pd,Gae=Kr,Kae=TypeError,HA=function(e){return function(t,r,n,o){Uae(r);var i=zae(t),a=Yae(i),l=Gae(i),s=e?l-1:0,u=e?-1:1;if(n<2)for(;;){if(s in a){o=a[s],s+=u;break}if(s+=u,e?s<0:l<=s)throw Kae("Reduce of empty array with no initial value")}for(;e?s>=0:l>s;s+=u)s in a&&(o=r(o,a[s],s,i));return o}},qae={left:HA(!1),right:HA(!0)},Xae=$e,Zae=qae.left,Qae=ff,LA=$d,Jae=zj,ele=!Jae&&LA>79&&LA<83,tle=ele||!Qae("reduce");Xae({target:"Array",proto:!0,forced:tle},{reduce:function(t){var r=arguments.length;return Zae(this,t,r,r>1?arguments[1]:void 0)}});var rle=$e,nle=Ga.findIndex,ole=Dd,pC="findIndex",QB=!0;pC in[]&&Array(1)[pC](function(){QB=!1});rle({target:"Array",proto:!0,forced:QB},{findIndex:function(t){return nle(this,t,arguments.length>1?arguments[1]:void 0)}});ole(pC);function tw(e){return sle(e)||lle(e)||ale(e)||ile()}function ile(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ale(e,t){if(e){if(typeof e=="string")return bC(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return bC(e,t)}}function lle(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function sle(e){if(Array.isArray(e))return bC(e)}function bC(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var JB={"&nbsp;":" ","&amp;":"&","&lt;":"<","&gt;":">"},ule=new RegExp(Object.keys(JB).map(function(e){return"(".concat(e,")")}).join("|"),"gi");function fle(e){return(e&&e.nodeName||"")==="TABLE"}function jA(e){for(var t=e.hasColHeaders(),r=e.hasRowHeaders(),n=[t?-1:0,r?-1:0,e.countRows()-1,e.countCols()-1],o=e.getData.apply(e,n),i=o.length,a=i>0?o[0].length:0,l=["<table>","</table>"],s=t?["<thead>","</thead>"]:[],u=["<tbody>","</tbody>"],f=r?1:0,c=t?1:0,h=0;h<i;h+=1){for(var d=t&&h===0,v=[],y=0;y<a;y+=1){var p=!d&&r&&y===0,w="";if(d)w="<th>".concat(e.getColHeader(y-f),"</th>");else if(p)w="<th>".concat(e.getRowHeader(h-c),"</th>");else{var S=o[h][y],C=e.getCellMeta(h-c,y-f),P=C.hidden,R=C.rowspan,W=C.colspan;if(!P){var Y=[];if(R&&Y.push('rowspan="'.concat(R,'"')),W&&Y.push('colspan="'.concat(W,'"')),Yt(S))w="<td ".concat(Y.join(" "),"></td>");else{var q=S.toString().replace("<","&lt;").replace(">","&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20/gi,"&nbsp;").replace(/\t/gi,"&#9;");w="<td ".concat(Y.join(" "),">").concat(q,"</td>")}}}v.push(w)}var G=["<tr>"].concat(v,["</tr>"]).join("");d?s.splice(1,0,G):u.splice(-1,0,G)}return l.splice(1,0,s.join(""),u.join("")),l.join("")}function FA(e){for(var t=e.length,r=["<table>"],n=0;n<t;n+=1){var o=e[n],i=o.length,a=[];n===0&&r.push("<tbody>");for(var l=0;l<i;l+=1){var s=o[l],u=Yt(s)?"":s.toString().replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20{2,}/gi,function(f){return'<span style="mso-spacerun: yes">'.concat("&nbsp;".repeat(f.length-1)," </span>")}).replace(/\t/gi,"&#9;");a.push("<td>".concat(u,"</td>"))}r.push.apply(r,["<tr>"].concat(a,["</tr>"])),n+1===t&&r.push("</tbody>")}return r.push("</table>"),r.join("")}function cle(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:document,r={},n=t.createDocumentFragment(),o=t.createElement("div");n.appendChild(o);var i=e;if(typeof i=="string"){var a=i.replace(/<td\b[^>]*?>([\s\S]*?)<\/\s*td>/g,function(b){var E=b.match(/<td\b[^>]*?>/g)[0],O=b.substring(E.length,b.lastIndexOf("<")).replace(/(<(?!br)([^>]+)>)/gi,""),F="</td>";return"".concat(E).concat(O).concat(F)});o.insertAdjacentHTML("afterbegin","".concat(a)),i=o.querySelector("table")}if(!(!i||!fle(i))){var l=o.querySelector('meta[name$="enerator"]'),s=i.querySelector("tbody th")!==null,u=i.querySelector("tr"),f=u?Array.from(u.cells).reduce(function(b,E){return b+E.colSpan},0)-(s?1:0):0,c=i.tFoot&&Array.from(i.tFoot.rows)||[],h=[],d=!1,v=0,y=0;if(i.tHead){var p=Array.from(i.tHead.rows).filter(function(b){var E=b.querySelector("td")!==null;return E&&h.push(b),!E});v=p.length,d=v>0,v>1?r.nestedHeaders=Array.from(p).reduce(function(b,E){var O=Array.from(E.cells).reduce(function(F,x,K){if(s&&K===0)return F;var Z=x.colSpan,te=x.innerHTML,ie=Z>1?{label:te,colspan:Z}:te;return F.push(ie),F},[]);return b.push(O),b},[]):d&&(r.colHeaders=Array.from(p[0].children).reduce(function(b,E,O){return s&&O===0||b.push(E.innerHTML),b},[]))}h.length&&(r.fixedRowsTop=h.length),c.length&&(r.fixedRowsBottom=c.length);var w=[].concat(h,tw(Array.from(i.tBodies).reduce(function(b,E){return b.push.apply(b,tw(Array.from(E.rows))),b},[])),tw(c));y=w.length;for(var S=new Array(y),C=0;C<y;C++)S[C]=new Array(f);for(var P=[],R=[],W=0;W<y;W++)for(var Y=w[W],q=Array.from(Y.cells),G=q.length,X=0;X<G;X++){var Q=q[X],oe=Q.nodeName,J=Q.innerHTML,ue=Q.rowSpan,de=Q.colSpan,Oe=S[W].findIndex(function(b){return b===void 0});if(oe==="TD"){if(ue>1||de>1){for(var be=W;be<W+ue;be++)if(be<y)for(var $=Oe;$<Oe+de;$++)S[be][$]=null;var k=Q.getAttribute("style"),g=k&&k.includes("mso-ignore:colspan");g||P.push({col:Oe,row:W,rowspan:ue,colspan:de})}var m="";l&&/excel/gi.test(l.content)?m=J.replace(/[\r\n][\x20]{0,2}/g," ").replace(/<br(\s*|\/)>[\r\n]?[\x20]{0,3}/gim,`\r
`):m=J.replace(/<br(\s*|\/)>[\r\n]?/gim,`\r
`),S[W][Oe]=m.replace(ule,function(b){return JB[b]})}else R.push(J)}return P.length&&(r.mergeCells=P),R.length&&(r.rowHeaders=R),S.length&&(r.data=S),r}}function hle(e){return gle(e)||yle(e)||vle(e)||dle()}function dle(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function vle(e,t){if(e){if(typeof e=="string")return wC(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return wC(e,t)}}function yle(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function gle(e){if(Array.isArray(e))return wC(e)}function wC(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function SC(e){"@babel/helpers - typeof";return SC=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},SC(e)}function Cr(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=SC(e);if(r==="number")return!isNaN(e)&&isFinite(e);if(r==="string"){if(e.length===0)return!1;if(e.length===1)return/\d/.test(e);var n=Array.from(new Set(["."].concat(hle(t)))).map(function(o){return"\\".concat(o)}).join("|");return new RegExp("^[+-]?\\s*(((".concat(n,")?\\d+((").concat(n,")\\d+)?(e[+-]?\\d+)?)|(0x[a-f\\d]+))$"),"i").test(e.trim())}else if(r==="object")return!!e&&typeof e.valueOf()=="number"&&!(e instanceof Date);return!1}function mle(e){return Cr(e,[","])}function _e(e,t,r){var n=-1;for(typeof t=="function"?(r=t,t=e):n=e-1;++n<=t&&r(n)!==!1;);}function CC(e,t,r){var n=e+1;for(typeof t=="function"&&(r=t,t=0);--n>=t&&r(n)!==!1;);}function eV(e,t){return t=parseInt(t.toString().replace("%",""),10),t=isNaN(t)?0:t,parseInt(e*t/100,10)}function ple(e){return Sle(e)||wle(e)||tV(e)||ble()}function ble(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function wle(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Sle(e){if(Array.isArray(e))return _C(e)}function Cle(e,t){return Rle(e)||Ole(e,t)||tV(e,t)||_le()}function _le(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function tV(e,t){if(e){if(typeof e=="string")return _C(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return _C(e,t)}}function _C(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Ole(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function Rle(e){if(Array.isArray(e))return e}var OC="asc",Ele="desc",BA=new Map([[OC,[-1,1]],[Ele,[1,-1]]]),Tle=function(t){return"The priority '".concat(t,"' is already declared in a map.")},kle=function(t){return"The priority '".concat(t,"' is not a number.")};function Ple(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=e.errorPriorityExists,r=e.errorPriorityNaN,n=new Map;t=vt(t)?t:Tle,r=vt(r)?r:kle;function o(a,l){if(!Cr(a))throw new Error(r(a));if(n.has(a))throw new Error(t(a));n.set(a,l)}function i(){var a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:OC,l=BA.get(a)||BA.get(OC),s=Cle(l,2),u=s[0],f=s[1];return ple(n).sort(function(c,h){return c[0]<h[0]?u:f}).map(function(c){return c[1]})}return{addItem:o,getItems:i}}var $le=$e,Ale=Ga.find,Ile=Dd,RC="find",rV=!0;RC in[]&&Array(1)[RC](function(){rV=!1});$le({target:"Array",proto:!0,forced:rV},{find:function(t){return Ale(this,t,arguments.length>1?arguments[1]:void 0)}});Ile(RC);function Mle(e){return Nle(e)||Dle(e)||nV(e)||xle()}function xle(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Dle(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Nle(e){if(Array.isArray(e))return EC(e)}function VA(e,t){return jle(e)||Lle(e,t)||nV(e,t)||Hle()}function Hle(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function nV(e,t){if(e){if(typeof e=="string")return EC(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return EC(e,t)}}function EC(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Lle(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function jle(e){if(Array.isArray(e))return e}var Fle=function(t){return"The id '".concat(t,"' is already declared in a map.")};function gp(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=e.errorIdExists,r=new Map;t=vt(t)?t:Fle;function n(f,c){if(u(f))throw new Error(t(f));r.set(f,c)}function o(f){return r.delete(f)}function i(){r.clear()}function a(f){var c=s().find(function(v){var y=VA(v,2),p=y[0],w=y[1];return f===w?p:!1})||[null],h=VA(c,1),d=h[0];return d}function l(f){return r.get(f)}function s(){return Mle(r)}function u(f){return r.has(f)}return{addItem:n,clear:i,getId:a,getItem:l,getItems:s,hasItem:u,removeItem:o}}function Ble(e){return zle(e)||Ule(e)||Wle(e)||Vle()}function Vle(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Wle(e,t){if(e){if(typeof e=="string")return TC(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return TC(e,t)}}function Ule(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function zle(e){if(Array.isArray(e))return TC(e)}function TC(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var Yle=function(t){return"'".concat(t,"' value is already declared in a unique set.")};function Gle(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=e.errorItemExists,r=new Set;t=vt(t)?t:Yle;function n(a){if(r.has(a))throw new Error(t(a));r.add(a)}function o(){return Ble(r)}function i(){r.clear()}return{addItem:n,clear:i,getItems:o}}function Kle(e,t){return Zle(e)||Xle(e,t)||oV(e,t)||qle()}function qle(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Xle(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function Zle(e){if(Array.isArray(e))return e}function WA(e){return ese(e)||Jle(e)||oV(e)||Qle()}function Qle(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function oV(e,t){if(e){if(typeof e=="string")return kC(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return kC(e,t)}}function Jle(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function ese(e){if(Array.isArray(e))return kC(e)}function kC(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var jE=function(t){return'There is already registered "'.concat(t,'" plugin.')},tse=function(t){return'There is already registered plugin on priority "'.concat(t,'".')},rse=function(t){return'The priority "'.concat(t,'" is not a number.')},iV=Ple({errorPriorityExists:tse,errorPriorityNaN:rse}),aV=Gle({errorItemExists:jE}),PC=gp({errorIdExists:jE});function lV(){return[].concat(WA(iV.getItems()),WA(aV.getItems()))}function FE(e){var t=un(e);return PC.getItem(t)}function nse(e){return!!FE(e)}function tt(e,t,r){var n=ise(e,t,r),o=Kle(n,3);e=o[0],t=o[1],r=o[2],FE(e)===void 0&&ose(e,t,r)}function ose(e,t,r){var n=un(e);if(PC.hasItem(n))throw new Error(jE(n));r===void 0?aV.addItem(n):iV.addItem(r,n),PC.addItem(n,t)}function ise(e,t,r){return typeof e=="function"&&(t=e,e=t.PLUGIN_KEY,r=t.PLUGIN_PRIORITY),[e,t,r]}var iv=Qr("renderers"),ase=iv.register,lse=iv.getItem,sV=iv.hasItem;iv.getNames;iv.getValues;function UA(e){if(typeof e=="function")return e;if(!sV(e))throw Error('No registered renderer found under "'.concat(e,'" name'));return lse(e)}function Zn(e,t){typeof e!="string"&&(t=e,e=t.RENDERER_TYPE),ase(e,t)}var av=Qr("validators"),sse=av.register,use=av.getItem,uV=av.hasItem;av.getNames;av.getValues;function fse(e){if(typeof e=="function")return e;if(!uV(e))throw Error('No registered validator found under "'.concat(e,'" name'));return use(e)}function rc(e,t){typeof e!="string"&&(t=e,e=t.VALIDATOR_TYPE),sse(e,t)}var Ki=1,tr=2;function Nc(e){"@babel/helpers - typeof";return Nc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Nc(e)}function cse(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function zA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,dse(n.key),n)}}function hse(e,t,r){return t&&zA(e.prototype,t),r&&zA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function dse(e){var t=vse(e,"string");return Nc(t)==="symbol"?t:String(t)}function vse(e,t){if(Nc(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Nc(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var al=new WeakMap,yse=function(){function e(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=t.viewportSize,n=t.scrollOffset,o=t.totalItems,i=t.itemSizeFn,a=t.overrideFn,l=t.calculationType,s=t.stretchMode,u=t.stretchingItemWidthFn,f=u===void 0?function(h){return h}:u,c=t.inlineStartOffset;cse(this,e),al.set(this,{viewportWidth:r,scrollOffset:n,totalColumns:o,columnWidthFn:i,overrideFn:a,calculationType:l,stretchingColumnWidthFn:f,inlineStartOffset:c}),this.count=0,this.startColumn=null,this.endColumn=null,this.startPosition=null,this.isVisibleInTrimmingContainer=!1,this.stretchAllRatio=0,this.stretchLastWidth=0,this.stretch=s,this.totalTargetWidth=0,this.needVerifyLastColumnWidth=!0,this.stretchAllColumnsWidth=[],this.calculate()}return hse(e,[{key:"calculate",value:function(){for(var r=0,n=!0,o=[],i,a=0,l=0,s=al.get(this),u=s.calculationType,f=s.overrideFn,c=s.scrollOffset,h=Math.max(s.scrollOffset,0),d=s.totalColumns,v=s.viewportWidth,y=h>0?v+1:v,p=0;p<d;p++)if(i=this._getColumnWidth(p),r<=h&&u!==tr&&(this.startColumn=p,a=i),r>=h&&r+(u===tr?i:0)<=h+y&&((this.startColumn===null||this.startColumn===void 0)&&(this.startColumn=p,a=i),this.endColumn=p),o.push(r),r+=i,l=i,u!==tr&&(this.endColumn=p),r>=h+v){n=!1;break}var w=c+v-y,S=u===tr?0:l,C=u===tr?a:0;if(w<-1*s.inlineStartOffset||c>o.at(-1)+S||-1*s.scrollOffset-s.viewportWidth>-1*C?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,this.endColumn===d-1&&n)for(this.startColumn=this.endColumn;this.startColumn>0;){var P=o[this.endColumn]+i-o[this.startColumn-1];if((P<=v||u!==tr)&&(this.startColumn-=1),P>v)break}u===Ki&&this.startColumn!==null&&f&&f(this),this.startPosition=o[this.startColumn],this.startPosition===void 0&&(this.startPosition=null),d<this.endColumn&&(this.endColumn=d-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}},{key:"refreshStretching",value:function(r){if(this.stretch!=="none"){var n=r;this.totalTargetWidth=n;for(var o=al.get(this),i=o.totalColumns,a=0,l=0;l<i;l++){var s=this._getColumnWidth(l),u=o.stretchingColumnWidthFn(void 0,l);typeof u=="number"?n-=u:a+=s}var f=n-a;if(this.stretch==="all"&&f>0)this.stretchAllRatio=n/a,this.stretchAllColumnsWidth=[],this.needVerifyLastColumnWidth=!0;else if(this.stretch==="last"&&n!==1/0){var c=this._getColumnWidth(i-1),h=f+c;this.stretchLastWidth=h>=0?h:c}}}},{key:"getStretchedColumnWidth",value:function(r,n){var o=null;return this.stretch==="all"&&this.stretchAllRatio!==0?o=this._getStretchedAllColumnWidth(r,n):this.stretch==="last"&&this.stretchLastWidth!==0&&(o=this._getStretchedLastColumnWidth(r)),o}},{key:"_getStretchedAllColumnWidth",value:function(r,n){var o=0,i=al.get(this),a=i.totalColumns;if(!this.stretchAllColumnsWidth[r]){var l=Math.round(n*this.stretchAllRatio),s=i.stretchingColumnWidthFn(l,r);s===void 0?this.stretchAllColumnsWidth[r]=l:this.stretchAllColumnsWidth[r]=isNaN(s)?this._getColumnWidth(r):s}if(this.stretchAllColumnsWidth.length===a&&this.needVerifyLastColumnWidth){this.needVerifyLastColumnWidth=!1;for(var u=0;u<this.stretchAllColumnsWidth.length;u++)o+=this.stretchAllColumnsWidth[u];o!==this.totalTargetWidth&&(this.stretchAllColumnsWidth[this.stretchAllColumnsWidth.length-1]+=this.totalTargetWidth-o)}return this.stretchAllColumnsWidth[r]}},{key:"_getStretchedLastColumnWidth",value:function(r){var n=al.get(this),o=n.totalColumns;return r===o-1?this.stretchLastWidth:null}},{key:"_getColumnWidth",value:function(r){var n=al.get(this).columnWidthFn(r);return isNaN(n)&&(n=e.DEFAULT_WIDTH),n}}],[{key:"DEFAULT_WIDTH",get:function(){return 50}}]),e}();const BE=yse;function Hc(e){"@babel/helpers - typeof";return Hc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Hc(e)}function gse(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function YA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,pse(n.key),n)}}function mse(e,t,r){return t&&YA(e.prototype,t),r&&YA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function pse(e){var t=bse(e,"string");return Hc(t)==="symbol"?t:String(t)}function bse(e,t){if(Hc(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Hc(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var GA=new WeakMap,wse=function(){function e(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=t.viewportSize,n=t.scrollOffset,o=t.totalItems,i=t.itemSizeFn,a=t.overrideFn,l=t.calculationType,s=t.scrollbarHeight;gse(this,e),GA.set(this,{viewportHeight:r,scrollOffset:n,totalRows:o,rowHeightFn:i,overrideFn:a,calculationType:l,horizontalScrollbarHeight:s}),this.count=0,this.startRow=null,this.endRow=null,this.startPosition=null,this.isVisibleInTrimmingContainer=!1,this.calculate()}return mse(e,[{key:"calculate",value:function(){for(var r=GA.get(this),n=r.calculationType,o=r.overrideFn,i=r.rowHeightFn,a=r.scrollOffset,l=Math.max(r.scrollOffset,0),s=r.totalRows,u=r.viewportHeight,f=r.horizontalScrollbarHeight||0,c=0,h=!0,d=[],v,y=0,p=0,w=0;w<s;w++)if(v=i(w),isNaN(v)&&(v=e.DEFAULT_HEIGHT),c<=l&&n!==tr&&(this.startRow=w,y=v),c>=l&&c+(n===tr?v:0)<=l+u-f&&(this.startRow===null&&(this.startRow=w,y=v),this.endRow=w),d.push(c),c+=v,p=v,n!==tr&&(this.endRow=w),c>=l+u-f){h=!1;break}var S=a+u-f,C=n===tr?y:0,P=n===tr?0:p;if(S<C||a>d.at(-1)+P?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,this.endRow===s-1&&h)for(this.startRow=this.endRow;this.startRow>0;){var R=d[this.endRow]+v-d[this.startRow-1];if((R<=u-f||n!==tr)&&(this.startRow-=1),R>=u-f)break}n===Ki&&this.startRow!==null&&o&&o(this),this.startPosition=d[this.startRow],this.startPosition===void 0&&(this.startPosition=null),s<this.endRow&&(this.endRow=s-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}],[{key:"DEFAULT_HEIGHT",get:function(){return 23}}]),e}();const fV=wse;function Lc(e){"@babel/helpers - typeof";return Lc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Lc(e)}function Sse(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function KA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,cV(n.key),n)}}function Cse(e,t,r){return t&&KA(e.prototype,t),r&&KA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _se(e,t,r){Ose(e,t),t.set(e,r)}function Ose(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function qA(e,t,r){return t=cV(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function cV(e){var t=Rse(e,"string");return Lc(t)==="symbol"?t:String(t)}function Rse(e,t){if(Lc(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Lc(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Mf(e,t){var r=hV(e,t,"get");return Ese(e,r)}function Ese(e,t){return t.get?t.get.call(e):t.value}function Tse(e,t,r){var n=hV(e,t,"set");return kse(e,n,r),r}function hV(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function kse(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}var xi=new WeakMap,Pse=function(){function e(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;Sse(this,e),qA(this,"row",null),qA(this,"col",null),_se(this,xi,{writable:!0,value:!1}),Tse(this,xi,n),typeof t<"u"&&typeof r<"u"&&(this.row=t,this.col=r)}return Cse(e,[{key:"isValid",value:function(r){return!(this.row<0||this.col<0||this.row>=r.getSetting("totalRows")||this.col>=r.getSetting("totalColumns"))}},{key:"isEqual",value:function(r){return r===this?!0:this.row===r.row&&this.col===r.col}},{key:"isSouthEastOf",value:function(r){return this.row>=r.row&&(Mf(this,xi)?this.col<=r.col:this.col>=r.col)}},{key:"isNorthWestOf",value:function(r){return this.row<=r.row&&(Mf(this,xi)?this.col>=r.col:this.col<=r.col)}},{key:"isSouthWestOf",value:function(r){return this.row>=r.row&&(Mf(this,xi)?this.col>=r.col:this.col<=r.col)}},{key:"isNorthEastOf",value:function(r){return this.row<=r.row&&(Mf(this,xi)?this.col<=r.col:this.col>=r.col)}},{key:"normalize",value:function(){return this.row=this.row===null?this.row:Math.max(this.row,0),this.col=this.col===null?this.col:Math.max(this.col,0),this}},{key:"clone",value:function(){return new e(this.row,this.col,Mf(this,xi))}},{key:"toObject",value:function(){return{row:this.row,col:this.col}}}]),e}();const Dg=Pse;function jc(e){"@babel/helpers - typeof";return jc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},jc(e)}function $se(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function XA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,dV(n.key),n)}}function Ase(e,t,r){return t&&XA(e.prototype,t),r&&XA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Ise(e,t,r){Mse(e,t),t.set(e,r)}function Mse(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function rw(e,t,r){return t=dV(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function dV(e){var t=xse(e,"string");return jc(t)==="symbol"?t:String(t)}function xse(e,t){if(jc(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(jc(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function gn(e,t){var r=vV(e,t,"get");return Dse(e,r)}function Dse(e,t){return t.get?t.get.call(e):t.value}function Nse(e,t,r){var n=vV(e,t,"set");return Hse(e,n,r),r}function vV(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function Hse(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}var Fr=new WeakMap,Lse=function(){function e(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:t,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:t,o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;$se(this,e),rw(this,"highlight",null),rw(this,"from",null),rw(this,"to",null),Ise(this,Fr,{writable:!0,value:!1}),this.highlight=t.clone().normalize(),this.from=r.clone(),this.to=n.clone(),Nse(this,Fr,o)}return Ase(e,[{key:"setHighlight",value:function(r){return this.highlight=r.clone().normalize(),this}},{key:"setFrom",value:function(r){return this.from=r.clone(),this}},{key:"setTo",value:function(r){return this.to=r.clone(),this}},{key:"isValid",value:function(r){return this.from.isValid(r)&&this.to.isValid(r)}},{key:"isSingle",value:function(){return this.from.row>=0&&this.from.row===this.to.row&&this.from.col>=0&&this.from.col===this.to.col}},{key:"getOuterHeight",value:function(){return Math.max(this.from.row,this.to.row)-Math.min(this.from.row,this.to.row)+1}},{key:"getOuterWidth",value:function(){return Math.max(this.from.col,this.to.col)-Math.min(this.from.col,this.to.col)+1}},{key:"getHeight",value:function(){if(this.from.row<0&&this.to.row<0)return 0;var r=Math.max(this.from.row,0),n=Math.max(this.to.row,0);return Math.max(r,n)-Math.min(r,n)+1}},{key:"getWidth",value:function(){if(this.from.col<0&&this.to.col<0)return 0;var r=Math.max(this.from.col,0),n=Math.max(this.to.col,0);return Math.max(r,n)-Math.min(r,n)+1}},{key:"getCellsCount",value:function(){return this.getWidth()*this.getHeight()}},{key:"includes",value:function(r){var n=r.row,o=r.col,i=this.getOuterTopStartCorner(),a=this.getOuterBottomEndCorner();return i.row<=n&&a.row>=n&&i.col<=o&&a.col>=o}},{key:"includesRange",value:function(r){return this.includes(r.getOuterTopStartCorner())&&this.includes(r.getOuterBottomEndCorner())}},{key:"isEqual",value:function(r){return Math.min(this.from.row,this.to.row)===Math.min(r.from.row,r.to.row)&&Math.max(this.from.row,this.to.row)===Math.max(r.from.row,r.to.row)&&Math.min(this.from.col,this.to.col)===Math.min(r.from.col,r.to.col)&&Math.max(this.from.col,this.to.col)===Math.max(r.from.col,r.to.col)}},{key:"overlaps",value:function(r){return r.isSouthEastOf(this.getOuterTopLeftCorner())&&r.isNorthWestOf(this.getOuterBottomRightCorner())}},{key:"isSouthEastOf",value:function(r){return this.getOuterTopLeftCorner().isSouthEastOf(r)||this.getOuterBottomRightCorner().isSouthEastOf(r)}},{key:"isNorthWestOf",value:function(r){return this.getOuterTopLeftCorner().isNorthWestOf(r)||this.getOuterBottomRightCorner().isNorthWestOf(r)}},{key:"isOverlappingHorizontally",value:function(r){return this.getOuterTopRightCorner().col>=r.getOuterTopLeftCorner().col&&this.getOuterTopRightCorner().col<=r.getOuterTopRightCorner().col||this.getOuterTopLeftCorner().col<=r.getOuterTopRightCorner().col&&this.getOuterTopLeftCorner().col>=r.getOuterTopLeftCorner().col}},{key:"isOverlappingVertically",value:function(r){return this.getOuterBottomRightCorner().row>=r.getOuterTopRightCorner().row&&this.getOuterBottomRightCorner().row<=r.getOuterBottomRightCorner().row||this.getOuterTopRightCorner().row<=r.getOuterBottomRightCorner().row&&this.getOuterTopRightCorner().row>=r.getOuterTopRightCorner().row}},{key:"expand",value:function(r){var n=this.getOuterTopStartCorner(),o=this.getOuterBottomEndCorner();return r.row<n.row||r.col<n.col||r.row>o.row||r.col>o.col?(this.from=this._createCellCoords(Math.min(n.row,r.row),Math.min(n.col,r.col)),this.to=this._createCellCoords(Math.max(o.row,r.row),Math.max(o.col,r.col)),!0):!1}},{key:"expandByRange",value:function(r){if(this.includesRange(r)||!this.overlaps(r))return!1;var n=this.getOuterTopStartCorner(),o=this.getOuterBottomEndCorner(),i=this.getDirection(),a=r.getOuterTopStartCorner(),l=r.getOuterBottomEndCorner(),s=Math.min(n.row,a.row),u=Math.min(n.col,a.col),f=Math.max(o.row,l.row),c=Math.max(o.col,l.col),h=this._createCellCoords(s,u),d=this._createCellCoords(f,c);return this.from=h,this.to=d,this.setDirection(i),this.highlight.row===this.getOuterBottomRightCorner().row&&this.getVerticalDirection()==="N-S"&&this.flipDirectionVertically(),this.highlight.col===this.getOuterTopRightCorner().col&&this.getHorizontalDirection()==="W-E"&&this.flipDirectionHorizontally(),!0}},{key:"getDirection",value:function(){if(this.from.isNorthWestOf(this.to))return"NW-SE";if(this.from.isNorthEastOf(this.to))return"NE-SW";if(this.from.isSouthEastOf(this.to))return"SE-NW";if(this.from.isSouthWestOf(this.to))return"SW-NE"}},{key:"setDirection",value:function(r){switch(r){case"NW-SE":var n=[this.getOuterTopLeftCorner(),this.getOuterBottomRightCorner()];this.from=n[0],this.to=n[1];break;case"NE-SW":var o=[this.getOuterTopRightCorner(),this.getOuterBottomLeftCorner()];this.from=o[0],this.to=o[1];break;case"SE-NW":var i=[this.getOuterBottomRightCorner(),this.getOuterTopLeftCorner()];this.from=i[0],this.to=i[1];break;case"SW-NE":var a=[this.getOuterBottomLeftCorner(),this.getOuterTopRightCorner()];this.from=a[0],this.to=a[1];break}}},{key:"getVerticalDirection",value:function(){return["NE-SW","NW-SE"].indexOf(this.getDirection())>-1?"N-S":"S-N"}},{key:"getHorizontalDirection",value:function(){return["NW-SE","SW-NE"].indexOf(this.getDirection())>-1?"W-E":"E-W"}},{key:"flipDirectionVertically",value:function(){var r=this.getDirection();switch(r){case"NW-SE":this.setDirection("SW-NE");break;case"NE-SW":this.setDirection("SE-NW");break;case"SE-NW":this.setDirection("NE-SW");break;case"SW-NE":this.setDirection("NW-SE");break}}},{key:"flipDirectionHorizontally",value:function(){var r=this.getDirection();switch(r){case"NW-SE":this.setDirection("NE-SW");break;case"NE-SW":this.setDirection("NW-SE");break;case"SE-NW":this.setDirection("SW-NE");break;case"SW-NE":this.setDirection("SE-NW");break}}},{key:"getTopStartCorner",value:function(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}},{key:"getTopLeftCorner",value:function(){return gn(this,Fr)?this.getTopEndCorner():this.getTopStartCorner()}},{key:"getBottomEndCorner",value:function(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}},{key:"getBottomRightCorner",value:function(){return gn(this,Fr)?this.getBottomStartCorner():this.getBottomEndCorner()}},{key:"getTopEndCorner",value:function(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}},{key:"getTopRightCorner",value:function(){return gn(this,Fr)?this.getTopStartCorner():this.getTopEndCorner()}},{key:"getBottomStartCorner",value:function(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}},{key:"getBottomLeftCorner",value:function(){return gn(this,Fr)?this.getBottomEndCorner():this.getBottomStartCorner()}},{key:"getOuterTopStartCorner",value:function(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}},{key:"getOuterTopLeftCorner",value:function(){return gn(this,Fr)?this.getOuterTopEndCorner():this.getOuterTopStartCorner()}},{key:"getOuterBottomEndCorner",value:function(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}},{key:"getOuterBottomRightCorner",value:function(){return gn(this,Fr)?this.getOuterBottomStartCorner():this.getOuterBottomEndCorner()}},{key:"getOuterTopEndCorner",value:function(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}},{key:"getOuterTopRightCorner",value:function(){return gn(this,Fr)?this.getOuterTopStartCorner():this.getOuterTopEndCorner()}},{key:"getOuterBottomStartCorner",value:function(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}},{key:"getOuterBottomLeftCorner",value:function(){return gn(this,Fr)?this.getOuterBottomEndCorner():this.getOuterBottomStartCorner()}},{key:"isCorner",value:function(r,n){return n&&n.includes(r)&&(this.getOuterTopLeftCorner().isEqual(this._createCellCoords(n.from.row,n.from.col))||this.getOuterTopRightCorner().isEqual(this._createCellCoords(n.from.row,n.to.col))||this.getOuterBottomLeftCorner().isEqual(this._createCellCoords(n.to.row,n.from.col))||this.getOuterBottomRightCorner().isEqual(this._createCellCoords(n.to.row,n.to.col)))?!0:r.isEqual(this.getOuterTopLeftCorner())||r.isEqual(this.getOuterTopRightCorner())||r.isEqual(this.getOuterBottomLeftCorner())||r.isEqual(this.getOuterBottomRightCorner())}},{key:"getOppositeCorner",value:function(r,n){if(!(r instanceof Dg))return!1;if(n){var o=n.from,i=n.to;if(n.includes(r)){if(this.getOuterTopStartCorner().isEqual(this._createCellCoords(o.row,o.col)))return this.getOuterBottomEndCorner();if(this.getOuterTopEndCorner().isEqual(this._createCellCoords(o.row,i.col)))return this.getOuterBottomStartCorner();if(this.getOuterBottomStartCorner().isEqual(this._createCellCoords(i.row,o.col)))return this.getOuterTopEndCorner();if(this.getOuterBottomEndCorner().isEqual(this._createCellCoords(i.row,i.col)))return this.getOuterTopStartCorner()}}if(r.isEqual(this.getOuterBottomEndCorner()))return this.getOuterTopStartCorner();if(r.isEqual(this.getOuterTopStartCorner()))return this.getOuterBottomEndCorner();if(r.isEqual(this.getOuterTopEndCorner()))return this.getOuterBottomStartCorner();if(r.isEqual(this.getOuterBottomStartCorner()))return this.getOuterTopEndCorner()}},{key:"getBordersSharedWith",value:function(r){if(!this.includesRange(r))return[];var n={top:Math.min(this.from.row,this.to.row),bottom:Math.max(this.from.row,this.to.row),left:Math.min(this.from.col,this.to.col),right:Math.max(this.from.col,this.to.col)},o={top:Math.min(r.from.row,r.to.row),bottom:Math.max(r.from.row,r.to.row),left:Math.min(r.from.col,r.to.col),right:Math.max(r.from.col,r.to.col)},i=[];return n.top===o.top&&i.push("top"),n.right===o.right&&i.push("right"),n.bottom===o.bottom&&i.push("bottom"),n.left===o.left&&i.push("left"),i}},{key:"getInner",value:function(){for(var r=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner(),o=[],i=r.row;i<=n.row;i++)for(var a=r.col;a<=n.col;a++)!(this.from.row===i&&this.from.col===a)&&!(this.to.row===i&&this.to.col===a)&&o.push(this._createCellCoords(i,a));return o}},{key:"getAll",value:function(){for(var r=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner(),o=[],i=r.row;i<=n.row;i++)for(var a=r.col;a<=n.col;a++)r.row===i&&r.col===a?o.push(r):n.row===i&&n.col===a?o.push(n):o.push(this._createCellCoords(i,a));return o}},{key:"forAll",value:function(r){for(var n=this.getOuterTopStartCorner(),o=this.getOuterBottomEndCorner(),i=n.row;i<=o.row;i++)for(var a=n.col;a<=o.col;a++){var l=r(i,a);if(l===!1)return}}},{key:"clone",value:function(){return new e(this.highlight,this.from,this.to,gn(this,Fr))}},{key:"toObject",value:function(){return{from:this.from.toObject(),to:this.to.toObject()}}},{key:"_createCellCoords",value:function(r,n){return new Dg(r,n,gn(this,Fr))}}]),e}();const VE=Lse;var jse=$e,Fse=wR;jse({target:"Object",stat:!0},{setPrototypeOf:Fse});var yV=Ve,Bse=Va,Vse=Lt,Wse=kt,ZA=Kd,Use=kd,gV=Function,zse=yV([].concat),Yse=yV([].join),nw={},Gse=function(e,t,r){if(!Wse(nw,t)){for(var n=[],o=0;o<t;o++)n[o]="a["+o+"]";nw[t]=gV("C,a","return new C("+Yse(n,",")+")")}return nw[t](e,r)},Kse=Use?gV.bind:function(t){var r=Bse(this),n=r.prototype,o=ZA(arguments,1),i=function(){var l=zse(o,ZA(arguments));return this instanceof i?Gse(r,l.length,l):r.apply(t,l)};return Vse(n)&&(i.prototype=n),i},qse=$e,Xse=No,ow=Ka,Zse=Kse,QA=PF,Qse=Mt,JA=Lt,Jse=sf,mV=Le,WE=Xse("Reflect","construct"),eue=Object.prototype,tue=[].push,pV=mV(function(){function e(){}return!(WE(function(){},[],e)instanceof e)}),bV=!mV(function(){WE(function(){})}),e1=pV||bV;qse({target:"Reflect",stat:!0,forced:e1,sham:e1},{construct:function(t,r){QA(t),Qse(r);var n=arguments.length<3?t:QA(arguments[2]);if(bV&&!pV)return WE(t,r,n);if(t==n){switch(r.length){case 0:return new t;case 1:return new t(r[0]);case 2:return new t(r[0],r[1]);case 3:return new t(r[0],r[1],r[2]);case 4:return new t(r[0],r[1],r[2],r[3])}var o=[null];return ow(tue,o,r),new(ow(Zse,t,o))}var i=n.prototype,a=Jse(JA(i)?i:eue),l=ow(t,a,r);return JA(l)?l:a}});function Fc(e){"@babel/helpers - typeof";return Fc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Fc(e)}function rue(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function t1(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,oue(n.key),n)}}function nue(e,t,r){return t&&t1(e.prototype,t),r&&t1(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function oue(e){var t=iue(e,"string");return Fc(t)==="symbol"?t:String(t)}function iue(e,t){if(Fc(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Fc(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var ll=new WeakMap,aue=function(){function e(t,r,n,o,i,a){var l=arguments.length>6&&arguments[6]!==void 0?arguments[6]:null;rue(this,e),this.wtSettings=n,this.domBindings=r,this.wtTable=i,this.selections=a,this.parent=l,this.eventManager=o,this.facadeGetter=t,ll.set(this,{selectedCellBeforeTouchEnd:void 0,dblClickTimeout:[null,null],dblClickOrigin:[null,null]}),this.registerEvents()}return nue(e,[{key:"registerEvents",value:function(){var r=this;this.eventManager.addEventListener(this.wtTable.holder,"contextmenu",function(i){return r.onContextMenu(i)}),this.eventManager.addEventListener(this.wtTable.TABLE,"mouseover",function(i){return r.onMouseOver(i)}),this.eventManager.addEventListener(this.wtTable.TABLE,"mouseout",function(i){return r.onMouseOut(i)});var n=function(){r.eventManager.addEventListener(r.wtTable.holder,"touchstart",function(a){return r.onTouchStart(a)}),r.eventManager.addEventListener(r.wtTable.holder,"touchend",function(a){return r.onTouchEnd(a)}),r.momentumScrolling||(r.momentumScrolling={}),r.eventManager.addEventListener(r.wtTable.holder,"scroll",function(){clearTimeout(r.momentumScrolling._timeout),r.momentumScrolling.ongoing||r.wtSettings.getSetting("onBeforeTouchScroll"),r.momentumScrolling.ongoing=!0,r.momentumScrolling._timeout=setTimeout(function(){r.touchApplied||(r.momentumScrolling.ongoing=!1,r.wtSettings.getSetting("onAfterMomentumScroll"))},200)})},o=function(){r.eventManager.addEventListener(r.wtTable.holder,"mouseup",function(a){return r.onMouseUp(a)}),r.eventManager.addEventListener(r.wtTable.holder,"mousedown",function(a){return r.onMouseDown(a)})};An()?n():(EF()&&n(),o())}},{key:"selectedCellWasTouched",value:function(r){var n=ll.get(this),o=this.parentCell(r),i=o.coords;if(n.selectedCellBeforeTouchEnd&&i){var a=[i.row,n.selectedCellBeforeTouchEnd.from.row],l=a[0],s=a[1],u=[i.col,n.selectedCellBeforeTouchEnd.from.col],f=u[0],c=u[1];return l===s&&f===c}return!1}},{key:"parentCell",value:function(r){var n={},o=this.wtTable.TABLE,i=Nv(r,["TD","TH"],o);return i?(n.coords=this.wtTable.getCoords(i),n.TD=i):xe(r,"wtBorder")&&xe(r,"current")?(n.coords=this.selections.getCell().cellRange.highlight,n.TD=this.wtTable.getCell(n.coords)):xe(r,"wtBorder")&&xe(r,"area")&&this.selections.createOrGetArea().cellRange&&(n.coords=this.selections.createOrGetArea().cellRange.to,n.TD=this.wtTable.getCell(n.coords)),n}},{key:"onMouseDown",value:function(r){var n=ll.get(this),o=this.domBindings.rootDocument.activeElement,i=NB(hie,r.target),a=r.target;if(!(a===o||i(0)===o||i(1)===o)){var l=this.parentCell(a);xe(a,"corner")?this.wtSettings.getSetting("onCellCornerMouseDown",r,a):l.TD&&this.wtSettings.has("onCellMouseDown")&&this.callListener("onCellMouseDown",r,l.coords,l.TD),(r.button===0||this.touchApplied)&&l.TD&&(n.dblClickOrigin[0]=l.TD,clearTimeout(n.dblClickTimeout[0]),n.dblClickTimeout[0]=setTimeout(function(){n.dblClickOrigin[0]=null},1e3))}}},{key:"onContextMenu",value:function(r){if(this.wtSettings.has("onCellContextMenu")){var n=this.parentCell(r.target);n.TD&&this.callListener("onCellContextMenu",r,n.coords,n.TD)}}},{key:"onMouseOver",value:function(r){if(this.wtSettings.has("onCellMouseOver")){var n=this.wtTable.TABLE,o=Nv(r.target,["TD","TH"],n),i=this.parent||this;o&&o!==i.lastMouseOver&&Ea(o,n)&&(i.lastMouseOver=o,this.callListener("onCellMouseOver",r,this.wtTable.getCoords(o),o))}}},{key:"onMouseOut",value:function(r){if(this.wtSettings.has("onCellMouseOut")){var n=this.wtTable.TABLE,o=Nv(r.target,["TD","TH"],n),i=Nv(r.relatedTarget,["TD","TH"],n),a=this.parent||this;o&&o!==i&&Ea(o,n)&&(this.callListener("onCellMouseOut",r,this.wtTable.getCoords(o),o),i===null&&(a.lastMouseOver=null))}}},{key:"onMouseUp",value:function(r){var n=ll.get(this),o=this.parentCell(r.target);o.TD&&this.wtSettings.has("onCellMouseUp")&&this.callListener("onCellMouseUp",r,o.coords,o.TD),!(r.button!==0&&!this.touchApplied)&&(o.TD===n.dblClickOrigin[0]&&o.TD===n.dblClickOrigin[1]?(xe(r.target,"corner")?this.callListener("onCellCornerDblClick",r,o.coords,o.TD):this.callListener("onCellDblClick",r,o.coords,o.TD),n.dblClickOrigin[0]=null,n.dblClickOrigin[1]=null):o.TD===n.dblClickOrigin[0]&&(n.dblClickOrigin[1]=o.TD,clearTimeout(n.dblClickTimeout[1]),n.dblClickTimeout[1]=setTimeout(function(){n.dblClickOrigin[1]=null},500)))}},{key:"onTouchStart",value:function(r){var n=ll.get(this);n.selectedCellBeforeTouchEnd=this.selections.getCell().cellRange,this.touchApplied=!0,this.onMouseDown(r)}},{key:"onTouchEnd",value:function(r){var n,o=r.target,i=(n=this.parentCell(o))===null||n===void 0?void 0:n.coords,a=ye(i)&&i.row>=0&&i.col>=0,l=r.cancelable&&a&&this.wtSettings.getSetting("isDataViewInstance");if(l){var s=["A","BUTTON","INPUT"];MF()&&(ZJ()||QJ())&&this.selectedCellWasTouched(o)&&!s.includes(o.tagName)?r.preventDefault():this.selectedCellWasTouched(o)||r.preventDefault()}this.onMouseUp(r),this.touchApplied=!1}},{key:"callListener",value:function(r,n,o,i){var a=this.wtSettings.getSettingPure(r);a&&a(n,o,i,this.facadeGetter())}},{key:"destroy",value:function(){var r=ll.get(this);clearTimeout(r.dblClickTimeout[0]),clearTimeout(r.dblClickTimeout[1]),this.eventManager.destroy()}}]),e}();const wV=aue;function Bc(e){"@babel/helpers - typeof";return Bc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Bc(e)}function lue(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r1(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,uue(n.key),n)}}function sue(e,t,r){return t&&r1(e.prototype,t),r&&r1(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function uue(e){var t=fue(e,"string");return Bc(t)==="symbol"?t:String(t)}function fue(e,t){if(Bc(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Bc(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var cue=function(){function e(t,r,n){lue(this,e),this.offset=t,this.total=r,this.countTH=n}return sue(e,[{key:"offsetted",value:function(r){return r+this.offset}},{key:"unOffsetted",value:function(r){return r-this.offset}},{key:"renderedToSource",value:function(r){return this.offsetted(r)}},{key:"sourceToRendered",value:function(r){return this.unOffsetted(r)}},{key:"offsettedTH",value:function(r){return r-this.countTH}},{key:"unOffsettedTH",value:function(r){return r+this.countTH}},{key:"visibleRowHeadedColumnToSourceColumn",value:function(r){return this.renderedToSource(this.offsettedTH(r))}},{key:"sourceColumnToVisibleRowHeadedColumn",value:function(r){return this.unOffsettedTH(this.sourceToRendered(r))}}]),e}();const hue=cue;function Vc(e){"@babel/helpers - typeof";return Vc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Vc(e)}function due(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n1(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,yue(n.key),n)}}function vue(e,t,r){return t&&n1(e.prototype,t),r&&n1(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function yue(e){var t=gue(e,"string");return Vc(t)==="symbol"?t:String(t)}function gue(e,t){if(Vc(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Vc(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var mue=function(){function e(t,r,n){due(this,e),this.offset=t,this.total=r,this.countTH=n}return vue(e,[{key:"offsetted",value:function(r){return r+this.offset}},{key:"unOffsetted",value:function(r){return r-this.offset}},{key:"renderedToSource",value:function(r){return this.offsetted(r)}},{key:"sourceToRendered",value:function(r){return this.unOffsetted(r)}},{key:"offsettedTH",value:function(r){return r-this.countTH}},{key:"unOffsettedTH",value:function(r){return r+this.countTH}},{key:"visibleColHeadedRowToSourceRow",value:function(r){return this.renderedToSource(this.offsettedTH(r))}},{key:"sourceRowToVisibleColHeadedRow",value:function(r){return this.unOffsettedTH(this.sourceToRendered(r))}}]),e}();const pue=mue;var bue=0,Ng=1,Hg=2;function Wc(e){"@babel/helpers - typeof";return Wc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Wc(e)}function wue(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o1(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Cue(n.key),n)}}function Sue(e,t,r){return t&&o1(e.prototype,t),r&&o1(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Cue(e){var t=_ue(e,"string");return Wc(t)==="symbol"?t:String(t)}function _ue(e,t){if(Wc(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Wc(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var i1=function(){function e(){wue(this,e),this.currentSize=0,this.nextSize=0,this.currentOffset=0,this.nextOffset=0}return Sue(e,[{key:"setSize",value:function(r){this.currentSize=this.nextSize,this.nextSize=r}},{key:"setOffset",value:function(r){this.currentOffset=this.nextOffset,this.nextOffset=r}}]),e}();function Uc(e){"@babel/helpers - typeof";return Uc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Uc(e)}function Oue(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a1(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Eue(n.key),n)}}function Rue(e,t,r){return t&&a1(e.prototype,t),r&&a1(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Eue(e){var t=Tue(e,"string");return Uc(t)==="symbol"?t:String(t)}function Tue(e,t){if(Uc(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Uc(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var kue=function(){function e(){Oue(this,e),this.size=new i1,this.workingSpace=bue,this.sharedSize=null}return Rue(e,[{key:"setSize",value:function(r){this.size.setSize(r)}},{key:"setOffset",value:function(r){this.size.setOffset(r)}},{key:"getViewSize",value:function(){return this.size}},{key:"isShared",value:function(){return this.sharedSize instanceof i1}},{key:"isPlaceOn",value:function(r){return this.workingSpace===r}},{key:"append",value:function(r){this.workingSpace=Ng,r.workingSpace=Hg,this.sharedSize=r.getViewSize()}},{key:"prepend",value:function(r){this.workingSpace=Hg,r.workingSpace=Ng,this.sharedSize=r.getViewSize()}}]),e}();function zc(e){"@babel/helpers - typeof";return zc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},zc(e)}function Pue(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l1(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Aue(n.key),n)}}function $ue(e,t,r){return t&&l1(e.prototype,t),r&&l1(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Aue(e){var t=Iue(e,"string");return zc(t)==="symbol"?t:String(t)}function Iue(e,t){if(zc(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(zc(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var SV=function(){function e(t,r,n){Pue(this,e),this.rootNode=t,this.nodesPool=r,this.sizeSet=new kue,this.childNodeType=n.toUpperCase(),this.visualIndex=0,this.collectedNodes=[]}return $ue(e,[{key:"setSize",value:function(r){return this.sizeSet.setSize(r),this}},{key:"setOffset",value:function(r){return this.sizeSet.setOffset(r),this}},{key:"isSharedViewSet",value:function(){return this.sizeSet.isShared()}},{key:"getNode",value:function(r){return r<this.collectedNodes.length?this.collectedNodes[r]:null}},{key:"getCurrentNode",value:function(){var r=this.collectedNodes.length;return r>0?this.collectedNodes[r-1]:null}},{key:"getRenderedChildCount",value:function(){var r=this.rootNode,n=this.sizeSet,o=0;if(this.isSharedViewSet())for(var i=r.firstElementChild;i;){if(i.tagName===this.childNodeType)o+=1;else if(n.isPlaceOn(Ng))break;i=i.nextElementSibling}else o=r.childElementCount;return o}},{key:"start",value:function(){this.collectedNodes.length=0,this.visualIndex=0;for(var r=this.rootNode,n=this.sizeSet,o=this.isSharedViewSet(),i=n.getViewSize(),a=i.nextSize,l=this.getRenderedChildCount();l<a;){var s=this.nodesPool();!o||o&&n.isPlaceOn(Hg)?r.appendChild(s):r.insertBefore(s,r.firstChild),l+=1}for(var u=o&&n.isPlaceOn(Ng);l>a;)r.removeChild(u?r.firstChild:r.lastChild),l-=1}},{key:"render",value:function(){var r=this.rootNode,n=this.sizeSet,o=this.visualIndex;this.isSharedViewSet()&&n.isPlaceOn(Hg)&&(o+=n.sharedSize.nextSize);var i=r.childNodes[o];if(i.tagName!==this.childNodeType){var a=this.nodesPool();r.replaceChild(a,i),i=a}this.collectedNodes.push(i),this.visualIndex+=1}},{key:"end",value:function(){}}]),e}();function os(e){"@babel/helpers - typeof";return os=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},os(e)}function Mue(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s1(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Due(n.key),n)}}function xue(e,t,r){return t&&s1(e.prototype,t),r&&s1(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Due(e){var t=Nue(e,"string");return os(t)==="symbol"?t:String(t)}function Nue(e,t){if(os(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(os(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Hue(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&$C(e,t)}function $C(e,t){return $C=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},$C(e,t)}function Lue(e){var t=Bue();return function(){var n=Lg(e),o;if(t){var i=Lg(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return jue(this,o)}}function jue(e,t){if(t&&(os(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Fue(e)}function Fue(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Bue(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Lg(e){return Lg=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Lg(e)}var CV=function(e){Hue(r,e);var t=Lue(r);function r(){return Mue(this,r),t.apply(this,arguments)}return xue(r,[{key:"prependView",value:function(o){return this.sizeSet.prepend(o.sizeSet),o.sizeSet.append(this.sizeSet),this}},{key:"appendView",value:function(o){return this.sizeSet.append(o.sizeSet),o.sizeSet.prepend(this.sizeSet),this}}]),r}(SV);function Yc(e){"@babel/helpers - typeof";return Yc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Yc(e)}function Vue(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u1(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Uue(n.key),n)}}function Wue(e,t,r){return t&&u1(e.prototype,t),r&&u1(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Uue(e){var t=zue(e,"string");return Yc(t)==="symbol"?t:String(t)}function zue(e,t){if(Yc(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Yc(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Yue=function(){function e(t){Vue(this,e),this.nodeType=t.toUpperCase()}return Wue(e,[{key:"setRootDocument",value:function(r){this.rootDocument=r}},{key:"obtain",value:function(){return this.rootDocument.createElement(this.nodeType)}}]),e}();function Gc(e){"@babel/helpers - typeof";return Gc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Gc(e)}function Gue(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function f1(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,que(n.key),n)}}function Kue(e,t,r){return t&&f1(e.prototype,t),r&&f1(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function que(e){var t=Xue(e,"string");return Gc(t)==="symbol"?t:String(t)}function Xue(e,t){if(Gc(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Gc(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var lv=function(){function e(t,r){Gue(this,e),this.nodesPool=typeof t=="string"?new Yue(t):null,this.nodeType=t,this.rootNode=r,this.table=null,this.renderedNodes=0}return Kue(e,[{key:"setTable",value:function(r){this.nodesPool&&this.nodesPool.setRootDocument(r.rootDocument),this.table=r}},{key:"adjust",value:function(){}},{key:"render",value:function(){}}]),e}();function is(e){"@babel/helpers - typeof";return is=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},is(e)}function Zue(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function c1(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Jue(n.key),n)}}function Que(e,t,r){return t&&c1(e.prototype,t),r&&c1(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Jue(e){var t=efe(e,"string");return is(t)==="symbol"?t:String(t)}function efe(e,t){if(is(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(is(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function tfe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&AC(e,t)}function AC(e,t){return AC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},AC(e,t)}function rfe(e){var t=ife();return function(){var n=jg(e),o;if(t){var i=jg(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return nfe(this,o)}}function nfe(e,t){if(t&&(is(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return ofe(e)}function ofe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ife(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function jg(e){return jg=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},jg(e)}var afe=function(e){tfe(r,e);var t=rfe(r);function r(){var n;return Zue(this,r),n=t.call(this,"TH"),n.orderViews=new WeakMap,n.sourceRowIndex=0,n}return Que(r,[{key:"obtainOrderView",value:function(o){var i=this,a;return this.orderViews.has(o)?a=this.orderViews.get(o):(a=new CV(o,function(l){return i.nodesPool.obtain(i.sourceRowIndex,l)},this.nodeType),this.orderViews.set(o,a)),a}},{key:"render",value:function(){for(var o=this.table,i=o.rowsToRender,a=o.rowHeaderFunctions,l=o.rowHeadersCount,s=o.rows,u=o.cells,f=0;f<i;f++){var c=this.table.renderedRowToSource(f),h=s.getRenderedNode(f);this.sourceRowIndex=c;var d=this.obtainOrderView(h),v=u.obtainOrderView(h);d.appendView(v).setSize(l).setOffset(this.table.renderedColumnToSource(0)).start();for(var y=0;y<l;y++){d.render();var p=d.getCurrentNode();p.className="",p.removeAttribute("style"),a[y](c,p,y)}d.end()}}}]),r}(lv);function as(e){"@babel/helpers - typeof";return as=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},as(e)}function lfe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function h1(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,ufe(n.key),n)}}function sfe(e,t,r){return t&&h1(e.prototype,t),r&&h1(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function ufe(e){var t=ffe(e,"string");return as(t)==="symbol"?t:String(t)}function ffe(e,t){if(as(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(as(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function cfe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&IC(e,t)}function IC(e,t){return IC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},IC(e,t)}function hfe(e){var t=yfe();return function(){var n=Fg(e),o;if(t){var i=Fg(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return dfe(this,o)}}function dfe(e,t){if(t&&(as(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return vfe(e)}function vfe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function yfe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Fg(e){return Fg=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Fg(e)}var gfe=function(e){cfe(r,e);var t=hfe(r);function r(n){return lfe(this,r),t.call(this,null,n)}return sfe(r,[{key:"adjust",value:function(){var o=this.table,i=o.columnHeadersCount,a=o.rowHeadersCount,l=this.rootNode.firstChild;if(i){for(var s=this.table.columnsToRender,u=s+a,f=0,c=i;f<c;f++){for(l=this.rootNode.childNodes[f],l||(l=this.table.rootDocument.createElement("tr"),this.rootNode.appendChild(l)),this.renderedNodes=l.childNodes.length;this.renderedNodes<u;)l.appendChild(this.table.rootDocument.createElement("th")),this.renderedNodes+=1;for(;this.renderedNodes>u;)l.removeChild(l.lastChild),this.renderedNodes-=1}var h=this.rootNode.childNodes.length;if(h>i)for(var d=i;d<h;d++)this.rootNode.removeChild(this.rootNode.lastChild)}else l&&xn(l)}},{key:"render",value:function(){for(var o=this.table.columnHeadersCount,i=0;i<o;i+=1)for(var a=this.table,l=a.columnHeaderFunctions,s=a.columnsToRender,u=a.rowHeadersCount,f=this.rootNode.childNodes[i],c=-1*u;c<s;c+=1){var h=this.table.renderedColumnToSource(c),d=f.childNodes[c+u];d.className="",d.removeAttribute("style"),l[i](h,d,i)}}}]),r}(lv);function ls(e){"@babel/helpers - typeof";return ls=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ls(e)}function mfe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function d1(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,bfe(n.key),n)}}function pfe(e,t,r){return t&&d1(e.prototype,t),r&&d1(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function bfe(e){var t=wfe(e,"string");return ls(t)==="symbol"?t:String(t)}function wfe(e,t){if(ls(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ls(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Sfe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&MC(e,t)}function MC(e,t){return MC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},MC(e,t)}function Cfe(e){var t=Rfe();return function(){var n=Bg(e),o;if(t){var i=Bg(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return _fe(this,o)}}function _fe(e,t){if(t&&(ls(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Ofe(e)}function Ofe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Rfe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Bg(e){return Bg=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Bg(e)}var Efe=function(e){Sfe(r,e);var t=Cfe(r);function r(n){return mfe(this,r),t.call(this,null,n)}return pfe(r,[{key:"adjust",value:function(){for(var o=this.table,i=o.columnsToRender,a=o.rowHeadersCount,l=i+a;this.renderedNodes<l;)this.rootNode.appendChild(this.table.rootDocument.createElement("col")),this.renderedNodes+=1;for(;this.renderedNodes>l;)this.rootNode.removeChild(this.rootNode.lastChild),this.renderedNodes-=1}},{key:"render",value:function(){this.adjust();for(var o=this.table,i=o.columnsToRender,a=o.rowHeadersCount,l=0;l<a;l++){var s=this.table.renderedColumnToSource(l),u=this.table.columnUtils.getHeaderWidth(s);this.rootNode.childNodes[l].style.width="".concat(u,"px")}for(var f=0;f<i;f++){var c=this.table.renderedColumnToSource(f),h=this.table.columnUtils.getStretchedColumnWidth(c);this.rootNode.childNodes[f+a].style.width="".concat(h,"px")}var d=this.rootNode.firstChild;d&&re(d,"rowHeader")}}]),r}(lv);function ss(e){"@babel/helpers - typeof";return ss=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ss(e)}var v1;function Tfe(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function kfe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function y1(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,$fe(n.key),n)}}function Pfe(e,t,r){return t&&y1(e.prototype,t),r&&y1(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function $fe(e){var t=Afe(e,"string");return ss(t)==="symbol"?t:String(t)}function Afe(e,t){if(ss(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ss(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Ife(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&xC(e,t)}function xC(e,t){return xC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},xC(e,t)}function Mfe(e){var t=Nfe();return function(){var n=Vg(e),o;if(t){var i=Vg(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return xfe(this,o)}}function xfe(e,t){if(t&&(ss(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Dfe(e)}function Dfe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Nfe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Vg(e){return Vg=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Vg(e)}var g1=!1,Hfe=function(e){Ife(r,e);var t=Mfe(r);function r(n){var o;return kfe(this,r),o=t.call(this,"TR",n),o.orderView=new SV(n,function(i){return o.nodesPool.obtain(i)},o.nodeType),o}return Pfe(r,[{key:"getRenderedNode",value:function(o){return this.orderView.getNode(o)}},{key:"render",value:function(){var o=this.table.rowsToRender;!g1&&o>1e3&&(g1=!0,yt(ft(v1||(v1=Tfe([`Performance tip: Handsontable rendered more than 1000 visible rows. Consider limiting 
        the number of rendered rows by specifying the table height and/or turning off the "renderAllRows" option.`],[`Performance tip: Handsontable rendered more than 1000 visible rows. Consider limiting\\x20
        the number of rendered rows by specifying the table height and/or turning off the "renderAllRows" option.`]))))),this.orderView.setSize(o).setOffset(this.table.renderedRowToSource(0)).start();for(var i=0;i<o;i++)this.orderView.render();this.orderView.end()}}]),r}(lv);function us(e){"@babel/helpers - typeof";return us=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},us(e)}function Lfe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function m1(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Ffe(n.key),n)}}function jfe(e,t,r){return t&&m1(e.prototype,t),r&&m1(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Ffe(e){var t=Bfe(e,"string");return us(t)==="symbol"?t:String(t)}function Bfe(e,t){if(us(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(us(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Vfe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&DC(e,t)}function DC(e,t){return DC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},DC(e,t)}function Wfe(e){var t=Yfe();return function(){var n=Wg(e),o;if(t){var i=Wg(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Ufe(this,o)}}function Ufe(e,t){if(t&&(us(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return zfe(e)}function zfe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Yfe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Wg(e){return Wg=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Wg(e)}var Gfe=function(e){Vfe(r,e);var t=Wfe(r);function r(){var n;return Lfe(this,r),n=t.call(this,"TD"),n.orderViews=new WeakMap,n.sourceRowIndex=0,n}return jfe(r,[{key:"obtainOrderView",value:function(o){var i=this,a;return this.orderViews.has(o)?a=this.orderViews.get(o):(a=new CV(o,function(l){return i.nodesPool.obtain(i.sourceRowIndex,l)},this.nodeType),this.orderViews.set(o,a)),a}},{key:"render",value:function(){for(var o=this.table,i=o.rowsToRender,a=o.columnsToRender,l=o.rows,s=o.rowHeaders,u=0;u<i;u++){var f=this.table.renderedRowToSource(u),c=l.getRenderedNode(u);this.sourceRowIndex=f;var h=this.obtainOrderView(c),d=s.obtainOrderView(c);h.prependView(d).setSize(a).setOffset(this.table.renderedColumnToSource(0)).start();for(var v=0;v<a;v++){h.render();var y=h.getCurrentNode(),p=this.table.renderedColumnToSource(v);xe(y,"hide")||(y.className=""),y.removeAttribute("style"),y.removeAttribute("dir"),this.table.cellRenderer(f,p,y)}h.end()}}}]),r}(lv);function Kc(e){"@babel/helpers - typeof";return Kc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Kc(e)}function Kfe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function p1(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Xfe(n.key),n)}}function qfe(e,t,r){return t&&p1(e.prototype,t),r&&p1(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Xfe(e){var t=Zfe(e,"string");return Kc(t)==="symbol"?t:String(t)}function Zfe(e,t){if(Kc(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Kc(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Qfe=function(){function e(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=r.cellRenderer;Kfe(this,e),this.rootNode=t,this.rootDocument=this.rootNode.ownerDocument,this.rowHeaders=null,this.columnHeaders=null,this.colGroup=null,this.rows=null,this.cells=null,this.rowFilter=null,this.columnFilter=null,this.rowUtils=null,this.columnUtils=null,this.rowsToRender=0,this.columnsToRender=0,this.rowHeaderFunctions=[],this.rowHeadersCount=0,this.columnHeaderFunctions=[],this.columnHeadersCount=0,this.cellRenderer=n}return qfe(e,[{key:"setAxisUtils",value:function(r,n){this.rowUtils=r,this.columnUtils=n}},{key:"setViewportSize",value:function(r,n){this.rowsToRender=r,this.columnsToRender=n}},{key:"setFilters",value:function(r,n){this.rowFilter=r,this.columnFilter=n}},{key:"setHeaderContentRenderers",value:function(r,n){this.rowHeaderFunctions=r,this.rowHeadersCount=r.length,this.columnHeaderFunctions=n,this.columnHeadersCount=n.length}},{key:"setRenderers",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=r.rowHeaders,o=r.columnHeaders,i=r.colGroup,a=r.rows,l=r.cells;n.setTable(this),o.setTable(this),i.setTable(this),a.setTable(this),l.setTable(this),this.rowHeaders=n,this.columnHeaders=o,this.colGroup=i,this.rows=a,this.cells=l}},{key:"renderedRowToSource",value:function(r){return this.rowFilter.renderedToSource(r)}},{key:"renderedColumnToSource",value:function(r){return this.columnFilter.renderedToSource(r)}},{key:"render",value:function(){this.colGroup.adjust(),this.columnHeaders.adjust(),this.rows.adjust(),this.rowHeaders.adjust(),this.columnHeaders.render(),this.rows.render(),this.rowHeaders.render(),this.cells.render(),this.columnUtils.calculateWidths(),this.colGroup.render();for(var r=this.rowsToRender,n=this.rows,o=0;o<r;o++){var i=n.getRenderedNode(o);if(i.firstChild){var a=this.renderedRowToSource(o),l=this.rowUtils.getHeight(a);l?i.firstChild.style.height="".concat(l-1,"px"):i.firstChild.style.height=""}}}}]),e}();function qc(e){"@babel/helpers - typeof";return qc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},qc(e)}function Jfe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function b1(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,tce(n.key),n)}}function ece(e,t,r){return t&&b1(e.prototype,t),r&&b1(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function tce(e){var t=rce(e,"string");return qc(t)==="symbol"?t:String(t)}function rce(e,t){if(qc(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(qc(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var nce=function(){function e(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=t.TABLE,n=t.THEAD,o=t.COLGROUP,i=t.TBODY,a=t.rowUtils,l=t.columnUtils,s=t.cellRenderer;Jfe(this,e),this.renderer=new Qfe(r,{cellRenderer:s}),this.renderer.setRenderers({rowHeaders:new afe,columnHeaders:new gfe(n),colGroup:new Efe(o),rows:new Hfe(i),cells:new Gfe}),this.renderer.setAxisUtils(a,l)}return ece(e,[{key:"setFilters",value:function(r,n){return this.renderer.setFilters(r,n),this}},{key:"setViewportSize",value:function(r,n){return this.renderer.setViewportSize(r,n),this}},{key:"setHeaderContentRenderers",value:function(r,n){return this.renderer.setHeaderContentRenderers(r,n),this}},{key:"adjust",value:function(){this.renderer.adjust()}},{key:"render",value:function(){this.renderer.render()}}]),e}();function Xc(e){"@babel/helpers - typeof";return Xc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Xc(e)}function oce(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function w1(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,ace(n.key),n)}}function ice(e,t,r){return t&&w1(e.prototype,t),r&&w1(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function ace(e){var t=lce(e,"string");return Xc(t)==="symbol"?t:String(t)}function lce(e,t){if(Xc(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Xc(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var sce=function(){function e(t,r){oce(this,e),this.dataAccessObject=t,this.wtSettings=r,this.headerWidths=new Map}return ice(e,[{key:"getWidth",value:function(r){return this.wtSettings.getSetting("columnWidth",r)||this.wtSettings.getSetting("defaultColumnWidth")}},{key:"getStretchedColumnWidth",value:function(r){var n=this.dataAccessObject.wtViewport.columnsRenderCalculator,o=this.getWidth(r);if(n){var i=n.getStretchedColumnWidth(r,o);i&&(o=i)}return o}},{key:"getHeaderHeight",value:function(r){var n=this.wtSettings.getSetting("defaultRowHeight"),o=this.dataAccessObject.wtViewport.oversizedColumnHeaders[r];return o!==void 0&&(n=n?Math.max(n,o):o),n}},{key:"getHeaderWidth",value:function(r){return this.headerWidths.get(this.dataAccessObject.wtTable.columnFilter.sourceToRendered(r))}},{key:"calculateWidths",value:function(){var r=this.wtSettings,n=this.dataAccessObject,o=n.wtTable,i=n.wtViewport,a=n.cloneSource,l=a?a.wtTable.holder:o.holder,s=l.offsetHeight<l.scrollHeight?Zt():0,u=r.getSetting("rowHeaderWidth");if(i.columnsRenderCalculator.refreshStretching(i.getViewportWidth()-s),u=r.getSetting("onModifyRowHeaderWidth",u),u!=null)for(var f=r.getSetting("rowHeaders").length,c=r.getSetting("defaultColumnWidth"),h=0;h<f;h++){var d=Array.isArray(u)?u[h]:u;d=d??c,this.headerWidths.set(h,d)}}}]),e}();function Zc(e){"@babel/helpers - typeof";return Zc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Zc(e)}function uce(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function S1(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,cce(n.key),n)}}function fce(e,t,r){return t&&S1(e.prototype,t),r&&S1(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function cce(e){var t=hce(e,"string");return Zc(t)==="symbol"?t:String(t)}function hce(e,t){if(Zc(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Zc(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var dce=function(){function e(t,r){uce(this,e),this.dataAccessObject=t,this.wtSettings=r}return fce(e,[{key:"getHeight",value:function(r){var n=this.wtSettings.getSetting("rowHeight",r),o=this.dataAccessObject.wtViewport.oversizedRows[r];return o!==void 0&&(n=n===void 0?o:Math.max(n,o)),n}}]),e}();function Qc(e){"@babel/helpers - typeof";return Qc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Qc(e)}function vce(e){return mce(e)||gce(e)||_V(e)||yce()}function yce(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function gce(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function mce(e){if(Array.isArray(e))return NC(e)}function pce(e,t){return Sce(e)||wce(e,t)||_V(e,t)||bce()}function bce(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _V(e,t){if(e){if(typeof e=="string")return NC(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return NC(e,t)}}function NC(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function wce(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function Sce(e){if(Array.isArray(e))return e}function Cce(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function C1(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,OV(n.key),n)}}function _ce(e,t,r){return t&&C1(e.prototype,t),r&&C1(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function mn(e,t,r){return t=OV(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function OV(e){var t=Oce(e,"string");return Qc(t)==="symbol"?t:String(t)}function Oce(e,t){if(Qc(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Qc(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Rce=function(){function e(t,r,n,o,i){var a=this;Cce(this,e),mn(this,"wtSettings",null),mn(this,"domBindings",void 0),mn(this,"TBODY",null),mn(this,"THEAD",null),mn(this,"COLGROUP",null),mn(this,"hasTableHeight",!0),mn(this,"hasTableWidth",!0),mn(this,"isTableVisible",!1),mn(this,"tableOffset",0),mn(this,"holderOffset",0),this.domBindings=n,this.isMaster=i==="master",this.name=i,this.dataAccessObject=t,this.facadeGetter=r,this.wtSettings=o,this.instance=this.dataAccessObject.wot,this.wot=this.dataAccessObject.wot,this.TABLE=n.rootTable,IB(this.TABLE),this.spreader=this.createSpreader(this.TABLE),this.hider=this.createHider(this.spreader),this.holder=this.createHolder(this.hider),this.wtRootElement=this.holder.parentNode,this.isMaster&&this.alignOverlaysWithTrimmingContainer(),this.fixTableDomTree(),this.rowFilter=null,this.columnFilter=null,this.correctHeaderWidth=!1;var l=this.wtSettings.getSettingPure("rowHeaderWidth");this.wtSettings.update("rowHeaderWidth",function(){return a._modifyRowHeaderWidth(l)}),this.rowUtils=new dce(this.dataAccessObject,this.wtSettings),this.columnUtils=new sce(this.dataAccessObject,this.wtSettings),this.tableRenderer=new nce({TABLE:this.TABLE,THEAD:this.THEAD,COLGROUP:this.COLGROUP,TBODY:this.TBODY,rowUtils:this.rowUtils,columnUtils:this.columnUtils,cellRenderer:this.wtSettings.getSettingPure("cellRenderer")})}return _ce(e,[{key:"is",value:function(r){return this.name===r}},{key:"fixTableDomTree",value:function(){var r=this.domBindings.rootDocument;this.TBODY=this.TABLE.querySelector("tbody"),this.TBODY||(this.TBODY=r.createElement("tbody"),this.TABLE.appendChild(this.TBODY)),this.THEAD=this.TABLE.querySelector("thead"),this.THEAD||(this.THEAD=r.createElement("thead"),this.TABLE.insertBefore(this.THEAD,this.TBODY)),this.COLGROUP=this.TABLE.querySelector("colgroup"),this.COLGROUP||(this.COLGROUP=r.createElement("colgroup"),this.TABLE.insertBefore(this.COLGROUP,this.THEAD))}},{key:"createSpreader",value:function(r){var n=r.parentNode,o;return(!n||n.nodeType!==Node.ELEMENT_NODE||!xe(n,"wtHolder"))&&(o=this.domBindings.rootDocument.createElement("div"),o.className="wtSpreader",n&&n.insertBefore(o,r),o.appendChild(r)),o.style.position="relative",o}},{key:"createHider",value:function(r){var n=r.parentNode,o;return(!n||n.nodeType!==Node.ELEMENT_NODE||!xe(n,"wtHolder"))&&(o=this.domBindings.rootDocument.createElement("div"),o.className="wtHider",n&&n.insertBefore(o,r),o.appendChild(r)),o}},{key:"createHolder",value:function(r){var n=r.parentNode,o;return(!n||n.nodeType!==Node.ELEMENT_NODE||!xe(n,"wtHolder"))&&(o=this.domBindings.rootDocument.createElement("div"),o.style.position="relative",o.className="wtHolder",n&&n.insertBefore(o,r),this.isMaster&&(o.parentNode.className+="ht_master handsontable",o.parentNode.setAttribute("dir",this.wtSettings.getSettingPure("rtlMode")?"rtl":"ltr")),o.appendChild(r)),o}},{key:"draw",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=this.wtSettings,o=this.dataAccessObject,i=o.wtOverlays,a=o.wtViewport,l=n.getSetting("totalRows"),s=n.getSetting("totalColumns"),u=n.getSetting("rowHeaders"),f=u.length,c=n.getSetting("columnHeaders"),h=c.length,d=!1,v=r;if(this.isMaster&&(this.holderOffset=Vt(this.holder),v=a.createRenderCalculators(v),f&&!n.getSetting("fixedColumnsStart"))){var y=i.inlineStartOverlay.getScrollPosition(),p=this.correctHeaderWidth;this.correctHeaderWidth=y!==0,p!==this.correctHeaderWidth&&(v=!1)}if(this.isMaster&&(d=i.updateStateOfRendering()),v)this.isMaster&&a.createVisibleCalculators(),i&&i.refresh(!0);else{this.isMaster?this.tableOffset=Vt(this.TABLE):this.tableOffset=this.dataAccessObject.parentTableOffset;var w=l>0?this.getFirstRenderedRow():0,S=s>0?this.getFirstRenderedColumn():0;this.rowFilter=new pue(w,l,h),this.columnFilter=new hue(S,s,f);var C=!0;if(this.isMaster){this.alignOverlaysWithTrimmingContainer();var P={};this.wtSettings.getSetting("beforeDraw",!0,P),C=P.skipRender!==!0}if(C){this.tableRenderer.setHeaderContentRenderers(u,c),(this.is($n)||this.is(ui))&&this.tableRenderer.setHeaderContentRenderers(u,[]),this.resetOversizedRows(),this.tableRenderer.setViewportSize(this.getRenderedRowsCount(),this.getRenderedColumnsCount()).setFilters(this.rowFilter,this.columnFilter).render();var R;if(this.isMaster&&(R=this.dataAccessObject.workspaceWidth,this.dataAccessObject.wtViewport.containerWidth=null,this.markOversizedColumnHeaders()),this.adjustColumnHeaderHeights(),(this.isMaster||this.is($n))&&this.markOversizedRows(),this.isMaster){this.dataAccessObject.wtViewport.createVisibleCalculators(),this.dataAccessObject.wtOverlays.refresh(!1),this.dataAccessObject.wtOverlays.applyToDOM();var W=ut(this.hider),Y=ut(this.TABLE);W!==0&&Y!==W&&(this.columnUtils.calculateWidths(),this.tableRenderer.renderer.colGroup.render()),R!==this.dataAccessObject.wtViewport.getWorkspaceWidth()&&(this.dataAccessObject.wtViewport.containerWidth=null,this.columnUtils.calculateWidths(),this.tableRenderer.renderer.colGroup.render()),this.wtSettings.getSetting("onDraw",!0)}else this.is($n)&&this.dataAccessObject.cloneSource.wtOverlays.adjustElementsSize()}}var q=!1;return this.isMaster&&(q=i.topOverlay.resetFixedPosition(),i.bottomOverlay.clone&&(q=i.bottomOverlay.resetFixedPosition()||q),q=i.inlineStartOverlay.resetFixedPosition()||q,i.topInlineStartCornerOverlay&&i.topInlineStartCornerOverlay.resetFixedPosition(),i.bottomInlineStartCornerOverlay&&i.bottomInlineStartCornerOverlay.clone&&i.bottomInlineStartCornerOverlay.resetFixedPosition()),q?(i.refreshAll(),i.adjustElementsSize()):this.refreshSelections(v),d&&i.syncScrollWithMaster(),this.dataAccessObject.drawn=!0,this}},{key:"markIfOversizedColumnHeader",value:function(r){for(var n=this.columnFilter.renderedToSource(r),o=this.wtSettings.getSetting("columnHeaders").length,i=this.wtSettings.getSetting("defaultRowHeight"),a,l,s,u=this.wtSettings.getSetting("columnHeaderHeight")||[];o;)o-=1,a=this.getColumnHeaderHeight(o),l=this.getColumnHeader(n,o),l&&(s=ii(l),(!a&&i<s||a<s)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[o]=s),Array.isArray(u)?u[o]!==null&&u[o]!==void 0&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[o]=u[o]):isNaN(u)||(this.dataAccessObject.wtViewport.oversizedColumnHeaders[o]=u),this.dataAccessObject.wtViewport.oversizedColumnHeaders[o]<(u[o]||u)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[o]=u[o]||u))}},{key:"adjustColumnHeaderHeights",value:function(){for(var r=this.wtSettings,n=this.THEAD.childNodes,o=this.dataAccessObject.wtViewport.oversizedColumnHeaders,i=r.getSetting("columnHeaders"),a=0,l=i.length;a<l;a++)if(o[a]){if(!n[a]||n[a].childNodes.length===0)return;n[a].childNodes[0].style.height="".concat(o[a],"px")}}},{key:"resetOversizedRows",value:function(){var r=this.wtSettings,n=this.dataAccessObject.wtViewport;if(!(!this.isMaster&&!this.is($n))&&!r.getSetting("externalRowCalculator"))for(var o=this.getRenderedRowsCount(),i=0;i<o;i++){var a=this.rowFilter.renderedToSource(i);n.oversizedRows&&n.oversizedRows[a]&&(n.oversizedRows[a]=void 0)}}},{key:"removeClassFromCells",value:function(r){for(var n=this.TABLE.querySelectorAll(".".concat(r)),o=0,i=n.length;o<i;o++)He(n[o],r)}},{key:"refreshSelections",value:function(r){var n=this.wtSettings,o=this.dataAccessObject.selections;if(o){var i=Array.from(o),a=i.length;if(r){for(var l=[],s=0;s<a;s++){for(var u=i[s].settings,f=u.highlightHeaderClassName,c=u.highlightRowClassName,h=u.highlightColumnClassName,d=i[s].classNames,v=d.length,y=0;y<v;y++)l.includes(d[y])||l.push(d[y]);f&&!l.includes(f)&&l.push(f),c&&!l.includes(c)&&l.push(c),h&&!l.includes(h)&&l.push(h)}var p=n.getSetting("onBeforeRemoveCellClassNames");if(Array.isArray(p))for(var w=0;w<p.length;w++)l.push(p[w]);for(var S=l.length,C=0;C<S;C++)this.removeClassFromCells(l[C])}for(var P=0;P<a;P++)i[P].draw(this.facadeGetter(),r)}}},{key:"getCell",value:function(r){var n=r.row,o=r.col,i=this.wtSettings.getSetting("onModifyGetCellCoords",n,o);if(i&&Array.isArray(i)){var a=pce(i,2);n=a[0],o=a[1]}if(this.isRowBeforeRenderedRows(n))return-1;if(this.isRowAfterRenderedRows(n))return-2;if(this.isColumnBeforeRenderedColumns(o))return-3;if(this.isColumnAfterRenderedColumns(o))return-4;var l=this.getRow(n);if(!l&&n>=0)throw new Error("TR was expected to be rendered but is not");var s=l.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(o)];if(!s&&o>=0)throw new Error("TD or TH was expected to be rendered but is not");return s}},{key:"getRow",value:function(r){var n=null,o=null;if(r<0){var i;n=(i=this.rowFilter)===null||i===void 0?void 0:i.sourceRowToVisibleColHeadedRow(r),o=this.THEAD}else{var a;n=(a=this.rowFilter)===null||a===void 0?void 0:a.sourceToRendered(r),o=this.TBODY}return n!==void 0&&o!==void 0?o.childNodes.length<n+1?!1:o.childNodes[n]:!1}},{key:"getColumnHeader",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,o=this.THEAD.childNodes[n];return o==null?void 0:o.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(r)]}},{key:"getColumnHeaders",value:function(r){var n=[],o=this.columnFilter.sourceColumnToVisibleRowHeadedColumn(r);return this.THEAD.childNodes.forEach(function(i){var a=i.childNodes[o];a&&n.push(a)}),n}},{key:"getRowHeader",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;if(this.columnFilter.sourceColumnToVisibleRowHeadedColumn(0)!==0){var o=this.wtSettings.getSetting("rowHeaders").length;if(!(n>=o)){var i=this.TBODY.childNodes[this.rowFilter.sourceToRendered(r)];return i==null?void 0:i.childNodes[n]}}}},{key:"getRowHeaders",value:function(r){if(this.columnFilter.sourceColumnToVisibleRowHeadedColumn(0)===0)return[];for(var n=[],o=this.wtSettings.getSetting("rowHeaders").length,i=0;i<o;i++){var a=this.TBODY.childNodes[this.rowFilter.sourceToRendered(r)],l=a==null?void 0:a.childNodes[i];l&&n.push(l)}return n}},{key:"getCoords",value:function(r){var n=r;if(n.nodeName!=="TD"&&n.nodeName!=="TH"&&(n=Ra(n,["TD","TH"])),n===null)return null;var o=n.parentNode,i=o.parentNode,a=vie(o),l=n.cellIndex;if(Mi(Ma,n,this.wtRootElement)||Mi(Aa,n,this.wtRootElement))i.nodeName==="THEAD"&&(a-=i.childNodes.length);else if(Mi(ui,n,this.wtRootElement)||Mi($n,n,this.wtRootElement)){var s=this.wtSettings.getSetting("totalRows");a=s-i.childNodes.length+a}else i===this.THEAD?a=this.rowFilter.visibleColHeadedRowToSourceRow(a):a=this.rowFilter.renderedToSource(a);return Mi(Ma,n,this.wtRootElement)||Mi(Ia,n,this.wtRootElement)||Mi(ui,n,this.wtRootElement)?l=this.columnFilter.offsettedTH(l):l=this.columnFilter.visibleRowHeadedColumnToSourceColumn(l),this.wot.createCellCoords(a,l)}},{key:"markOversizedRows",value:function(){if(!this.wtSettings.getSetting("externalRowCalculator")){var r=this.TBODY.childNodes.length,n=r*this.wtSettings.getSetting("defaultRowHeight"),o=ii(this.TBODY)-1,i,a,l,s,u;if(!(n===o&&!this.wtSettings.getSetting("fixedRowsBottom")))for(;r;)r-=1,l=this.rowFilter.renderedToSource(r),i=this.getRowHeight(l),s=this.getTrForRow(l),u=s.querySelector("th"),u?a=ii(u):a=ii(s)-1,(!i&&this.wtSettings.getSetting("defaultRowHeight")<a||i<a)&&(a+=1,this.dataAccessObject.wtViewport.oversizedRows[l]=a)}}},{key:"getTrForRow",value:function(r){return this.TBODY.childNodes[this.rowFilter.sourceToRendered(r)]}},{key:"isColumnHeaderRendered",value:function(r){if(r>=0)return!1;var n=this.wtSettings.getSetting("rowHeaders"),o=n.length;return Math.abs(r)<=o}},{key:"isRowHeaderRendered",value:function(r){if(r>=0)return!1;var n=this.wtSettings.getSetting("columnHeaders"),o=n.length;return Math.abs(r)<=o}},{key:"isRowBeforeRenderedRows",value:function(r){var n=this.getFirstRenderedRow();return r<0&&n<=0?!this.isRowHeaderRendered(r):r<n}},{key:"isRowAfterRenderedRows",value:function(r){return r>this.getLastRenderedRow()}},{key:"isColumnBeforeRenderedColumns",value:function(r){var n=this.getFirstRenderedColumn();return r<0&&n<=0?!this.isColumnHeaderRendered(r):r<n}},{key:"isColumnAfterRenderedColumns",value:function(r){return this.columnFilter&&r>this.getLastRenderedColumn()}},{key:"isColumnAfterViewport",value:function(r){return this.columnFilter&&r>this.getLastVisibleColumn()}},{key:"isRowAfterViewport",value:function(r){return this.rowFilter&&r>this.getLastVisibleRow()}},{key:"isColumnBeforeViewport",value:function(r){return this.columnFilter&&this.columnFilter.sourceToRendered(r)<0&&r>=0}},{key:"isLastRowFullyVisible",value:function(){return this.getLastVisibleRow()===this.getLastRenderedRow()}},{key:"isLastColumnFullyVisible",value:function(){return this.getLastVisibleColumn()===this.getLastRenderedColumn()}},{key:"allRowsInViewport",value:function(){return this.wtSettings.getSetting("totalRows")===this.getVisibleRowsCount()}},{key:"allColumnsInViewport",value:function(){return this.wtSettings.getSetting("totalColumns")===this.getVisibleColumnsCount()}},{key:"getRowHeight",value:function(r){return this.rowUtils.getHeight(r)}},{key:"getColumnHeaderHeight",value:function(r){return this.columnUtils.getHeaderHeight(r)}},{key:"getColumnWidth",value:function(r){return this.columnUtils.getWidth(r)}},{key:"getStretchedColumnWidth",value:function(r){return this.columnUtils.getStretchedColumnWidth(r)}},{key:"hasDefinedSize",value:function(){return this.hasTableHeight&&this.hasTableWidth}},{key:"getWidth",value:function(){return ut(this.TABLE)}},{key:"getHeight",value:function(){return Tt(this.TABLE)}},{key:"getTotalWidth",value:function(){var r=ut(this.hider);return r!==0?r:this.getWidth()}},{key:"getTotalHeight",value:function(){var r=Tt(this.hider);return r!==0?r:this.getHeight()}},{key:"isVisible",value:function(){return Pc(this.TABLE)}},{key:"_modifyRowHeaderWidth",value:function(r){var n=vt(r)?r():null;return Array.isArray(n)?(n=vce(n),n[n.length-1]=this._correctRowHeaderWidth(n[n.length-1])):n=this._correctRowHeaderWidth(n),n}},{key:"_correctRowHeaderWidth",value:function(r){var n=r;return typeof r!="number"&&(n=this.wtSettings.getSetting("defaultColumnWidth")),this.correctHeaderWidth&&(n+=1),n}}]),e}();const yf=Rce;var Ece="stickyRowsBottom",RV={getFirstRenderedRow:function(){var t=this.wtSettings.getSetting("totalRows"),r=this.wtSettings.getSetting("fixedRowsBottom"),n=t-r;return t===0||r===0?-1:n<0?0:n},getFirstVisibleRow:function(){return this.getFirstRenderedRow()},getLastRenderedRow:function(){return this.wtSettings.getSetting("totalRows")-1},getLastVisibleRow:function(){return this.getLastRenderedRow()},getRenderedRowsCount:function(){var t=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsBottom"),t)},getVisibleRowsCount:function(){return this.getRenderedRowsCount()}};Lo(RV,"MIXIN_NAME",Ece,{writable:!1,enumerable:!1});const EV=RV;var Tce="stickyColumnsStart",TV={getFirstRenderedColumn:function(){var t=this.wtSettings.getSetting("totalColumns");return t===0?-1:0},getFirstVisibleColumn:function(){return this.getFirstRenderedColumn()},getLastRenderedColumn:function(){return this.getRenderedColumnsCount()-1},getLastVisibleColumn:function(){return this.getLastRenderedColumn()},getRenderedColumnsCount:function(){var t=this.wtSettings.getSetting("totalColumns");return Math.min(this.wtSettings.getSetting("fixedColumnsStart"),t)},getVisibleColumnsCount:function(){return this.getRenderedColumnsCount()}};Lo(TV,"MIXIN_NAME",Tce,{writable:!1,enumerable:!1});const UE=TV;function fs(e){"@babel/helpers - typeof";return fs=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},fs(e)}function _1(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Pce(n.key),n)}}function kce(e,t,r){return t&&_1(e.prototype,t),r&&_1(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Pce(e){var t=$ce(e,"string");return fs(t)==="symbol"?t:String(t)}function $ce(e,t){if(fs(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(fs(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Ace(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ice(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&HC(e,t)}function HC(e,t){return HC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},HC(e,t)}function Mce(e){var t=Nce();return function(){var n=Ug(e),o;if(t){var i=Ug(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return xce(this,o)}}function xce(e,t){if(t&&(fs(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Dce(e)}function Dce(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Nce(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ug(e){return Ug=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Ug(e)}var zE=function(e){Ice(r,e);var t=Mce(r);function r(n,o,i,a){return Ace(this,r),t.call(this,n,o,i,a,ui)}return kce(r)}(yf);dt(zE,EV);dt(zE,UE);const Hce=zE;var Aa="top",$n="bottom",Ia="inline_start",Ma="top_inline_start_corner",ui="bottom_inline_start_corner",Lce=[Aa,$n,Ia,Ma,ui],jce=new Map([[Aa,"ht_clone_".concat(Aa)],[$n,"ht_clone_".concat($n)],[Ia,"ht_clone_".concat(Ia," ht_clone_left")],[Ma,"ht_clone_".concat(Ma," ht_clone_top_left_corner")],[ui,"ht_clone_".concat(ui," ht_clone_bottom_left_corner")]]);function Jc(e){"@babel/helpers - typeof";return Jc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Jc(e)}function Fce(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function O1(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,kV(n.key),n)}}function Bce(e,t,r){return t&&O1(e.prototype,t),r&&O1(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function iw(e,t,r){return t=kV(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function kV(e){var t=Vce(e,"string");return Jc(t)==="symbol"?t:String(t)}function Vce(e,t){if(Jc(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Jc(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Wce=function(){function e(t){Fce(this,e),iw(this,"dataAccessObject",void 0),iw(this,"lastScrolledColumnPos",-1),iw(this,"lastScrolledRowPos",-1),this.dataAccessObject=t}return Bce(e,[{key:"scrollViewport",value:function(r,n,o,i,a){var l=this.scrollViewportHorizontally(r.col,o,a),s=this.scrollViewportVertically(r.row,n,i);return l||s}},{key:"scrollViewportHorizontally",value:function(r,n,o){var i=this.dataAccessObject,a=i.drawn,l=i.totalColumns;if(!a||!Number.isInteger(r)||r<0||r>l)return!1;var s=this.getFirstVisibleColumn(),u=this.getLastVisibleColumn(),f=n===void 0&&o===void 0,c=this.dataAccessObject,h=c.fixedColumnsStart,d=c.inlineStartOverlay;if(f&&r<h)return!1;var v=!1;return s===-1?v=d.scrollTo(r,f?r>this.lastScrolledColumnPos:n):(f&&(r<s||r>u)||!f)&&(v=d.scrollTo(r,f?r>u:n)),v&&(this.lastScrolledColumnPos=r),v}},{key:"scrollViewportVertically",value:function(r,n,o){var i=this.dataAccessObject,a=i.drawn,l=i.totalRows;if(!a||!Number.isInteger(r)||r<0||r>l)return!1;var s=this.getFirstVisibleRow(),u=this.getLastVisibleRow(),f=n===void 0&&o===void 0,c=this.dataAccessObject,h=c.fixedRowsBottom,d=c.fixedRowsTop,v=c.topOverlay;if(f&&(r<d||r>l-h-1))return!1;var y=!1;return s===-1?y=v.scrollTo(r,f?r>this.lastScrolledRowPos:o):(f&&(r<s||r>u)||!f)&&(y=v.scrollTo(r,f?r>u:o)),y&&(this.lastScrolledRowPos=r),y}},{key:"getFirstVisibleRow",value:function(){var r=this.dataAccessObject,n=r.topOverlay,o=r.wtTable,i=r.wtViewport,a=r.totalRows,l=r.fixedRowsTop,s=r.rootWindow,u=o.getFirstVisibleRow();if(n.mainTableScrollableElement===s){var f=Vt(o.wtRootElement),c=ii(o.hider),h=ii(s),d=Ig(s,s);if(f.top+c-h<=d){var v=i.getColumnHeaderHeight();v+=n.sumCellSizes(0,l);for(var y=a;y>0;y--)if(v+=n.sumCellSizes(y-1,y),f.top+c-v<=d){u=y;break}}}return u}},{key:"getLastVisibleRow",value:function(){var r=this.dataAccessObject,n=r.topOverlay,o=r.wtTable,i=r.wtViewport,a=r.totalRows,l=r.rootWindow,s=o.getLastVisibleRow();if(n.mainTableScrollableElement===l){var u=Vt(o.wtRootElement),f=Ig(l,l);if(u.top>f){for(var c=ii(l),h=i.getColumnHeaderHeight(),d=1;d<=a;d++)if(h+=n.sumCellSizes(d-1,d),u.top+h-f>=c){s=d-2;break}}}return s}},{key:"getFirstVisibleColumn",value:function(){var r=this.dataAccessObject,n=r.inlineStartOverlay,o=r.wtTable,i=r.wtViewport,a=r.totalColumns,l=r.rootWindow,s=o.getFirstVisibleColumn();if(n.mainTableScrollableElement===l){var u=Vt(o.wtRootElement),f=By(o.hider),c=By(l),h=Math.abs(hC(l,l));if(u.left+f-c<=h){for(var d=i.getRowHeaderWidth(),v=a;v>0;v--)if(d+=n.sumCellSizes(v-1,v),u.left+f-d<=h){s=v;break}}}return s}},{key:"getLastVisibleColumn",value:function(){var r=this.dataAccessObject,n=r.wtSettings,o=r.inlineStartOverlay,i=r.wtTable,a=r.wtViewport,l=r.totalColumns,s=r.rootWindow,u=i.getLastVisibleColumn();if(o.mainTableScrollableElement===s){var f=n.getSetting("rtlMode"),c=null;if(f){var h=i.TABLE.getBoundingClientRect(),d=this.dataAccessObject.rootWindow.document,v=d.documentElement.offsetWidth;c=Math.abs(h.right-v)}else{var y=Vt(i.wtRootElement);c=y.left}var p=Math.abs(hC(s,s));if(c>p){for(var w=By(s),S=a.getRowHeaderWidth(),C=1;C<=l;C++)if(S+=o.sumCellSizes(C-1,C),c+S-p>=w){u=C-2;break}}}return u}}]),e}();const Uce=Wce;function eh(e){"@babel/helpers - typeof";return eh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},eh(e)}function zce(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function R1(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,PV(n.key),n)}}function Yce(e,t,r){return t&&R1(e.prototype,t),r&&R1(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function en(e,t,r){return t=PV(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function PV(e){var t=Gce(e,"string");return eh(t)==="symbol"?t:String(t)}function Gce(e,t){if(eh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(eh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var YE=function(){function e(t,r){zce(this,e),en(this,"wtTable",void 0),en(this,"wtScroll",void 0),en(this,"wtViewport",void 0),en(this,"wtOverlays",void 0),en(this,"selections",void 0),en(this,"wtEvent",void 0),en(this,"guid","wt_".concat(PB())),en(this,"drawInterrupted",!1),en(this,"drawn",!1),en(this,"domBindings",void 0),en(this,"wtSettings",void 0),this.domBindings={rootTable:t,rootDocument:t.ownerDocument,rootWindow:t.ownerDocument.defaultView},this.wtSettings=r,this.wtScroll=new Uce(this.createScrollDao())}return Yce(e,[{key:"eventManager",get:function(){return new Pt(this)}},{key:"findOriginalHeaders",value:function(){var r=[];if(this.wtTable.THEAD.childNodes.length&&this.wtTable.THEAD.childNodes[0].childNodes.length){for(var n=0,o=this.wtTable.THEAD.childNodes[0].childNodes.length;n<o;n++)r.push(this.wtTable.THEAD.childNodes[0].childNodes[n].innerHTML);this.wtSettings.getSetting("columnHeaders").length||this.wtSettings.update("columnHeaders",[function(i,a){ka(a,r[i])}])}}},{key:"createCellCoords",value:function(r,n){return new Dg(r,n,this.wtSettings.getSetting("rtlMode"))}},{key:"createCellRange",value:function(r,n,o){return new VE(r,n,o,this.wtSettings.getSetting("rtlMode"))}},{key:"draw",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this.drawInterrupted=!1,!r&&!this.wtTable.isVisible()?this.drawInterrupted=!0:this.wtTable.draw(r),this}},{key:"getCell",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(!n)return this.wtTable.getCell(r);var o=this.wtSettings.getSetting("totalRows"),i=this.wtSettings.getSetting("fixedRowsTop"),a=this.wtSettings.getSetting("fixedRowsBottom"),l=this.wtSettings.getSetting("fixedColumnsStart");if(r.row<i&&r.col<l)return this.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.getCell(r);if(r.row<i)return this.wtOverlays.topOverlay.clone.wtTable.getCell(r);if(r.col<l&&r.row>=o-a){if(this.wtOverlays.bottomInlineStartCornerOverlay&&this.wtOverlays.bottomInlineStartCornerOverlay.clone)return this.wtOverlays.bottomInlineStartCornerOverlay.clone.wtTable.getCell(r)}else{if(r.col<l)return this.wtOverlays.inlineStartOverlay.clone.wtTable.getCell(r);if(r.row<o&&r.row>=o-a&&this.wtOverlays.bottomOverlay&&this.wtOverlays.bottomOverlay.clone)return this.wtOverlays.bottomOverlay.clone.wtTable.getCell(r)}return this.wtTable.getCell(r)}},{key:"scrollViewport",value:function(r,n,o,i,a){return r.col<0||r.row<0?!1:this.wtScroll.scrollViewport(r,n,o,i,a)}},{key:"scrollViewportHorizontally",value:function(r,n,o){return r<0?!1:this.wtScroll.scrollViewportHorizontally(r,n,o)}},{key:"scrollViewportVertically",value:function(r,n,o){return r<0?!1:this.wtScroll.scrollViewportVertically(r,n,o)}},{key:"getViewport",value:function(){return[this.wtTable.getFirstVisibleRow(),this.wtTable.getFirstVisibleColumn(),this.wtTable.getLastVisibleRow(),this.wtTable.getLastVisibleColumn()]}},{key:"destroy",value:function(){this.wtOverlays.destroy(),this.wtEvent.destroy()}},{key:"createScrollDao",value:function(){var r=this;return{get drawn(){return r.drawn},get topOverlay(){return r.wtOverlays.topOverlay},get inlineStartOverlay(){return r.wtOverlays.inlineStartOverlay},get wtTable(){return r.wtTable},get wtViewport(){return r.wtViewport},get wtSettings(){return r.wtSettings},get rootWindow(){return r.domBindings.rootWindow},get totalRows(){return r.wtSettings.getSetting("totalRows")},get totalColumns(){return r.wtSettings.getSetting("totalColumns")},get fixedRowsTop(){return r.wtSettings.getSetting("fixedRowsTop")},get fixedRowsBottom(){return r.wtSettings.getSetting("fixedRowsBottom")},get fixedColumnsStart(){return r.wtSettings.getSetting("fixedColumnsStart")}}}},{key:"getTableDao",value:function(){var r=this;return{get wot(){return r},get parentTableOffset(){return r.cloneSource.wtTable.tableOffset},get cloneSource(){return r.cloneSource},get workspaceWidth(){return r.wtViewport.getWorkspaceWidth()},get wtViewport(){return r.wtViewport},get wtOverlays(){return r.wtOverlays},get selections(){return r.selections},get drawn(){return r.drawn},set drawn(n){r.drawn=n},get wtTable(){return r.wtTable},get startColumnRendered(){return r.wtViewport.columnsRenderCalculator.startColumn},get startColumnVisible(){return r.wtViewport.columnsVisibleCalculator.startColumn},get endColumnRendered(){return r.wtViewport.columnsRenderCalculator.endColumn},get endColumnVisible(){return r.wtViewport.columnsVisibleCalculator.endColumn},get countColumnsRendered(){return r.wtViewport.columnsRenderCalculator.count},get countColumnsVisible(){return r.wtViewport.columnsVisibleCalculator.count},get startRowRendered(){return r.wtViewport.rowsRenderCalculator.startRow},get startRowVisible(){return r.wtViewport.rowsVisibleCalculator.startRow},get endRowRendered(){return r.wtViewport.rowsRenderCalculator.endRow},get endRowVisible(){return r.wtViewport.rowsVisibleCalculator.endRow},get countRowsRendered(){return r.wtViewport.rowsRenderCalculator.count},get countRowsVisible(){return r.wtViewport.rowsVisibleCalculator.count}}}}]),e}();function cs(e){"@babel/helpers - typeof";return cs=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},cs(e)}function E1(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,$V(n.key),n)}}function Kce(e,t,r){return t&&E1(e.prototype,t),r&&E1(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function qce(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Xce(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&LC(e,t)}function LC(e,t){return LC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},LC(e,t)}function Zce(e){var t=Jce();return function(){var n=zg(e),o;if(t){var i=zg(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Qce(this,o)}}function Qce(e,t){if(t&&(cs(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Uy(e)}function Uy(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Jce(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function zg(e){return zg=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},zg(e)}function T1(e,t,r){return t=$V(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function $V(e){var t=ehe(e,"string");return cs(t)==="symbol"?t:String(t)}function ehe(e,t){if(cs(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(cs(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var the=function(e){Xce(r,e);var t=Zce(r);function r(n,o,i){var a;qce(this,r),a=t.call(this,n,o),T1(Uy(a),"cloneSource",void 0),T1(Uy(a),"cloneOverlay",void 0);var l=a.wtSettings.getSetting("facade",Uy(a));return a.cloneSource=i.source,a.cloneOverlay=i.overlay,a.wtTable=a.cloneOverlay.createTable(a.getTableDao(),l,a.domBindings,a.wtSettings),a.wtViewport=i.viewport,a.selections=i.selections,a.wtEvent=new wV(l,a.domBindings,a.wtSettings,a.eventManager,a.wtTable,a.selections,i.event),a.findOriginalHeaders(),a}return Kce(r)}(YE);function th(e){"@babel/helpers - typeof";return th=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},th(e)}function rhe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function k1(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,AV(n.key),n)}}function nhe(e,t,r){return t&&k1(e.prototype,t),r&&k1(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function ohe(e,t,r){return t=AV(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function AV(e){var t=ihe(e,"string");return th(t)==="symbol"?t:String(t)}function ihe(e,t){if(th(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(th(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var sv=function(){function e(t,r,n,o,i){rhe(this,e),ohe(this,"wtSettings",null),Lo(this,"wot",t,{writable:!1}),this.domBindings=i,this.facadeGetter=r,this.wtSettings=o;var a=this.wot.wtTable,l=a.TABLE,s=a.hider,u=a.spreader,f=a.holder,c=a.wtRootElement;this.instance=this.wot,this.type=n,this.mainTableScrollableElement=null,this.TABLE=l,this.hider=s,this.spreader=u,this.holder=f,this.wtRootElement=c,this.trimmingContainer=ns(this.hider.parentNode.parentNode),this.updateStateOfRendering(),this.clone=this.makeClone()}return nhe(e,[{key:"updateStateOfRendering",value:function(){var r=this.needFullRender;this.needFullRender=this.shouldBeRendered();var n=r!==this.needFullRender;return n&&!this.needFullRender&&this.reset(),n}},{key:"shouldBeRendered",value:function(){return!0}},{key:"updateTrimmingContainer",value:function(){this.trimmingContainer=ns(this.hider.parentNode.parentNode)}},{key:"updateMainScrollableElement",value:function(){var r=this.wot.wtTable,n=this.domBindings.rootWindow;n.getComputedStyle(r.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=this.wot.wtTable.holder:this.mainTableScrollableElement=Mg(r.TABLE)}},{key:"getRelativeCellPosition",value:function(r,n,o){if(this.clone.wtTable.holder.contains(r)===!1){yt("The provided element is not a child of the ".concat(this.type," overlay"));return}var i=this.mainTableScrollableElement===this.domBindings.rootWindow,a=o<this.wtSettings.getSetting("fixedColumnsStart"),l=n<this.wtSettings.getSetting("fixedRowsTop"),s=n>=this.wtSettings.getSetting("totalRows")-this.wtSettings.getSetting("fixedRowsBottom"),u=this.clone.wtTable.spreader,f={start:this.getRelativeStartPosition(u),top:u.offsetTop},c={start:this.getRelativeStartPosition(r),top:r.offsetTop},h=null;return i?h=this.getRelativeCellPositionWithinWindow(l,a,c,f):h=this.getRelativeCellPositionWithinHolder(l,s,a,c,f),h}},{key:"getRelativeStartPosition",value:function(r){return this.isRtl()?r.offsetParent.offsetWidth-r.offsetLeft-r.offsetWidth:r.offsetLeft}},{key:"getRelativeCellPositionWithinWindow",value:function(r,n,o,i){var a=this.wot.wtTable.wtRootElement.getBoundingClientRect(),l=0,s=0;if(!n)l=i.start;else{var u=a.left;this.isRtl()&&(u=this.domBindings.rootWindow.innerWidth-(a.left+a.width+Zt())),l=u<=0?-1*u:0}if(r){var f=this.clone.wtTable.TABLE.getBoundingClientRect();s=f.top-a.top}else s=i.top;return{start:o.start+l,top:o.top+s}}},{key:"getRelativeCellPositionWithinHolder",value:function(r,n,o,i,a){var l={horizontal:this.wot.wtOverlays.inlineStartOverlay.getScrollPosition(),vertical:this.wot.wtOverlays.topOverlay.getScrollPosition()},s=0,u=0;if(o||(s=l.horizontal-a.start),n){var f=this.wot.wtTable.wtRootElement.getBoundingClientRect(),c=this.clone.wtTable.TABLE.getBoundingClientRect();u=c.top*-1+f.top}else r||(u=l.vertical-a.top);return{start:i.start-s,top:i.top-u}}},{key:"makeClone",value:function(){if(Lce.indexOf(this.type)===-1)throw new Error('Clone type "'.concat(this.type,'" is not supported.'));var r=this.wot.wtTable,n=this.domBindings,o=n.rootDocument,i=n.rootWindow,a=o.createElement("DIV"),l=o.createElement("TABLE"),s=r.wtRootElement.parentNode;a.className="".concat(jce.get(this.type)," handsontable"),a.setAttribute("dir",this.isRtl()?"rtl":"ltr"),a.style.position="absolute",a.style.top=0,a.style.overflow="visible",this.isRtl()?a.style.right=0:a.style.left=0,l.className=r.TABLE.className,a.appendChild(l),s.appendChild(a);var u=this.wtSettings.getSetting("preventOverflow");return u===!0||u==="horizontal"&&this.type===Aa||u==="vertical"&&this.type===Ia?this.mainTableScrollableElement=i:i.getComputedStyle(s).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=r.holder:this.mainTableScrollableElement=Mg(r.TABLE),new the(l,this.wtSettings,{source:this.wot,overlay:this,viewport:this.wot.wtViewport,event:this.wot.wtEvent,selections:this.wot.selections})}},{key:"refresh",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=this.shouldBeRendered();this.clone&&(this.needFullRender||n)&&this.clone.draw(r),this.needFullRender=n}},{key:"reset",value:function(){if(this.clone){var r=this.clone.wtTable.holder,n=this.clone.wtTable.hider,o=r.style,i=n.style,a=r.parentNode.style;I([o,i,a],function(l){l.width="",l.height=""})}}},{key:"isRtl",value:function(){return this.wtSettings.getSetting("rtlMode")}},{key:"destroy",value:function(){this.clone.eventManager.destroy()}}]),e}();function hs(e){"@babel/helpers - typeof";return hs=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},hs(e)}function zy(e,t,r){return IV()?zy=Reflect.construct.bind():zy=function(o,i,a){var l=[null];l.push.apply(l,i);var s=Function.bind.apply(o,l),u=new s;return a&&Yg(u,a.prototype),u},zy.apply(null,arguments)}function ahe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function P1(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,she(n.key),n)}}function lhe(e,t,r){return t&&P1(e.prototype,t),r&&P1(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function she(e){var t=uhe(e,"string");return hs(t)==="symbol"?t:String(t)}function uhe(e,t){if(hs(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(hs(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function fhe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Yg(e,t)}function Yg(e,t){return Yg=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},Yg(e,t)}function che(e){var t=IV();return function(){var n=Gg(e),o;if(t){var i=Gg(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return hhe(this,o)}}function hhe(e,t){if(t&&(hs(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return dhe(e)}function dhe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function IV(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Gg(e){return Gg=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Gg(e)}var vhe=function(e){fhe(r,e);var t=che(r);function r(n,o,i,a,l,s){var u;return ahe(this,r),u=t.call(this,n,o,ui,i,a),u.bottomOverlay=l,u.inlineStartOverlay=s,u}return lhe(r,[{key:"createTable",value:function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return zy(Hce,i)}},{key:"shouldBeRendered",value:function(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}},{key:"resetFixedPosition",value:function(){var o=this.wot;if(this.updateTrimmingContainer(),!o.wtTable.holder.parentNode)return!1;var i=this.clone.wtTable.holder.parentNode;if(i.style.top="",this.trimmingContainer===this.domBindings.rootWindow){var a=this.inlineStartOverlay.getOverlayOffset(),l=this.bottomOverlay.getOverlayOffset();i.style[this.isRtl()?"right":"left"]="".concat(a,"px"),i.style.bottom="".concat(l,"px")}else vp(i),this.repositionOverlay();var s=Tt(this.clone.wtTable.TABLE),u=ut(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(s=0),i.style.height="".concat(s,"px"),i.style.width="".concat(u,"px"),!1}},{key:"repositionOverlay",value:function(){var o=this.wot,i=o.wtTable,a=o.wtViewport,l=this.domBindings.rootDocument,s=this.clone.wtTable.holder.parentNode,u=0;a.hasVerticalScroll()||(u+=a.getWorkspaceHeight()-i.getTotalHeight()),a.hasVerticalScroll()&&a.hasHorizontalScroll()&&(u+=Zt(l)),s.style.bottom="".concat(u,"px")}}]),r}(sv),yhe="calculatedColumns",MV={getFirstRenderedColumn:function(){var t=this.dataAccessObject.startColumnRendered;return t===null?-1:t},getFirstVisibleColumn:function(){var t=this.dataAccessObject.startColumnVisible;return t===null?-1:t},getLastRenderedColumn:function(){var t=this.dataAccessObject.endColumnRendered;return t===null?-1:t},getLastVisibleColumn:function(){var t=this.dataAccessObject.endColumnVisible;return t===null?-1:t},getRenderedColumnsCount:function(){return this.dataAccessObject.countColumnsRendered},getVisibleColumnsCount:function(){return this.dataAccessObject.countColumnsVisible}};Lo(MV,"MIXIN_NAME",yhe,{writable:!1,enumerable:!1});const GE=MV;function ds(e){"@babel/helpers - typeof";return ds=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ds(e)}function $1(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,mhe(n.key),n)}}function ghe(e,t,r){return t&&$1(e.prototype,t),r&&$1(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function mhe(e){var t=phe(e,"string");return ds(t)==="symbol"?t:String(t)}function phe(e,t){if(ds(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ds(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function bhe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function whe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&jC(e,t)}function jC(e,t){return jC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},jC(e,t)}function She(e){var t=Ohe();return function(){var n=Kg(e),o;if(t){var i=Kg(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Che(this,o)}}function Che(e,t){if(t&&(ds(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return _he(e)}function _he(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ohe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Kg(e){return Kg=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Kg(e)}var KE=function(e){whe(r,e);var t=She(r);function r(n,o,i,a){return bhe(this,r),t.call(this,n,o,i,a,$n)}return ghe(r)}(yf);dt(KE,EV);dt(KE,GE);const Rhe=KE;function vs(e){"@babel/helpers - typeof";return vs=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},vs(e)}function Yy(e,t,r){return DV()?Yy=Reflect.construct.bind():Yy=function(o,i,a){var l=[null];l.push.apply(l,i);var s=Function.bind.apply(o,l),u=new s;return a&&qg(u,a.prototype),u},Yy.apply(null,arguments)}function Ehe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function A1(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,NV(n.key),n)}}function The(e,t,r){return t&&A1(e.prototype,t),r&&A1(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function khe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&qg(e,t)}function qg(e,t){return qg=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},qg(e,t)}function Phe(e){var t=DV();return function(){var n=Xg(e),o;if(t){var i=Xg(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return $he(this,o)}}function $he(e,t){if(t&&(vs(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return xV(e)}function xV(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function DV(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Xg(e){return Xg=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Xg(e)}function Ahe(e,t,r){return t=NV(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function NV(e){var t=Ihe(e,"string");return vs(t)==="symbol"?t:String(t)}function Ihe(e,t){if(vs(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(vs(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Mhe=function(e){khe(r,e);var t=Phe(r);function r(n,o,i,a){var l;return Ehe(this,r),l=t.call(this,n,o,$n,i,a),Ahe(xV(l),"cachedFixedRowsBottom",-1),l.cachedFixedRowsBottom=l.wtSettings.getSetting("fixedRowsBottom"),l}return The(r,[{key:"createTable",value:function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return Yy(Rhe,i)}},{key:"shouldBeRendered",value:function(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")}},{key:"resetFixedPosition",value:function(){if(!this.needFullRender||!this.wot.wtTable.holder.parentNode)return!1;var o=this.domBindings.rootWindow,i=this.clone.wtTable.holder.parentNode;i.style.top="";var a=0,l=this.wtSettings.getSetting("preventOverflow");this.trimmingContainer===o&&(!l||l!=="vertical")?(a=this.getOverlayOffset(),i.style.bottom="".concat(a,"px")):(a=this.getScrollPosition(),this.repositionOverlay());var s=this.adjustHeaderBordersPosition(a);return this.adjustElementsSize(),s}},{key:"repositionOverlay",value:function(){var o=this.wot,i=o.wtTable,a=o.wtViewport,l=this.domBindings.rootDocument,s=this.clone.wtTable.holder.parentNode,u=0;a.hasVerticalScroll()||(u+=a.getWorkspaceHeight()-i.getTotalHeight()),a.hasVerticalScroll()&&a.hasHorizontalScroll()&&(u+=Zt(l)),s.style.bottom="".concat(u,"px")}},{key:"setScrollPosition",value:function(o){var i=this.domBindings.rootWindow,a=!1;return this.mainTableScrollableElement===i?(i.scrollTo(rs(i),o),a=!0):this.mainTableScrollableElement.scrollTop!==o&&(this.mainTableScrollableElement.scrollTop=o,a=!0),a}},{key:"onScroll",value:function(){this.wtSettings.getSetting("onScrollHorizontally")}},{key:"sumCellSizes",value:function(o,i){for(var a=this.wot,l=a.wtTable,s=a.wtSettings,u=s.getSetting("defaultRowHeight"),f=o,c=0;f<i;){var h=l.getRowHeight(f);c+=h===void 0?u:h,f+=1}return c}},{key:"adjustElementsSize",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateTrimmingContainer(),(this.needFullRender||o)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}},{key:"adjustRootElementSize",value:function(){var o=this.wot,i=o.wtTable,a=o.wtViewport,l=this.domBindings,s=l.rootDocument,u=l.rootWindow,f=Zt(s),c=this.clone.wtTable.holder.parentNode,h=c.style,d=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==u||d==="horizontal"){var v=a.getWorkspaceWidth();this.wot.wtOverlays.hasScrollbarRight&&(v-=f),v=Math.min(v,i.wtRootElement.scrollWidth),h.width="".concat(v,"px")}else h.width="";this.clone.wtTable.holder.style.width=h.width;var y=Tt(this.clone.wtTable.TABLE);this.wot.wtTable.hasDefinedSize()||(y=0),h.height="".concat(y,"px")}},{key:"adjustRootChildrenSize",value:function(){var o=this.clone.wtTable.holder;this.clone.wtTable.hider.style.width=this.hider.style.width,o.style.width=o.parentNode.style.width,o.style.height=o.parentNode.style.height}},{key:"applyToDOM",value:function(){var o=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top="".concat(this.wot.wtViewport.rowsRenderCalculator.startPosition,"px");else if(o===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}},{key:"syncOverlayOffset",value:function(){var o=this.isRtl()?"right":"left",i=this.clone.wtTable.spreader;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?i.style[o]="".concat(this.wot.wtViewport.columnsRenderCalculator.startPosition,"px"):i.style[o]=""}},{key:"scrollTo",value:function(o,i){var a=this.getTableParentOffset(),l=this.wot.cloneSource?this.wot.cloneSource:this.wot,s=l.wtTable.holder,u=0;i&&s.offsetHeight!==s.clientHeight&&(u=Zt(this.domBindings.rootDocument)),i?(a+=this.sumCellSizes(0,o+1),a-=this.wot.wtViewport.getViewportHeight(),a+=1):a+=this.sumCellSizes(this.wtSettings.getSetting("fixedRowsBottom"),o),a+=u,this.setScrollPosition(a)}},{key:"getTableParentOffset",value:function(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}},{key:"getScrollPosition",value:function(){return Ig(this.mainTableScrollableElement,this.domBindings.rootWindow)}},{key:"getOverlayOffset",value:function(){var o=this.domBindings.rootWindow,i=this.wtSettings.getSetting("preventOverflow"),a=0;if(this.trimmingContainer===o&&(!i||i!=="vertical")){var l=this.wot.wtTable.getTotalHeight(),s=this.clone.wtTable.getTotalHeight(),u=l-s,f=this.domBindings.rootDocument.documentElement.clientHeight;a=Math.max(this.getTableParentOffset()-this.getScrollPosition()-f+l,0),a>u&&(a=0)}return a}},{key:"adjustHeaderBordersPosition",value:function(o){var i=this.wtSettings.getSetting("fixedRowsBottom"),a=this.cachedFixedRowsBottom!==i,l=this.wtSettings.getSetting("columnHeaders"),s=!1;if((a||i===0)&&l.length>0){var u=this.wot.wtTable.holder.parentNode,f=xe(u,"innerBorderBottom");this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom"),o||this.wtSettings.getSetting("totalRows")===0?(re(u,"innerBorderBottom"),s=!f):(He(u,"innerBorderBottom"),s=f)}return s}}]),r}(sv),xhe="calculatedRows",HV={getFirstRenderedRow:function(){var t=this.dataAccessObject.startRowRendered;return t===null?-1:t},getFirstVisibleRow:function(){var t=this.dataAccessObject.startRowVisible;return t===null?-1:t},getLastRenderedRow:function(){var t=this.dataAccessObject.endRowRendered;return t===null?-1:t},getLastVisibleRow:function(){var t=this.dataAccessObject.endRowVisible;return t===null?-1:t},getRenderedRowsCount:function(){return this.dataAccessObject.countRowsRendered},getVisibleRowsCount:function(){return this.dataAccessObject.countRowsVisible}};Lo(HV,"MIXIN_NAME",xhe,{writable:!1,enumerable:!1});const LV=HV;function ys(e){"@babel/helpers - typeof";return ys=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ys(e)}function I1(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Nhe(n.key),n)}}function Dhe(e,t,r){return t&&I1(e.prototype,t),r&&I1(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Nhe(e){var t=Hhe(e,"string");return ys(t)==="symbol"?t:String(t)}function Hhe(e,t){if(ys(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ys(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Lhe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function jhe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&FC(e,t)}function FC(e,t){return FC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},FC(e,t)}function Fhe(e){var t=Whe();return function(){var n=Zg(e),o;if(t){var i=Zg(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Bhe(this,o)}}function Bhe(e,t){if(t&&(ys(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Vhe(e)}function Vhe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Whe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Zg(e){return Zg=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Zg(e)}var qE=function(e){jhe(r,e);var t=Fhe(r);function r(n,o,i,a){return Lhe(this,r),t.call(this,n,o,i,a,Ia)}return Dhe(r)}(yf);dt(qE,LV);dt(qE,UE);const Uhe=qE;function gs(e){"@babel/helpers - typeof";return gs=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},gs(e)}function Gy(e,t,r){return jV()?Gy=Reflect.construct.bind():Gy=function(o,i,a){var l=[null];l.push.apply(l,i);var s=Function.bind.apply(o,l),u=new s;return a&&Qg(u,a.prototype),u},Gy.apply(null,arguments)}function zhe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function M1(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Ghe(n.key),n)}}function Yhe(e,t,r){return t&&M1(e.prototype,t),r&&M1(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Ghe(e){var t=Khe(e,"string");return gs(t)==="symbol"?t:String(t)}function Khe(e,t){if(gs(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(gs(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function qhe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Qg(e,t)}function Qg(e,t){return Qg=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},Qg(e,t)}function Xhe(e){var t=jV();return function(){var n=Jg(e),o;if(t){var i=Jg(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Zhe(this,o)}}function Zhe(e,t){if(t&&(gs(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Qhe(e)}function Qhe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function jV(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Jg(e){return Jg=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Jg(e)}var Jhe=function(e){qhe(r,e);var t=Xhe(r);function r(n,o,i,a){return zhe(this,r),t.call(this,n,o,Ia,i,a)}return Yhe(r,[{key:"createTable",value:function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return Gy(Uhe,i)}},{key:"shouldBeRendered",value:function(){return this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}},{key:"resetFixedPosition",value:function(){var o=this.wot.wtTable;if(!this.needFullRender||!o.holder.parentNode)return!1;var i=this.domBindings.rootWindow,a=this.clone.wtTable.holder.parentNode,l=this.wtSettings.getSetting("preventOverflow"),s=0;this.trimmingContainer===i&&(!l||l!=="horizontal")?(s=this.getOverlayOffset()*(this.isRtl()?-1:1),DE(a,"".concat(s,"px"),"0px")):(s=this.getScrollPosition(),vp(a));var u=this.adjustHeaderBordersPosition(s);return this.adjustElementsSize(),u}},{key:"setScrollPosition",value:function(o){var i=this.domBindings.rootWindow,a=!1;return this.isRtl()&&(o=-o),this.mainTableScrollableElement===i&&i.scrollX!==o?(i.scrollTo(o,$c(i)),a=!0):this.mainTableScrollableElement.scrollLeft!==o&&(this.mainTableScrollableElement.scrollLeft=o,a=!0),a}},{key:"onScroll",value:function(){this.wtSettings.getSetting("onScrollVertically")}},{key:"sumCellSizes",value:function(o,i){for(var a=this.wtSettings.getSetting("defaultColumnWidth"),l=o,s=0;l<i;)s+=this.wot.wtTable.getStretchedColumnWidth(l)||a,l+=1;return s}},{key:"adjustElementsSize",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateTrimmingContainer(),(this.needFullRender||o)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}},{key:"adjustRootElementSize",value:function(){var o=this.wot.wtTable,i=this.domBindings,a=i.rootDocument,l=i.rootWindow,s=Zt(a),u=this.clone.wtTable.holder.parentNode,f=u.style,c=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==l||c==="vertical"){var h=this.wot.wtViewport.getWorkspaceHeight();this.wot.wtOverlays.hasScrollbarBottom&&(h-=s),h=Math.min(h,o.wtRootElement.scrollHeight),f.height="".concat(h,"px")}else f.height="";this.clone.wtTable.holder.style.height=f.height;var d=ut(this.clone.wtTable.TABLE);f.width="".concat(d,"px")}},{key:"adjustRootChildrenSize",value:function(){var o,i=this.clone.wtTable.holder,a=this.wot.selections,l=this.facadeGetter(),s=Math.abs((o=a==null?void 0:a.getCell().getBorder(l).cornerCenterPointOffset)!==null&&o!==void 0?o:0);this.clone.wtTable.hider.style.height=this.hider.style.height,i.style.height=i.parentNode.style.height,i.style.width="".concat(parseInt(i.parentNode.style.width,10)+s,"px")}},{key:"applyToDOM",value:function(){var o=this.wtSettings.getSetting("totalColumns"),i=this.isRtl()?"right":"left";if(typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number")this.spreader.style[i]="".concat(this.wot.wtViewport.columnsRenderCalculator.startPosition,"px");else if(o===0)this.spreader.style[i]="0";else throw new Error("Incorrect value of the columnsRenderCalculator");this.isRtl()?this.spreader.style.left="":this.spreader.style.right="",this.needFullRender&&this.syncOverlayOffset()}},{key:"syncOverlayOffset",value:function(){typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number"?this.clone.wtTable.spreader.style.top="".concat(this.wot.wtViewport.rowsRenderCalculator.startPosition,"px"):this.clone.wtTable.spreader.style.top=""}},{key:"scrollTo",value:function(o,i){var a=this.getTableParentOffset(),l=this.wot.cloneSource?this.wot.cloneSource:this.wot,s=l.wtTable.holder,u=0;if(i){var f=this.wot.wtTable.getColumnWidth(o),c=this.wot.wtViewport.getViewportWidth();f>c&&(i=!1)}return i&&s.offsetWidth!==s.clientWidth&&(u=Zt(this.domBindings.rootDocument)),i?(a+=this.sumCellSizes(0,o+1),a-=this.wot.wtViewport.getViewportWidth()):a+=this.sumCellSizes(this.wtSettings.getSetting("fixedColumnsStart"),o),a+=u,this.setScrollPosition(a)}},{key:"getTableParentOffset",value:function(){var o=this.wtSettings.getSetting("preventOverflow"),i=0;return!o&&this.trimmingContainer===this.domBindings.rootWindow&&(i=this.wot.wtTable.holderOffset.left),i}},{key:"getScrollPosition",value:function(){return Math.abs(hC(this.mainTableScrollableElement,this.domBindings.rootWindow))}},{key:"getOverlayOffset",value:function(){var o=this.domBindings.rootWindow,i=this.wtSettings.getSetting("preventOverflow"),a=0;if(this.trimmingContainer===o&&(!i||i!=="horizontal")){this.isRtl()?a=Math.abs(Math.min(this.getTableParentOffset()-this.getScrollPosition(),0)):a=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0);var l=this.wot.wtTable.getTotalWidth(),s=this.clone.wtTable.getTotalWidth(),u=l-s;a>u&&(a=0)}return a}},{key:"adjustHeaderBordersPosition",value:function(o){var i=this.wot.wtTable.holder.parentNode,a=this.wtSettings.getSetting("rowHeaders"),l=this.wtSettings.getSetting("fixedColumnsStart"),s=this.wtSettings.getSetting("totalRows");s?He(i,"emptyRows"):re(i,"emptyRows");var u=!1;if(l&&!a.length)re(i,"innerBorderLeft innerBorderInlineStart");else if(!l&&a.length){var f=xe(i,"innerBorderInlineStart");o?(re(i,"innerBorderLeft innerBorderInlineStart"),u=!f):(He(i,"innerBorderLeft innerBorderInlineStart"),u=f)}return u}}]),r}(sv),ede="stickyRowsTop",FV={getFirstRenderedRow:function(){var t=this.wtSettings.getSetting("totalRows");return t===0?-1:0},getFirstVisibleRow:function(){return this.getFirstRenderedRow()},getLastRenderedRow:function(){return this.getRenderedRowsCount()-1},getLastVisibleRow:function(){return this.getLastRenderedRow()},getRenderedRowsCount:function(){var t=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsTop"),t)},getVisibleRowsCount:function(){return this.getRenderedRowsCount()}};Lo(FV,"MIXIN_NAME",ede,{writable:!1,enumerable:!1});const BV=FV;function ms(e){"@babel/helpers - typeof";return ms=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ms(e)}function x1(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,rde(n.key),n)}}function tde(e,t,r){return t&&x1(e.prototype,t),r&&x1(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function rde(e){var t=nde(e,"string");return ms(t)==="symbol"?t:String(t)}function nde(e,t){if(ms(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ms(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ode(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ide(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&BC(e,t)}function BC(e,t){return BC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},BC(e,t)}function ade(e){var t=ude();return function(){var n=em(e),o;if(t){var i=em(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return lde(this,o)}}function lde(e,t){if(t&&(ms(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return sde(e)}function sde(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ude(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function em(e){return em=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},em(e)}var XE=function(e){ide(r,e);var t=ade(r);function r(n,o,i,a){return ode(this,r),t.call(this,n,o,i,a,Ma)}return tde(r)}(yf);dt(XE,BV);dt(XE,UE);const fde=XE;function ps(e){"@babel/helpers - typeof";return ps=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ps(e)}function Ky(e,t,r){return VV()?Ky=Reflect.construct.bind():Ky=function(o,i,a){var l=[null];l.push.apply(l,i);var s=Function.bind.apply(o,l),u=new s;return a&&tm(u,a.prototype),u},Ky.apply(null,arguments)}function cde(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function D1(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,WV(n.key),n)}}function hde(e,t,r){return t&&D1(e.prototype,t),r&&D1(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function dde(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&tm(e,t)}function tm(e,t){return tm=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},tm(e,t)}function vde(e){var t=VV();return function(){var n=rm(e),o;if(t){var i=rm(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return yde(this,o)}}function yde(e,t){if(t&&(ps(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return VC(e)}function VC(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function VV(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function rm(e){return rm=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},rm(e)}function N1(e,t,r){return t=WV(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function WV(e){var t=gde(e,"string");return ps(t)==="symbol"?t:String(t)}function gde(e,t){if(ps(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ps(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var mde=function(e){dde(r,e);var t=vde(r);function r(n,o,i,a,l,s){var u;return cde(this,r),u=t.call(this,n,o,Ma,i,a),N1(VC(u),"topOverlay",void 0),N1(VC(u),"inlineStartOverlay",void 0),u.topOverlay=l,u.inlineStartOverlay=s,u}return hde(r,[{key:"createTable",value:function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return Ky(fde,i)}},{key:"shouldBeRendered",value:function(){return this.wtSettings.getSetting("shouldRenderTopOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}},{key:"resetFixedPosition",value:function(){if(this.updateTrimmingContainer(),!this.wot.wtTable.holder.parentNode)return!1;var o=this.clone.wtTable.holder.parentNode;if(this.trimmingContainer===this.domBindings.rootWindow){var i=this.inlineStartOverlay.getOverlayOffset()*(this.isRtl()?-1:1),a=this.topOverlay.getOverlayOffset();DE(o,"".concat(i,"px"),"".concat(a,"px"))}else vp(o);var l=Tt(this.clone.wtTable.TABLE),s=ut(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(l=0),o.style.height="".concat(l,"px"),o.style.width="".concat(s,"px"),!1}}]),r}(sv);function bs(e){"@babel/helpers - typeof";return bs=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},bs(e)}function H1(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,bde(n.key),n)}}function pde(e,t,r){return t&&H1(e.prototype,t),r&&H1(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function bde(e){var t=wde(e,"string");return bs(t)==="symbol"?t:String(t)}function wde(e,t){if(bs(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(bs(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Sde(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Cde(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&WC(e,t)}function WC(e,t){return WC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},WC(e,t)}function _de(e){var t=Ede();return function(){var n=nm(e),o;if(t){var i=nm(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Ode(this,o)}}function Ode(e,t){if(t&&(bs(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Rde(e)}function Rde(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ede(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function nm(e){return nm=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},nm(e)}var ZE=function(e){Cde(r,e);var t=_de(r);function r(n,o,i,a){return Sde(this,r),t.call(this,n,o,i,a,Aa)}return pde(r)}(yf);dt(ZE,BV);dt(ZE,GE);const Tde=ZE;function ws(e){"@babel/helpers - typeof";return ws=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ws(e)}function qy(e,t,r){return zV()?qy=Reflect.construct.bind():qy=function(o,i,a){var l=[null];l.push.apply(l,i);var s=Function.bind.apply(o,l),u=new s;return a&&om(u,a.prototype),u},qy.apply(null,arguments)}function kde(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function L1(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,YV(n.key),n)}}function Pde(e,t,r){return t&&L1(e.prototype,t),r&&L1(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function $de(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&om(e,t)}function om(e,t){return om=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},om(e,t)}function Ade(e){var t=zV();return function(){var n=im(e),o;if(t){var i=im(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Ide(this,o)}}function Ide(e,t){if(t&&(ws(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return UV(e)}function UV(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function zV(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function im(e){return im=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},im(e)}function Mde(e,t,r){return t=YV(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function YV(e){var t=xde(e,"string");return ws(t)==="symbol"?t:String(t)}function xde(e,t){if(ws(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ws(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Dde=function(e){$de(r,e);var t=Ade(r);function r(n,o,i,a){var l;return kde(this,r),l=t.call(this,n,o,Aa,i,a),Mde(UV(l),"cachedFixedRowsTop",-1),l.cachedFixedRowsTop=l.wtSettings.getSetting("fixedRowsTop"),l}return Pde(r,[{key:"createTable",value:function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return qy(Tde,i)}},{key:"shouldBeRendered",value:function(){return this.wtSettings.getSetting("shouldRenderTopOverlay")}},{key:"resetFixedPosition",value:function(){if(!this.needFullRender||!this.wot.wtTable.holder.parentNode)return!1;var o=this.clone.wtTable.holder.parentNode,i=this.domBindings.rootWindow,a=this.wtSettings.getSetting("preventOverflow"),l=0,s=!1;if(this.trimmingContainer===i&&(!a||a!=="vertical")){var u=this.wot.wtTable,f=u.hider.getBoundingClientRect(),c=Math.ceil(f.bottom),h=o.offsetHeight;s=c===h,l=this.getOverlayOffset(),DE(o,"0px","".concat(l,"px"))}else l=this.getScrollPosition(),vp(o);var d=this.adjustHeaderBordersPosition(l,s);return this.adjustElementsSize(),d}},{key:"setScrollPosition",value:function(o){var i=this.domBindings.rootWindow,a=!1;return this.mainTableScrollableElement===i&&i.scrollY!==o?(i.scrollTo(rs(i),o),a=!0):this.mainTableScrollableElement.scrollTop!==o&&(this.mainTableScrollableElement.scrollTop=o,a=!0),a}},{key:"onScroll",value:function(){this.wtSettings.getSetting("onScrollHorizontally")}},{key:"sumCellSizes",value:function(o,i){for(var a=this.wtSettings.getSetting("defaultRowHeight"),l=o,s=0;l<i;){var u=this.wot.wtTable.getRowHeight(l);s+=u===void 0?a:u,l+=1}return s}},{key:"adjustElementsSize",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateTrimmingContainer(),(this.needFullRender||o)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}},{key:"adjustRootElementSize",value:function(){var o=this.wot.wtTable,i=this.domBindings,a=i.rootDocument,l=i.rootWindow,s=Zt(a),u=this.clone.wtTable.holder.parentNode,f=u.style,c=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==l||c==="horizontal"){var h=this.wot.wtViewport.getWorkspaceWidth();this.wot.wtOverlays.hasScrollbarRight&&(h-=s),h=Math.min(h,o.wtRootElement.scrollWidth),f.width="".concat(h,"px")}else f.width="";this.clone.wtTable.holder.style.width=f.width;var d=Tt(this.clone.wtTable.TABLE);this.wot.wtTable.hasDefinedSize()||(d=0),f.height="".concat(d,"px")}},{key:"adjustRootChildrenSize",value:function(){var o,i=this.clone.wtTable.holder,a=this.wot.selections,l=this.facadeGetter(),s=Math.abs((o=a==null?void 0:a.getCell().getBorder(l).cornerCenterPointOffset)!==null&&o!==void 0?o:0);this.clone.wtTable.hider.style.width=this.hider.style.width,i.style.width=i.parentNode.style.width,i.style.height="".concat(parseInt(i.parentNode.style.height,10)+s,"px")}},{key:"applyToDOM",value:function(){var o=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top="".concat(this.wot.wtViewport.rowsRenderCalculator.startPosition,"px");else if(o===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}},{key:"syncOverlayOffset",value:function(){var o=this.isRtl()?"right":"left",i=this.clone.wtTable.spreader;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?i.style[o]="".concat(this.wot.wtViewport.columnsRenderCalculator.startPosition,"px"):i.style[o]=""}},{key:"scrollTo",value:function(o,i){var a=this.wot,l=this.wtSettings,s=a.cloneSource?a.cloneSource:a,u=s.wtTable.holder,f=this.getTableParentOffset(),c=0;if(i){var h=this.wot.wtTable.getRowHeight(o),d=this.wot.wtViewport.getViewportHeight();h>d&&(i=!1)}if(i&&u.offsetHeight!==u.clientHeight&&(c=Zt(this.domBindings.rootDocument)),i){var v=l.getSetting("fixedRowsBottom"),y=l.getSetting("totalRows");f+=this.sumCellSizes(0,o+1),f-=a.wtViewport.getViewportHeight()-this.sumCellSizes(y-v,y),f+=1}else f+=this.sumCellSizes(l.getSetting("fixedRowsTop"),o);return f+=c,this.setScrollPosition(f)}},{key:"getTableParentOffset",value:function(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}},{key:"getScrollPosition",value:function(){return Ig(this.mainTableScrollableElement,this.domBindings.rootWindow)}},{key:"getOverlayOffset",value:function(){var o=this.domBindings.rootWindow,i=this.wtSettings.getSetting("preventOverflow"),a=0;if(this.trimmingContainer===o&&(!i||i!=="vertical")){var l=this.wot.wtTable.getTotalHeight(),s=this.clone.wtTable.getTotalHeight(),u=l-s;a=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0),a>u&&(a=0)}return a}},{key:"adjustHeaderBordersPosition",value:function(o){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,a=this.wot.wtTable.holder.parentNode,l=this.wtSettings.getSetting("totalColumns");l?He(a,"emptyColumns"):re(a,"emptyColumns");var s=!1;if(!i){var u=this.wtSettings.getSetting("fixedRowsTop"),f=this.cachedFixedRowsTop!==u,c=this.wtSettings.getSetting("columnHeaders");if((f||u===0)&&c.length>0){var h=xe(a,"innerBorderTop");this.cachedFixedRowsTop=this.wtSettings.getSetting("fixedRowsTop"),o||this.wtSettings.getSetting("totalRows")===0?(re(a,"innerBorderTop"),s=!h):(He(a,"innerBorderTop"),s=h)}}return s}}]),r}(sv);function rh(e){"@babel/helpers - typeof";return rh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},rh(e)}function ti(e,t,r){return Nde()?ti=Reflect.construct.bind():ti=function(o,i,a){var l=[null];l.push.apply(l,i);var s=Function.bind.apply(o,l),u=new s;return a&&UC(u,a.prototype),u},ti.apply(null,arguments)}function Nde(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function UC(e,t){return UC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},UC(e,t)}function Hde(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function j1(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,GV(n.key),n)}}function Lde(e,t,r){return t&&j1(e.prototype,t),r&&j1(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Un(e,t,r){return t=GV(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function GV(e){var t=jde(e,"string");return rh(t)==="symbol"?t:String(t)}function jde(e,t){if(rh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(rh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Fde=function(){function e(t,r,n,o,i,a){var l=this;Hde(this,e),Un(this,"wot",null),Un(this,"topOverlay",null),Un(this,"bottomOverlay",null),Un(this,"inlineStartOverlay",null),Un(this,"topInlineStartCornerOverlay",null),Un(this,"bottomInlineStartCornerOverlay",null),Un(this,"browserLineHeight",void 0),Un(this,"wtSettings",null),Un(this,"resizeObserver",new ResizeObserver(function(h){uE(function(){!Array.isArray(h)||!h.length||l.wtSettings.getSetting("onContainerElementResize")})})),this.wot=t,this.wtSettings=o,this.domBindings=n,this.facadeGetter=r,this.wtTable=a;var s=this.domBindings,u=s.rootDocument,f=s.rootWindow;this.instance=this.wot,this.eventManager=i,this.scrollbarSize=Zt(u);var c=f.getComputedStyle(a.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden";this.scrollableElement=c?a.holder:Mg(a.TABLE),this.initOverlays(),this.hasScrollbarBottom=!1,this.hasScrollbarRight=!1,this.destroyed=!1,this.keyPressed=!1,this.spreaderLastSize={width:null,height:null},this.verticalScrolling=!1,this.horizontalScrolling=!1,this.initBrowserLineHeight(),this.registerListeners(),this.lastScrollX=f.scrollX,this.lastScrollY=f.scrollY}return Lde(e,[{key:"getOverlays",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=[this.topOverlay,this.topInlineStartCornerOverlay,this.inlineStartOverlay,this.bottomOverlay,this.bottomInlineStartCornerOverlay];return r&&n.push(this.wtTable),n}},{key:"initBrowserLineHeight",value:function(){var r=this.domBindings,n=r.rootWindow,o=r.rootDocument,i=n.getComputedStyle(o.body),a=parseInt(i.lineHeight,10),l=parseInt(i.fontSize,10)*1.2;this.browserLineHeight=a||l}},{key:"initOverlays",value:function(){var r=[this.wot,this.facadeGetter,this.wtSettings,this.domBindings];this.topOverlay=ti(Dde,r),this.bottomOverlay=ti(Mhe,r),this.inlineStartOverlay=ti(Jhe,r),this.topInlineStartCornerOverlay=ti(mde,r.concat([this.topOverlay,this.inlineStartOverlay])),this.bottomInlineStartCornerOverlay=ti(vhe,r.concat([this.bottomOverlay,this.inlineStartOverlay]))}},{key:"updateStateOfRendering",value:function(){var r=this.topOverlay.updateStateOfRendering();return r=this.bottomOverlay.updateStateOfRendering()||r,r=this.inlineStartOverlay.updateStateOfRendering()||r,this.inlineStartOverlay.needFullRender&&(this.topOverlay.needFullRender&&(r=this.topInlineStartCornerOverlay.updateStateOfRendering()||r),this.bottomOverlay.needFullRender&&(r=this.bottomInlineStartCornerOverlay.updateStateOfRendering()||r)),r}},{key:"refreshAll",value:function(){if(this.wot.drawn){if(!this.wtTable.holder.parentNode){this.destroy();return}this.wot.draw(!0),this.verticalScrolling&&this.inlineStartOverlay.onScroll(),this.horizontalScrolling&&this.topOverlay.onScroll(),this.verticalScrolling=!1,this.horizontalScrolling=!1}}},{key:"registerListeners",value:function(){var r=this,n=this.domBindings,o=n.rootDocument,i=n.rootWindow,a=this.topOverlay.mainTableScrollableElement,l=this.inlineStartOverlay.mainTableScrollableElement;this.eventManager.addEventListener(o.documentElement,"keydown",function(v){return r.onKeyDown(v)}),this.eventManager.addEventListener(o.documentElement,"keyup",function(){return r.onKeyUp()}),this.eventManager.addEventListener(o,"visibilitychange",function(){return r.onKeyUp()}),this.eventManager.addEventListener(a,"scroll",function(v){return r.onTableScroll(v)},{passive:!0}),a!==l&&this.eventManager.addEventListener(l,"scroll",function(v){return r.onTableScroll(v)},{passive:!0});var s=i.devicePixelRatio&&i.devicePixelRatio>1,u=this.scrollableElement===i,f=this.wtSettings.getSetting("preventWheel"),c={passive:u};(f||s||!IF())&&this.eventManager.addEventListener(this.wtTable.wtRootElement,"wheel",function(v){return r.onCloneWheel(v,f)},c);var h=[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];h.forEach(function(v){if(v&&v.needFullRender){var y=v.clone.wtTable.holder;r.eventManager.addEventListener(y,"wheel",function(p){return r.onCloneWheel(p,f)},c)}});var d;this.eventManager.addEventListener(i,"resize",function(){clearTimeout(d),d=setTimeout(function(){r.wtSettings.getSetting("onWindowResize")},200)}),u||this.resizeObserver.observe(this.wtTable.wtRootElement.parentElement)}},{key:"deregisterListeners",value:function(){this.eventManager.clearEvents(!0)}},{key:"onTableScroll",value:function(r){var n=this.domBindings.rootWindow,o=this.inlineStartOverlay.mainTableScrollableElement,i=this.topOverlay.mainTableScrollableElement,a=r.target;this.keyPressed&&(i!==n&&a!==n&&!r.target.contains(i)||o!==n&&a!==n&&!r.target.contains(o))||this.syncScrollPositions(r)}},{key:"onCloneWheel",value:function(r,n){var o=this.domBindings.rootWindow,i=this.inlineStartOverlay.mainTableScrollableElement,a=this.topOverlay.mainTableScrollableElement,l=r.target,s=a!==o&&l!==o&&!l.contains(a),u=i!==o&&l!==o&&!l.contains(i);if(!(this.keyPressed&&(s||u))){var f=this.translateMouseWheelToScroll(r);(n||this.scrollableElement!==o&&f)&&r.preventDefault()}}},{key:"onKeyDown",value:function(r){this.keyPressed=Ic(r.keyCode,"ARROW_UP|ARROW_RIGHT|ARROW_DOWN|ARROW_LEFT")}},{key:"onKeyUp",value:function(){this.keyPressed=!1}},{key:"translateMouseWheelToScroll",value:function(r){var n=isNaN(r.deltaY)?-1*r.wheelDeltaY:r.deltaY,o=isNaN(r.deltaX)?-1*r.wheelDeltaX:r.deltaX;r.deltaMode===1&&(o+=o*this.browserLineHeight,n+=n*this.browserLineHeight);var i=this.scrollVertically(n),a=this.scrollHorizontally(o);return i||a}},{key:"scrollVertically",value:function(r){var n=this.scrollableElement.scrollTop;return this.scrollableElement.scrollTop+=r,n!==this.scrollableElement.scrollTop}},{key:"scrollHorizontally",value:function(r){var n=this.scrollableElement.scrollLeft;return this.scrollableElement.scrollLeft+=r,n!==this.scrollableElement.scrollLeft}},{key:"syncScrollPositions",value:function(){if(!this.destroyed){var r=this.domBindings.rootWindow,n=this.topOverlay.clone.wtTable.holder,o=this.inlineStartOverlay.clone.wtTable.holder,i=[this.scrollableElement.scrollLeft,this.scrollableElement.scrollTop],a=i[0],l=i[1];if(this.horizontalScrolling=n.scrollLeft!==a||this.lastScrollX!==r.scrollX,this.verticalScrolling=o.scrollTop!==l||this.lastScrollY!==r.scrollY,this.lastScrollX=r.scrollX,this.lastScrollY=r.scrollY,this.horizontalScrolling){n.scrollLeft=a;var s=this.bottomOverlay.needFullRender?this.bottomOverlay.clone.wtTable.holder:null;s&&(s.scrollLeft=a)}this.verticalScrolling&&(o.scrollTop=l),this.refreshAll()}}},{key:"syncScrollWithMaster",value:function(){var r=this.topOverlay.mainTableScrollableElement,n=r.scrollLeft,o=r.scrollTop;this.topOverlay.needFullRender&&(this.topOverlay.clone.wtTable.holder.scrollLeft=n),this.bottomOverlay.needFullRender&&(this.bottomOverlay.clone.wtTable.holder.scrollLeft=n),this.inlineStartOverlay.needFullRender&&(this.inlineStartOverlay.clone.wtTable.holder.scrollTop=o)}},{key:"updateMainScrollableElements",value:function(){this.deregisterListeners(),this.inlineStartOverlay.updateMainScrollableElement(),this.topOverlay.updateMainScrollableElement(),this.bottomOverlay.needFullRender&&this.bottomOverlay.updateMainScrollableElement();var r=this.wtTable,n=this.domBindings.rootWindow;n.getComputedStyle(r.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.scrollableElement=r.holder:this.scrollableElement=Mg(r.TABLE),this.registerListeners()}},{key:"destroy",value:function(){this.resizeObserver.disconnect(),this.eventManager.destroy(),this.topOverlay.destroy(),this.bottomOverlay.clone&&this.bottomOverlay.destroy(),this.inlineStartOverlay.destroy(),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.destroy(),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.destroy(),this.destroyed=!0}},{key:"refresh",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=this.updateLastSpreaderSize();n&&this.adjustElementsSize(),this.bottomOverlay.clone&&this.bottomOverlay.refresh(r),this.inlineStartOverlay.refresh(r),this.topOverlay.refresh(r),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.refresh(r),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.refresh(r)}},{key:"updateLastSpreaderSize",value:function(){var r=this.wtTable.spreader,n=r.clientWidth,o=r.clientHeight,i=n!==this.spreaderLastSize.width||o!==this.spreaderLastSize.height;return i&&(this.spreaderLastSize.width=n,this.spreaderLastSize.height=o),i}},{key:"adjustElementsSize",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=this.wot.wtViewport,o=this.wtTable,i=this.wtSettings.getSetting("totalColumns"),a=this.wtSettings.getSetting("totalRows"),l=n.getRowHeaderWidth(),s=n.getColumnHeaderHeight(),u=o.hider.style;if(u.width="".concat(l+this.inlineStartOverlay.sumCellSizes(0,i),"px"),u.height="".concat(s+this.topOverlay.sumCellSizes(0,a)+1,"px"),this.scrollbarSize>0){var f=o.wtRootElement,c=f.scrollHeight,h=f.scrollWidth,d=o.holder,v=d.scrollHeight,y=d.scrollWidth;this.hasScrollbarRight=c<v,this.hasScrollbarBottom=h<y,this.hasScrollbarRight&&o.hider.scrollWidth+this.scrollbarSize>h?this.hasScrollbarBottom=!0:this.hasScrollbarBottom&&o.hider.scrollHeight+this.scrollbarSize>c&&(this.hasScrollbarRight=!0)}this.topOverlay.adjustElementsSize(r),this.inlineStartOverlay.adjustElementsSize(r),this.bottomOverlay.adjustElementsSize(r)}},{key:"applyToDOM",value:function(){this.wtTable.isVisible()&&(this.topOverlay.applyToDOM(),this.bottomOverlay.clone&&this.bottomOverlay.applyToDOM(),this.inlineStartOverlay.applyToDOM())}},{key:"getParentOverlay",value:function(r){if(!r)return null;var n=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay],o=null;return I(n,function(i){i&&i.clone&&i.clone.wtTable.TABLE.contains(r)&&(o=i.clone)}),o}},{key:"syncOverlayTableClassNames",value:function(){var r=this.wtTable.TABLE,n=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];I(n,function(o){o&&(o.clone.wtTable.TABLE.className=r.className)})}}]),e}();const Bde=Fde;function nh(e){"@babel/helpers - typeof";return nh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},nh(e)}function Vde(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function F1(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,KV(n.key),n)}}function Wde(e,t,r){return t&&F1(e.prototype,t),r&&F1(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function B1(e,t,r){return t=KV(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function KV(e){var t=Ude(e,"string");return nh(t)==="symbol"?t:String(t)}function Ude(e,t){if(nh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(nh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var zde=function(){function e(t){var r=this;Vde(this,e),B1(this,"settings",{}),B1(this,"defaults",Object.freeze(this.getDefaults())),Ke(this.defaults,function(n,o){if(t[o]!==void 0)r.settings[o]=t[o];else{if(n===void 0)throw new Error('A required setting "'.concat(o,'" was not provided'));r.settings[o]=n}})}return Wde(e,[{key:"getDefaults",value:function(){var r=this;return{facade:void 0,table:void 0,isDataViewInstance:!0,externalRowCalculator:!1,stretchH:"none",currentRowClassName:null,currentColumnClassName:null,preventOverflow:function(){return!1},preventWheel:!1,data:void 0,freezeOverlays:!1,fixedColumnsStart:0,fixedRowsTop:0,fixedRowsBottom:0,shouldRenderInlineStartOverlay:function(){return r.getSetting("fixedColumnsStart")>0||r.getSetting("rowHeaders").length>0},shouldRenderTopOverlay:function(){return r.getSetting("fixedRowsTop")>0||r.getSetting("columnHeaders").length>0},shouldRenderBottomOverlay:function(){return r.getSetting("fixedRowsBottom")>0},minSpareRows:0,rowHeaders:function(){return[]},columnHeaders:function(){return[]},totalRows:void 0,totalColumns:void 0,cellRenderer:function(o,i,a){var l=r.getSetting("data",o,i);ka(a,l??"")},columnWidth:function(){},rowHeight:function(){},defaultRowHeight:23,defaultColumnWidth:50,selections:null,hideBorderOnMouseDownOver:!1,viewportRowCalculatorOverride:null,viewportColumnCalculatorOverride:null,onCellMouseDown:null,onCellContextMenu:null,onCellMouseOver:null,onCellMouseOut:null,onCellMouseUp:null,onCellDblClick:null,onCellCornerMouseDown:null,onCellCornerDblClick:null,beforeDraw:null,onDraw:null,onBeforeRemoveCellClassNames:null,onAfterDrawSelection:null,onBeforeDrawBorders:null,onScrollVertically:null,onScrollHorizontally:null,onBeforeTouchScroll:null,onAfterMomentumScroll:null,onBeforeStretchingColumnWidth:function(o){return o},onModifyRowHeaderWidth:null,onModifyGetCellCoords:null,onBeforeHighlightingRowHeader:function(o){return o},onBeforeHighlightingColumnHeader:function(o){return o},onWindowResize:null,onContainerElementResize:null,renderAllRows:!1,groups:!1,rowHeaderWidth:null,columnHeaderHeight:null,headerClassName:null,rtlMode:!1}}},{key:"update",value:function(r,n){var o=this;return n===void 0?Ke(r,function(i,a){o.settings[a]=i}):this.settings[r]=n,this}},{key:"getSetting",value:function(r,n,o,i,a){return typeof this.settings[r]=="function"?this.settings[r](n,o,i,a):n!==void 0&&Array.isArray(this.settings[r])?this.settings[r][n]:this.settings[r]}},{key:"getSettingPure",value:function(r){return this.settings[r]}},{key:"has",value:function(r){return!!this.settings[r]}}]),e}();function Ss(e){"@babel/helpers - typeof";return Ss=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ss(e)}function Yde(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function V1(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Kde(n.key),n)}}function Gde(e,t,r){return t&&V1(e.prototype,t),r&&V1(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Kde(e){var t=qde(e,"string");return Ss(t)==="symbol"?t:String(t)}function qde(e,t){if(Ss(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ss(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Xde(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&zC(e,t)}function zC(e,t){return zC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},zC(e,t)}function Zde(e){var t=eve();return function(){var n=am(e),o;if(t){var i=am(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Qde(this,o)}}function Qde(e,t){if(t&&(Ss(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Jde(e)}function Jde(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function eve(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function am(e){return am=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},am(e)}var QE=function(e){Xde(r,e);var t=Zde(r);function r(n,o,i,a){return Yde(this,r),t.call(this,n,o,i,a,"master")}return Gde(r,[{key:"alignOverlaysWithTrimmingContainer",value:function(){var o=ns(this.wtRootElement),i=this.domBindings.rootWindow;if(o===i){var a=this.wtSettings.getSetting("preventOverflow");a||(this.holder.style.overflow="visible",this.wtRootElement.style.overflow="visible")}else{var l=o.parentElement,s=Ac(o,"height",i),u=Ac(o,"overflow",i),f=this.holder.style,c=o.scrollWidth,h=o.scrollHeight,d=o.getBoundingClientRect(),v=d.width,y=d.height,p=["auto","hidden","scroll"];if(l&&p.includes(u)){var w=o.cloneNode(!1);w.style.overflow="auto",w.style.position="absolute",o.nextElementSibling?l.insertBefore(w,o.nextElementSibling):l.appendChild(w);var S=parseInt(Pa(w,i).height,10);l.removeChild(w),S===0&&(y=0)}y=Math.min(y,h),f.height=s==="auto"?"auto":"".concat(y,"px"),v=Math.min(v,c),f.width="".concat(v,"px"),f.overflow="",this.hasTableHeight=f.height==="auto"?!0:y>0,this.hasTableWidth=v>0}this.isTableVisible=Pc(this.TABLE)}},{key:"markOversizedColumnHeaders",value:function(){var o=this.wtSettings,i=this.dataAccessObject.wtViewport,a="master",l=o.getSetting("columnHeaders"),s=l.length;if(s&&!i.hasOversizedColumnHeadersMarked[a]){for(var u=o.getSetting("rowHeaders"),f=u.length,c=this.getRenderedColumnsCount(),h=0;h<s;h++)for(var d=-1*f;d<c;d++)this.markIfOversizedColumnHeader(d);i.hasOversizedColumnHeadersMarked[a]=!0}}}]),r}(yf);dt(QE,LV);dt(QE,GE);const tve=QE;function oh(e){"@babel/helpers - typeof";return oh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},oh(e)}function rve(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function W1(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,ove(n.key),n)}}function nve(e,t,r){return t&&W1(e.prototype,t),r&&W1(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function ove(e){var t=ive(e,"string");return oh(t)==="symbol"?t:String(t)}function ive(e,t){if(oh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(oh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var ave=function(){function e(t,r,n,o,i){var a=this;rve(this,e),this.dataAccessObject=t,this.wot=t.wot,this.instance=this.wot,this.domBindings=r,this.wtSettings=n,this.wtTable=i,this.oversizedRows=[],this.oversizedColumnHeaders=[],this.hasOversizedColumnHeadersMarked={},this.clientHeight=0,this.containerWidth=NaN,this.rowHeaderWidth=NaN,this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,this.eventManager=o,this.eventManager.addEventListener(this.domBindings.rootWindow,"resize",function(){a.clientHeight=a.getWorkspaceHeight()})}return nve(e,[{key:"getWorkspaceHeight",value:function(){var r=this.domBindings.rootDocument,n=this.dataAccessObject.topOverlayTrimmingContainer,o=0;if(n===this.domBindings.rootWindow)o=r.documentElement.clientHeight;else{var i=Tt(n);o=i>0&&n.clientHeight>0?n.clientHeight:1/0}return o}},{key:"getWorkspaceWidth",value:function(){var r=this.wtSettings,n=this.domBindings,o=n.rootDocument,i=n.rootWindow,a=this.dataAccessObject.inlineStartOverlayTrimmingContainer,l=o.documentElement.offsetWidth,s=r.getSetting("totalColumns"),u=r.getSetting("preventOverflow"),f=r.getSetting("rtlMode"),c=this.wtTable.TABLE.getBoundingClientRect(),h=f?c.right-l:c.left,d=l-h,v,y;if(u)return ut(this.wtTable.wtRootElement);if(r.getSetting("freezeOverlays")?v=Math.min(d,l):v=Math.min(this.getContainerFillWidth(),d,l),a===i&&s>0&&this.sumColumnWidths(0,s-1)>v)return o.documentElement.clientWidth;if(a!==i&&(y=Ac(this.dataAccessObject.inlineStartOverlayTrimmingContainer,"overflow",i),y==="scroll"||y==="hidden"||y==="auto"))return Math.max(v,a.clientWidth);var p=r.getSetting("stretchH");return p==="none"||!p?Math.max(v,ut(this.wtTable.TABLE)):v}},{key:"hasVerticalScroll",value:function(){return this.wtTable.hider.offsetHeight>this.getWorkspaceHeight()}},{key:"hasHorizontalScroll",value:function(){return this.wtTable.hider.offsetWidth>this.getWorkspaceWidth()}},{key:"sumColumnWidths",value:function(r,n){for(var o=0,i=r;i<n;)o+=this.wtTable.getColumnWidth(i),i+=1;return o}},{key:"getContainerFillWidth",value:function(){if(this.containerWidth)return this.containerWidth;var r=this.wtTable.holder,n=this.domBindings.rootDocument.createElement("div");n.style.width="100%",n.style.height="1px",r.appendChild(n);var o=n.offsetWidth;return this.containerWidth=o,r.removeChild(n),o}},{key:"getWorkspaceOffset",value:function(){return Vt(this.wtTable.TABLE)}},{key:"getColumnHeaderHeight",value:function(){var r=this.wtSettings.getSetting("columnHeaders");return r.length?isNaN(this.columnHeaderHeight)&&(this.columnHeaderHeight=Tt(this.wtTable.THEAD)):this.columnHeaderHeight=0,this.columnHeaderHeight}},{key:"getViewportHeight",value:function(){var r=this.getWorkspaceHeight();if(r===1/0)return r;var n=this.getColumnHeaderHeight();return n>0&&(r-=n),r}},{key:"getRowHeaderWidth",value:function(){var r=this.wtSettings.getSetting("rowHeaderWidth"),n=this.wtSettings.getSetting("rowHeaders");if(r){this.rowHeaderWidth=0;for(var o=0,i=n.length;o<i;o++)this.rowHeaderWidth+=r[o]||r}if(isNaN(this.rowHeaderWidth))if(n.length){var a=this.wtTable.TABLE.querySelector("TH");this.rowHeaderWidth=0;for(var l=0,s=n.length;l<s;l++)a?(this.rowHeaderWidth+=ut(a),a=a.nextSibling):this.rowHeaderWidth+=50}else this.rowHeaderWidth=0;return this.rowHeaderWidth=this.wtSettings.getSetting("onModifyRowHeaderWidth",this.rowHeaderWidth)||this.rowHeaderWidth,this.rowHeaderWidth}},{key:"getViewportWidth",value:function(){var r=this.getWorkspaceWidth();if(r===1/0)return r;var n=this.getRowHeaderWidth();return n>0?r-n:r}},{key:"createRowsCalculator",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Ki,n=this.wtSettings,o=this.wtTable,i,a,l;this.rowHeaderWidth=NaN,n.getSetting("renderAllRows")&&r===Ki?i=1/0:i=this.getViewportHeight();var s=this.dataAccessObject.topScrollPosition-this.dataAccessObject.topParentOffset,u=n.getSetting("fixedRowsTop"),f=n.getSetting("fixedRowsBottom"),c=n.getSetting("totalRows");return u&&s>=0&&(l=this.dataAccessObject.topOverlay.sumCellSizes(0,u),s+=l,i-=l),f&&this.dataAccessObject.bottomOverlay.clone&&(l=this.dataAccessObject.bottomOverlay.sumCellSizes(c-f,c),i-=l),o.holder.clientHeight===o.holder.offsetHeight?a=0:a=Zt(this.domBindings.rootDocument),new fV({viewportSize:i,scrollOffset:s,totalItems:n.getSetting("totalRows"),itemSizeFn:function(d){return o.getRowHeight(d)},overrideFn:n.getSettingPure("viewportRowCalculatorOverride"),calculationType:r,scrollbarHeight:a})}},{key:"createColumnsCalculator",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Ki,n=this.wtSettings,o=this.wtTable,i=this.getViewportWidth(),a=Math.abs(this.dataAccessObject.inlineStartScrollPosition)-this.dataAccessObject.inlineStartParentOffset;this.columnHeaderHeight=NaN;var l=n.getSetting("fixedColumnsStart");if(l&&a>=0){var s=this.dataAccessObject.inlineStartOverlay.sumCellSizes(0,l);a+=s,i-=s}return o.holder.clientWidth!==o.holder.offsetWidth&&(i-=Zt(this.domBindings.rootDocument)),new BE({viewportSize:i,scrollOffset:a,totalItems:n.getSetting("totalColumns"),itemSizeFn:function(f){return o.getColumnWidth(f)},overrideFn:n.getSettingPure("viewportColumnCalculatorOverride"),calculationType:r,stretchMode:n.getSetting("stretchH"),stretchingItemWidthFn:function(f,c){return n.getSetting("onBeforeStretchingColumnWidth",f,c)},inlineStartOffset:this.dataAccessObject.inlineStartParentOffset})}},{key:"createRenderCalculators",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=r;if(n){var o=this.createRowsCalculator(tr),i=this.createColumnsCalculator(tr);this.areAllProposedVisibleRowsAlreadyRendered(o)&&this.areAllProposedVisibleColumnsAlreadyRendered(i)||(n=!1)}return n||(this.rowsRenderCalculator=this.createRowsCalculator(Ki),this.columnsRenderCalculator=this.createColumnsCalculator(Ki)),this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,n}},{key:"createVisibleCalculators",value:function(){this.rowsVisibleCalculator=this.createRowsCalculator(tr),this.columnsVisibleCalculator=this.createColumnsCalculator(tr)}},{key:"areAllProposedVisibleRowsAlreadyRendered",value:function(r){if(!this.rowsVisibleCalculator)return!1;var n=r.startRow,o=r.endRow,i=r.isVisibleInTrimmingContainer;if(n===null&&o===null)return!i;var a=this.rowsRenderCalculator,l=a.startRow,s=a.endRow;return n<l||n===l&&n>0?!1:!(o>s||o===s&&o<this.wtSettings.getSetting("totalRows")-1)}},{key:"areAllProposedVisibleColumnsAlreadyRendered",value:function(r){if(!this.columnsVisibleCalculator)return!1;var n=r.startColumn,o=r.endColumn,i=r.isVisibleInTrimmingContainer;if(n===null&&o===null)return!i;var a=this.columnsRenderCalculator,l=a.startColumn,s=a.endColumn;return n<l||n===l&&n>0?!1:!(o>s||o===s&&o<this.wtSettings.getSetting("totalColumns")-1)}},{key:"resetHasOversizedColumnHeadersMarked",value:function(){Ke(this.hasOversizedColumnHeadersMarked,function(r,n,o){o[n]=void 0})}}]),e}();const lve=ave;function Cs(e){"@babel/helpers - typeof";return Cs=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Cs(e)}function sve(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function U1(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,fve(n.key),n)}}function uve(e,t,r){return t&&U1(e.prototype,t),r&&U1(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function fve(e){var t=cve(e,"string");return Cs(t)==="symbol"?t:String(t)}function cve(e,t){if(Cs(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Cs(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function hve(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&YC(e,t)}function YC(e,t){return YC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},YC(e,t)}function dve(e){var t=yve();return function(){var n=lm(e),o;if(t){var i=lm(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return vve(this,o)}}function vve(e,t){if(t&&(Cs(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return GC(e)}function GC(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function yve(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function lm(e){return lm=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},lm(e)}var gve=function(e){hve(r,e);var t=dve(r);function r(n,o){var i;sve(this,r),i=t.call(this,n,new zde(o));var a=i.wtSettings.getSetting("facade",GC(i));return i.wtTable=new tve(i.getTableDao(),a,i.domBindings,i.wtSettings),i.wtViewport=new lve(i.getViewportDao(),i.domBindings,i.wtSettings,i.eventManager,i.wtTable),i.selections=i.wtSettings.getSetting("selections"),i.wtEvent=new wV(a,i.domBindings,i.wtSettings,i.eventManager,i.wtTable,i.selections),i.wtOverlays=new Bde(GC(i),a,i.domBindings,i.wtSettings,i.eventManager,i.wtTable),i.exportSettingsAsClassNames(),i.findOriginalHeaders(),i}return uve(r,[{key:"exportSettingsAsClassNames",value:function(){var o=this,i={rowHeaders:"htRowHeaders",columnHeaders:"htColumnHeaders"},a=[],l=[];Ke(i,function(s,u){o.wtSettings.getSetting(u).length&&l.push(s),a.push(s)}),He(this.wtTable.wtRootElement.parentNode,a),re(this.wtTable.wtRootElement.parentNode,l)}},{key:"getViewportDao",value:function(){var o=this;return{get wot(){return o},get topOverlayTrimmingContainer(){return o.wtOverlays.topOverlay.trimmingContainer},get inlineStartOverlayTrimmingContainer(){return o.wtOverlays.inlineStartOverlay.trimmingContainer},get topScrollPosition(){return o.wtOverlays.topOverlay.getScrollPosition()},get topParentOffset(){return o.wtOverlays.topOverlay.getTableParentOffset()},get inlineStartScrollPosition(){return o.wtOverlays.inlineStartOverlay.getScrollPosition()},get inlineStartParentOffset(){return o.wtOverlays.inlineStartOverlay.getTableParentOffset()},get topOverlay(){return o.wtOverlays.topOverlay},get inlineStartOverlay(){return o.wtOverlays.inlineStartOverlay},get bottomOverlay(){return o.wtOverlays.bottomOverlay}}}}]),r}(YE);function ih(e){"@babel/helpers - typeof";return ih=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ih(e)}function mve(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function z1(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,bve(n.key),n)}}function pve(e,t,r){return t&&z1(e.prototype,t),r&&z1(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function bve(e){var t=wve(e,"string");return ih(t)==="symbol"?t:String(t)}function wve(e,t){if(ih(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ih(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Sve=function(){function e(t){mve(this,e),t instanceof YE?this._wot=t:this._initFromSettings(t)}return pve(e,[{key:"_initFromSettings",value:function(r){r.facade=function(n){var o=new e(n);return function(){return o}},this._wot=new gve(r.table,r)}},{key:"guid",get:function(){return this._wot.guid}},{key:"rootDocument",get:function(){return this._wot.domBindings.rootDocument}},{key:"rootWindow",get:function(){return this._wot.domBindings.rootWindow}},{key:"wtSettings",get:function(){return this._wot.wtSettings}},{key:"cloneSource",get:function(){return this._wot.cloneSource}},{key:"cloneOverlay",get:function(){return this._wot.cloneOverlay}},{key:"selections",get:function(){return this._wot.selections}},{key:"wtViewport",get:function(){return this._wot.wtViewport}},{key:"wtOverlays",get:function(){return this._wot.wtOverlays}},{key:"wtTable",get:function(){return this._wot.wtTable}},{key:"wtEvent",get:function(){return this._wot.wtEvent}},{key:"wtScroll",get:function(){return this._wot.wtScroll}},{key:"drawn",get:function(){return this._wot.drawn},set:function(r){this._wot.drawn=r}},{key:"drawInterrupted",get:function(){return this._wot.drawInterrupted},set:function(r){this._wot.drawInterrupted=r}},{key:"lastMouseOver",get:function(){return this._wot.lastMouseOver},set:function(r){this._wot.lastMouseOver=r}},{key:"momentumScrolling",get:function(){return this._wot.momentumScrolling},set:function(r){this._wot.momentumScrolling=r}},{key:"touchApplied",get:function(){return this._wot.touchApplied},set:function(r){this._wot.touchApplied=r}},{key:"domBindings",get:function(){return this._wot.domBindings}},{key:"eventListeners",get:function(){return this._wot.eventListeners},set:function(r){this._wot.eventListeners=r}},{key:"eventManager",get:function(){return this._wot.eventManager}},{key:"createCellCoords",value:function(r,n){return this._wot.createCellCoords(r,n)}},{key:"createCellRange",value:function(r,n,o){return this._wot.createCellRange(r,n,o)}},{key:"draw",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this._wot.draw(r),this}},{key:"getCell",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this._wot.getCell(r,n)}},{key:"scrollViewport",value:function(r,n,o,i,a){return this._wot.scrollViewport(r,n,o,i,a)}},{key:"scrollViewportHorizontally",value:function(r,n,o){return this._wot.scrollViewportHorizontally(r,n,o)}},{key:"scrollViewportVertically",value:function(r,n,o){return this._wot.scrollViewportVertically(r,n,o)}},{key:"getViewport",value:function(){return this._wot.getViewport()}},{key:"getOverlayName",value:function(){return this._wot.cloneOverlay?this._wot.cloneOverlay.type:"master"}},{key:"exportSettingsAsClassNames",value:function(){return this._wot.exportSettingsAsClassNames()}},{key:"update",value:function(r,n){return this._wot.wtSettings.update(r,n),this}},{key:"getSetting",value:function(r,n,o,i,a){return this._wot.wtSettings.getSetting(r,n,o,i,a)}},{key:"hasSetting",value:function(r){return this._wot.wtSettings.hasSetting(r)}},{key:"destroy",value:function(){this._wot.destroy()}}]),e}(),qV=jt,Cve=Le,XV=Ve,_ve=Vd,Ove=xd,Rve=Lr,Eve=Ld.f,ZV=XV(Eve),Tve=XV([].push),kve=qV&&Cve(function(){var e=Object.create(null);return e[2]=2,!ZV(e,2)}),Y1=function(e){return function(t){for(var r=Rve(t),n=Ove(r),o=kve&&_ve(r)===null,i=n.length,a=0,l=[],s;i>a;)s=n[a++],(!qV||(o?s in r:ZV(r,s)))&&Tve(l,e?[s,r[s]]:r[s]);return l}},Pve={entries:Y1(!0),values:Y1(!1)},$ve=$e,Ave=Pve.values;$ve({target:"Object",stat:!0},{values:function(t){return Ave(t)}});function ah(e){"@babel/helpers - typeof";return ah=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ah(e)}function aw(e,t){return Dve(e)||xve(e,t)||Mve(e,t)||Ive()}function Ive(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Mve(e,t){if(e){if(typeof e=="string")return G1(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return G1(e,t)}}function G1(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function xve(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function Dve(e){if(Array.isArray(e))return e}function Nve(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function K1(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Lve(n.key),n)}}function Hve(e,t,r){return t&&K1(e.prototype,t),r&&K1(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Lve(e){var t=jve(e,"string");return ah(t)==="symbol"?t:String(t)}function jve(e,t){if(ah(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ah(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Fve=function(){function e(t,r){Nve(this,e),r&&(this.eventManager=t.eventManager,this.instance=t,this.wot=t,this.settings=r,this.mouseDown=!1,this.main=null,this.top=null,this.bottom=null,this.start=null,this.end=null,this.topStyle=null,this.bottomStyle=null,this.startStyle=null,this.endStyle=null,this.cornerDefaultStyle={width:"6px",height:"6px",borderWidth:"1px",borderStyle:"solid",borderColor:"#FFF"},this.cornerCenterPointOffset=-(parseInt(this.cornerDefaultStyle.width,10)/2),this.corner=null,this.cornerStyle=null,this.createBorders(r),this.registerListeners())}return Hve(e,[{key:"registerListeners",value:function(){var r=this,n=this.wot.rootDocument.body;this.eventManager.addEventListener(n,"mousedown",function(){return r.onMouseDown()}),this.eventManager.addEventListener(n,"mouseup",function(){return r.onMouseUp()});for(var o=function(s){var u=r.main.childNodes[s];r.eventManager.addEventListener(u,"mouseenter",function(f){return r.onMouseEnter(f,r.main.childNodes[s])})},i=0,a=this.main.childNodes.length;i<a;i++)o(i)}},{key:"onMouseDown",value:function(){this.mouseDown=!0}},{key:"onMouseUp",value:function(){this.mouseDown=!1}},{key:"onMouseEnter",value:function(r,n){if(!this.mouseDown||!this.wot.getSetting("hideBorderOnMouseDownOver"))return;r.preventDefault(),Dn(r);var o=this,i=this.wot.rootDocument.body,a=n.getBoundingClientRect();n.style.display="none";function l(u){if(u.clientY<Math.floor(a.top)||u.clientY>Math.ceil(a.top+a.height)||u.clientX<Math.floor(a.left)||u.clientX>Math.ceil(a.left+a.width))return!0}function s(u){l(u)&&(o.eventManager.removeEventListener(i,"mousemove",s),n.style.display="block")}this.eventManager.addEventListener(i,"mousemove",s)}},{key:"createBorders",value:function(r){var n=this.wot.rootDocument;this.main=n.createElement("div");var o=["top","start","bottom","end","corner"],i=this.main.style;i.position="absolute",i.top=0,i.left=0;for(var a=0;a<5;a++){var l=o[a],s=n.createElement("div");s.className="wtBorder ".concat(this.settings.className||""),this.settings[l]&&this.settings[l].hide&&(s.className+=" hidden"),i=s.style,i.backgroundColor=this.settings[l]&&this.settings[l].color?this.settings[l].color:r.border.color,i.height=this.settings[l]&&this.settings[l].width?"".concat(this.settings[l].width,"px"):"".concat(r.border.width,"px"),i.width=this.settings[l]&&this.settings[l].width?"".concat(this.settings[l].width,"px"):"".concat(r.border.width,"px"),this.main.appendChild(s)}this.top=this.main.childNodes[0],this.start=this.main.childNodes[1],this.bottom=this.main.childNodes[2],this.end=this.main.childNodes[3],this.topStyle=this.top.style,this.startStyle=this.start.style,this.bottomStyle=this.bottom.style,this.endStyle=this.end.style,this.corner=this.main.childNodes[4],this.corner.className+=" corner",this.cornerStyle=this.corner.style,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.height=this.cornerDefaultStyle.height,this.cornerStyle.border=[this.cornerDefaultStyle.borderWidth,this.cornerDefaultStyle.borderStyle,this.cornerDefaultStyle.borderColor].join(" "),An()&&this.createMultipleSelectorHandles(),this.disappear();var u=this.wot.wtTable,f=u.bordersHolder;f||(f=n.createElement("div"),f.className="htBorders",u.bordersHolder=f,u.spreader.appendChild(f)),f.appendChild(this.main)}},{key:"createMultipleSelectorHandles",value:function(){var r=this,n=this.wot.rootDocument;this.selectionHandles={top:n.createElement("DIV"),topHitArea:n.createElement("DIV"),bottom:n.createElement("DIV"),bottomHitArea:n.createElement("DIV")};var o=10,i=40;this.selectionHandles.top.className="topSelectionHandle topLeftSelectionHandle",this.selectionHandles.topHitArea.className="topSelectionHandle-HitArea topLeftSelectionHandle-HitArea",this.selectionHandles.bottom.className="bottomSelectionHandle bottomRightSelectionHandle",this.selectionHandles.bottomHitArea.className="bottomSelectionHandle-HitArea bottomRightSelectionHandle-HitArea",this.selectionHandles.styles={top:this.selectionHandles.top.style,topHitArea:this.selectionHandles.topHitArea.style,bottom:this.selectionHandles.bottom.style,bottomHitArea:this.selectionHandles.bottomHitArea.style};var a={position:"absolute",height:"".concat(i,"px"),width:"".concat(i,"px"),"border-radius":"".concat(parseInt(i/1.5,10),"px")};Ke(a,function(s,u){r.selectionHandles.styles.bottomHitArea[u]=s,r.selectionHandles.styles.topHitArea[u]=s});var l={position:"absolute",height:"".concat(o,"px"),width:"".concat(o,"px"),"border-radius":"".concat(parseInt(o/1.5,10),"px"),background:"#F5F5FF",border:"1px solid #4285c8"};Ke(l,function(s,u){r.selectionHandles.styles.bottom[u]=s,r.selectionHandles.styles.top[u]=s}),this.main.appendChild(this.selectionHandles.top),this.main.appendChild(this.selectionHandles.bottom),this.main.appendChild(this.selectionHandles.topHitArea),this.main.appendChild(this.selectionHandles.bottomHitArea)}},{key:"isPartRange",value:function(r,n){var o=this.wot.selections.createOrGetArea();return!!(o.cellRange&&(r!==o.cellRange.to.row||n!==o.cellRange.to.col))}},{key:"updateMultipleSelectionHandlesPosition",value:function(r,n,o,i,a,l){var s=this.wot.wtSettings.getSetting("rtlMode"),u=s?"right":"left",f=this.selectionHandles.styles,c=f.top,h=f.topHitArea,d=f.bottom,v=f.bottomHitArea,y=parseInt(c.borderWidth,10),p=parseInt(c.width,10),w=parseInt(h.width,10),S=this.wot.wtTable.getWidth(),C=this.wot.wtTable.getHeight();c.top="".concat(parseInt(o-p-1,10),"px"),c[u]="".concat(parseInt(i-p-1,10),"px"),h.top="".concat(parseInt(o-w/4*3,10),"px"),h[u]="".concat(parseInt(i-w/4*3,10),"px");var P=Math.min(parseInt(i+a,10),S-p-y*2),R=Math.min(parseInt(i+a-w/4,10),S-w-y*2);d[u]="".concat(P,"px"),v[u]="".concat(R,"px");var W=Math.min(parseInt(o+l,10),C-p-y*2),Y=Math.min(parseInt(o+l-w/4,10),C-w-y*2);d.top="".concat(W,"px"),v.top="".concat(Y,"px"),this.settings.border.cornerVisible&&this.settings.border.cornerVisible()?(c.display="block",h.display="block",this.isPartRange(r,n)?(d.display="none",v.display="none"):(d.display="block",v.display="block")):(c.display="none",d.display="none",h.display="none",v.display="none"),r===this.wot.wtSettings.getSetting("fixedRowsTop")||n===this.wot.wtSettings.getSetting("fixedColumnsStart")?(c.zIndex="9999",h.zIndex="9999"):(c.zIndex="",h.zIndex="")}},{key:"appear",value:function(r){if(!this.disabled){for(var n=this.wot,o=n.wtTable,i=n.rootDocument,a=n.rootWindow,l,s,u,f,c,h,d=o.getRenderedRowsCount(),v=0;v<d;v+=1){var y=o.rowFilter.renderedToSource(v);if(y>=r[0]&&y<=r[2]){l=y,c=r[0];break}}for(var p=d-1;p>=0;p-=1){var w=o.rowFilter.renderedToSource(p);if(w>=r[0]&&w<=r[2]){s=w;break}}for(var S=o.getRenderedColumnsCount(),C=0;C<S;C+=1){var P=o.columnFilter.renderedToSource(C);if(P>=r[1]&&P<=r[3]){u=P,h=r[1];break}}for(var R=S-1;R>=0;R-=1){var W=o.columnFilter.renderedToSource(R);if(W>=r[1]&&W<=r[3]){f=W;break}}if(l===void 0||u===void 0){this.disappear();return}var Y=o.getCell(this.wot.createCellCoords(l,u)),q=l!==s||u!==f,G=q?o.getCell(this.wot.createCellCoords(s,f)):Y,X=Vt(Y),Q=q?Vt(G):X,oe=Vt(o.TABLE),J=ut(o.TABLE),ue=X.top,de=X.left,Oe=this.wot.wtSettings.getSetting("rtlMode"),be=0,$=0;if(Oe){var k=ut(Y),g=a.innerWidth-oe.left-J;$=de+k-Q.left,be=a.innerWidth-de-k-g-1}else $=Q.left+ut(G)-de,be=de-oe.left-1;if(this.isEntireColumnSelected(l,s)){var m=this.getDimensionsFromHeader("columns",u,f,c,oe),b=null;if(m){var E=aw(m,3);b=E[0],be=E[1],$=E[2]}b&&(Y=b)}var O=ue-oe.top-1,F=Q.top+Tt(G)-ue;if(this.isEntireRowSelected(u,f)){var x=this.getDimensionsFromHeader("rows",l,s,h,oe),K=null;if(x){var Z=aw(x,3);K=Z[0],O=Z[1],F=Z[2]}K&&(Y=K)}var te=Pa(Y,a);parseInt(te.borderTopWidth,10)>0&&(O+=1,F=F>0?F-1:0),parseInt(te[Oe?"borderRightWidth":"borderLeftWidth"],10)>0&&(be+=1,$=$>0?$-1:0);var ie=Oe?"right":"left";this.topStyle.top="".concat(O,"px"),this.topStyle[ie]="".concat(be,"px"),this.topStyle.width="".concat($,"px"),this.topStyle.display="block",this.startStyle.top="".concat(O,"px"),this.startStyle[ie]="".concat(be,"px"),this.startStyle.height="".concat(F,"px"),this.startStyle.display="block";var se=Math.floor(this.settings.border.width/2);this.bottomStyle.top="".concat(O+F-se,"px"),this.bottomStyle[ie]="".concat(be,"px"),this.bottomStyle.width="".concat($,"px"),this.bottomStyle.display="block",this.endStyle.top="".concat(O,"px"),this.endStyle[ie]="".concat(be+$-se,"px"),this.endStyle.height="".concat(F+1,"px"),this.endStyle.display="block";var Se=this.settings.border.cornerVisible;Se=typeof Se=="function"?Se(this.settings.layerLevel):Se;var we=this.wot.getSetting("onModifyGetCellCoords",s,f),U=s,De=f;if(we&&Array.isArray(we)){var Fe=aw(we,4);U=Fe[2],De=Fe[3]}if(An()||!Se||this.isPartRange(U,De))this.cornerStyle.display="none";else{this.cornerStyle.top="".concat(O+F+this.cornerCenterPointOffset-1,"px"),this.cornerStyle[ie]="".concat(be+$+this.cornerCenterPointOffset-1,"px"),this.cornerStyle.borderRightWidth=this.cornerDefaultStyle.borderWidth,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.display="none";var ke=ns(o.TABLE),Ae=ke===a;Ae&&(ke=i.documentElement);var Pe=parseInt(this.cornerDefaultStyle.width,10)/2,_=parseInt(this.cornerDefaultStyle.height,10)/2;if(f===this.wot.getSetting("totalColumns")-1){var T=Ae?G.getBoundingClientRect().left:G.offsetLeft,A=!1,j=0;Oe?(j=T-parseInt(this.cornerDefaultStyle.width,10)/2,A=j<0):(j=T+ut(G)+parseInt(this.cornerDefaultStyle.width,10)/2,A=j>=By(ke)),A&&(this.cornerStyle[ie]="".concat(Math.floor(be+$+this.cornerCenterPointOffset-Pe),"px"),this.cornerStyle[Oe?"borderLeftWidth":"borderRightWidth"]=0)}if(s===this.wot.getSetting("totalRows")-1){var M=Ae?G.getBoundingClientRect().top:G.offsetTop,B=M+Tt(G)+parseInt(this.cornerDefaultStyle.height,10)/2,N=B>=ii(ke);N&&(this.cornerStyle.top="".concat(Math.floor(O+F+this.cornerCenterPointOffset-_),"px"),this.cornerStyle.borderBottomWidth=0)}this.cornerStyle.display="block"}An()&&this.updateMultipleSelectionHandlesPosition(s,f,O,be,$,F)}}},{key:"isEntireColumnSelected",value:function(r,n){return r===this.wot.wtTable.getFirstRenderedRow()&&n===this.wot.wtTable.getLastRenderedRow()}},{key:"isEntireRowSelected",value:function(r,n){return r===this.wot.wtTable.getFirstRenderedColumn()&&n===this.wot.wtTable.getLastRenderedColumn()}},{key:"getDimensionsFromHeader",value:function(r,n,o,i,a){var l=this.wot.wtTable,s=l.wtRootElement.parentNode,u=null,f=null,c=null,h=null,d=null,v=null,y=null,p=null;switch(r){case"rows":u=function(){return l.getRowHeader.apply(l,arguments)},f=function(){return Tt.apply(void 0,arguments)},c="ht__selection--rows",v="top";break;case"columns":u=function(){return l.getColumnHeader.apply(l,arguments)},f=function(){return ut.apply(void 0,arguments)},c="ht__selection--columns",v="left";break}if(s.classList.contains(c)){var w=this.wot.getSetting("columnHeaders").length;if(y=u(n,w-i),p=u(o,w-i),!y||!p)return!1;var S=Vt(y),C=Vt(p);return y&&p&&(h=S[v]-a[v]-1,d=C[v]+f(p)-S[v]),[y,h,d]}return!1}},{key:"changeBorderStyle",value:function(r,n){var o=this[r].style,i=n[r];!i||i.hide?re(this[r],"hidden"):(xe(this[r],"hidden")&&He(this[r],"hidden"),o.backgroundColor=i.color,(r==="top"||r==="bottom")&&(o.height="".concat(i.width,"px")),(r==="start"||r==="end")&&(o.width="".concat(i.width,"px")))}},{key:"changeBorderToDefaultStyle",value:function(r){var n={width:1,color:"#000"},o=this[r].style;o.backgroundColor=n.color,o.width="".concat(n.width,"px"),o.height="".concat(n.width,"px")}},{key:"toggleHiddenClass",value:function(r,n){this.changeBorderToDefaultStyle(r),n?re(this[r],"hidden"):He(this[r],"hidden")}},{key:"disappear",value:function(){this.topStyle.display="none",this.bottomStyle.display="none",this.startStyle.display="none",this.endStyle.display="none",this.cornerStyle.display="none",An()&&(this.selectionHandles.styles.top.display="none",this.selectionHandles.styles.topHitArea.display="none",this.selectionHandles.styles.bottom.display="none",this.selectionHandles.styles.bottomHitArea.display="none")}},{key:"destroy",value:function(){this.eventManager.destroyWithOwnEventsOnly(),this.main.parentNode.removeChild(this.main)}}]),e}();const Bve=Fve;function Vve(e,t){return Yve(e)||zve(e,t)||Uve(e,t)||Wve()}function Wve(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Uve(e,t){if(e){if(typeof e=="string")return q1(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return q1(e,t)}}function q1(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function zve(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function Yve(e){if(Array.isArray(e))return e}function _s(e){"@babel/helpers - typeof";return _s=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_s(e)}function Gve(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function X1(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,qve(n.key),n)}}function Kve(e,t,r){return t&&X1(e.prototype,t),r&&X1(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function qve(e){var t=Xve(e,"string");return _s(t)==="symbol"?t:String(t)}function Xve(e,t){if(_s(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_s(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Zve=function(){function e(t,r){Gve(this,e),this.settings=t,this.cellRange=r||null,this.instanceBorders={},this.classNames=[this.settings.className],this.classNameGenerator=this.linearClassNameGenerator(this.settings.className,this.settings.layerLevel)}return Kve(e,[{key:"getBorder",value:function(r){return this.instanceBorders[r.guid]||(this.instanceBorders[r.guid]=new Bve(r,this.settings)),this.instanceBorders[r.guid]}},{key:"isEmpty",value:function(){return this.cellRange===null}},{key:"add",value:function(r){return this.isEmpty()?this.cellRange=this.settings.createCellRange(r):this.cellRange.expand(r),this}},{key:"replace",value:function(r,n){if(!this.isEmpty()){if(this.cellRange.from.isEqual(r))return this.cellRange.from=n,!0;if(this.cellRange.to.isEqual(r))return this.cellRange.to=n,!0}return!1}},{key:"clear",value:function(){return this.cellRange=null,this}},{key:"getCorners",value:function(){var r=this.cellRange.getOuterTopStartCorner(),n=this.cellRange.getOuterBottomEndCorner();return[r.row,r.col,n.row,n.col]}},{key:"addClassAtCoords",value:function(r,n,o,i){var a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1,l=r.wtTable.getCell(this.settings.createCellCoords(n,o));if(_s(l)==="object"){var s=i;a&&(s=this.classNameGenerator(l),this.classNames.includes(s)||this.classNames.push(s)),re(l,s)}return this}},{key:"linearClassNameGenerator",value:function(r,n){return function o(i){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:-1;if(n===0||a===0)return r;var l=a>=0?a:n,s=r;l-=1;var u=l===0?r:"".concat(r,"-").concat(l);if(xe(i,u)){var f=l+1;s="".concat(r,"-").concat(f)}else s=o(i,l);return s}}},{key:"draw",value:function(r){if(this.isEmpty()){this.settings.border&&this.getBorder(r).disappear();return}var n=r.wtTable.getRenderedRowsCount(),o=r.wtTable.getRenderedColumnsCount(),i=this.getCorners(),a=Vve(i,4),l=a[0],s=a[1],u=a[2],f=a[3],c=this.settings,h=c.highlightHeaderClassName,d=c.highlightColumnClassName,v=c.highlightRowClassName,y=c.highlightOnlyClosestHeader,p=c.selectionType,w=p===void 0||["active-header","header"].includes(p);if(w&&s!==null&&f!==null)for(var S=0,C=0;C<o;C+=1){var P=r.wtTable.columnFilter.renderedToSource(C);if(P>=s&&P<=f){var R=r.wtTable.getColumnHeaders(P),W=R.length-1;y&&R.length>1&&(R=[R[W]]);for(var Y=0;Y<R.length;Y+=1){var q=[],G=R[Y];h&&q.push(h),d&&q.push(d),Y=y?W:Y;var X=r.getSetting("onBeforeHighlightingColumnHeader",P,Y,{selectionType:p,columnCursor:S,selectionWidth:f-s+1,classNames:q});X!==P&&(G=r.wtTable.getColumnHeader(X,Y)),re(G,q)}S+=1}}if(l!==null&&u!==null)for(var Q=0,oe=0;oe<n;oe+=1){var J=r.wtTable.rowFilter.renderedToSource(oe);if(w&&J>=l&&J<=u){var ue=r.wtTable.getRowHeaders(J),de=ue.length-1;y&&ue.length>1&&(ue=[ue[de]]);for(var Oe=0;Oe<ue.length;Oe+=1){var be=[],$=ue[Oe];h&&be.push(h),v&&be.push(v),Oe=y?de:Oe;var k=r.getSetting("onBeforeHighlightingRowHeader",J,Oe,{selectionType:p,rowCursor:Q,selectionHeight:u-l+1,classNames:be});k!==J&&($=r.wtTable.getRowHeader(k,Oe)),re($,be)}Q+=1}if(s!==null&&f!==null)for(var g=0;g<o;g+=1){var m=r.wtTable.columnFilter.renderedToSource(g);J>=l&&J<=u&&m>=s&&m<=f?this.settings.className&&this.addClassAtCoords(r,J,m,this.settings.className,this.settings.markIntersections):J>=l&&J<=u?v&&this.addClassAtCoords(r,J,m,v):m>=s&&m<=f&&d&&this.addClassAtCoords(r,J,m,d);var b=r.getSetting("onAfterDrawSelection",J,m,this.settings.layerLevel);typeof b=="string"&&this.addClassAtCoords(r,J,m,b)}}r.getSetting("onBeforeDrawBorders",i,this.settings.className),this.settings.border&&this.getBorder(r).appear(i)}},{key:"destroy",value:function(){Object.values(this.instanceBorders).forEach(function(r){return r.destroy()})}}]),e}();const Qve=Zve;function Z1(e){var t=e.isShiftKey,r=e.isLeftClick,n=e.isRightClick,o=e.coords,i=e.selection,a=e.controller,l=e.cellCoordsFactory,s=i.isSelected()?i.getSelectedRange().current():null,u=i.isSelectedByCorner(),f=i.isSelectedByRowHeader();if(t&&s)o.row>=0&&o.col>=0&&!a.cell?i.setRangeEnd(o):(u||f)&&o.row>=0&&o.col>=0&&!a.cell?i.setRangeEnd(l(o.row,o.col)):u&&o.row<0&&!a.column?i.setRangeEnd(l(s.to.row,o.col)):f&&o.col<0&&!a.row?i.setRangeEnd(l(o.row,s.to.col)):(!u&&!f&&o.col<0||u&&o.col<0)&&!a.row?i.selectRows(Math.max(s.from.row,0),o.row,o.col):(!u&&!f&&o.row<0||f&&o.row<0)&&!a.column&&i.selectColumns(Math.max(s.from.col,0),o.col,o.row);else{var c=!i.inInSelection(o),h=r||n&&c;o.row<0&&o.col>=0&&!a.column?h&&i.selectColumns(o.col,o.col,o.row):o.col<0&&o.row>=0&&!a.row?h&&i.selectRows(o.row,o.row,o.col):o.col>=0&&o.row>=0&&!a.cell?h&&i.setRangeStart(o):o.col<0&&o.row<0&&i.selectAll(!0,!0)}}function Jve(e){var t=e.isLeftClick,r=e.coords,n=e.selection,o=e.controller,i=e.cellCoordsFactory;if(t){var a=n.isSelectedByRowHeader(),l=n.isSelectedByColumnHeader(),s=n.tableProps.countCols(),u=n.tableProps.countRows();l&&!o.column?n.setRangeEnd(i(u-1,r.col)):a&&!o.row?n.setRangeEnd(i(r.row,s-1)):o.cell||n.setRangeEnd(r)}}var eye=new Map([["mousedown",Z1],["mouseover",Jve],["touchstart",Z1]]);function Q1(e,t){var r=t.coords,n=t.selection,o=t.controller,i=t.cellCoordsFactory;eye.get(e.type)({coords:r,selection:n,controller:o,cellCoordsFactory:i,isShiftKey:e.shiftKey,isLeftClick:HE(e)||e.type==="touchstart",isRightClick:$a(e)})}var QV=new WeakMap,JE=Symbol("rootInstance");function tye(e){QV.set(e,!0)}function rye(e){return e===JE}function KC(e){return QV.has(e)}function lh(e){"@babel/helpers - typeof";return lh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},lh(e)}function xf(e,t){return iye(e)||oye(e,t)||JV(e,t)||nye()}function nye(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function oye(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function iye(e){if(Array.isArray(e))return e}function J1(e){return sye(e)||lye(e)||JV(e)||aye()}function aye(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function JV(e,t){if(e){if(typeof e=="string")return qC(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return qC(e,t)}}function lye(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function sye(e){if(Array.isArray(e))return qC(e)}function qC(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function uye(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function eI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,eW(n.key),n)}}function fye(e,t,r){return t&&eI(e.prototype,t),r&&eI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function tI(e,t,r){cye(e,t),t.set(e,r)}function cye(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Wo(e,t,r){return t=eW(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function eW(e){var t=hye(e,"string");return lh(t)==="symbol"?t:String(t)}function hye(e,t){if(lh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(lh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function rI(e,t){var r=tW(e,t,"get");return dye(e,r)}function dye(e,t){return t.get?t.get.call(e):t.value}function nI(e,t,r){var n=tW(e,t,"set");return vye(e,n,r),r}function tW(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function vye(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}var Di=new WeakMap,lw=new WeakMap,sw=new WeakMap,yye=function(){function e(t){uye(this,e),Wo(this,"instance",void 0),Wo(this,"eventManager",void 0),Wo(this,"settings",void 0),Wo(this,"THEAD",void 0),Wo(this,"TBODY",void 0),Wo(this,"_wt",void 0),Wo(this,"activeWt",void 0),tI(this,lw,{writable:!0,value:0}),tI(this,sw,{writable:!0,value:0}),Wo(this,"postponedAdjustElementsSize",!1),this.instance=t,this.eventManager=new Pt(this.instance),this.settings=this.instance.getSettings(),Di.set(this,{selectionMouseDown:!1,mouseDown:void 0,table:void 0,lastWidth:0,lastHeight:0}),this.createElements(),this.registerEvents(),this.initializeWalkontable()}return fye(e,[{key:"render",value:function(){this.instance.isRenderSuspended()||(this.instance.runHooks("beforeRender",this.instance.forceFullRender),this.postponedAdjustElementsSize&&(this.postponedAdjustElementsSize=!1,this.adjustElementsSize(!0)),this._wt.draw(!this.instance.forceFullRender),this.instance.runHooks("afterRender",this.instance.forceFullRender),this.instance.forceFullRender=!1,this.instance.renderCall=!1)}},{key:"adjustElementsSize",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.instance.isRenderSuspended()?this.postponedAdjustElementsSize=!0:this._wt.wtOverlays.adjustElementsSize(r)}},{key:"getCellAtCoords",value:function(r,n){var o=this._wt.getCell(r,n);return o<0?null:o}},{key:"scrollViewport",value:function(r,n,o,i,a){return this._wt.scrollViewport(r,n,o,i,a)}},{key:"scrollViewportHorizontally",value:function(r,n,o){return this._wt.scrollViewportHorizontally(r,n,o)}},{key:"scrollViewportVertically",value:function(r,n,o){return this._wt.scrollViewportVertically(r,n,o)}},{key:"createElements",value:function(){var r=Di.get(this),n=this.instance,o=n.rootElement,i=n.rootDocument,a=o.getAttribute("style");a&&o.setAttribute("data-originalstyle",a),re(o,"handsontable"),r.table=i.createElement("TABLE"),re(r.table,"htCore"),this.instance.getSettings().tableClassName&&re(r.table,this.instance.getSettings().tableClassName),this.THEAD=i.createElement("THEAD"),r.table.appendChild(this.THEAD),this.TBODY=i.createElement("TBODY"),r.table.appendChild(this.TBODY),this.instance.table=r.table,this.instance.container.insertBefore(r.table,this.instance.container.firstChild)}},{key:"registerEvents",value:function(){var r=this,n=Di.get(this),o=this.instance,i=o.rootElement,a=o.rootDocument,l=o.selection,s=a.documentElement;this.eventManager.addEventListener(i,"mousedown",function(u){if(n.selectionMouseDown=!0,!r.isTextSelectionAllowed(u.target)){var f=r.instance.rootWindow;pA(f),u.preventDefault(),f.focus()}}),this.eventManager.addEventListener(i,"mouseup",function(){n.selectionMouseDown=!1}),this.eventManager.addEventListener(i,"mousemove",function(u){n.selectionMouseDown&&!r.isTextSelectionAllowed(u.target)&&(r.settings.fragmentSelection&&pA(r.instance.rootWindow),u.preventDefault())}),this.eventManager.addEventListener(s,"keyup",function(u){l.isInProgress()&&!u.shiftKey&&l.finish()}),this.eventManager.addEventListener(s,"mouseup",function(u){l.isInProgress()&&HE(u)&&l.finish(),n.mouseDown=!1,(NE(a.activeElement)||!l.isSelected()&&!l.isSelectedByAnyHeader()&&!i.contains(u.target)&&!$a(u))&&r.instance.unlisten()}),this.eventManager.addEventListener(s,"contextmenu",function(u){l.isInProgress()&&$a(u)&&(l.finish(),n.mouseDown=!1)}),this.eventManager.addEventListener(s,"touchend",function(){l.isInProgress()&&l.finish(),n.mouseDown=!1}),this.eventManager.addEventListener(s,"mousedown",function(u){var f=u.target,c=u.x||u.clientX,h=u.y||u.clientY,d=u.target;if(!(n.mouseDown||!i||!r.instance.view)){var v=r.instance.view._wt.wtTable.holder;if(d===v){var y=Zt(a);if(a.elementFromPoint(c+y,h)!==v||a.elementFromPoint(c,h+y)!==v)return}else for(;d!==s;){if(d===null){if(u.isTargetWebComponent)break;return}if(d===i)return;d=d.parentNode}var p=typeof r.settings.outsideClickDeselects=="function"?r.settings.outsideClickDeselects(f):r.settings.outsideClickDeselects;p?r.instance.deselectCell():r.instance.destroyEditor(!1,!1)}}),this.eventManager.addEventListener(n.table,"selectstart",function(u){r.settings.fragmentSelection||xg(u.target)||u.preventDefault()})}},{key:"translateFromRenderableToVisualCoords",value:function(r){var n,o=r.row,i=r.col;return(n=this.instance)._createCellCoords.apply(n,J1(this.translateFromRenderableToVisualIndex(o,i)))}},{key:"translateFromRenderableToVisualIndex",value:function(r,n){var o=r>=0?this.instance.rowIndexMapper.getVisualFromRenderableIndex(r):r,i=n>=0?this.instance.columnIndexMapper.getVisualFromRenderableIndex(n):n;return o===null&&(o=r),i===null&&(i=n),[o,i]}},{key:"countRenderableIndexes",value:function(r,n){var o=Math.min(r.getNotTrimmedIndexesLength(),n),i=r.getNearestNotHiddenIndex(o-1,-1);return i===null?0:r.getRenderableFromVisualIndex(i)+1}},{key:"countRenderableColumns",value:function(){return this.countRenderableIndexes(this.instance.columnIndexMapper,this.settings.maxCols)}},{key:"countRenderableRows",value:function(){return this.countRenderableIndexes(this.instance.rowIndexMapper,this.settings.maxRows)}},{key:"countNotHiddenRowIndexes",value:function(r,n){return this.countNotHiddenIndexes(r,n,this.instance.rowIndexMapper,this.countRenderableRows())}},{key:"countNotHiddenColumnIndexes",value:function(r,n){return this.countNotHiddenIndexes(r,n,this.instance.columnIndexMapper,this.countRenderableColumns())}},{key:"countNotHiddenIndexes",value:function(r,n,o,i){if(isNaN(r)||r<0)return 0;var a=o.getNearestNotHiddenIndex(r,n),l=o.getRenderableFromVisualIndex(a);if(!Number.isInteger(l))return 0;var s=0;return n<0?s=l+1:n>0&&(s=i-l),s}},{key:"countNotHiddenFixedColumnsStart",value:function(){var r=this.instance.countCols(),n=Math.min(parseInt(this.settings.fixedColumnsStart,10),r)-1;return this.countNotHiddenColumnIndexes(n,-1)}},{key:"countNotHiddenFixedRowsTop",value:function(){var r=this.instance.countRows(),n=Math.min(parseInt(this.settings.fixedRowsTop,10),r)-1;return this.countNotHiddenRowIndexes(n,-1)}},{key:"countNotHiddenFixedRowsBottom",value:function(){var r=this.instance.countRows(),n=Math.max(r-parseInt(this.settings.fixedRowsBottom,10),0);return this.countNotHiddenRowIndexes(n,1)}},{key:"isMainTableNotFullyCoveredByOverlays",value:function(){var r=this.countNotHiddenFixedRowsTop()+this.countNotHiddenFixedRowsBottom(),n=this.countNotHiddenFixedColumnsStart();return this.instance.countRenderedRows()>r&&this.instance.countRenderedCols()>n}},{key:"initializeWalkontable",value:function(){var r=this,n=Di.get(this),o={rtlMode:this.instance.isRtl(),externalRowCalculator:this.instance.getPlugin("autoRowSize")&&this.instance.getPlugin("autoRowSize").isEnabled(),table:n.table,isDataViewInstance:function(){return KC(r.instance)},preventOverflow:function(){return r.settings.preventOverflow},preventWheel:function(){return r.settings.preventWheel},stretchH:function(){return r.settings.stretchH},data:function(f,c){var h;return(h=r.instance).getDataAtCell.apply(h,J1(r.translateFromRenderableToVisualIndex(f,c)))},totalRows:function(){return r.countRenderableRows()},totalColumns:function(){return r.countRenderableColumns()},fixedColumnsStart:function(){return r.countNotHiddenFixedColumnsStart()},fixedRowsTop:function(){return r.countNotHiddenFixedRowsTop()},fixedRowsBottom:function(){return r.countNotHiddenFixedRowsBottom()},shouldRenderInlineStartOverlay:function(){return r.settings.fixedColumnsStart>0||o.rowHeaders().length>0},shouldRenderTopOverlay:function(){return r.settings.fixedRowsTop>0||o.columnHeaders().length>0},shouldRenderBottomOverlay:function(){return r.settings.fixedRowsBottom>0},minSpareRows:function(){return r.settings.minSpareRows},renderAllRows:this.settings.renderAllRows,rowHeaders:function(){var f=[];return r.instance.hasRowHeaders()&&f.push(function(c,h){var d=c>=0?r.instance.rowIndexMapper.getVisualFromRenderableIndex(c):c;r.appendRowHeader(d,h)}),r.instance.runHooks("afterGetRowHeaderRenderers",f),nI(r,sw,f.length),f},columnHeaders:function(){var f=[];return r.instance.hasColHeaders()&&f.push(function(c,h){var d=c>=0?r.instance.columnIndexMapper.getVisualFromRenderableIndex(c):c;r.appendColHeader(d,h)}),r.instance.runHooks("afterGetColumnHeaderRenderers",f),nI(r,lw,f.length),f},columnWidth:function(f){var c=r.instance.columnIndexMapper.getVisualFromRenderableIndex(f);return r.instance.getColWidth(c===null?f:c)},rowHeight:function(f){var c=r.instance.rowIndexMapper.getVisualFromRenderableIndex(f);return r.instance.getRowHeight(c===null?f:c)},cellRenderer:function(f,c,h){var d=r.translateFromRenderableToVisualIndex(f,c),v=xf(d,2),y=v[0],p=v[1],w=r.instance.runHooks("modifyGetCellCoords",y,p),S=y,C=p;if(Array.isArray(w)){var P=xf(w,2);S=P[0],C=P[1]}var R=r.instance.getCellMeta(S,C),W=r.instance.colToProp(C),Y=r.instance.getDataAtRowProp(S,W);r.instance.hasHook("beforeValueRender")&&(Y=r.instance.runHooks("beforeValueRender",Y,R)),r.instance.runHooks("beforeRenderer",h,y,p,W,Y,R),r.instance.getCellRenderer(R)(r.instance,h,y,p,W,Y,R),r.instance.runHooks("afterRenderer",h,y,p,W,Y,R)},selections:this.instance.selection.highlight,hideBorderOnMouseDownOver:function(){return r.settings.fragmentSelection},onWindowResize:function(){r.instance&&!r.instance.isDestroyed&&r.instance.refreshDimensions()},onContainerElementResize:function(){r.instance&&!r.instance.isDestroyed&&r.instance.refreshDimensions()},onCellMouseDown:function(f,c,h,d){var v=r.translateFromRenderableToVisualCoords(c),y={row:!1,column:!1,cell:!1};r.instance.listen(),r.activeWt=d,n.mouseDown=!0,r.instance.runHooks("beforeOnCellMouseDown",f,v,h,y),!Il(f)&&(Q1(f,{coords:v,selection:r.instance.selection,controller:y,cellCoordsFactory:function(w,S){return r.instance._createCellCoords(w,S)}}),r.instance.runHooks("afterOnCellMouseDown",f,v,h),r.activeWt=r._wt)},onCellContextMenu:function(f,c,h,d){var v=r.translateFromRenderableToVisualCoords(c);r.activeWt=d,n.mouseDown=!1,r.instance.selection.isInProgress()&&r.instance.selection.finish(),r.instance.runHooks("beforeOnCellContextMenu",f,v,h),!Il(f)&&(r.instance.runHooks("afterOnCellContextMenu",f,v,h),r.activeWt=r._wt)},onCellMouseOut:function(f,c,h,d){var v=r.translateFromRenderableToVisualCoords(c);r.activeWt=d,r.instance.runHooks("beforeOnCellMouseOut",f,v,h),!Il(f)&&(r.instance.runHooks("afterOnCellMouseOut",f,v,h),r.activeWt=r._wt)},onCellMouseOver:function(f,c,h,d){var v=r.translateFromRenderableToVisualCoords(c),y={row:!1,column:!1,cell:!1};r.activeWt=d,r.instance.runHooks("beforeOnCellMouseOver",f,v,h,y),!Il(f)&&(n.mouseDown&&Q1(f,{coords:v,selection:r.instance.selection,controller:y,cellCoordsFactory:function(w,S){return r.instance._createCellCoords(w,S)}}),r.instance.runHooks("afterOnCellMouseOver",f,v,h),r.activeWt=r._wt)},onCellMouseUp:function(f,c,h,d){var v=r.translateFromRenderableToVisualCoords(c);r.activeWt=d,r.instance.runHooks("beforeOnCellMouseUp",f,v,h),!(Il(f)||r.instance.isDestroyed)&&(r.instance.runHooks("afterOnCellMouseUp",f,v,h),r.activeWt=r._wt)},onCellCornerMouseDown:function(f){f.preventDefault(),r.instance.runHooks("afterOnCellCornerMouseDown",f)},onCellCornerDblClick:function(f){f.preventDefault(),r.instance.runHooks("afterOnCellCornerDblClick",f)},beforeDraw:function(f,c){return r.beforeRender(f,c)},onDraw:function(f){return r.afterRender(f)},onScrollVertically:function(){return r.instance.runHooks("afterScrollVertically")},onScrollHorizontally:function(){return r.instance.runHooks("afterScrollHorizontally")},onBeforeRemoveCellClassNames:function(){return r.instance.runHooks("beforeRemoveCellClassNames")},onBeforeHighlightingRowHeader:function(f,c,h){var d=r.instance.rowIndexMapper,v=d.getVisualFromRenderableIndex(f),y=r.instance.runHooks("beforeHighlightingRowHeader",v,c,h);return d.getRenderableFromVisualIndex(d.getNearestNotHiddenIndex(y,1))},onBeforeHighlightingColumnHeader:function(f,c,h){var d=r.instance.columnIndexMapper,v=d.getVisualFromRenderableIndex(f),y=r.instance.runHooks("beforeHighlightingColumnHeader",v,c,h);return d.getRenderableFromVisualIndex(d.getNearestNotHiddenIndex(y,1))},onAfterDrawSelection:function(f,c,h){var d,v=r.translateFromRenderableToVisualIndex(f,c),y=xf(v,2),p=y[0],w=y[1],S=r.instance.selection.getSelectedRange(),C=S.size();if(C>0){var P=(h??0)+1-C,R=S.peekByIndex(P);d=[R.from.row,R.from.col,R.to.row,R.to.col]}return r.instance.runHooks("afterDrawSelection",p,w,d,h)},onBeforeDrawBorders:function(f,c){var h=xf(f,4),d=h[0],v=h[1],y=h[2],p=h[3],w=[r.instance.rowIndexMapper.getVisualFromRenderableIndex(d),r.instance.columnIndexMapper.getVisualFromRenderableIndex(v),r.instance.rowIndexMapper.getVisualFromRenderableIndex(y),r.instance.columnIndexMapper.getVisualFromRenderableIndex(p)];return r.instance.runHooks("beforeDrawBorders",w,c)},onBeforeTouchScroll:function(){return r.instance.runHooks("beforeTouchScroll")},onAfterMomentumScroll:function(){return r.instance.runHooks("afterMomentumScroll")},onBeforeStretchingColumnWidth:function(f,c){var h=r.instance.columnIndexMapper.getVisualFromRenderableIndex(c);return r.instance.runHooks("beforeStretchingColumnWidth",f,h)},onModifyRowHeaderWidth:function(f){return r.instance.runHooks("modifyRowHeaderWidth",f)},onModifyGetCellCoords:function(f,c,h){var d=r.instance.rowIndexMapper,v=r.instance.columnIndexMapper,y=c>=0?v.getVisualFromRenderableIndex(c):c,p=f>=0?d.getVisualFromRenderableIndex(f):f,w=r.instance.runHooks("modifyGetCellCoords",p,y,h);if(Array.isArray(w)){var S=xf(w,4),C=S[0],P=S[1],R=S[2],W=S[3];return[C>=0?d.getRenderableFromVisualIndex(d.getNearestNotHiddenIndex(C,1)):C,P>=0?v.getRenderableFromVisualIndex(v.getNearestNotHiddenIndex(P,1)):P,R>=0?d.getRenderableFromVisualIndex(d.getNearestNotHiddenIndex(R,-1)):R,W>=0?v.getRenderableFromVisualIndex(v.getNearestNotHiddenIndex(W,-1)):W]}},viewportRowCalculatorOverride:function(f){var c=r.settings.viewportRowRenderingOffset;if(c==="auto"&&r.settings.fixedRowsTop&&(c=10),c>0||c==="auto"){var h=r.countRenderableRows(),d=f.startRow,v=f.endRow;if(typeof c=="number")f.startRow=Math.max(d-c,0),f.endRow=Math.min(v+c,h-1);else if(c==="auto"){var y=Math.ceil(v/h*12);f.startRow=Math.max(d-y,0),f.endRow=Math.min(v+y,h-1)}}r.instance.runHooks("afterViewportRowCalculatorOverride",f)},viewportColumnCalculatorOverride:function(f){var c=r.settings.viewportColumnRenderingOffset;if(c==="auto"&&r.settings.fixedColumnsStart&&(c=10),c>0||c==="auto"){var h=r.countRenderableColumns(),d=f.startColumn,v=f.endColumn;if(typeof c=="number"&&(f.startColumn=Math.max(d-c,0),f.endColumn=Math.min(v+c,h-1)),c==="auto"){var y=Math.ceil(v/h*6);f.startColumn=Math.max(d-y,0),f.endColumn=Math.min(v+y,h-1)}}r.instance.runHooks("afterViewportColumnCalculatorOverride",f)},rowHeaderWidth:function(){return r.settings.rowHeaderWidth},columnHeaderHeight:function(){var f=r.instance.runHooks("modifyColumnHeaderHeight");return r.settings.columnHeaderHeight||f}};this.instance.runHooks("beforeInitWalkontable",o),this._wt=new Sve(o),this.activeWt=this._wt;var i=this._wt.wtTable.spreader,a=this.instance.rootElement.getBoundingClientRect(),l=a.width,s=a.height;this.setLastSize(l,s),this.eventManager.addEventListener(i,"mousedown",function(u){u.target===i&&u.which===3&&u.stopPropagation()}),this.eventManager.addEventListener(i,"contextmenu",function(u){u.target===i&&u.which===3&&u.stopPropagation()}),this.eventManager.addEventListener(this.instance.rootDocument.documentElement,"click",function(){r.settings.observeDOMVisibility&&r._wt.drawInterrupted&&(r.instance.forceFullRender=!0,r.render())})}},{key:"isTextSelectionAllowed",value:function(r){if(xg(r))return!0;var n=Ea(r,this.instance.view._wt.wtTable.spreader);return!!(this.settings.fragmentSelection===!0&&n||this.settings.fragmentSelection==="cell"&&this.isSelectedOnlyCell()&&n||!this.settings.fragmentSelection&&this.isCellEdited()&&this.isSelectedOnlyCell())}},{key:"isMouseDown",value:function(){return Di.get(this).mouseDown}},{key:"isSelectedOnlyCell",value:function(){var r,n;return(r=(n=this.instance.getSelectedRangeLast())===null||n===void 0?void 0:n.isSingle())!==null&&r!==void 0?r:!1}},{key:"isCellEdited",value:function(){var r=this.instance.getActiveEditor();return r&&r.isOpened()}},{key:"beforeRender",value:function(r,n){r&&this.instance.runHooks("beforeViewRender",this.instance.forceFullRender,n)}},{key:"afterRender",value:function(r){r&&this.instance.runHooks("afterViewRender",this.instance.forceFullRender)}},{key:"appendRowHeader",value:function(r,n){if(n.firstChild){var o=n.firstChild;if(!xe(o,"relative")){xn(n),this.appendRowHeader(r,n);return}this.updateCellHeader(o.querySelector(".rowHeader"),r,this.instance.getRowHeader)}else{var i=this.instance,a=i.rootDocument,l=i.getRowHeader,s=a.createElement("div"),u=a.createElement("span");s.className="relative",u.className="rowHeader",this.updateCellHeader(u,r,l),s.appendChild(u),n.appendChild(s)}this.instance.runHooks("afterGetRowHeader",r,n)}},{key:"appendColHeader",value:function(r,n){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.instance.getColHeader,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;if(n.firstChild){var a=n.firstChild;xe(a,"relative")?this.updateCellHeader(a.querySelector(".colHeader"),r,o,i):(xn(n),this.appendColHeader(r,n,o,i))}else{var l=this.instance.rootDocument,s=l.createElement("div"),u=l.createElement("span");s.className="relative",u.className="colHeader",this.updateCellHeader(u,r,o,i),s.appendChild(u),n.appendChild(s)}this.instance.runHooks("afterGetColHeader",r,n,i)}},{key:"updateCellHeader",value:function(r,n,o){var i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,a=n,l=this._wt.wtOverlays.getParentOverlay(r)||this._wt;r.parentNode&&(xe(r,"colHeader")?a=l.wtTable.columnFilter.sourceToRendered(n):xe(r,"rowHeader")&&(a=l.wtTable.rowFilter.sourceToRendered(n))),a>-1?vf(r,o(n,i)):(ka(r,String.fromCharCode(160)),re(r,"cornerHeader"))}},{key:"maximumVisibleElementWidth",value:function(r){var n=this._wt.wtViewport.getWorkspaceWidth(),o=n-r;return o>0?o:0}},{key:"maximumVisibleElementHeight",value:function(r){var n=this._wt.wtViewport.getWorkspaceHeight(),o=n-r;return o>0?o:0}},{key:"setLastSize",value:function(r,n){var o=Di.get(this),i=[r,n];o.lastWidth=i[0],o.lastHeight=i[1]}},{key:"getLastSize",value:function(){var r=Di.get(this);return{width:r.lastWidth,height:r.lastHeight}}},{key:"getFirstFullyVisibleRow",value:function(){return this.instance.rowIndexMapper.getVisualFromRenderableIndex(this.instance.view._wt.wtScroll.getFirstVisibleRow())}},{key:"getLastFullyVisibleRow",value:function(){return this.instance.rowIndexMapper.getVisualFromRenderableIndex(this.instance.view._wt.wtScroll.getLastVisibleRow())}},{key:"getFirstFullyVisibleColumn",value:function(){return this.instance.columnIndexMapper.getVisualFromRenderableIndex(this.instance.view._wt.wtScroll.getFirstVisibleColumn())}},{key:"getLastFullyVisibleColumn",value:function(){return this.instance.columnIndexMapper.getVisualFromRenderableIndex(this.instance.view._wt.wtScroll.getLastVisibleColumn())}},{key:"getColumnHeadersCount",value:function(){return rI(this,lw)}},{key:"getRowHeadersCount",value:function(){return rI(this,sw)}},{key:"destroy",value:function(){this._wt.destroy(),this.eventManager.destroy()}}]),e}();const gye=yye;function XC(e){"@babel/helpers - typeof";return XC=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},XC(e)}var mye="ABCDEFGHIJKLMNOPQRSTUVWXYZ",oI=mye.length;function pye(e){for(var t=e+1,r="",n;t>0;)n=(t-1)%oI,r=String.fromCharCode(65+n)+r,t=parseInt((t-n)/oI,10);return r}function iI(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=e,n=[];return(!Array.isArray(e)||!Array.isArray(e[0]))&&(r=[e]),r.forEach(function(o,i){Array.isArray(o)?o.forEach(function(a,l){n.push([i+t,l,a])}):Object.keys(o).forEach(function(a){n.push([i+t,a,o[a]])})}),n}function rW(e){var t=0;return Array.isArray(e)&&(e[0]&&Array.isArray(e[0])?t=e[0].length:e[0]&&Ge(e[0])&&(t=hE(e[0]))),t}function bye(e){return!!(Array.isArray(e)&&e.length&&e.every(function(t){return Array.isArray(t)}))}function wye(e){return!!(Array.isArray(e)&&e.length&&e.every(function(t){return XC(t)==="object"&&!Array.isArray(t)&&t!==null}))}function sh(e){"@babel/helpers - typeof";return sh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},sh(e)}function Sye(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function aI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_ye(n.key),n)}}function Cye(e,t,r){return t&&aI(e.prototype,t),r&&aI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _ye(e){var t=Oye(e,"string");return sh(t)==="symbol"?t:String(t)}function Oye(e,t){if(sh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(sh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Rye=function(){function e(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];Sye(this,e),this.hot=t,this.data=r,this.dataType="array",this.colToProp=function(){},this.propToCol=function(){}}return Cye(e,[{key:"modifyRowData",value:function(r){var n;return this.hot.hasHook("modifyRowData")&&(n=this.hot.runHooks("modifyRowData",r)),n!==void 0&&!Number.isInteger(n)?n:this.data[r]}},{key:"getData",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return!this.data||this.data.length===0?this.data:this.getByRange(null,null,r)}},{key:"setData",value:function(r){this.data=r}},{key:"getAtColumn",value:function(r){var n=this,o=[];return I(this.data,function(i,a){var l=n.getAtCell(a,r);o.push(l)}),o}},{key:"getAtRow",value:function(r,n,o){var i=this,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,l=n===void 0&&o===void 0,s=null,u=null;if(s=this.modifyRowData(r),Array.isArray(s))u=[],l?s.forEach(function(h,d){u[d]=i.getAtPhysicalCell(r,d,s)}):_e(n,o,function(h){u[h-n]=i.getAtPhysicalCell(r,h,s)});else if(Ge(s)||vt(s))if(a?u=[]:u={},!l||a){var f=0,c=this.countFirstRowKeys()-1;_e(f,c,function(h){var d=i.colToProp(h);if(h>=(n||f)&&h<=(o||c)&&!Number.isInteger(d)){var v=i.getAtPhysicalCell(r,d,s);a?u.push(v):Db(u,d,v)}})}else Ke(s,function(h,d){Db(u,d,i.getAtPhysicalCell(r,d,s))});return u}},{key:"setAtCell",value:function(r,n,o){if(!(r>=this.countRows()||n>=this.countFirstRowKeys())){if(this.hot.hasHook("modifySourceData")){var i=ts(o);this.hot.runHooks("modifySourceData",r,n,i,"set"),i.isTouched()&&(o=i.value)}Number.isInteger(n)?this.data[r][n]=o:Db(this.data[r],n,o)}}},{key:"getAtPhysicalCell",value:function(r,n,o){var i=null;if(o&&(typeof n=="string"?i=KJ(o,n):typeof n=="function"?i=n(o):i=o[n]),this.hot.hasHook("modifySourceData")){var a=ts(i);this.hot.runHooks("modifySourceData",r,n,a,"get"),a.isTouched()&&(i=a.value)}return i}},{key:"getAtCell",value:function(r,n){var o=this.modifyRowData(r);return this.getAtPhysicalCell(r,this.colToProp(n),o)}},{key:"getByRange",value:function(){var r=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,a=!1,l=null,s=null,u=null,f=null;n===null||o===null?(a=!0,l=0,u=this.countRows()-1):(l=Math.min(n.row,o.row),s=Math.min(n.col,o.col),u=Math.max(n.row,o.row),f=Math.max(n.col,o.col));var c=[];return _e(l,u,function(h){c.push(a?r.getAtRow(h,void 0,void 0,i):r.getAtRow(h,s,f,i))}),c}},{key:"countRows",value:function(){if(this.hot.hasHook("modifySourceLength")){var r=this.hot.runHooks("modifySourceLength");if(Number.isInteger(r))return r}return this.data.length}},{key:"countFirstRowKeys",value:function(){return rW(this.data)}},{key:"destroy",value:function(){this.data=null,this.hot=null}}]),e}();const Eye=Rye;var lI=kt,Tye=function(e){return e!==void 0&&(lI(e,"value")||lI(e,"writable"))},kye=$e,Pye=Ut,$ye=Lt,Aye=Mt,Iye=Tye,Mye=Hn,xye=Vd;function nW(e,t){var r=arguments.length<3?e:arguments[2],n,o;if(Aye(e)===r)return e[t];if(n=Mye.f(e,t),n)return Iye(n)?n.value:n.get===void 0?void 0:Pye(n.get,r);if($ye(o=xye(e)))return nW(o,t,r)}kye({target:"Reflect",stat:!0},{get:nW});var Dye=$e,Nye=Le,Hye=Lr,oW=Hn.f,iW=jt,Lye=!iW||Nye(function(){oW(1)});Dye({target:"Object",stat:!0,forced:Lye,sham:!iW},{getOwnPropertyDescriptor:function(t,r){return oW(Hye(t),r)}});var jye="localHooks",aW={_localHooks:Object.create(null),addLocalHook:function(t,r){return this._localHooks[t]||(this._localHooks[t]=[]),this._localHooks[t].push(r),this},runLocalHooks:function(t,r,n,o,i,a,l){if(this._localHooks[t])for(var s=this._localHooks[t].length,u=0;u<s;u++)dC(this._localHooks[t][u],this,r,n,o,i,a,l)},clearLocalHooks:function(){return this._localHooks={},this}};Lo(aW,"MIXIN_NAME",jye,{writable:!1,enumerable:!1});const Er=aW;function uh(e){"@babel/helpers - typeof";return uh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},uh(e)}function Fye(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function sI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Vye(n.key),n)}}function Bye(e,t,r){return t&&sI(e.prototype,t),r&&sI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Vye(e){var t=Wye(e,"string");return uh(t)==="symbol"?t:String(t)}function Wye(e,t){if(uh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(uh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Xa=function(){function e(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;Fye(this,e),this.indexedValues=[],this.initValueOrFn=t}return Bye(e,[{key:"getValues",value:function(){return this.indexedValues}},{key:"getValueAtIndex",value:function(r){var n=this.indexedValues;if(r<n.length)return n[r]}},{key:"setValues",value:function(r){this.indexedValues=r.slice(),this.runLocalHooks("change")}},{key:"setValueAtIndex",value:function(r,n){return r<this.indexedValues.length?(this.indexedValues[r]=n,this.runLocalHooks("change"),!0):!1}},{key:"clear",value:function(){this.setDefaultValues()}},{key:"getLength",value:function(){return this.getValues().length}},{key:"setDefaultValues",value:function(){var r=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.indexedValues.length=0,vt(this.initValueOrFn)?_e(n-1,function(o){return r.indexedValues.push(r.initValueOrFn(o))}):_e(n-1,function(){return r.indexedValues.push(r.initValueOrFn)}),this.runLocalHooks("change")}},{key:"init",value:function(r){return this.setDefaultValues(r),this.runLocalHooks("init"),this}},{key:"insert",value:function(){this.runLocalHooks("change")}},{key:"remove",value:function(){this.runLocalHooks("change")}},{key:"destroy",value:function(){this.clearLocalHooks(),this.indexedValues=null,this.initValueOrFn=null}}]),e}();dt(Xa,Er);function uw(e){return Gye(e)||Yye(e)||zye(e)||Uye()}function Uye(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function zye(e,t){if(e){if(typeof e=="string")return ZC(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return ZC(e,t)}}function Yye(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Gye(e){if(Array.isArray(e))return ZC(e)}function ZC(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function e0(e,t,r,n){var o=r.length?r[0]:void 0;return[].concat(uw(e.slice(0,o)),uw(r.map(function(i,a){return vt(n)?n(i,a):n})),uw(o===void 0?[]:e.slice(o)))}function t0(e,t){return Yr(e,function(r,n){return t.includes(n)===!1})}function Os(e){"@babel/helpers - typeof";return Os=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Os(e)}function Kye(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function uI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Xye(n.key),n)}}function qye(e,t,r){return t&&uI(e.prototype,t),r&&uI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Xye(e){var t=Zye(e,"string");return Os(t)==="symbol"?t:String(t)}function Zye(e,t){if(Os(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Os(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function hc(){return typeof Reflect<"u"&&Reflect.get?hc=Reflect.get.bind():hc=function(t,r,n){var o=Qye(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},hc.apply(this,arguments)}function Qye(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=xa(e),e!==null););return e}function Jye(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&QC(e,t)}function QC(e,t){return QC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},QC(e,t)}function ege(e){var t=nge();return function(){var n=xa(e),o;if(t){var i=xa(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return tge(this,o)}}function tge(e,t){if(t&&(Os(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return rge(e)}function rge(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function nge(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function xa(e){return xa=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},xa(e)}var Ri=function(e){Jye(r,e);var t=ege(r);function r(){return Kye(this,r),t.apply(this,arguments)}return qye(r,[{key:"insert",value:function(o,i){this.indexedValues=e0(this.indexedValues,o,i,this.initValueOrFn),hc(xa(r.prototype),"insert",this).call(this,o,i)}},{key:"remove",value:function(o){this.indexedValues=t0(this.indexedValues,o),hc(xa(r.prototype),"remove",this).call(this,o)}}]),r}(Xa);function Rs(e){"@babel/helpers - typeof";return Rs=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Rs(e)}function oge(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function fI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,age(n.key),n)}}function ige(e,t,r){return t&&fI(e.prototype,t),r&&fI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function age(e){var t=lge(e,"string");return Rs(t)==="symbol"?t:String(t)}function lge(e,t){if(Rs(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Rs(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function sge(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&JC(e,t)}function JC(e,t){return JC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},JC(e,t)}function uge(e){var t=hge();return function(){var n=sm(e),o;if(t){var i=sm(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return fge(this,o)}}function fge(e,t){if(t&&(Rs(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return cge(e)}function cge(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function hge(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function sm(e){return sm=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},sm(e)}var mp=function(e){sge(r,e);var t=uge(r);function r(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return oge(this,r),t.call(this,n)}return ige(r,[{key:"getHiddenIndexes",value:function(){return nr(this.getValues(),function(o,i,a){return i&&o.push(a),o},[])}}]),r}(Ri);function fw(e){return gge(e)||yge(e)||vge(e)||dge()}function dge(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function vge(e,t){if(e){if(typeof e=="string")return e_(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return e_(e,t)}}function yge(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function gge(e){if(Array.isArray(e))return e_(e)}function e_(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function r0(e,t,r){return[].concat(fw(e.slice(0,t)),fw(r),fw(e.slice(t)))}function fh(e,t){return Yr(e,function(r){return t.includes(r)===!1})}function n0(e,t){return Ye(e,function(r){return r-t.filter(function(n){return n<r}).length})}function o0(e,t){var r=t[0],n=t.length;return Ye(e,function(o){return o>=r?o+n:o})}function Es(e){"@babel/helpers - typeof";return Es=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Es(e)}function mge(e){return Sge(e)||wge(e)||bge(e)||pge()}function pge(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function bge(e,t){if(e){if(typeof e=="string")return t_(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return t_(e,t)}}function wge(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Sge(e){if(Array.isArray(e))return t_(e)}function t_(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Cge(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function cI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,sW(n.key),n)}}function _ge(e,t,r){return t&&cI(e.prototype,t),r&&cI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function to(){return typeof Reflect<"u"&&Reflect.get?to=Reflect.get.bind():to=function(t,r,n){var o=Oge(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},to.apply(this,arguments)}function Oge(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=an(e),e!==null););return e}function Rge(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&r_(e,t)}function r_(e,t){return r_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},r_(e,t)}function Ege(e){var t=kge();return function(){var n=an(e),o;if(t){var i=an(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Tge(this,o)}}function Tge(e,t){if(t&&(Es(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return lW(e)}function lW(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function kge(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function an(e){return an=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},an(e)}function Pge(e,t,r){return t=sW(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function sW(e){var t=$ge(e,"string");return Es(t)==="symbol"?t:String(t)}function $ge(e,t){if(Es(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Es(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var pp=function(e){Rge(r,e);var t=Ege(r);function r(){var n;Cge(this,r);for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return n=t.call.apply(t,[this].concat(i)),Pge(lW(n),"orderOfIndexes",[]),n}return _ge(r,[{key:"getValues",value:function(){var o=this;return this.orderOfIndexes.map(function(i){return o.indexedValues[i]})}},{key:"setValues",value:function(o){this.orderOfIndexes=mge(Array(o.length).keys()),to(an(r.prototype),"setValues",this).call(this,o)}},{key:"setValueAtIndex",value:function(o,i){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.orderOfIndexes.length;return o<this.indexedValues.length?(this.indexedValues[o]=i,this.orderOfIndexes.includes(o)===!1&&this.orderOfIndexes.splice(a,0,o),this.runLocalHooks("change"),!0):!1}},{key:"clearValue",value:function(o){this.orderOfIndexes=fh(this.orderOfIndexes,[o]),vt(this.initValueOrFn)?to(an(r.prototype),"setValueAtIndex",this).call(this,o,this.initValueOrFn(o)):to(an(r.prototype),"setValueAtIndex",this).call(this,o,this.initValueOrFn)}},{key:"getLength",value:function(){return this.orderOfIndexes.length}},{key:"setDefaultValues",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.orderOfIndexes.length=0,to(an(r.prototype),"setDefaultValues",this).call(this,o)}},{key:"insert",value:function(o,i){this.indexedValues=e0(this.indexedValues,o,i,this.initValueOrFn),this.orderOfIndexes=o0(this.orderOfIndexes,i),to(an(r.prototype),"insert",this).call(this,o,i)}},{key:"remove",value:function(o){this.indexedValues=t0(this.indexedValues,o),this.orderOfIndexes=fh(this.orderOfIndexes,o),this.orderOfIndexes=n0(this.orderOfIndexes,o),to(an(r.prototype),"remove",this).call(this,o)}},{key:"getEntries",value:function(){var o=this;return this.orderOfIndexes.map(function(i){return[i,o.getValueAtIndex(i)]})}}]),r}(Xa);function Ts(e){"@babel/helpers - typeof";return Ts=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ts(e)}function Age(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function hI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Mge(n.key),n)}}function Ige(e,t,r){return t&&hI(e.prototype,t),r&&hI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Mge(e){var t=xge(e,"string");return Ts(t)==="symbol"?t:String(t)}function xge(e,t){if(Ts(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ts(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Dge(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&n_(e,t)}function n_(e,t){return n_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},n_(e,t)}function Nge(e){var t=jge();return function(){var n=um(e),o;if(t){var i=um(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Hge(this,o)}}function Hge(e,t){if(t&&(Ts(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Lge(e)}function Lge(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function jge(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function um(e){return um=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},um(e)}var uv=function(e){Dge(r,e);var t=Nge(r);function r(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return Age(this,r),t.call(this,n)}return Ige(r,[{key:"getTrimmedIndexes",value:function(){return nr(this.getValues(),function(o,i,a){return i&&o.push(a),o},[])}}]),r}(Ri),dI=new Map([["indexesSequence",{getListWithInsertedItems:r0,getListWithRemovedItems:fh}],["physicallyIndexed",{getListWithInsertedItems:e0,getListWithRemovedItems:t0}]]),uW=function(t){if(dI.has(t)===!1)throw new Error("Alter strategy with ID '".concat(t,"' does not exist."));return dI.get(t)};function ks(e){"@babel/helpers - typeof";return ks=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ks(e)}function Fge(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function vI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Vge(n.key),n)}}function Bge(e,t,r){return t&&vI(e.prototype,t),r&&vI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Vge(e){var t=Wge(e,"string");return ks(t)==="symbol"?t:String(t)}function Wge(e,t){if(ks(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ks(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function dc(){return typeof Reflect<"u"&&Reflect.get?dc=Reflect.get.bind():dc=function(t,r,n){var o=Uge(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},dc.apply(this,arguments)}function Uge(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Da(e),e!==null););return e}function zge(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&o_(e,t)}function o_(e,t){return o_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},o_(e,t)}function Yge(e){var t=qge();return function(){var n=Da(e),o;if(t){var i=Da(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Gge(this,o)}}function Gge(e,t){if(t&&(ks(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Kge(e)}function Kge(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function qge(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Da(e){return Da=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Da(e)}var fW=function(e){zge(r,e);var t=Yge(r);function r(){return Fge(this,r),t.call(this,function(n){return n})}return Bge(r,[{key:"insert",value:function(o,i){var a=o0(this.indexedValues,i);this.indexedValues=r0(a,o,i),dc(Da(r.prototype),"insert",this).call(this,o,i)}},{key:"remove",value:function(o){var i=fh(this.indexedValues,o);this.indexedValues=n0(i,o),dc(Da(r.prototype),"remove",this).call(this,o)}}]),r}(Xa),yI=new Map([["hiding",mp],["index",Xa],["linkedPhysicalIndexToValue",pp],["physicalIndexToValue",Ri],["trimming",uv]]);function Xge(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(!yI.has(e))throw new Error('The provided map type ("'.concat(e,'") does not exist.'));return new(yI.get(e))(t)}function ch(e){"@babel/helpers - typeof";return ch=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ch(e)}function Zge(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function gI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Jge(n.key),n)}}function Qge(e,t,r){return t&&gI(e.prototype,t),r&&gI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Jge(e){var t=eme(e,"string");return ch(t)==="symbol"?t:String(t)}function eme(e,t){if(ch(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ch(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var i0=function(){function e(){Zge(this,e),this.collection=new Map}return Qge(e,[{key:"register",value:function(r,n){var o=this;this.collection.has(r)===!1&&(this.collection.set(r,n),n.addLocalHook("change",function(){return o.runLocalHooks("change",n)}))}},{key:"unregister",value:function(r){var n=this.collection.get(r);ye(n)&&(n.destroy(),this.collection.delete(r),this.runLocalHooks("change",n))}},{key:"unregisterAll",value:function(){var r=this;this.collection.forEach(function(n,o){return r.unregister(o)}),this.collection.clear()}},{key:"get",value:function(r){return gt(r)?Array.from(this.collection.values()):this.collection.get(r)}},{key:"getLength",value:function(){return this.collection.size}},{key:"removeFromEvery",value:function(r){this.collection.forEach(function(n){n.remove(r)})}},{key:"insertToEvery",value:function(r,n){this.collection.forEach(function(o){o.insert(r,n)})}},{key:"initEvery",value:function(r){this.collection.forEach(function(n){n.init(r)})}}]),e}();dt(i0,Er);function Ps(e){"@babel/helpers - typeof";return Ps=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ps(e)}function tme(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function mI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,nme(n.key),n)}}function rme(e,t,r){return t&&mI(e.prototype,t),r&&mI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function nme(e){var t=ome(e,"string");return Ps(t)==="symbol"?t:String(t)}function ome(e,t){if(Ps(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ps(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ime(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&i_(e,t)}function i_(e,t){return i_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},i_(e,t)}function ame(e){var t=ume();return function(){var n=fm(e),o;if(t){var i=fm(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return lme(this,o)}}function lme(e,t){if(t&&(Ps(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return sme(e)}function sme(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ume(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function fm(e){return fm=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},fm(e)}var pI=function(e){ime(r,e);var t=ame(r);function r(n,o){var i;return tme(this,r),i=t.call(this),i.mergedValuesCache=[],i.aggregationFunction=n,i.fallbackValue=o,i}return rme(r,[{key:"getMergedValues",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(o===!0)return this.mergedValuesCache;if(this.getLength()===0)return[];for(var i=Ye(this.get(),function(c){return c.getValues()}),a=[],l=ye(i[0])&&i[0].length||0,s=0;s<l;s+=1){for(var u=[],f=0;f<this.getLength();f+=1)u.push(i[f][s]);a.push(u)}return Ye(a,this.aggregationFunction)}},{key:"getMergedValueAtIndex",value:function(o,i){var a=this.getMergedValues(i)[o];return ye(a)?a:this.fallbackValue}},{key:"updateCache",value:function(){this.mergedValuesCache=this.getMergedValues(!1)}}]),r}(i0);function hh(e){"@babel/helpers - typeof";return hh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},hh(e)}function fme(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function bI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,hme(n.key),n)}}function cme(e,t,r){return t&&bI(e.prototype,t),r&&bI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function hme(e){var t=dme(e,"string");return hh(t)==="symbol"?t:String(t)}function dme(e,t){if(hh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(hh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function vme(e,t,r){yme(e,t),t.set(e,r)}function yme(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function gme(e,t,r){var n=cW(e,t,"set");return mme(e,n,r),r}function mme(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}function pme(e,t){var r=cW(e,t,"get");return bme(e,r)}function cW(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function bme(e,t){return t.get?t.get.call(e):t.value}var cw=new WeakMap,hW=function(){function e(){fme(this,e),vme(this,cw,{writable:!0,value:[]})}return cme(e,[{key:"subscribe",value:function(r){return this.addLocalHook("change",r),this._write(pme(this,cw)),this}},{key:"unsubscribe",value:function(){return this.runLocalHooks("unsubscribe"),this.clearLocalHooks(),this}},{key:"_write",value:function(r){return r.length>0&&this.runLocalHooks("change",r),this}},{key:"_writeInitialChanges",value:function(r){gme(this,cw,r)}}]),e}();dt(hW,Er);function wI(e,t){for(var r=[],n=0,o=0;n<e.length&&o<t.length;n++,o++)e[n]!==t[o]&&r.push({op:"replace",index:o,oldValue:e[n],newValue:t[o]});for(;n<t.length;n++)r.push({op:"insert",index:n,oldValue:void 0,newValue:t[n]});for(;o<e.length;o++)r.push({op:"remove",index:o,oldValue:e[o],newValue:void 0});return r}function dh(e){"@babel/helpers - typeof";return dh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},dh(e)}function wme(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function SI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Cme(n.key),n)}}function Sme(e,t,r){return t&&SI(e.prototype,t),r&&SI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Cme(e){var t=_me(e,"string");return dh(t)==="symbol"?t:String(t)}function _me(e,t){if(dh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(dh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Df(e,t,r){Ome(e,t),t.set(e,r)}function Ome(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Br(e,t){var r=dW(e,t,"get");return Rme(e,r)}function Rme(e,t){return t.get?t.get.call(e):t.value}function Uv(e,t,r){var n=dW(e,t,"set");return Eme(e,n,r),r}function dW(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function Eme(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}var zv=new WeakMap,Nf=new WeakMap,Yv=new WeakMap,Gv=new WeakMap,Kv=new WeakMap,Tme=function(){function e(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=t.initialIndexValue;wme(this,e),Df(this,zv,{writable:!0,value:new Set}),Df(this,Nf,{writable:!0,value:[]}),Df(this,Yv,{writable:!0,value:[]}),Df(this,Gv,{writable:!0,value:!1}),Df(this,Kv,{writable:!0,value:!1}),Uv(this,Kv,r??!1)}return Sme(e,[{key:"createObserver",value:function(){var r=this,n=new hW;return Br(this,zv).add(n),n.addLocalHook("unsubscribe",function(){Br(r,zv).delete(n)}),n._writeInitialChanges(wI(Br(this,Nf),Br(this,Yv))),n}},{key:"emit",value:function(r){var n=Br(this,Yv);(!Br(this,Gv)||Br(this,Nf).length!==r.length)&&(r.length===0?r=new Array(n.length).fill(Br(this,Kv)):Uv(this,Nf,new Array(r.length).fill(Br(this,Kv))),Br(this,Gv)||(Uv(this,Gv,!0),n=Br(this,Nf)));var o=wI(n,r);Br(this,zv).forEach(function(i){return i._write(o)}),Uv(this,Yv,r)}}]),e}();function vh(e){"@babel/helpers - typeof";return vh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},vh(e)}function hw(e){return Ame(e)||$me(e)||Pme(e)||kme()}function kme(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Pme(e,t){if(e){if(typeof e=="string")return a_(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return a_(e,t)}}function $me(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Ame(e){if(Array.isArray(e))return a_(e)}function a_(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Ime(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function CI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,xme(n.key),n)}}function Mme(e,t,r){return t&&CI(e.prototype,t),r&&CI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function xme(e){var t=Dme(e,"string");return vh(t)==="symbol"?t:String(t)}function Dme(e,t){if(vh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(vh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var l_=function(){function e(){var t=this;Ime(this,e),this.indexesSequence=new fW,this.trimmingMapsCollection=new pI(function(r){return r.some(function(n){return n===!0})},!1),this.hidingMapsCollection=new pI(function(r){return r.some(function(n){return n===!0})},!1),this.variousMapsCollection=new i0,this.hidingChangesObservable=new Tme({initialIndexValue:!1}),this.notTrimmedIndexesCache=[],this.notHiddenIndexesCache=[],this.isBatched=!1,this.indexesSequenceChanged=!1,this.indexesChangeSource=void 0,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1,this.renderablePhysicalIndexesCache=[],this.fromPhysicalToVisualIndexesCache=new Map,this.fromVisualToRenderableIndexesCache=new Map,this.indexesSequence.addLocalHook("change",function(){t.indexesSequenceChanged=!0,t.updateCache(),t.runLocalHooks("indexesSequenceChange",t.indexesChangeSource),t.runLocalHooks("change",t.indexesSequence,null)}),this.trimmingMapsCollection.addLocalHook("change",function(r){t.trimmedIndexesChanged=!0,t.updateCache(),t.runLocalHooks("change",r,t.trimmingMapsCollection)}),this.hidingMapsCollection.addLocalHook("change",function(r){t.hiddenIndexesChanged=!0,t.updateCache(),t.runLocalHooks("change",r,t.hidingMapsCollection)}),this.variousMapsCollection.addLocalHook("change",function(r){t.runLocalHooks("change",r,t.variousMapsCollection)})}return Mme(e,[{key:"suspendOperations",value:function(){this.isBatched=!0}},{key:"resumeOperations",value:function(){this.isBatched=!1,this.updateCache()}},{key:"createChangesObserver",value:function(r){if(r!=="hiding")throw new Error('Unsupported index map type "'.concat(r,'".'));return this.hidingChangesObservable.createObserver()}},{key:"createAndRegisterIndexMap",value:function(r,n,o){return this.registerMap(r,Xge(n,o))}},{key:"registerMap",value:function(r,n){if(this.trimmingMapsCollection.get(r)||this.hidingMapsCollection.get(r)||this.variousMapsCollection.get(r))throw Error('Map with name "'.concat(r,'" has been already registered.'));n instanceof uv?this.trimmingMapsCollection.register(r,n):n instanceof mp?this.hidingMapsCollection.register(r,n):this.variousMapsCollection.register(r,n);var o=this.getNumberOfIndexes();return o>0&&n.init(o),n}},{key:"unregisterMap",value:function(r){this.trimmingMapsCollection.unregister(r),this.hidingMapsCollection.unregister(r),this.variousMapsCollection.unregister(r)}},{key:"unregisterAll",value:function(){this.trimmingMapsCollection.unregisterAll(),this.hidingMapsCollection.unregisterAll(),this.variousMapsCollection.unregisterAll()}},{key:"getPhysicalFromVisualIndex",value:function(r){var n=this.notTrimmedIndexesCache[r];return ye(n)?n:null}},{key:"getPhysicalFromRenderableIndex",value:function(r){var n=this.renderablePhysicalIndexesCache[r];return ye(n)?n:null}},{key:"getVisualFromPhysicalIndex",value:function(r){var n=this.fromPhysicalToVisualIndexesCache.get(r);return ye(n)?n:null}},{key:"getVisualFromRenderableIndex",value:function(r){return this.getVisualFromPhysicalIndex(this.getPhysicalFromRenderableIndex(r))}},{key:"getRenderableFromVisualIndex",value:function(r){var n=this.fromVisualToRenderableIndexesCache.get(r);return ye(n)?n:null}},{key:"getNearestNotHiddenIndex",value:function(r,n){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=this.getPhysicalFromVisualIndex(r);if(i===null)return null;if(this.fromVisualToRenderableIndexesCache.has(r))return r;var a=Array.from(this.fromVisualToRenderableIndexesCache.keys()),l=-1;return n>0?l=a.findIndex(function(s){return s>r}):l=a.reverse().findIndex(function(s){return s<r}),l===-1?o?this.getNearestNotHiddenIndex(r,-n,!1):null:a[l]}},{key:"initToLength",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getNumberOfIndexes();this.notTrimmedIndexesCache=hw(new Array(r).keys()),this.notHiddenIndexesCache=hw(new Array(r).keys()),this.suspendOperations(),this.indexesChangeSource="init",this.indexesSequence.init(r),this.indexesChangeSource=void 0,this.trimmingMapsCollection.initEvery(r),this.resumeOperations(),this.suspendOperations(),this.hidingMapsCollection.initEvery(r),this.variousMapsCollection.initEvery(r),this.resumeOperations(),this.runLocalHooks("init")}},{key:"fitToLength",value:function(r){var n=this.getNumberOfIndexes();if(r<n){var o=hw(Array(this.getNumberOfIndexes()-r).keys()).map(function(i){return i+r});this.removeIndexes(o)}else this.insertIndexes(n,r-n)}},{key:"getIndexesSequence",value:function(){return this.indexesSequence.getValues()}},{key:"setIndexesSequence",value:function(r){this.indexesChangeSource===void 0&&(this.indexesChangeSource="update"),this.indexesSequence.setValues(r),this.indexesChangeSource==="update"&&(this.indexesChangeSource=void 0)}},{key:"getNotTrimmedIndexes",value:function(){var r=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(n===!0)return this.notTrimmedIndexesCache;var o=this.getIndexesSequence();return o.filter(function(i){return r.isTrimmed(i)===!1})}},{key:"getNotTrimmedIndexesLength",value:function(){return this.getNotTrimmedIndexes().length}},{key:"getNotHiddenIndexes",value:function(){var r=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(n===!0)return this.notHiddenIndexesCache;var o=this.getIndexesSequence();return o.filter(function(i){return r.isHidden(i)===!1})}},{key:"getNotHiddenIndexesLength",value:function(){return this.getNotHiddenIndexes().length}},{key:"getRenderableIndexes",value:function(){var r=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(n===!0)return this.renderablePhysicalIndexesCache;var o=this.getNotTrimmedIndexes();return o.filter(function(i){return r.isHidden(i)===!1})}},{key:"getRenderableIndexesLength",value:function(){return this.getRenderableIndexes().length}},{key:"getNumberOfIndexes",value:function(){return this.getIndexesSequence().length}},{key:"moveIndexes",value:function(r,n){var o=this;typeof r=="number"&&(r=[r]);var i=Ye(r,function(c){return o.getPhysicalFromVisualIndex(c)}),a=this.getNotTrimmedIndexesLength(),l=r.length,s=fh(this.getIndexesSequence(),i),u=a-l;if(n+l<a){var f=s.filter(function(c){return o.isTrimmed(c)===!1})[n];u=s.indexOf(f)}this.indexesChangeSource="move",this.setIndexesSequence(r0(s,u,i)),this.indexesChangeSource=void 0}},{key:"isTrimmed",value:function(r){return this.trimmingMapsCollection.getMergedValueAtIndex(r)}},{key:"isHidden",value:function(r){return this.hidingMapsCollection.getMergedValueAtIndex(r)}},{key:"insertIndexes",value:function(r,n){var o=this.getNotTrimmedIndexes()[r],i=ye(o)?o:this.getNumberOfIndexes(),a=this.getIndexesSequence().includes(o)?this.getIndexesSequence().indexOf(o):this.getNumberOfIndexes(),l=Ye(new Array(n).fill(i),function(s,u){return s+u});this.suspendOperations(),this.indexesChangeSource="insert",this.indexesSequence.insert(a,l),this.indexesChangeSource=void 0,this.trimmingMapsCollection.insertToEvery(a,l),this.hidingMapsCollection.insertToEvery(a,l),this.variousMapsCollection.insertToEvery(a,l),this.resumeOperations()}},{key:"removeIndexes",value:function(r){this.suspendOperations(),this.indexesChangeSource="remove",this.indexesSequence.remove(r),this.indexesChangeSource=void 0,this.trimmingMapsCollection.removeFromEvery(r),this.hidingMapsCollection.removeFromEvery(r),this.variousMapsCollection.removeFromEvery(r),this.resumeOperations()}},{key:"updateCache",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=this.indexesSequenceChanged||this.trimmedIndexesChanged||this.hiddenIndexesChanged;(r===!0||this.isBatched===!1&&n===!0)&&(this.trimmingMapsCollection.updateCache(),this.hidingMapsCollection.updateCache(),this.notTrimmedIndexesCache=this.getNotTrimmedIndexes(!1),this.notHiddenIndexesCache=this.getNotHiddenIndexes(!1),this.renderablePhysicalIndexesCache=this.getRenderableIndexes(!1),this.cacheFromPhysicalToVisualIndexes(),this.cacheFromVisualToRenderableIndexes(),this.hiddenIndexesChanged&&this.hidingChangesObservable.emit(this.hidingMapsCollection.getMergedValues()),this.runLocalHooks("cacheUpdated",{indexesSequenceChanged:this.indexesSequenceChanged,trimmedIndexesChanged:this.trimmedIndexesChanged,hiddenIndexesChanged:this.hiddenIndexesChanged}),this.indexesSequenceChanged=!1,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1)}},{key:"cacheFromPhysicalToVisualIndexes",value:function(){var r=this.getNotTrimmedIndexesLength();this.fromPhysicalToVisualIndexesCache.clear();for(var n=0;n<r;n+=1){var o=this.getPhysicalFromVisualIndex(n);this.fromPhysicalToVisualIndexesCache.set(o,n)}}},{key:"cacheFromVisualToRenderableIndexes",value:function(){var r=this.getRenderableIndexesLength();this.fromVisualToRenderableIndexesCache.clear();for(var n=0;n<r;n+=1){var o=this.getPhysicalFromRenderableIndex(n),i=this.getVisualFromPhysicalIndex(o);this.fromVisualToRenderableIndexesCache.set(i,n)}}}]),e}();dt(l_,Er);var _I;function Nme(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function Hme(e,t){return Ke(t,function(r,n){gt(e[n])&&(e[n]=r)}),e}function vW(e){var t=/^([a-zA-Z]{2})-([a-zA-Z]{2})$/,r=t.exec(e);return r?"".concat(r[1].toLowerCase(),"-").concat(r[2].toUpperCase()):e}function yW(e){ye(e)&&LE(ft(_I||(_I=Nme(['Language with code "',`" was not found. You should register particular language 
    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.`],['Language with code "',`" was not found. You should register particular language\\x20
    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.`])),e))}function Lme(e,t){var r=Array.isArray(e)&&Number.isInteger(t);return r?e[t]:e}var gW=Qr("phraseFormatters"),jme=gW.register,Fme=gW.getValues;function Bme(e,t){jme(e,t)}function Vme(){return Fme()}Bme("pluralize",Lme);var mW="ContextMenu:items",je=mW,a0="".concat(je,".noItems"),l0="".concat(je,".insertRowAbove"),s0="".concat(je,".insertRowBelow"),u0="".concat(je,".insertColumnOnTheLeft"),f0="".concat(je,".insertColumnOnTheRight"),c0="".concat(je,".removeRow"),h0="".concat(je,".removeColumn"),d0="".concat(je,".undo"),v0="".concat(je,".redo"),y0="".concat(je,".readOnly"),g0="".concat(je,".clearColumn"),m0="".concat(je,".copy"),p0="".concat(je,".copyWithHeaders"),b0="".concat(je,".copyWithGroupHeaders"),w0="".concat(je,".copyHeadersOnly"),S0="".concat(je,".cut"),C0="".concat(je,".freezeColumn"),_0="".concat(je,".unfreezeColumn"),O0="".concat(je,".mergeCells"),R0="".concat(je,".unmergeCells"),E0="".concat(je,".addComment"),T0="".concat(je,".editComment"),k0="".concat(je,".removeComment"),P0="".concat(je,".readOnlyComment"),$0="".concat(je,".align"),A0="".concat(je,".align.left"),I0="".concat(je,".align.center"),M0="".concat(je,".align.right"),x0="".concat(je,".align.justify"),D0="".concat(je,".align.top"),N0="".concat(je,".align.middle"),H0="".concat(je,".align.bottom"),L0="".concat(je,".borders"),j0="".concat(je,".borders.top"),F0="".concat(je,".borders.right"),B0="".concat(je,".borders.bottom"),V0="".concat(je,".borders.left"),W0="".concat(je,".borders.remove"),U0="".concat(je,".nestedHeaders.insertChildRow"),z0="".concat(je,".nestedHeaders.detachFromParent"),Y0="".concat(je,".hideColumn"),G0="".concat(je,".showColumn"),K0="".concat(je,".hideRow"),q0="".concat(je,".showRow"),gr="Filters:",$t="".concat(gr,"conditions"),bp="".concat($t,".none"),X0="".concat($t,".isEmpty"),Z0="".concat($t,".isNotEmpty"),Q0="".concat($t,".isEqualTo"),J0="".concat($t,".isNotEqualTo"),eT="".concat($t,".beginsWith"),tT="".concat($t,".endsWith"),rT="".concat($t,".contains"),nT="".concat($t,".doesNotContain"),Wme="".concat($t,".byValue"),oT="".concat($t,".greaterThan"),iT="".concat($t,".greaterThanOrEqualTo"),aT="".concat($t,".lessThan"),lT="".concat($t,".lessThanOrEqualTo"),sT="".concat($t,".isBetween"),uT="".concat($t,".isNotBetween"),fT="".concat($t,".after"),cT="".concat($t,".before"),hT="".concat($t,".today"),dT="".concat($t,".tomorrow"),vT="".concat($t,".yesterday"),yT="".concat(gr,"labels.filterByCondition"),gT="".concat(gr,"labels.filterByValue"),mT="".concat(gr,"labels.conjunction"),wp="".concat(gr,"labels.disjunction"),cm="".concat(gr,"values.blankCells"),pT="".concat(gr,"buttons.selectAll"),bT="".concat(gr,"buttons.clear"),wT="".concat(gr,"buttons.ok"),ST="".concat(gr,"buttons.cancel"),CT="".concat(gr,"buttons.placeholder.search"),_T="".concat(gr,"buttons.placeholder.value"),OT="".concat(gr,"buttons.placeholder.secondValue");const Ume=Object.freeze(Object.defineProperty({__proto__:null,CONTEXTMENU_ITEMS_ADD_COMMENT:E0,CONTEXTMENU_ITEMS_ALIGNMENT:$0,CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM:H0,CONTEXTMENU_ITEMS_ALIGNMENT_CENTER:I0,CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY:x0,CONTEXTMENU_ITEMS_ALIGNMENT_LEFT:A0,CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE:N0,CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT:M0,CONTEXTMENU_ITEMS_ALIGNMENT_TOP:D0,CONTEXTMENU_ITEMS_BORDERS:L0,CONTEXTMENU_ITEMS_BORDERS_BOTTOM:B0,CONTEXTMENU_ITEMS_BORDERS_LEFT:V0,CONTEXTMENU_ITEMS_BORDERS_RIGHT:F0,CONTEXTMENU_ITEMS_BORDERS_TOP:j0,CONTEXTMENU_ITEMS_CLEAR_COLUMN:g0,CONTEXTMENU_ITEMS_COPY:m0,CONTEXTMENU_ITEMS_COPY_COLUMN_HEADERS_ONLY:w0,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_GROUP_HEADERS:b0,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_HEADERS:p0,CONTEXTMENU_ITEMS_CUT:S0,CONTEXTMENU_ITEMS_EDIT_COMMENT:T0,CONTEXTMENU_ITEMS_FREEZE_COLUMN:C0,CONTEXTMENU_ITEMS_HIDE_COLUMN:Y0,CONTEXTMENU_ITEMS_HIDE_ROW:K0,CONTEXTMENU_ITEMS_INSERT_LEFT:u0,CONTEXTMENU_ITEMS_INSERT_RIGHT:f0,CONTEXTMENU_ITEMS_MERGE_CELLS:O0,CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD:z0,CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD:U0,CONTEXTMENU_ITEMS_NO_ITEMS:a0,CONTEXTMENU_ITEMS_READ_ONLY:y0,CONTEXTMENU_ITEMS_READ_ONLY_COMMENT:P0,CONTEXTMENU_ITEMS_REDO:v0,CONTEXTMENU_ITEMS_REMOVE_BORDERS:W0,CONTEXTMENU_ITEMS_REMOVE_COLUMN:h0,CONTEXTMENU_ITEMS_REMOVE_COMMENT:k0,CONTEXTMENU_ITEMS_REMOVE_ROW:c0,CONTEXTMENU_ITEMS_ROW_ABOVE:l0,CONTEXTMENU_ITEMS_ROW_BELOW:s0,CONTEXTMENU_ITEMS_SHOW_COLUMN:G0,CONTEXTMENU_ITEMS_SHOW_ROW:q0,CONTEXTMENU_ITEMS_UNDO:d0,CONTEXTMENU_ITEMS_UNFREEZE_COLUMN:_0,CONTEXTMENU_ITEMS_UNMERGE_CELLS:R0,CONTEXT_MENU_ITEMS_NAMESPACE:mW,FILTERS_BUTTONS_CANCEL:ST,FILTERS_BUTTONS_CLEAR:bT,FILTERS_BUTTONS_OK:wT,FILTERS_BUTTONS_PLACEHOLDER_SEARCH:CT,FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE:OT,FILTERS_BUTTONS_PLACEHOLDER_VALUE:_T,FILTERS_BUTTONS_SELECT_ALL:pT,FILTERS_CONDITIONS_AFTER:fT,FILTERS_CONDITIONS_BEFORE:cT,FILTERS_CONDITIONS_BEGINS_WITH:eT,FILTERS_CONDITIONS_BETWEEN:sT,FILTERS_CONDITIONS_BY_VALUE:Wme,FILTERS_CONDITIONS_CONTAINS:rT,FILTERS_CONDITIONS_EMPTY:X0,FILTERS_CONDITIONS_ENDS_WITH:tT,FILTERS_CONDITIONS_EQUAL:Q0,FILTERS_CONDITIONS_GREATER_THAN:oT,FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL:iT,FILTERS_CONDITIONS_LESS_THAN:aT,FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL:lT,FILTERS_CONDITIONS_NAMESPACE:$t,FILTERS_CONDITIONS_NONE:bp,FILTERS_CONDITIONS_NOT_BETWEEN:uT,FILTERS_CONDITIONS_NOT_CONTAIN:nT,FILTERS_CONDITIONS_NOT_EMPTY:Z0,FILTERS_CONDITIONS_NOT_EQUAL:J0,FILTERS_CONDITIONS_TODAY:hT,FILTERS_CONDITIONS_TOMORROW:dT,FILTERS_CONDITIONS_YESTERDAY:vT,FILTERS_DIVS_FILTER_BY_CONDITION:yT,FILTERS_DIVS_FILTER_BY_VALUE:gT,FILTERS_LABELS_CONJUNCTION:mT,FILTERS_LABELS_DISJUNCTION:wp,FILTERS_NAMESPACE:gr,FILTERS_VALUES_BLANK_CELLS:cm},Symbol.toStringTag,{value:"Module"}));function yh(e){"@babel/helpers - typeof";return yh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},yh(e)}var fe;function ce(e,t,r){return t=zme(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function zme(e){var t=Yme(e,"string");return yh(t)==="symbol"?t:String(t)}function Yme(e,t){if(yh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(yh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Gme=(fe={languageCode:"en-US"},ce(fe,a0,"No available options"),ce(fe,l0,"Insert row above"),ce(fe,s0,"Insert row below"),ce(fe,u0,"Insert column left"),ce(fe,f0,"Insert column right"),ce(fe,c0,["Remove row","Remove rows"]),ce(fe,h0,["Remove column","Remove columns"]),ce(fe,d0,"Undo"),ce(fe,v0,"Redo"),ce(fe,y0,"Read only"),ce(fe,g0,"Clear column"),ce(fe,$0,"Alignment"),ce(fe,A0,"Left"),ce(fe,I0,"Center"),ce(fe,M0,"Right"),ce(fe,x0,"Justify"),ce(fe,D0,"Top"),ce(fe,N0,"Middle"),ce(fe,H0,"Bottom"),ce(fe,C0,"Freeze column"),ce(fe,_0,"Unfreeze column"),ce(fe,L0,"Borders"),ce(fe,j0,"Top"),ce(fe,F0,"Right"),ce(fe,B0,"Bottom"),ce(fe,V0,"Left"),ce(fe,W0,"Remove border(s)"),ce(fe,E0,"Add comment"),ce(fe,T0,"Edit comment"),ce(fe,k0,"Delete comment"),ce(fe,P0,"Read-only comment"),ce(fe,O0,"Merge cells"),ce(fe,R0,"Unmerge cells"),ce(fe,m0,"Copy"),ce(fe,p0,["Copy with header","Copy with headers"]),ce(fe,b0,["Copy with group header","Copy with group headers"]),ce(fe,w0,["Copy header only","Copy headers only"]),ce(fe,S0,"Cut"),ce(fe,U0,"Insert child row"),ce(fe,z0,"Detach from parent"),ce(fe,Y0,["Hide column","Hide columns"]),ce(fe,G0,["Show column","Show columns"]),ce(fe,K0,["Hide row","Hide rows"]),ce(fe,q0,["Show row","Show rows"]),ce(fe,bp,"None"),ce(fe,X0,"Is empty"),ce(fe,Z0,"Is not empty"),ce(fe,Q0,"Is equal to"),ce(fe,J0,"Is not equal to"),ce(fe,eT,"Begins with"),ce(fe,tT,"Ends with"),ce(fe,rT,"Contains"),ce(fe,nT,"Does not contain"),ce(fe,oT,"Greater than"),ce(fe,iT,"Greater than or equal to"),ce(fe,aT,"Less than"),ce(fe,lT,"Less than or equal to"),ce(fe,sT,"Is between"),ce(fe,uT,"Is not between"),ce(fe,fT,"After"),ce(fe,cT,"Before"),ce(fe,hT,"Today"),ce(fe,dT,"Tomorrow"),ce(fe,vT,"Yesterday"),ce(fe,cm,"Blank cells"),ce(fe,yT,"Filter by condition"),ce(fe,gT,"Filter by value"),ce(fe,mT,"And"),ce(fe,wp,"Or"),ce(fe,pT,"Select all"),ce(fe,bT,"Clear"),ce(fe,wT,"OK"),ce(fe,ST,"Cancel"),ce(fe,CT,"Search"),ce(fe,_T,"Value"),ce(fe,OT,"Second value"),fe);const pW=Gme;var s_=pW.languageCode,Sp=Qr("languagesDictionaries"),Kme=Sp.register,bW=Sp.getItem,qme=Sp.hasItem,Xme=Sp.getValues;wW(pW);function wW(e,t){var r=e,n=t;return Ge(e)&&(n=e,r=n.languageCode),Zme(r,n),Kme(r,dr(n)),dr(n)}function Zme(e,t){e!==s_&&Hme(t,bW(s_))}function SW(e){return RT(e)?dr(bW(e)):null}function RT(e){return qme(e)}function Qme(){return Xme()}function CW(e,t,r){var n=SW(e);if(n===null)return null;var o=n[t];if(gt(o))return null;var i=Jme(o,r);return Array.isArray(i)?i[0]:i}function Jme(e,t){var r=e;return I(Vme(),function(n){r=n(e,t)}),r}function epe(e){var t=vW(e);return RT(t)||(t=s_,yW(e)),t}var tpe=$e,rpe=jt,npe=jL,ope=Lr,ipe=Hn,ape=uf;tpe({target:"Object",stat:!0,sham:!rpe},{getOwnPropertyDescriptors:function(t){for(var r=ope(t),n=ipe.f,o=npe(r),i={},a=0,l,s;o.length>a;)s=n(r,l=o[a++]),s!==void 0&&ape(i,l,s);return i}});var Cp="active-header",_p="area",gh="cell",ET="fill",fv="header",TT="custom-selection";function $s(e){"@babel/helpers - typeof";return $s=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$s(e)}function lpe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function OI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,OW(n.key),n)}}function spe(e,t,r){return t&&OI(e.prototype,t),r&&OI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Xy(){return typeof Reflect<"u"&&Reflect.get?Xy=Reflect.get.bind():Xy=function(t,r,n){var o=upe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Xy.apply(this,arguments)}function upe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=As(e),e!==null););return e}function fpe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&u_(e,t)}function u_(e,t){return u_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},u_(e,t)}function cpe(e){var t=dpe();return function(){var n=As(e),o;if(t){var i=As(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return hpe(this,o)}}function hpe(e,t){if(t&&($s(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return _W(e)}function _W(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function dpe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function As(e){return As=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},As(e)}function vpe(e,t,r){return t=OW(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function OW(e){var t=ype(e,"string");return $s(t)==="symbol"?t:String(t)}function ype(e,t){if($s(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if($s(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var gpe=function(e){fpe(r,e);var t=cpe(r);function r(n,o){var i;return lpe(this,r),i=t.call(this,n,null),vpe(_W(i),"visualCellRange",null),i.visualCellRange=o||null,i.commit(),i}return spe(r,[{key:"add",value:function(o){return this.visualCellRange===null?this.visualCellRange=this.settings.createCellRange(o):this.visualCellRange.expand(o),this}},{key:"clear",value:function(){return this.visualCellRange=null,Xy(As(r.prototype),"clear",this).call(this)}},{key:"trimToVisibleCellsRangeOnly",value:function(o){var i=o.from,a=o.to,l=this.getNearestNotHiddenCoords(i,1),s=this.getNearestNotHiddenCoords(a,-1);if(l===null||s===null)return null;if(l.row>s.row||l.col>s.col){var u=this.settings.type==="header"||this.settings.type==="active-header";if(!u)return null;l=i,s=a}return this.settings.createCellRange(l,l,s)}},{key:"getNearestNotHiddenCoords",value:function(o,i){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:i,l=this.getNearestNotHiddenIndex(this.settings.rowIndexMapper(),o.row,i);if(l===null)return null;var s=this.getNearestNotHiddenIndex(this.settings.columnIndexMapper(),o.col,a);return s===null?null:this.settings.createCellCoords(l,s)}},{key:"getNearestNotHiddenIndex",value:function(o,i,a){if(i<0)return i;var l=o.getNearestNotHiddenIndex(i,a),s=this.settings.type==="header"||this.settings.type==="active-header";return s&&l===null?-1:l}},{key:"commit",value:function(){if(this.visualCellRange===null)return this;var o=this.trimToVisibleCellsRangeOnly(this.visualCellRange);return o===null?this.cellRange=null:this.cellRange=this.createRenderableCellRange(o.from,o.to),this}},{key:"syncWith",value:function(o){var i=o.getVerticalDirection()==="N-S"?1:-1,a=o.getHorizontalDirection()==="W-E"?1:-1,l=this.getNearestNotHiddenCoords(o.from.clone().normalize(),i,a);if(l!==null&&o.overlaps(l)){if(this.cellRange===null){var s=this.settings.visualToRenderableCoords(l);this.cellRange=this.settings.createCellRange(s)}return o.setHighlight(l),this}return o.setHighlight(o.from),this}},{key:"getCorners",value:function(){var o=this.cellRange,i=o.from,a=o.to,l=i.row===null||a.row===null,s=i.col===null||a.col===null,u=this.settings.createCellCoords(l?null:Math.min(i.row,a.row),s?null:Math.min(i.col,a.col)),f=this.settings.createCellCoords(l?null:Math.max(i.row,a.row),s?null:Math.max(i.col,a.col));return[u.row,u.col,f.row,f.col]}},{key:"getVisualCorners",value:function(){var o=this.settings.renderableToVisualCoords(this.cellRange.getTopStartCorner()),i=this.settings.renderableToVisualCoords(this.cellRange.getBottomEndCorner());return[o.row,o.col,i.row,i.col]}},{key:"createRenderableCellRange",value:function(o,i){var a=this.settings.visualToRenderableCoords(o),l=this.settings.visualToRenderableCoords(i);return this.settings.createCellRange(a,a,l)}}]),r}(Qve);const gf=gpe;function mh(e){"@babel/helpers - typeof";return mh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},mh(e)}var mpe=["activeHeaderClassName"];function RI(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function EI(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?RI(Object(r),!0).forEach(function(n){ppe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):RI(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function ppe(e,t,r){return t=bpe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function bpe(e){var t=wpe(e,"string");return mh(t)==="symbol"?t:String(t)}function wpe(e,t){if(mh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(mh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Spe(e,t){if(e==null)return{};var r=Cpe(e,t),n,o;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)n=i[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function Cpe(e,t){if(e==null)return{};var r={},n=Object.keys(e),o,i;for(i=0;i<n.length;i++)o=n[i],!(t.indexOf(o)>=0)&&(r[o]=e[o]);return r}function _pe(e){var t=e.activeHeaderClassName,r=Spe(e,mpe),n=new gf(EI(EI({highlightHeaderClassName:t},r),{},{selectionType:Cp}));return n}function ph(e){"@babel/helpers - typeof";return ph=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ph(e)}var Ope=["layerLevel","areaCornerVisible"];function TI(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function kI(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?TI(Object(r),!0).forEach(function(n){Rpe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):TI(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Rpe(e,t,r){return t=Epe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Epe(e){var t=Tpe(e,"string");return ph(t)==="symbol"?t:String(t)}function Tpe(e,t){if(ph(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ph(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function kpe(e,t){if(e==null)return{};var r=Ppe(e,t),n,o;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)n=i[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function Ppe(e,t){if(e==null)return{};var r={},n=Object.keys(e),o,i;for(i=0;i<n.length;i++)o=n[i],!(t.indexOf(o)>=0)&&(r[o]=e[o]);return r}function $pe(e){var t=e.layerLevel,r=e.areaCornerVisible,n=kpe(e,Ope),o=new gf(kI(kI({className:"area",markIntersections:!0,layerLevel:Math.min(t,7),border:{width:1,color:"#4b89ff",cornerVisible:r}},n),{},{selectionType:_p}));return o}function bh(e){"@babel/helpers - typeof";return bh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},bh(e)}var Ape=["cellCornerVisible"];function PI(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function $I(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?PI(Object(r),!0).forEach(function(n){Ipe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):PI(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Ipe(e,t,r){return t=Mpe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Mpe(e){var t=xpe(e,"string");return bh(t)==="symbol"?t:String(t)}function xpe(e,t){if(bh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(bh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Dpe(e,t){if(e==null)return{};var r=Npe(e,t),n,o;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)n=i[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function Npe(e,t){if(e==null)return{};var r={},n=Object.keys(e),o,i;for(i=0;i<n.length;i++)o=n[i],!(t.indexOf(o)>=0)&&(r[o]=e[o]);return r}function Hpe(e){var t=e.cellCornerVisible,r=Dpe(e,Ape),n=new gf($I($I({className:"current",border:{width:2,color:"#4b89ff",cornerVisible:t}},r),{},{selectionType:gh}));return n}function wh(e){"@babel/helpers - typeof";return wh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},wh(e)}var Lpe=["border","visualCellRange"];function AI(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function dw(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?AI(Object(r),!0).forEach(function(n){jpe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):AI(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function jpe(e,t,r){return t=Fpe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Fpe(e){var t=Bpe(e,"string");return wh(t)==="symbol"?t:String(t)}function Bpe(e,t){if(wh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(wh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Vpe(e,t){if(e==null)return{};var r=Wpe(e,t),n,o;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)n=i[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function Wpe(e,t){if(e==null)return{};var r={},n=Object.keys(e),o,i;for(i=0;i<n.length;i++)o=n[i],!(t.indexOf(o)>=0)&&(r[o]=e[o]);return r}function Upe(e){var t=e.border,r=e.visualCellRange,n=Vpe(e,Lpe),o=new gf(dw(dw(dw({},t),n),{},{selectionType:TT}),r);return o}var II=jt,zpe=Ve,Ype=Ut,Gpe=Le,vw=xd,Kpe=Fd,qpe=Ld,Xpe=Rr,Zpe=Pd,sl=Object.assign,MI=Object.defineProperty,Qpe=zpe([].concat),Jpe=!sl||Gpe(function(){if(II&&sl({b:1},sl(MI({},"a",{enumerable:!0,get:function(){MI(this,"b",{value:3,enumerable:!1})}}),{b:2})).b!==1)return!0;var e={},t={},r=Symbol(),n="abcdefghijklmnopqrst";return e[r]=7,n.split("").forEach(function(o){t[o]=o}),sl({},e)[r]!=7||vw(sl({},t)).join("")!=n})?function(t,r){for(var n=Xpe(t),o=arguments.length,i=1,a=Kpe.f,l=qpe.f;o>i;)for(var s=Zpe(arguments[i++]),u=a?Qpe(vw(s),a(s)):vw(s),f=u.length,c=0,h;f>c;)h=u[c++],(!II||Ype(l,s,h))&&(n[h]=s[h]);return n}:sl,ebe=$e,xI=Jpe;ebe({target:"Object",stat:!0,arity:2,forced:Object.assign!==xI},{assign:xI});function Sh(e){"@babel/helpers - typeof";return Sh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Sh(e)}function DI(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function NI(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?DI(Object(r),!0).forEach(function(n){tbe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):DI(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function tbe(e,t,r){return t=rbe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function rbe(e){var t=nbe(e,"string");return Sh(t)==="symbol"?t:String(t)}function nbe(e,t){if(Sh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Sh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function obe(e){if(e==null)throw new TypeError("Cannot destructure "+e)}function ibe(e){var t=Object.assign({},(obe(e),e)),r=new gf(NI(NI({className:"fill",border:{width:1,color:"#ff0000"}},t),{},{selectionType:ET}));return r}function Ch(e){"@babel/helpers - typeof";return Ch=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ch(e)}var abe=["headerClassName","rowClassName","columnClassName"];function HI(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function LI(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?HI(Object(r),!0).forEach(function(n){lbe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):HI(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function lbe(e,t,r){return t=sbe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function sbe(e){var t=ube(e,"string");return Ch(t)==="symbol"?t:String(t)}function ube(e,t){if(Ch(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ch(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function fbe(e,t){if(e==null)return{};var r=cbe(e,t),n,o;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)n=i[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function cbe(e,t){if(e==null)return{};var r={},n=Object.keys(e),o,i;for(i=0;i<n.length;i++)o=n[i],!(t.indexOf(o)>=0)&&(r[o]=e[o]);return r}function hbe(e){var t=e.headerClassName,r=e.rowClassName,n=e.columnClassName,o=fbe(e,abe),i=new gf(LI(LI({className:"highlight",highlightHeaderClassName:t,highlightRowClassName:r,highlightColumnClassName:n},o),{},{highlightOnlyClosestHeader:!0,selectionType:fv}));return i}function _h(e){"@babel/helpers - typeof";return _h=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_h(e)}function jI(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function dbe(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?jI(Object(r),!0).forEach(function(n){vbe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):jI(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function vbe(e,t,r){return t=ybe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ybe(e){var t=gbe(e,"string");return _h(t)==="symbol"?t:String(t)}function gbe(e,t){if(_h(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_h(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var RW=Qr("highlight/types"),mf=RW.register,mbe=RW.getItem;mf(Cp,_pe);mf(_p,$pe);mf(gh,Hpe);mf(TT,Upe);mf(ET,ibe);mf(fv,hbe);function ul(e,t){return mbe(e)(dbe({type:e},t))}function Oh(e){"@babel/helpers - typeof";return Oh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Oh(e)}function Uo(e){return Sbe(e)||wbe(e)||bbe(e)||pbe()}function pbe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function bbe(e,t){if(e){if(typeof e=="string")return f_(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return f_(e,t)}}function wbe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Sbe(e){if(Array.isArray(e))return f_(e)}function f_(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function FI(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function Hf(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?FI(Object(r),!0).forEach(function(n){Cbe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):FI(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Cbe(e,t,r){return t=EW(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _be(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function BI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,EW(n.key),n)}}function Obe(e,t,r){return t&&BI(e.prototype,t),r&&BI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function EW(e){var t=Rbe(e,"string");return Oh(t)==="symbol"?t:String(t)}function Rbe(e,t){if(Oh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Oh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Ebe=function(e){function t(r){_be(this,t),this.options=r,this.layerLevel=0,this.cell=ul(gh,r),this.fill=ul(ET,r),this.areas=new Map,this.headers=new Map,this.activeHeaders=new Map,this.customSelections=[]}return Obe(t,[{key:"isEnabledFor",value:function(n,o){var i=n;n===gh&&(i="current");var a=this.options.disabledCellSelection(o.row,o.col);return typeof a=="string"&&(a=[a]),a===!1||Array.isArray(a)&&!a.includes(i)}},{key:"useLayerLevel",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.layerLevel=n,this}},{key:"getCell",value:function(){return this.cell}},{key:"getFill",value:function(){return this.fill}},{key:"createOrGetArea",value:function(){var n=this.layerLevel,o;return this.areas.has(n)?o=this.areas.get(n):(o=ul(_p,Hf({layerLevel:n},this.options)),this.areas.set(n,o)),o}},{key:"getAreas",value:function(){return Uo(this.areas.values())}},{key:"createOrGetHeader",value:function(){var n=this.layerLevel,o;return this.headers.has(n)?o=this.headers.get(n):(o=ul(fv,Hf({},this.options)),this.headers.set(n,o)),o}},{key:"getHeaders",value:function(){return Uo(this.headers.values())}},{key:"createOrGetActiveHeader",value:function(){var n=this.layerLevel,o;return this.activeHeaders.has(n)?o=this.activeHeaders.get(n):(o=ul(Cp,Hf({},this.options)),this.activeHeaders.set(n,o)),o}},{key:"getActiveHeaders",value:function(){return Uo(this.activeHeaders.values())}},{key:"getCustomSelections",value:function(){return Uo(this.customSelections.values())}},{key:"addCustomSelection",value:function(n){this.customSelections.push(ul(TT,Hf(Hf({},this.options),n)))}},{key:"clear",value:function(){this.cell.clear(),this.fill.clear(),I(this.areas.values(),function(n){return void n.clear()}),I(this.headers.values(),function(n){return void n.clear()}),I(this.activeHeaders.values(),function(n){return void n.clear()})}},{key:e,value:function(){return[this.cell,this.fill].concat(Uo(this.areas.values()),Uo(this.headers.values()),Uo(this.activeHeaders.values()),Uo(this.customSelections))[Symbol.iterator]()}}]),t}(Symbol.iterator);const Tbe=Ebe;function Rh(e){"@babel/helpers - typeof";return Rh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Rh(e)}function kbe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function VI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,$be(n.key),n)}}function Pbe(e,t,r){return t&&VI(e.prototype,t),r&&VI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function $be(e){var t=Abe(e,"string");return Rh(t)==="symbol"?t:String(t)}function Abe(e,t){if(Rh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Rh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Ibe=function(e){function t(r){kbe(this,t),this.ranges=[],this.createCellRange=r}return Pbe(t,[{key:"isEmpty",value:function(){return this.size()===0}},{key:"set",value:function(n){return this.clear(),this.ranges.push(this.createCellRange(n)),this}},{key:"add",value:function(n){return this.ranges.push(this.createCellRange(n)),this}},{key:"pop",value:function(){return this.ranges.pop(),this}},{key:"current",value:function(){return this.peekByIndex(0)}},{key:"previous",value:function(){return this.peekByIndex(-1)}},{key:"includes",value:function(n){return this.ranges.some(function(o){return o.includes(n)})}},{key:"clear",value:function(){return this.ranges.length=0,this}},{key:"size",value:function(){return this.ranges.length}},{key:"peekByIndex",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,o=this.size()+n-1,i;return o>=0&&(i=this.ranges[o]),i}},{key:e,value:function(){return this.ranges[Symbol.iterator]()}}]),t}(Symbol.iterator);const Mbe=Ibe;function Eh(e){"@babel/helpers - typeof";return Eh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Eh(e)}function xbe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function WI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Nbe(n.key),n)}}function Dbe(e,t,r){return t&&WI(e.prototype,t),r&&WI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Nbe(e){var t=Hbe(e,"string");return Eh(t)==="symbol"?t:String(t)}function Hbe(e,t){if(Eh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Eh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var TW=function(){function e(t,r){xbe(this,e),this.range=t,this.options=r}return Dbe(e,[{key:"transformStart",value:function(r,n){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=this.options.createCellCoords(r,n),a=this.range.current().highlight,l=this.options.visualToRenderableCoords(a),s=l.row,u=l.col,f=a,c=0,h=0;if(this.runLocalHooks("beforeTransformStart",i),s!==null&&u!==null){var d=this.options.countRows(),v=this.options.countCols(),y=this.options.fixedRowsBottom(),p=this.options.minSpareRows(),w=this.options.minSpareCols(),S=this.options.autoWrapRow(),C=this.options.autoWrapCol();s+r>d-1?o&&p>0&&!(y&&s>=d-y-1)?(this.runLocalHooks("insertRowRequire",d),d=this.options.countRows()):C&&(i.row=1-d,i.col=u+i.col===v-1?1-v:1):C&&s+i.row<0&&u+i.col>=0&&(i.row=d-1,i.col=u+i.col===0?v-1:-1),u+i.col>v-1?o&&w>0?(this.runLocalHooks("insertColRequire",v),v=this.options.countCols()):S&&(i.row=s+i.row===d-1?1-d:1,i.col=1-v):S&&u+i.col<0&&s+i.row>=0&&(i.row=s+i.row===0?d-1:-1,i.col=v-1);var P=this.options.createCellCoords(s+i.row,u+i.col);c=0,h=0,P.row<0?(c=-1,P.row=0):P.row>0&&P.row>=d&&(c=1,P.row=d-1),P.col<0?(h=-1,P.col=0):P.col>0&&P.col>=v&&(h=1,P.col=v-1),f=this.options.renderableToVisualCoords(P)}return this.runLocalHooks("afterTransformStart",f,c,h),f}},{key:"transformEnd",value:function(r,n){var o=this.options.createCellCoords(r,n),i=this.range.current(),a=i.to,l=0,s=0;this.runLocalHooks("beforeTransformEnd",o);var u=this.options.visualToRenderableCoords(i.highlight),f=u.row,c=u.col;if(f!==null&&c!==null){var h=this.options.countRows(),d=this.options.countCols(),v=this.options.visualToRenderableCoords(i.to),y=v.row,p=v.col,w=this.options.createCellCoords(y+o.row,p+o.col);l=0,s=0,w.row<0?(l=-1,w.row=0):w.row>0&&w.row>=h&&(l=1,w.row=h-1),w.col<0?(s=-1,w.col=0):w.col>0&&w.col>=d&&(s=1,w.col=d-1),a=this.options.renderableToVisualCoords(w)}return this.runLocalHooks("afterTransformEnd",a,l,s),a}}]),e}();dt(TW,Er);const Lbe=TW;function kW(e,t){return Vbe(e)||Bbe(e,t)||Fbe(e,t)||jbe()}function jbe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Fbe(e,t){if(e){if(typeof e=="string")return UI(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return UI(e,t)}}function UI(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Bbe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function Vbe(e){if(Array.isArray(e))return e}function c_(e){"@babel/helpers - typeof";return c_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},c_(e)}var Op=0,Rp=1,PW=2,kT=3,Wbe=[kT,PW],Ube=[["number"],["number","string"],["number","undefined"],["number","string","undefined"]],yw=Symbol("root"),zI=Symbol("child");function Is(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:yw;if(t!==yw&&t!==zI)throw new Error("The second argument is used internally only and cannot be overwritten.");var r=Array.isArray(e),n=t===yw,o=Op;if(r){var i=e[0];if(e.length===0)o=Rp;else if(n&&i instanceof VE)o=kT;else if(n&&Array.isArray(i))o=Is(i,zI);else if(e.length>=2&&e.length<=4){var a=!e.some(function(l,s){return!Ube[s].includes(c_(l))});a&&(o=PW)}}return o}function Th(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=t.keepDirection,n=r===void 0?!1:r,o=t.propToCol;if(!Wbe.includes(e))throw new Error("Unsupported selection ranges schema type was provided.");return function(i){var a=e===kT,l=a?i.from.row:i[0],s=a?i.from.col:i[1],u=a?i.to.row:i[2],f=a?i.to.col:i[3];if(typeof o=="function"&&(typeof s=="string"&&(s=o(s)),typeof f=="string"&&(f=o(f))),gt(u)&&(u=l),gt(f)&&(f=s),!n){var c=l,h=s,d=u,v=f;l=Math.min(c,d),s=Math.min(h,v),u=Math.max(c,d),f=Math.max(h,v)}return[l,s,u,f]}}function zbe(e){var t=Is(e);if(t===Op||t===Rp)return[];var r=Th(t),n=new Set;I(e,function(a){var l=r(a),s=kW(l,4),u=s[1],f=s[3],c=Math.max(u,0),h=f-c+1;I(Array.from(new Array(h),function(d,v){return c+v}),function(d){n.has(d)||n.add(d)})});var o=Array.from(n).sort(function(a,l){return a-l}),i=nr(o,function(a,l,s,u){return s!==0&&l===u[s-1]+1?a[a.length-1][1]+=1:a.push([l,1]),a},[]);return i}function Ybe(e){var t=Is(e);if(t===Op||t===Rp)return[];var r=Th(t),n=new Set;I(e,function(a){var l=r(a),s=kW(l,3),u=s[0],f=s[2],c=Math.max(u,0),h=f-c+1;I(Array.from(new Array(h),function(d,v){return c+v}),function(d){n.has(d)||n.add(d)})});var o=Array.from(n).sort(function(a,l){return a-l}),i=nr(o,function(a,l,s,u){return s!==0&&l===u[s-1]+1?a[a.length-1][1]+=1:a.push([l,1]),a},[]);return i}function zo(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1/0;return typeof e=="number"&&e>=0&&e<t}function kh(e){"@babel/helpers - typeof";return kh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},kh(e)}var YI;function GI(e,t){return Xbe(e)||qbe(e,t)||Kbe(e,t)||Gbe()}function Gbe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Kbe(e,t){if(e){if(typeof e=="string")return KI(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return KI(e,t)}}function KI(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function qbe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function Xbe(e){if(Array.isArray(e))return e}function Zbe(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function Qbe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function qI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,ewe(n.key),n)}}function Jbe(e,t,r){return t&&qI(e.prototype,t),r&&qI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function ewe(e){var t=twe(e,"string");return kh(t)==="symbol"?t:String(t)}function twe(e,t){if(kh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(kh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var $W=function(){function e(t,r){var n=this;Qbe(this,e),this.settings=t,this.tableProps=r,this.inProgress=!1,this.selectedByCorner=!1,this.selectedByRowHeader=new Set,this.selectedByColumnHeader=new Set,this.selectedRange=new Mbe(function(o,i,a){return n.tableProps.createCellRange(o,i,a)}),this.highlight=new Tbe({headerClassName:t.currentHeaderClassName,activeHeaderClassName:t.activeHeaderClassName,rowClassName:t.currentRowClassName,columnClassName:t.currentColClassName,disabledCellSelection:function(i,a){return n.tableProps.isDisabledCellSelection(i,a)},cellCornerVisible:function(){return n.isCellCornerVisible.apply(n,arguments)},areaCornerVisible:function(){return n.isAreaCornerVisible.apply(n,arguments)},visualToRenderableCoords:function(i){return n.tableProps.visualToRenderableCoords(i)},renderableToVisualCoords:function(i){return n.tableProps.renderableToVisualCoords(i)},createCellCoords:function(i,a){return n.tableProps.createCellCoords(i,a)},createCellRange:function(i,a,l){return n.tableProps.createCellRange(i,a,l)},rowIndexMapper:function(){return n.tableProps.rowIndexMapper()},columnIndexMapper:function(){return n.tableProps.columnIndexMapper()}}),this.transformation=new Lbe(this.selectedRange,{countRows:function(){return n.tableProps.countRowsTranslated()},countCols:function(){return n.tableProps.countColsTranslated()},visualToRenderableCoords:function(i){return n.tableProps.visualToRenderableCoords(i)},renderableToVisualCoords:function(i){return n.tableProps.renderableToVisualCoords(i)},createCellCoords:function(i,a){return n.tableProps.createCellCoords(i,a)},fixedRowsBottom:function(){return t.fixedRowsBottom},minSpareRows:function(){return t.minSpareRows},minSpareCols:function(){return t.minSpareCols},autoWrapRow:function(){return t.autoWrapRow},autoWrapCol:function(){return t.autoWrapCol}}),this.transformation.addLocalHook("beforeTransformStart",function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return n.runLocalHooks.apply(n,["beforeModifyTransformStart"].concat(i))}),this.transformation.addLocalHook("afterTransformStart",function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return n.runLocalHooks.apply(n,["afterModifyTransformStart"].concat(i))}),this.transformation.addLocalHook("beforeTransformEnd",function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return n.runLocalHooks.apply(n,["beforeModifyTransformEnd"].concat(i))}),this.transformation.addLocalHook("afterTransformEnd",function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return n.runLocalHooks.apply(n,["afterModifyTransformEnd"].concat(i))}),this.transformation.addLocalHook("insertRowRequire",function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return n.runLocalHooks.apply(n,["insertRowRequire"].concat(i))}),this.transformation.addLocalHook("insertColRequire",function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return n.runLocalHooks.apply(n,["insertColRequire"].concat(i))})}return Jbe(e,[{key:"getSelectedRange",value:function(){return this.selectedRange}},{key:"begin",value:function(){this.inProgress=!0}},{key:"finish",value:function(){this.runLocalHooks("afterSelectionFinished",Array.from(this.selectedRange)),this.inProgress=!1}},{key:"isInProgress",value:function(){return this.inProgress}},{key:"setRangeStart",value:function(r,n){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=this.settings.selectionMode==="multiple",a=gt(n)?this.tableProps.getShortcutManager().isCtrlPressed():n,l=r.row<0,s=r.col<0,u=l&&s,f=r.clone();this.selectedByCorner=u,this.runLocalHooks("beforeSetRangeStart".concat(o?"Only":""),f),(!i||i&&!a&&gt(n))&&this.selectedRange.clear(),this.selectedRange.add(f),this.getLayerLevel()===0&&(this.selectedByRowHeader.clear(),this.selectedByColumnHeader.clear()),!u&&s&&this.selectedByRowHeader.add(this.getLayerLevel()),!u&&l&&this.selectedByColumnHeader.add(this.getLayerLevel()),o||this.setRangeEnd(r)}},{key:"setRangeStartOnly",value:function(r,n){this.setRangeStart(r,n,!0)}},{key:"setRangeEnd",value:function(r){if(!this.selectedRange.isEmpty()){var n=r.clone();this.runLocalHooks("beforeSetRangeEnd",n),this.begin();var o=this.selectedRange.current();this.settings.selectionMode!=="single"&&o.setTo(this.tableProps.createCellCoords(n.row,n.col)),this.highlight.getCell().clear(),this.highlight.isEnabledFor(gh,o.highlight)&&this.highlight.getCell().add(this.selectedRange.current().highlight).commit().syncWith(o);var i=this.getLayerLevel();i<this.highlight.layerLevel&&(I(this.highlight.getAreas(),function(y){return void y.clear()}),I(this.highlight.getHeaders(),function(y){return void y.clear()}),I(this.highlight.getActiveHeaders(),function(y){return void y.clear()})),this.highlight.useLayerLevel(i);var a=this.highlight.createOrGetArea(),l=this.highlight.createOrGetHeader(),s=this.highlight.createOrGetActiveHeader();if(a.clear(),l.clear(),s.clear(),this.highlight.isEnabledFor(_p,o.highlight)&&(this.isMultiple()||i>=1)&&(a.add(o.from).add(o.to).commit(),i===1)){var u=this.selectedRange.previous();this.highlight.useLayerLevel(i-1).createOrGetArea().add(u.from).commit().syncWith(u),this.highlight.useLayerLevel(i)}if(this.highlight.isEnabledFor(fv,o.highlight)){var f=this.tableProps.countRowsTranslated()===0,c=this.tableProps.countColsTranslated()===0,h=o;if((f||c)&&(h=o.clone()),f&&(h.from.row=-1),c&&(h.from.col=-1),this.settings.selectionMode==="single"?(this.isSelectedByAnyHeader()&&h.from.normalize(),l.add(h.from).commit()):l.add(h.from).add(h.to).commit(),this.isEntireRowSelected()){var d=this.tableProps.countCols()===o.getWidth();d&&s.add(this.tableProps.createCellCoords(o.from.row,-1)).add(this.tableProps.createCellCoords(o.to.row,-1)).commit()}if(this.isEntireColumnSelected()){var v=this.tableProps.countRows()===o.getHeight();v&&s.add(this.tableProps.createCellCoords(-1,o.from.col)).add(this.tableProps.createCellCoords(-1,o.to.col)).commit()}}this.runLocalHooks("afterSetRangeEnd",r)}}},{key:"isMultiple",value:function(){var r=ts(!this.selectedRange.current().isSingle());return this.runLocalHooks("afterIsMultipleSelection",r),r.value}},{key:"transformStart",value:function(r,n){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;this.setRangeStart(this.transformation.transformStart(r,n,o))}},{key:"transformEnd",value:function(r,n){this.setRangeEnd(this.transformation.transformEnd(r,n))}},{key:"getLayerLevel",value:function(){return this.selectedRange.size()-1}},{key:"isSelected",value:function(){return!this.selectedRange.isEmpty()}},{key:"isSelectedByRowHeader",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner(r)&&this.isEntireRowSelected(r)}},{key:"isEntireRowSelected",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return r===-1?this.selectedByRowHeader.size>0:this.selectedByRowHeader.has(r)}},{key:"isSelectedByColumnHeader",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner()&&this.isEntireColumnSelected(r)}},{key:"isEntireColumnSelected",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return r===-1?this.selectedByColumnHeader.size>0:this.selectedByColumnHeader.has(r)}},{key:"isSelectedByAnyHeader",value:function(){return this.isSelectedByRowHeader(-1)||this.isSelectedByColumnHeader(-1)||this.isSelectedByCorner()}},{key:"isSelectedByCorner",value:function(){return this.selectedByCorner}},{key:"inInSelection",value:function(r){return this.selectedRange.includes(r)}},{key:"isCellCornerVisible",value:function(){return this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&!this.isMultiple()}},{key:"isAreaCornerVisible",value:function(r){return Number.isInteger(r)&&r!==this.getLayerLevel()?!1:this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&this.isMultiple()}},{key:"clear",value:function(){this.selectedRange.clear(),this.highlight.clear()}},{key:"deselect",value:function(){this.isSelected()&&(this.inProgress=!1,this.clear(),this.runLocalHooks("afterDeselect"))}},{key:"selectAll",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,o=this.tableProps.countRows(),i=this.tableProps.countCols();if(!(!r&&!n&&(o===0||i===0))){var a=this.tableProps.createCellCoords(n?-1:0,r?-1:0),l=this.tableProps.createCellCoords(o-1,i-1);this.clear(),this.setRangeStartOnly(a),this.selectedByRowHeader.add(this.getLayerLevel()),this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(l),this.finish()}}},{key:"selectCells",value:function(r){var n=this,o=Is(r);if(o===Rp)return!1;if(o===Op)throw new Error(ft(YI||(YI=Zbe([`Unsupported format of the selection ranges was passed. To select cells pass 
        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd, 
        columnEnd/columnPropEnd]]) or as an array of CellRange objects.`],[`Unsupported format of the selection ranges was passed. To select cells pass\\x20
        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd,\\x20
        columnEnd/columnPropEnd]]) or as an array of CellRange objects.`]))));var i=Th(o,{propToCol:function(f){return n.tableProps.propToCol(f)},keepDirection:!0}),a=this.tableProps.countRows(),l=this.tableProps.countCols(),s=!r.some(function(u){var f=i(u),c=GI(f,4),h=c[0],d=c[1],v=c[2],y=c[3],p=zo(h,a)&&zo(d,l)&&zo(v,a)&&zo(y,l);return!p});return s&&(this.clear(),I(r,function(u){var f=i(u),c=GI(f,4),h=c[0],d=c[1],v=c[2],y=c[3];n.setRangeStartOnly(n.tableProps.createCellCoords(h,d),!1),n.setRangeEnd(n.tableProps.createCellCoords(v,y)),n.finish()})),s}},{key:"selectColumns",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:r,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:-1,i=typeof r=="string"?this.tableProps.propToCol(r):r,a=typeof n=="string"?this.tableProps.propToCol(n):n,l=this.tableProps.countCols(),s=this.tableProps.countRows(),u=zo(i,l)&&zo(a,l);return u&&(this.setRangeStartOnly(this.tableProps.createCellCoords(o,i)),this.setRangeEnd(this.tableProps.createCellCoords(s-1,a)),this.finish()),u}},{key:"selectRows",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:r,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:-1,i=this.tableProps.countRows(),a=this.tableProps.countCols(),l=zo(r,i)&&zo(n,i);return l&&(this.setRangeStartOnly(this.tableProps.createCellCoords(r,o)),this.setRangeEnd(this.tableProps.createCellCoords(n,a-1)),this.finish()),l}},{key:"refresh",value:function(){var r=this.highlight.getCustomSelections();if(r.forEach(function(u){u.commit()}),!!this.isSelected()){var n=this.highlight.getCell(),o=this.getLayerLevel();n.commit().syncWith(this.selectedRange.current());for(var i=0;i<this.selectedRange.size();i+=1){this.highlight.useLayerLevel(i);var a=this.highlight.createOrGetArea(),l=this.highlight.createOrGetHeader(),s=this.highlight.createOrGetActiveHeader();a.commit(),l.commit(),s.commit()}this.highlight.useLayerLevel(o)}}}]),e}();dt($W,Er);const rwe=$W;var nwe=$e,AW=Ud,owe=Hn.f,iwe=Ua,XI=Ft,awe=aE,lwe=Or,swe=lE,ZI=AW("".startsWith),uwe=AW("".slice),fwe=Math.min,IW=swe("startsWith"),cwe=!IW&&!!function(){var e=owe(String.prototype,"startsWith");return e&&!e.writable}();nwe({target:"String",proto:!0,forced:!cwe&&!IW},{startsWith:function(t){var r=XI(lwe(this));awe(t);var n=iwe(fwe(arguments.length>1?arguments[1]:void 0,r.length)),o=XI(t);return ZI?ZI(r,o,n):uwe(r,n,n+o.length)===o}});var QI=/^(\r\n|\n\r|\r|\n)/,hwe=/^[^\t\r\n]+/,JI=/^\t/;function dwe(e){var t=[[""]];if(e.length===0)return t;for(var r=0,n=0,o;e.length>0&&o!==e.length;)if(o=e.length,e.match(JI))e=e.replace(JI,""),r+=1,t[n][r]="";else if(e.match(QI))e=e.replace(QI,""),r=0,n+=1,t[n]=[""];else{var i="";if(e.startsWith('"')){for(var a=0,l=!0;l;){var s=e.slice(0,1);s==='"'&&(a+=1),i+=s,e=e.slice(1),(e.length===0||e.match(/^[\t\r\n]/)&&a%2===0)&&(l=!1)}i=i.replace(/^"/,"").replace(/"$/,"").replace(/["]*/g,function(f){return new Array(Math.floor(f.length/2)).fill('"').join("")})}else{var u=e.match(hwe);i=u?u[0]:"",e=e.slice(i.length)}t[n][r]=i}return t}function vc(e){var t,r,n,o,i="",a;for(t=0,r=e.length;t<r;t+=1){for(o=e[t].length,n=0;n<o;n+=1)n>0&&(i+="	"),a=e[t][n],typeof a=="string"?a.indexOf(`
`)>-1?i+='"'.concat(a.replace(/"/g,'""'),'"'):i+=a:a==null?i+="":i+=a;t!==r-1&&(i+=`
`)}return i}function gw(e){return mwe(e)||gwe(e)||ywe(e)||vwe()}function vwe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ywe(e,t){if(e){if(typeof e=="string")return h_(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return h_(e,t)}}function gwe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function mwe(e){if(Array.isArray(e))return h_(e)}function h_(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Ms(e){"@babel/helpers - typeof";return Ms=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ms(e)}function pwe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function eM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,wwe(n.key),n)}}function bwe(e,t,r){return t&&eM(e.prototype,t),r&&eM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function wwe(e){var t=Swe(e,"string");return Ms(t)==="symbol"?t:String(t)}function Swe(e,t){if(Ms(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ms(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Cwe=function(){function e(t,r,n){pwe(this,e),this.instance=t,this.metaManager=n,this.tableMeta=n.getTableMeta(),this.dataSource=r,this.duckSchema=this.createDuckSchema(),this.colToPropCache=void 0,this.propToColCache=void 0,this.createMap()}return bwe(e,[{key:"createMap",value:function(){var r=this.getSchema();if(typeof r>"u")throw new Error("trying to create `columns` definition but you didn't provide `schema` nor `data`");var n=this.tableMeta.columns,o;if(this.colToPropCache=[],this.propToColCache=new Map,n){var i=0,a=0,l=!1;if(typeof n=="function"){var s=hE(r);i=s>0?s:this.countFirstRowKeys(),l=!0}else{var u=this.tableMeta.maxCols;i=Math.min(u,n.length)}for(o=0;o<i;o++){var f=l?n(o):n[o];if(Ge(f)){if(typeof f.data<"u"){var c=l?a:o;this.colToPropCache[c]=f.data,this.propToColCache.set(f.data,c)}a+=1}}}else this.recursiveDuckColumns(r)}},{key:"countFirstRowKeys",value:function(){return rW(this.dataSource)}},{key:"recursiveDuckColumns",value:function(r,n,o){var i=this,a=n,l=o,s;return typeof a>"u"&&(a=0,l=""),Ms(r)==="object"&&!Array.isArray(r)&&Ke(r,function(u,f){u===null?(s=l+f,i.colToPropCache.push(s),i.propToColCache.set(s,a),a+=1):a=i.recursiveDuckColumns(u,a,"".concat(f,"."))}),a}},{key:"colToProp",value:function(r){if(Number.isInteger(r)===!1)return r;var n=this.instance.toPhysicalColumn(r);return n===null?r:this.colToPropCache&&ye(this.colToPropCache[n])?this.colToPropCache[n]:n}},{key:"propToCol",value:function(r){var n=this.propToColCache.get(r);if(ye(n))return this.instance.toVisualColumn(n);var o=this.instance.toVisualColumn(r);return o===null?r:o}},{key:"getSchema",value:function(){var r=this.tableMeta.dataSchema;return r?typeof r=="function"?r():r:this.duckSchema}},{key:"createDuckSchema",value:function(){return this.dataSource&&this.dataSource[0]?Rc(this.dataSource[0]):{}}},{key:"refreshDuckSchema",value:function(){this.duckSchema=this.createDuckSchema()}},{key:"createRow",value:function(r){var n=this,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},a=i.source,l=i.mode,s=l===void 0?"above":l,u=this.instance.countSourceRows(),f=u,c=0,h=r;(typeof h!="number"||h>=u)&&(h=u),h<this.instance.countRows()&&(f=this.instance.toPhysicalRow(h));var d=this.instance.runHooks("beforeCreateRow",h,o,a);if(d===!1||f===null)return{delta:0};for(var v=this.tableMeta.maxRows,y=this.getSchema().length,p=[],w=function(){var P=null;n.instance.dataType==="array"?n.tableMeta.dataSchema?P=dr(n.getSchema()):(P=[],_e(y-1,function(){return P.push(null)})):n.instance.dataType==="function"?P=n.tableMeta.dataSchema(h+c):(P={},ep(P,n.getSchema())),p.push(P),c+=1};c<o&&u+c<v;)w();this.instance.rowIndexMapper.insertIndexes(h,c),s==="below"&&(f=Math.min(f+1,u)),this.spliceData(f,0,p);var S=this.instance.toVisualRow(f);return this.instance.countSourceRows()===p.length&&this.instance.columnIndexMapper.initToLength(this.instance.getInitialColumnCount()),c>0&&(r==null?this.metaManager.createRow(null,c):a!=="auto"&&this.metaManager.createRow(f,o)),this.instance.runHooks("afterCreateRow",S,c,a),this.instance.forceFullRender=!0,{delta:c,startPhysicalIndex:f}}},{key:"createCol",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},i=o.source,a=o.mode,l=a===void 0?"start":a;if(!this.instance.isColumnModificationAllowed())throw new Error("Cannot create new column. When data source in an object, you can only have as much columns as defined in first data row, data schema or in the 'columns' setting.If you want to be able to add new columns, you have to use array datasource.");var s=this.dataSource,u=this.tableMeta.maxCols,f=this.instance.countSourceCols(),c=r;(typeof c!="number"||c>=f)&&(c=f);var h=this.instance.runHooks("beforeCreateCol",c,n,i);if(h===!1)return{delta:0};var d=f;c<this.instance.countCols()&&(d=this.instance.toPhysicalColumn(c));var v=this.instance.countSourceRows(),y=this.instance.countCols(),p=0,w=d;l==="end"&&(w=Math.min(w+1,f));for(var S=w;p<n&&y<u;){if(typeof c!="number"||c>=y)if(v>0)for(var C=0;C<v;C+=1)typeof s[C]>"u"&&(s[C]=[]),s[C].push(null);else s.push([null]);else for(var P=0;P<v;P++)s[P].splice(w,0,null);p+=1,w+=1,y+=1}this.instance.columnIndexMapper.insertIndexes(c,p),p>0&&(r==null?this.metaManager.createColumn(null,p):i!=="auto"&&this.metaManager.createColumn(S,n));var R=this.instance.toVisualColumn(S);return this.instance.runHooks("afterCreateCol",R,p,i),this.instance.forceFullRender=!0,this.refreshDuckSchema(),{delta:p,startPhysicalIndex:S}}},{key:"removeRow",value:function(r){var n=this,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,i=arguments.length>2?arguments[2]:void 0,a=Number.isInteger(r)?r:-o,l=this.visualRowsToPhysical(a,o),s=this.instance.countSourceRows();a=(s+a)%s;var u=this.instance.runHooks("beforeRemoveRow",a,l.length,l,i);if(u===!1)return!1;var f=l.length;if(this.filterData(a,f,l),a<this.instance.countRows()){this.instance.rowIndexMapper.removeIndexes(l);var c=ye(this.tableMeta.columns)||ye(this.tableMeta.dataSchema);this.instance.rowIndexMapper.getNotTrimmedIndexesLength()===0&&c===!1&&this.instance.columnIndexMapper.setIndexesSequence([])}var h=l.slice(0).sort(function(d,v){return v-d});return h.forEach(function(d){n.metaManager.removeRow(d,1)}),this.instance.runHooks("afterRemoveRow",a,f,l,i),this.instance.forceFullRender=!0,!0}},{key:"removeCol",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,o=arguments.length>2?arguments[2]:void 0;if(this.instance.dataType==="object"||this.tableMeta.columns)throw new Error("cannot remove column with object data source or columns option specified");var i=typeof r!="number"?-n:r;i=(this.instance.countCols()+i)%this.instance.countCols();var a=this.visualColumnsToPhysical(i,n),l=a.slice(0).sort(function(S,C){return C-S}),s=this.instance.runHooks("beforeRemoveCol",i,n,a,o);if(s===!1)return!1;for(var u=!0,f=l.length,c=this.dataSource,h=0;h<f;h++)u&&a[0]!==a[h]-h&&(u=!1);if(u)for(var d=0,v=this.instance.countSourceRows();d<v;d++)c[d].splice(a[0],n),d===0&&this.metaManager.removeColumn(a[0],n);else for(var y=0,p=this.instance.countSourceRows();y<p;y++)for(var w=0;w<f;w++)c[y].splice(l[w],1),y===0&&this.metaManager.removeColumn(l[w],1);return i<this.instance.countCols()&&(this.instance.columnIndexMapper.removeIndexes(a),this.instance.columnIndexMapper.getNotTrimmedIndexesLength()===0&&this.instance.rowIndexMapper.setIndexesSequence([])),this.instance.runHooks("afterRemoveCol",i,n,a,o),this.instance.forceFullRender=!0,this.refreshDuckSchema(),!0}},{key:"spliceCol",value:function(r,n,o){for(var i=this.instance.getDataAtCol(r),a=i.slice(n,n+o),l=i.slice(n+o),s=arguments.length,u=new Array(s>3?s-3:0),f=3;f<s;f++)u[f-3]=arguments[f];F$(u,l);for(var c=0;c<o;)u.push(null),c+=1;return zJ(u),this.instance.populateFromArray(n,r,u,null,null,"spliceCol"),a}},{key:"spliceRow",value:function(r,n,o){for(var i=this.instance.getSourceDataAtRow(r),a=i.slice(n,n+o),l=i.slice(n+o),s=arguments.length,u=new Array(s>3?s-3:0),f=3;f<s;f++)u[f-3]=arguments[f];F$(u,l);for(var c=0;c<o;)u.push(null),c+=1;return this.instance.populateFromArray(r,n,[u],null,null,"spliceRow"),a}},{key:"spliceData",value:function(r,n,o){var i=this,a=this.instance.runHooks("beforeDataSplice",r,n,o);if(a!==!1){var l=[].concat(gw(this.dataSource.slice(0,r)),gw(o),gw(this.dataSource.slice(r)));this.dataSource.length=0,l.forEach(function(s){return i.dataSource.push(s)})}}},{key:"filterData",value:function(r,n,o){var i=this.instance.runHooks("filterData",r,n,o);Array.isArray(i)===!1&&(i=this.dataSource.filter(function(a,l){return o.indexOf(l)===-1})),this.dataSource.length=0,Array.prototype.push.apply(this.dataSource,i)}},{key:"get",value:function(r,n){var o=this.instance.toPhysicalRow(r),i=this.dataSource[o],a=this.instance.runHooks("modifyRowData",o);i=isNaN(a)?a:i;var l=null;if(i&&i.hasOwnProperty&&It(i,n))l=i[n];else if(typeof n=="string"&&n.indexOf(".")>-1){var s=n.split("."),u=i;if(!u)return null;for(var f=0,c=s.length;f<c;f++)if(u=u[s[f]],typeof u>"u")return null;l=u}else typeof n=="function"&&(l=n(this.dataSource.slice(o,o+1)[0]));if(this.instance.hasHook("modifyData")){var h=ts(l);this.instance.runHooks("modifyData",o,this.propToCol(n),h,"get"),h.isTouched()&&(l=h.value)}return l}},{key:"getCopyable",value:function(r,n){return this.instance.getCellMeta(r,this.propToCol(n)).copyable?this.get(r,n):""}},{key:"set",value:function(r,n,o){var i=this.instance.toPhysicalRow(r),a=o,l=this.dataSource[i],s=this.instance.runHooks("modifyRowData",i);if(l=isNaN(s)?s:l,this.instance.hasHook("modifyData")){var u=ts(a);this.instance.runHooks("modifyData",i,this.propToCol(n),u,"set"),u.isTouched()&&(a=u.value)}if(l&&l.hasOwnProperty&&It(l,n))l[n]=a;else if(typeof n=="string"&&n.indexOf(".")>-1){var f=n.split("."),c=l,h=0,d;for(h=0,d=f.length-1;h<d;h++)typeof c[f[h]]>"u"&&(c[f[h]]={}),c=c[f[h]];c[f[h]]=a}else typeof n=="function"?n(this.dataSource.slice(i,i+1)[0],a):l[n]=a}},{key:"visualRowsToPhysical",value:function(r,n){for(var o=this.instance.countSourceRows(),i=[],a=(o+r)%o,l=n,s;a<o&&l;)s=this.instance.toPhysicalRow(a),i.push(s),l-=1,a+=1;return i}},{key:"visualColumnsToPhysical",value:function(r,n){for(var o=this.instance.countCols(),i=[],a=(o+r)%o,l=n;a<o&&l;){var s=this.instance.toPhysicalColumn(a);i.push(s),l-=1,a+=1}return i}},{key:"clear",value:function(){for(var r=0;r<this.instance.countSourceRows();r++)for(var n=0;n<this.instance.countCols();n++)this.set(r,this.colToProp(n),"")}},{key:"getLength",value:function(){var r=this.tableMeta.maxRows,n;r<0||r===0?n=0:n=r||1/0;var o=this.instance.rowIndexMapper.getNotTrimmedIndexesLength();return Math.min(o,n)}},{key:"getAll",value:function(){var r={row:0,col:0},n={row:Math.max(this.instance.countRows()-1,0),col:Math.max(this.instance.countCols()-1,0)};return r.row-n.row===0&&!this.instance.countSourceRows()?[]:this.getRange(r,n,e.DESTINATION_RENDERER)}},{key:"countCachedColumns",value:function(){return this.colToPropCache.length}},{key:"getRange",value:function(r,n,o){var i=[],a,l,s,u=this.tableMeta.maxRows,f=this.tableMeta.maxCols;if(u===0||f===0)return[];var c=o===e.DESTINATION_CLIPBOARD_GENERATOR?this.getCopyable:this.get,h=Math.min(Math.max(u-1,0),Math.max(r.row,n.row)),d=Math.min(Math.max(f-1,0),Math.max(r.col,n.col));for(a=Math.min(r.row,n.row);a<=h;a++){s=[];var v=a>=0?this.instance.toPhysicalRow(a):a;for(l=Math.min(r.col,n.col);l<=d&&v!==null;l++)s.push(c.call(this,a,this.colToProp(l)));v!==null&&i.push(s)}return i}},{key:"getText",value:function(r,n){return vc(this.getRange(r,n,e.DESTINATION_RENDERER))}},{key:"getCopyableText",value:function(r,n){return vc(this.getRange(r,n,e.DESTINATION_CLIPBOARD_GENERATOR))}},{key:"destroy",value:function(){this.instance=null,this.metaManager=null,this.dataSource=null,this.duckSchema=null,this.colToPropCache.length=0,this.propToColCache.clear(),this.propToColCache=void 0}}],[{key:"DESTINATION_RENDERER",get:function(){return 1}},{key:"DESTINATION_CLIPBOARD_GENERATOR",get:function(){return 2}}]),e}();const _we=Cwe;var cv=Qr("cellTypes"),Owe=cv.register,Rwe=cv.getItem,MW=cv.hasItem;cv.getNames;cv.getValues;function Ewe(e){if(!MW(e))throw Error('You declared cell type "'.concat(e,`" as a string that is not mapped to a known object.
                 Cell type must be an object or a string mapped to an object registered by
                 "Handsontable.cellTypes.registerCellType" method`));return Rwe(e)}function Rn(e,t){typeof e!="string"&&(t=e,e=t.CELL_TYPE);var r=t,n=r.editor,o=r.renderer,i=r.validator;n&&Ir(e,n),o&&Zn(e,o),i&&rc(e,i),Owe(e,t)}function Twe(e,t){var r;return e==="CELL_TYPE"?!1:((r=t._automaticallyAssignedMetaProps)===null||r===void 0?void 0:r.has(e))||!It(t,e)}function Ep(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e,n=typeof t.type=="string"?Ewe(t.type):t.type;if(e._automaticallyAssignedMetaProps&&Ke(t,function(i,a){return void e._automaticallyAssignedMetaProps.delete(a)}),!!Ge(n)){r===e&&!e._automaticallyAssignedMetaProps&&(e._automaticallyAssignedMetaProps=new Set);var o={};Ke(n,function(i,a){if(Twe(a,r)){var l;o[a]=i,(l=e._automaticallyAssignedMetaProps)===null||l===void 0||l.add(a)}}),Wt(e,o)}}function kwe(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];function r(){}Oi(r,e);for(var n=0;n<t.length;n++)r.prototype[t[n]]=void 0;return r}function Zy(e){return Number.isInteger(e)&&e>=0}function Qy(e,t){if(!e())throw new Error("Assertion failed: ".concat(t))}function qv(e){return e==null}function d_(e){"@babel/helpers - typeof";return d_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},d_(e)}const xW=function(){return{_automaticallyAssignedMetaProps:void 0,activeHeaderClassName:"ht__active_highlight",allowEmpty:!0,allowHtml:!1,allowInsertColumn:!0,allowInsertRow:!0,allowInvalid:!0,allowRemoveColumn:!0,allowRemoveRow:!0,autoColumnSize:void 0,autoRowSize:void 0,autoWrapCol:!1,autoWrapRow:!1,bindRowsWithHeaders:void 0,cell:[],cells:void 0,checkedTemplate:void 0,className:void 0,colHeaders:null,collapsibleColumns:void 0,columnHeaderHeight:void 0,columns:void 0,columnSorting:void 0,columnSummary:void 0,colWidths:void 0,commentedCellClassName:"htCommentCell",comments:!1,contextMenu:void 0,copyable:!0,copyPaste:!0,correctFormat:!1,currentColClassName:void 0,currentHeaderClassName:"ht__highlight",currentRowClassName:void 0,customBorders:!1,data:void 0,dataSchema:void 0,dateFormat:"DD/MM/YYYY",datePickerConfig:void 0,defaultDate:void 0,disableVisualSelection:!1,dragToScroll:!0,dropdownMenu:void 0,editor:void 0,enterBeginsEditing:!0,enterMoves:{col:0,row:1},fillHandle:{autoInsertRow:!1},filter:!0,filteringCaseSensitive:!1,filters:void 0,fixedColumnsLeft:0,fixedColumnsStart:0,fixedRowsBottom:0,fixedRowsTop:0,formulas:void 0,fragmentSelection:!1,height:void 0,hiddenColumns:void 0,hiddenRows:void 0,invalidCellClassName:"htInvalid",isEmptyCol:function(t){var r,n,o;for(r=0,n=this.countRows();r<n;r++)if(o=this.getDataAtCell(r,t),Yt(o)===!1)return!1;return!0},isEmptyRow:function(t){var r,n,o,i;for(r=0,n=this.countCols();r<n;r++)if(o=this.getDataAtCell(t,r),Yt(o)===!1)return d_(o)==="object"?(i=this.getCellMeta(t,r),cE(this.getSchema()[i.prop],o)):!1;return!0},label:void 0,language:"en-US",layoutDirection:"inherit",licenseKey:void 0,locale:"en-US",manualColumnFreeze:void 0,manualColumnMove:void 0,manualColumnResize:void 0,manualRowMove:void 0,manualRowResize:void 0,maxCols:1/0,maxRows:1/0,mergeCells:!1,minCols:0,minRows:0,minSpareCols:0,minSpareRows:0,multiColumnSorting:void 0,nestedHeaders:void 0,nestedRows:void 0,noWordWrapClassName:"htNoWrap",numericFormat:void 0,observeDOMVisibility:!0,outsideClickDeselects:!0,persistentState:void 0,placeholder:void 0,placeholderCellClassName:"htPlaceholder",preventOverflow:!1,preventWheel:!1,readOnly:!1,readOnlyCellClassName:"htDimmed",renderAllRows:void 0,renderer:void 0,rowHeaders:void 0,rowHeaderWidth:void 0,rowHeights:void 0,search:!1,selectionMode:"multiple",selectOptions:void 0,skipColumnOnPaste:!1,skipRowOnPaste:!1,sortByRelevance:!0,source:void 0,startCols:5,startRows:5,stretchH:"none",strict:void 0,tableClassName:void 0,tabMoves:{row:0,col:1},title:void 0,trimDropdown:!0,trimRows:void 0,trimWhitespace:!0,type:"text",uncheckedTemplate:void 0,undo:void 0,validator:void 0,viewportColumnRenderingOffset:"auto",viewportRowRenderingOffset:"auto",visibleRows:10,width:void 0,wordWrap:!0}};function Ph(e){"@babel/helpers - typeof";return Ph=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ph(e)}function tM(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function rM(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?tM(Object(r),!0).forEach(function(n){Pwe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):tM(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Pwe(e,t,r){return t=NW(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function nM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,NW(n.key),n)}}function DW(e,t,r){return t&&nM(e.prototype,t),r&&nM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function NW(e){var t=$we(e,"string");return Ph(t)==="symbol"?t:String(t)}function $we(e,t){if(Ph(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ph(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function HW(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Awe(){return DW(function e(){HW(this,e)})}var Iwe=function(){function e(t){HW(this,e),this.metaCtor=Awe(),this.meta=this.metaCtor.prototype,Wt(this.meta,xW()),this.meta.instance=t}return DW(e,[{key:"getMetaConstructor",value:function(){return this.metaCtor}},{key:"getMeta",value:function(){return this.meta}},{key:"updateMeta",value:function(r){var n;Wt(this.meta,r),Ep(this.meta,rM(rM({},r),{},{type:(n=r.type)!==null&&n!==void 0?n:this.meta.type}),r)}}]),e}();function $h(e){"@babel/helpers - typeof";return $h=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$h(e)}function Mwe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function oM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Dwe(n.key),n)}}function xwe(e,t,r){return t&&oM(e.prototype,t),r&&oM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Dwe(e){var t=Nwe(e,"string");return $h(t)==="symbol"?t:String(t)}function Nwe(e,t){if($h(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if($h(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Hwe=function(){function e(t){Mwe(this,e);var r=t.getMetaConstructor();this.meta=new r}return xwe(e,[{key:"getMeta",value:function(){return this.meta}},{key:"updateMeta",value:function(r){Wt(this.meta,r),Ep(this.meta,r,r)}}]),e}();function Ah(e){"@babel/helpers - typeof";return Ah=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ah(e)}function iM(e){return Bwe(e)||Fwe(e)||jwe(e)||Lwe()}function Lwe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function jwe(e,t){if(e){if(typeof e=="string")return v_(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return v_(e,t)}}function Fwe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Bwe(e){if(Array.isArray(e))return v_(e)}function v_(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Vwe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function aM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Uwe(n.key),n)}}function Wwe(e,t,r){return t&&aM(e.prototype,t),r&&aM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Uwe(e){var t=zwe(e,"string");return Ah(t)==="symbol"?t:String(t)}function zwe(e,t){if(Ah(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ah(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var y_=function(e){function t(r){Vwe(this,t),this.valueFactory=r,this.data=[],this.index=[],this.holes=new Set}return Wwe(t,[{key:"obtain",value:function(n){Qy(function(){return Zy(n)},"Expecting an unsigned number.");var o=this._getStorageIndexByKey(n),i;if(o>=0)i=this.data[o],i===void 0&&(i=this.valueFactory(n),this.data[o]=i);else if(i=this.valueFactory(n),this.holes.size>0){var a=this.holes.values().next().value;this.holes.delete(a),this.data[a]=i,this.index[n]=a}else this.data.push(i),this.index[n]=this.data.length-1;return i}},{key:"insert",value:function(n){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;Qy(function(){return Zy(n)||qv(n)},"Expecting an unsigned number or null/undefined argument.");for(var i=[],a=this.data.length,l=0;l<o;l++)i.push(a+l),this.data.push(void 0);var s=qv(n)?this.index.length:n;this.index=[].concat(iM(this.index.slice(0,s)),i,iM(this.index.slice(s)))}},{key:"remove",value:function(n){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;Qy(function(){return Zy(n)||qv(n)},"Expecting an unsigned number or null/undefined argument.");for(var i=this.index.splice(qv(n)?this.index.length-o:n,o),a=0;a<i.length;a++){var l=i[a];typeof l=="number"&&this.holes.add(l)}}},{key:"size",value:function(){return this.data.length-this.holes.size}},{key:"values",value:function(){var n=this;return Yr(this.data,function(o,i){return!n.holes.has(i)})[Symbol.iterator]()}},{key:"entries",value:function(){for(var n=[],o=0;o<this.data.length;o++){var i=this._getKeyByStorageIndex(o);i!==-1&&n.push([i,this.data[o]])}var a=0;return{next:function(){if(a<n.length){var s=n[a];return a+=1,{value:s,done:!1}}return{done:!0}}}}},{key:"clear",value:function(){this.data=[],this.index=[],this.holes.clear()}},{key:"_getStorageIndexByKey",value:function(n){return this.index.length>n?this.index[n]:-1}},{key:"_getKeyByStorageIndex",value:function(n){return this.index.indexOf(n)}},{key:e,value:function(){return this.entries()}}]),t}(Symbol.iterator);function Ih(e){"@babel/helpers - typeof";return Ih=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ih(e)}function Ywe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function lM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Kwe(n.key),n)}}function Gwe(e,t,r){return t&&lM(e.prototype,t),r&&lM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Kwe(e){var t=qwe(e,"string");return Ih(t)==="symbol"?t:String(t)}function qwe(e,t){if(Ih(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ih(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Xwe=["data","width"],Zwe=function(){function e(t){var r=this;Ywe(this,e),this.globalMeta=t,this.metas=new y_(function(){return r._createMeta()})}return Gwe(e,[{key:"updateMeta",value:function(r,n){var o=this.getMeta(r);Wt(o,n),Ep(o,n)}},{key:"createColumn",value:function(r,n){this.metas.insert(r,n)}},{key:"removeColumn",value:function(r,n){this.metas.remove(r,n)}},{key:"getMeta",value:function(r){return this.metas.obtain(r)}},{key:"getMetaConstructor",value:function(r){return this.metas.obtain(r).constructor}},{key:"clearCache",value:function(){this.metas.clear()}},{key:"_createMeta",value:function(){return kwe(this.globalMeta.getMetaConstructor(),Xwe).prototype}}]),e}();function Mh(e){"@babel/helpers - typeof";return Mh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Mh(e)}function Qwe(e){return rSe(e)||tSe(e)||eSe(e)||Jwe()}function Jwe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function eSe(e,t){if(e){if(typeof e=="string")return g_(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return g_(e,t)}}function tSe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function rSe(e){if(Array.isArray(e))return g_(e)}function g_(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function nSe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function sM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,iSe(n.key),n)}}function oSe(e,t,r){return t&&sM(e.prototype,t),r&&sM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function iSe(e){var t=aSe(e,"string");return Mh(t)==="symbol"?t:String(t)}function aSe(e,t){if(Mh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Mh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var lSe=function(){function e(t){var r=this;nSe(this,e),this.columnMeta=t,this.metas=new y_(function(){return r._createRow()})}return oSe(e,[{key:"updateMeta",value:function(r,n,o){var i=this.getMeta(r,n);Wt(i,o),Ep(i,o)}},{key:"createRow",value:function(r,n){this.metas.insert(r,n)}},{key:"createColumn",value:function(r,n){for(var o=0;o<this.metas.size();o++)this.metas.obtain(o).insert(r,n)}},{key:"removeRow",value:function(r,n){this.metas.remove(r,n)}},{key:"removeColumn",value:function(r,n){for(var o=0;o<this.metas.size();o++)this.metas.obtain(o).remove(r,n)}},{key:"getMeta",value:function(r,n,o){var i=this.metas.obtain(r).obtain(n);return o===void 0?i:i[o]}},{key:"setMeta",value:function(r,n,o,i){var a,l=this.metas.obtain(r).obtain(n);(a=l._automaticallyAssignedMetaProps)===null||a===void 0||a.delete(o),l[o]=i}},{key:"removeMeta",value:function(r,n,o){var i=this.metas.obtain(r).obtain(n);delete i[o]}},{key:"getMetas",value:function(){for(var r=[],n=Array.from(this.metas.values()),o=0;o<n.length;o++)r.push.apply(r,Qwe(n[o].values()));return r}},{key:"getMetasAtRow",value:function(r){Qy(function(){return Zy(r)},"Expecting an unsigned number.");var n=new Map(this.metas);return n.has(r)?Array.from(n.get(r).values()):[]}},{key:"clearCache",value:function(){this.metas.clear()}},{key:"_createRow",value:function(){var r=this;return new y_(function(n){return r._createMeta(n)})}},{key:"_createMeta",value:function(r){var n=this.columnMeta.getMetaConstructor(r);return new n}}]),e}();function xh(e){"@babel/helpers - typeof";return xh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},xh(e)}function sSe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function uM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,fSe(n.key),n)}}function uSe(e,t,r){return t&&uM(e.prototype,t),r&&uM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function fSe(e){var t=cSe(e,"string");return xh(t)==="symbol"?t:String(t)}function cSe(e,t){if(xh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(xh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var LW=function(){function e(t){var r=this,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];sSe(this,e),this.hot=t,this.globalMeta=new Iwe(t),this.tableMeta=new Hwe(this.globalMeta),this.columnMeta=new Zwe(this.globalMeta),this.cellMeta=new lSe(this.columnMeta),o.forEach(function(i){return new i(r)}),this.globalMeta.updateMeta(n)}return uSe(e,[{key:"getGlobalMeta",value:function(){return this.globalMeta.getMeta()}},{key:"updateGlobalMeta",value:function(r){this.globalMeta.updateMeta(r)}},{key:"getTableMeta",value:function(){return this.tableMeta.getMeta()}},{key:"updateTableMeta",value:function(r){this.tableMeta.updateMeta(r)}},{key:"getColumnMeta",value:function(r){return this.columnMeta.getMeta(r)}},{key:"updateColumnMeta",value:function(r,n){this.columnMeta.updateMeta(r,n)}},{key:"getCellMeta",value:function(r,n,o){var i=o.visualRow,a=o.visualColumn,l=this.cellMeta.getMeta(r,n);return l.visualRow=i,l.visualCol=a,l.row=r,l.col=n,this.runLocalHooks("afterGetCellMeta",l),l}},{key:"getCellMetaKeyValue",value:function(r,n,o){if(typeof o!="string")throw new Error("The passed cell meta object key is not a string");return this.cellMeta.getMeta(r,n,o)}},{key:"setCellMeta",value:function(r,n,o,i){this.cellMeta.setMeta(r,n,o,i)}},{key:"updateCellMeta",value:function(r,n,o){this.cellMeta.updateMeta(r,n,o)}},{key:"removeCellMeta",value:function(r,n,o){this.cellMeta.removeMeta(r,n,o)}},{key:"getCellsMeta",value:function(){return this.cellMeta.getMetas()}},{key:"getCellsMetaAtRow",value:function(r){return this.cellMeta.getMetasAtRow(r)}},{key:"createRow",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createRow(r,n)}},{key:"removeRow",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeRow(r,n)}},{key:"createColumn",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createColumn(r,n),this.columnMeta.createColumn(r,n)}},{key:"removeColumn",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeColumn(r,n),this.columnMeta.removeColumn(r,n)}},{key:"clearCellsCache",value:function(){this.cellMeta.clearCache()}},{key:"clearCache",value:function(){this.cellMeta.clearCache(),this.columnMeta.clearCache()}}]),e}();dt(LW,Er);function hm(e){"@babel/helpers - typeof";return hm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},hm(e)}function fM(e,t,r,n){var o=n.hotInstance,i=n.dataMap,a=n.dataSource,l=n.internalSource,s=n.source,u=n.metaManager,f=n.firstRun,c=un(l),h=o.getSettings();Array.isArray(h.dataSchema)?o.dataType="array":vt(h.dataSchema)?o.dataType="function":o.dataType="object",i&&i.destroy(),e=o.runHooks("before".concat(c),e,f,s);var d=new _we(o,e,u);if(t(d),hm(e)==="object"&&e!==null)e.push&&e.splice||(e=[e]);else if(e===null){var v=d.getSchema();e=[];var y,p=0,w=0;for(p=0,w=h.startRows;p<w;p++)if((o.dataType==="object"||o.dataType==="function")&&h.dataSchema)y=dr(v),e.push(y);else if(o.dataType==="array")y=dr(v[0]),e.push(y);else{y=[];for(var S=0,C=h.startCols;S<C;S++)y.push(null);e.push(y)}}else throw new Error("".concat(l," only accepts array of objects or array of arrays (").concat(hm(e)," given)"));Array.isArray(e[0])&&(o.dataType="array"),h.data=e,d.dataSource=e,a.data=e,a.dataType=o.dataType,a.colToProp=d.colToProp.bind(d),a.propToCol=d.propToCol.bind(d),a.countCachedColumns=d.countCachedColumns.bind(d),r(d),o.runHooks("after".concat(c),e,f,s),f||(o.runHooks("afterChange",null,l),o.render())}function Dh(e){"@babel/helpers - typeof";return Dh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Dh(e)}function hSe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function cM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,vSe(n.key),n)}}function dSe(e,t,r){return t&&cM(e.prototype,t),r&&cM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function vSe(e){var t=ySe(e,"string");return Dh(t)==="symbol"?t:String(t)}function ySe(e,t){if(Dh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Dh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var gSe=function(){function e(t){var r=this;hSe(this,e),this.metaManager=t,this.metaSyncMemo=new Map,t.addLocalHook("afterGetCellMeta",function(n){return r.extendCellMeta(n)}),ge.getSingleton().add("beforeRender",function(n){n&&r.metaSyncMemo.clear()},this.metaManager.hot)}return dSe(e,[{key:"extendCellMeta",value:function(r){var n,o=r.row,i=r.col;if(!((n=this.metaSyncMemo.get(o))!==null&&n!==void 0&&n.has(i))){var a=r.visualRow,l=r.visualCol,s=this.metaManager.hot,u=s.colToProp(l);r.prop=u,s.runHooks("beforeGetCellMeta",a,l,r);var f=It(r,"type")?r.type:null,c=vt(r.cells)?r.cells(o,i,u):null;if(f)if(c){var h;c.type=(h=c.type)!==null&&h!==void 0?h:f}else c={type:f};c&&this.metaManager.updateCellMeta(o,i,c),s.runHooks("afterGetCellMeta",a,l,r),this.metaSyncMemo.has(o)||this.metaSyncMemo.set(o,new Set),this.metaSyncMemo.get(o).add(i)}}}]),e}();function Nh(e){"@babel/helpers - typeof";return Nh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Nh(e)}function mSe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function hM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,bSe(n.key),n)}}function pSe(e,t,r){return t&&hM(e.prototype,t),r&&hM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function bSe(e){var t=wSe(e,"string");return Nh(t)==="symbol"?t:String(t)}function wSe(e,t){if(Nh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Nh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var SSe=function(){function e(t){mSe(this,e),this.metaManager=t,this.usageTracker=new Set,this.propDescriptors=new Map([["fixedColumnsLeft",{target:"fixedColumnsStart",onChange:function(n){var o=this.metaManager.hot.isRtl();if(o&&n==="fixedColumnsLeft")throw new Error("The `fixedColumnsLeft` is not supported for RTL. Please use option `fixedColumnsStart`.");if(this.usageTracker.has("fixedColumnsLeft")&&this.usageTracker.has("fixedColumnsStart"))throw new Error("The `fixedColumnsLeft` and `fixedColumnsStart` should not be used together. Please use only the option `fixedColumnsStart`.")}}],["layoutDirection",{onChange:function(n,o,i){if(!i)throw new Error("The `".concat(n,"` option can not be updated after the Handsontable is initialized."))}}]]),this.extendMetaProps()}return pSe(e,[{key:"extendMetaProps",value:function(){var r=this;this.propDescriptors.forEach(function(n,o){var i=n.target,a=n.onChange,l=a===void 0?function(){}:a,s=typeof i=="string",u=s?i:o,f="_".concat(u);r.metaManager.globalMeta.meta[f]=r.metaManager.globalMeta.meta[u],r.installPropWatcher(o,f,l),s&&r.installPropWatcher(i,f,l)})}},{key:"installPropWatcher",value:function(r,n,o){var i=this;Object.defineProperty(this.metaManager.globalMeta.meta,r,{get:function(){return this[n]},set:function(l){var s=!i.usageTracker.has(r);i.usageTracker.add(r),o.call(i,r,l,s),this[n]=l},enumerable:!0,configurable:!0})}}]),e}(),dM=new Map([[" ","space"],["spacebar","space"],["scroll","scrolllock"],["del","delete"],["esc","escape"],["medianexttrack","mediatracknext"],["mediaprevioustrack","mediatrackprevious"],["volumeup","audiovolumeup"],["volumedown","audiovolumedown"],["volumemute","audiovolumemute"],["multiply","*"],["add","+"],["divide","/"],["subtract","-"],["left","arrowleft"],["right","arrowright"],["up","arrowup"],["down","arrowdown"]]),Xv=function(t){return t.map(function(r){var n=r.toLowerCase();return dM.has(n)?dM.get(n):n}).sort().join("+")},CSe=function(t){return t.split("+")},vM=function(t){return t.toLowerCase()},yM;function _Se(e){return ESe(e)||RSe(e)||jW(e)||OSe()}function OSe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function RSe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function ESe(e){if(Array.isArray(e))return m_(e)}function TSe(e,t){return $Se(e)||PSe(e,t)||jW(e,t)||kSe()}function kSe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function jW(e,t){if(e){if(typeof e=="string")return m_(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return m_(e,t)}}function m_(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function PSe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function $Se(e){if(Array.isArray(e))return e}function ASe(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}var ISe=function(t){var r=gp({errorIdExists:function(f){return'The "'.concat(f,'" shortcut is already registered in the "').concat(t,'" context.')}}),n=function(){var f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},c=f.keys,h=f.callback,d=f.group,v=f.runOnlyIf,y=v===void 0?function(){return!0}:v,p=f.captureCtrl,w=p===void 0?!1:p,S=f.preventDefault,C=S===void 0?!0:S,P=f.stopPropagation,R=P===void 0?!1:P,W=f.relativeToGroup,Y=f.position;if(gt(d))throw new Error("You need to define the shortcut's group.");if(vt(h)===!1)throw new Error("The shortcut's callback needs to be a function.");if(Array.isArray(c)===!1)throw new Error(ft(yM||(yM=ASe([`Pass the shortcut's keys as an array of arrays, 
      using the KeyboardEvent.key properties: 
      https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key/Key_Values.`],[`Pass the shortcut\\'s keys as an array of arrays,\\x20
      using the KeyboardEvent.key properties:\\x20
      https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key/Key_Values.`]))));var q={callback:h,group:d,runOnlyIf:y,captureCtrl:w,preventDefault:C,stopPropagation:R};if(ye(W)){var G=[W,Y];q.relativeToGroup=G[0],q.position=G[1]}c.forEach(function(X){var Q=Xv(X),oe=r.hasItem(Q);if(oe){var J=r.getItem(Q),ue=J.findIndex(function(de){return de.group===W});ue!==-1?Y==="before"?ue-=1:ue+=1:ue=J.length,J.splice(ue,0,q)}else r.addItem(Q,[q])})},o=function(f){var c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};f.forEach(function(h){Ke(c,function(d,v){Object.prototype.hasOwnProperty.call(h,v)===!1&&(h[v]=c[v])}),n(h)})},i=function(f){var c=Xv(f);r.removeItem(c)},a=function(f){var c=r.getItems();c.forEach(function(h){var d=TSe(h,2),v=d[0],y=d[1],p=y.filter(function(w){return w.group!==f});p.length===0?i(CSe(v)):(y.length=0,y.push.apply(y,_Se(p)))})},l=function(f){var c=Xv(f),h=r.getItem(c);return ye(h)?h.slice():[]},s=function(f){var c=Xv(f);return r.hasItem(c)};return{addShortcut:n,addShortcuts:o,getShortcuts:l,hasShortcut:s,removeShortcutsByKeys:i,removeShortcutsByGroup:a}};function MSe(){var e=new Set;return{press:function(r){e.add(r)},release:function(r){e.delete(r)},releaseAll:function(){e.clear()},isPressed:function(r){return e.has(r)}}}var xSe=["meta","alt","shift","control"],Lf=MSe();function DSe(e,t,r,n,o){var i=function(d){return xSe.includes(d)},a=function(d){var v=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,y=[];return d.altKey&&y.push("alt"),v&&(d.ctrlKey||d.metaKey)?y.push("control/meta"):(d.ctrlKey&&y.push("control"),d.metaKey&&y.push("meta")),d.shiftKey&&y.push("shift"),y},l=function(d){if(t(d)!==!1){var v=r(d);if(!(d.keyCode===229||v===!1||Il(d))){var y=vM(d.key),p=[];i(y)?Lf.press(y):p=a(d);var w=[y].concat(p),S=o(d,w);!S&&(z$()&&p.includes("meta")||!z$()&&p.includes("control"))&&o(d,[y].concat(a(d,!0))),n(d)}}},s=function(d){if(t(d)!==!1){var v=vM(d.key);i(v)!==!1&&Lf.release(v)}},u=function(){Lf.releaseAll()},f=function(){for(var d=e;d;)d.document.documentElement.addEventListener("keydown",l),d.document.documentElement.addEventListener("keyup",s),d.document.documentElement.addEventListener("blur",u),d=Ag(d)},c=function(){for(var d=e;d;)d.document.documentElement.removeEventListener("keydown",l),d.document.documentElement.removeEventListener("keyup",s),d.document.documentElement.removeEventListener("blur",u),d=Ag(d)};return{mount:f,unmount:c,isPressed:function(d){return Lf.isPressed(d)},releasePressedKeys:function(){return Lf.releaseAll()}}}var NSe=function(t){var r=t.ownerWindow,n=t.handleEvent,o=t.beforeKeyDown,i=t.afterKeyDown,a=gp({errorIdExists:function(y){return'The "'.concat(y,'" context name is already registered.')}}),l="grid",s=function(y){var p=ISe(y);return a.addItem(y,p),p},u=function(){return l},f=function(y){return a.getItem(y)},c=function(y){l=y},h=!1,d=DSe(r,n,o,i,function(v,y){var p=f(u()),w=!1;if(!p.hasShortcut(y))return w;for(var S=p.getShortcuts(y),C=0;C<S.length;C++){var P=S[C],R=P.callback,W=P.runOnlyIf,Y=P.preventDefault,q=P.stopPropagation,G=P.captureCtrl;if(W(v)!==!1&&(h=G,w=R(v,y)===!1,h=!1,Y&&v.preventDefault(),q&&v.stopPropagation(),w))break}return w});return d.mount(),{addContext:s,getActiveContextName:u,getContext:f,setActiveContextName:c,isCtrlPressed:function(){return!h&&(d.isPressed("control")||d.isPressed("meta"))},releasePressedKeys:function(){return d.releasePressedKeys()},destroy:function(){return d.unmount()}}};function pr(e){"@babel/helpers - typeof";return pr=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},pr(e)}function pn(e,t){return jSe(e)||LSe(e,t)||FW(e,t)||HSe()}function HSe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function LSe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function jSe(e){if(Array.isArray(e))return e}function fl(e){return VSe(e)||BSe(e)||FW(e)||FSe()}function FSe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function FW(e,t){if(e){if(typeof e=="string")return p_(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return p_(e,t)}}function BSe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function VSe(e){if(Array.isArray(e))return p_(e)}function p_(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var WSe="gridDefault",mw=null;function PT(e,t){var r,n=this,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=!1,a=this,l=new Pt(a),s,u,f,c,h=!0;rye(o)&&tye(this),this.rootElement=e,this.rootDocument=e.ownerDocument,this.rootWindow=this.rootDocument.defaultView,this.isDestroyed=!1,this.renderSuspendedCounter=0,this.executionSuspendedCounter=0;var d=(r=t==null?void 0:t.layoutDirection)!==null&&r!==void 0?r:"inherit",v=["rtl","ltr"].includes(d)?d:this.rootWindow.getComputedStyle(this.rootElement).direction;this.rootElement.setAttribute("dir",v),this.isRtl=function(){return v==="rtl"},this.isLtr=function(){return!a.isRtl()},this.getDirectionFactor=function(){return a.isLtr()?1:-1},t.language=epe(t.language);var y=new LW(a,t,[gSe,SSe]),p=y.getTableMeta(),w=y.getGlobalMeta(),S=gp();this.container=this.rootDocument.createElement("div"),this.renderCall=!1,e.insertBefore(this.container,e.firstChild),KC(this)&&aie(t.licenseKey,e),this.guid="ht_".concat(PB()),this.columnIndexMapper=new l_,this.rowIndexMapper=new l_,this.columnIndexMapper.addLocalHook("indexesSequenceChange",function(g){a.runHooks("afterColumnSequenceChange",g)}),this.rowIndexMapper.addLocalHook("indexesSequenceChange",function(g){a.runHooks("afterRowSequenceChange",g)}),u=new Eye(a),(!this.rootElement.id||this.rootElement.id.substring(0,3)==="ht_")&&(this.rootElement.id=this.guid);var C=function(m){var b=m.row,E=m.col;return a._createCellCoords(b>=0?a.rowIndexMapper.getRenderableFromVisualIndex(b):b,E>=0?a.columnIndexMapper.getRenderableFromVisualIndex(E):E)},P=function(m){var b=m.row,E=m.col;return a._createCellCoords(b>=0?a.rowIndexMapper.getVisualFromRenderableIndex(b):b,E>=0?a.columnIndexMapper.getVisualFromRenderableIndex(E):E)},R=new rwe(p,{rowIndexMapper:function(){return a.rowIndexMapper},columnIndexMapper:function(){return a.columnIndexMapper},countCols:function(){return a.countCols()},countRows:function(){return a.countRows()},propToCol:function(m){return s.propToCol(m)},isEditorOpened:function(){return a.getActiveEditor()?a.getActiveEditor().isOpened():!1},countColsTranslated:function(){return n.view.countRenderableColumns()},countRowsTranslated:function(){return n.view.countRenderableRows()},getShortcutManager:function(){return a.getShortcutManager()},createCellCoords:function(m,b){return a._createCellCoords(m,b)},createCellRange:function(m,b,E){return a._createCellRange(m,b,E)},visualToRenderableCoords:C,renderableToVisualCoords:P,isDisabledCellSelection:function(m,b){return a.getCellMeta(m,b).disableVisualSelection}});this.selection=R;var W=function(m){var b=m.hiddenIndexesChanged;b&&n.selection.refresh()};this.columnIndexMapper.addLocalHook("cacheUpdated",W),this.rowIndexMapper.addLocalHook("cacheUpdated",W),this.selection.addLocalHook("beforeSetRangeStart",function(g){n.runHooks("beforeSetRangeStart",g)}),this.selection.addLocalHook("beforeSetRangeStartOnly",function(g){n.runHooks("beforeSetRangeStartOnly",g)}),this.selection.addLocalHook("beforeSetRangeEnd",function(g){n.runHooks("beforeSetRangeEnd",g),g.row<0&&(g.row=n.view._wt.wtTable.getFirstVisibleRow()),g.col<0&&(g.col=n.view._wt.wtTable.getFirstVisibleColumn())}),this.selection.addLocalHook("afterSetRangeEnd",function(g){var m=ts(!1),b=n.selection.getSelectedRange(),E=b.current(),O=E.from,F=E.to,x=b.size()-1;n.runHooks("afterSelection",O.row,O.col,F.row,F.col,m,x),n.runHooks("afterSelectionByProp",O.row,a.colToProp(O.col),F.row,a.colToProp(F.col),m,x);var K=n.selection.isSelectedByAnyHeader(),Z=n.selection.selectedRange.current(),te=!0;i&&(te=!1),m.isTouched()&&(te=!m.value);var ie=n.selection.isSelectedByRowHeader(),se=n.selection.isSelectedByColumnHeader();te!==!1&&(K?ie?n.view.scrollViewportVertically(a.rowIndexMapper.getRenderableFromVisualIndex(g.row)):se&&n.view.scrollViewportHorizontally(a.columnIndexMapper.getRenderableFromVisualIndex(g.col)):Z&&!n.selection.isMultiple()?n.view.scrollViewport(C(Z.from)):n.view.scrollViewport(C(g))),ie&&se?re(n.rootElement,["ht__selection--rows","ht__selection--columns"]):ie?(He(n.rootElement,"ht__selection--columns"),re(n.rootElement,"ht__selection--rows")):se?(He(n.rootElement,"ht__selection--rows"),re(n.rootElement,"ht__selection--columns")):He(n.rootElement,["ht__selection--rows","ht__selection--columns"]),n._refreshBorders(null)}),this.selection.addLocalHook("afterSelectionFinished",function(g){var m=g.length-1,b=g[m],E=b.from,O=b.to;n.runHooks("afterSelectionEnd",E.row,E.col,O.row,O.col,m),n.runHooks("afterSelectionEndByProp",E.row,a.colToProp(E.col),O.row,a.colToProp(O.col),m)}),this.selection.addLocalHook("afterIsMultipleSelection",function(g){var m=n.runHooks("afterIsMultipleSelection",g.value);g.value&&(g.value=m)}),this.selection.addLocalHook("beforeModifyTransformStart",function(g){n.runHooks("modifyTransformStart",g)}),this.selection.addLocalHook("afterModifyTransformStart",function(g,m,b){n.runHooks("afterModifyTransformStart",g,m,b)}),this.selection.addLocalHook("beforeModifyTransformEnd",function(g){n.runHooks("modifyTransformEnd",g)}),this.selection.addLocalHook("afterModifyTransformEnd",function(g,m,b){n.runHooks("afterModifyTransformEnd",g,m,b)}),this.selection.addLocalHook("afterDeselect",function(){c.destroyEditor(),n._refreshBorders(),He(n.rootElement,["ht__selection--rows","ht__selection--columns"]),n.runHooks("afterDeselect")}),this.selection.addLocalHook("insertRowRequire",function(g){n.alter("insert_row_above",g,1,"auto")}),this.selection.addLocalHook("insertColRequire",function(g){n.alter("insert_col_start",g,1,"auto")}),f={alter:function(m,b){var E,O,F=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,x=arguments.length>3?arguments[3]:void 0,K=arguments.length>4?arguments[4]:void 0,Z=function(Ie){if(Ie.length===0)return[];var Me=fl(Ie);Me.sort(function(xt,Be){var Qe=pn(xt,1),pt=Qe[0],lt=pn(Be,1),st=lt[0];return pt===st?0:pt>st?1:-1});var ar=nr(Me,function(xt,Be){var Qe=pn(Be,2),pt=Qe[0],lt=Qe[1],st=xt[xt.length-1],Je=pn(st,2),Bo=Je[0],Lp=Je[1],Ti=Bo+Lp;if(pt<=Ti){var wf=Math.max(lt-(Ti-pt),0);st[1]+=wf}else xt.push([pt,lt]);return xt},[Me[0]]);return ar};switch(m){case"insert_row_below":case"insert_row_above":var te=a.countSourceRows();if(p.maxRows===te)return;var ie=m==="insert_row_below"?"below":"above";b=(E=b)!==null&&E!==void 0?E:ie==="below"?te:0;var se=s.createRow(b,F,{source:x,mode:ie}),Se=se.delta,we=se.startPhysicalIndex;if(Se){var U=R.selectedRange.current(),De=U==null?void 0:U.from,Fe=De==null?void 0:De.row,ke=a.toVisualRow(we);if(R.isSelectedByCorner())a.selectAll();else if(ye(Fe)&&Fe>=ke){var Ae=U.to,Pe=Ae.row,_=Ae.col,T=De.col;R.isSelectedByRowHeader()&&(T=-1),R.getSelectedRange().pop(),R.setRangeStartOnly(a._createCellCoords(Fe+Se,T),!0),R.setRangeEnd(a._createCellCoords(Pe+Se,_))}else a._refreshBorders()}break;case"insert_col_start":case"insert_col_end":var A=m==="insert_col_end"?"end":"start";b=(O=b)!==null&&O!==void 0?O:A==="end"?a.countSourceCols():0;var j=s.createCol(b,F,{source:x,mode:A}),M=j.delta,B=j.startPhysicalIndex;if(M){if(Array.isArray(p.colHeaders)){var N=[a.toVisualColumn(B),0];N.length+=M,Array.prototype.splice.apply(p.colHeaders,N)}var D=R.selectedRange.current(),V=D==null?void 0:D.from,L=V==null?void 0:V.col,z=a.toVisualColumn(B);if(R.isSelectedByCorner())a.selectAll();else if(ye(L)&&L>=z){var le=D.to,me=le.row,Re=le.col,Ne=V.row;R.isSelectedByColumnHeader()&&(Ne=-1),R.getSelectedRange().pop(),R.setRangeStartOnly(a._createCellCoords(Ne,L+M),!0),R.setRangeEnd(a._createCellCoords(me,Re+M))}else a._refreshBorders()}break;case"remove_row":var Xe=function(Ie){var Me=0;I(Ie,function(ar){var xt=pn(ar,2),Be=xt[0],Qe=xt[1],pt=Yt(Be)?a.countRows()-1:Math.max(Be-Me,0);Number.isInteger(Be)&&(Be=Math.max(Be-Me,0));var lt=s.removeRow(Be,Qe,x);if(lt){var st=a.countRows(),Je=p.fixedRowsTop;Je>=pt+1&&(p.fixedRowsTop-=Math.min(Qe,Je-pt));var Bo=p.fixedRowsBottom;Bo&&pt>=st-Bo&&(p.fixedRowsBottom-=Math.min(Qe,Bo)),Me+=Qe}})};Array.isArray(b)?Xe(Z(b)):Xe([[b,F]]),f.adjustRowsAndCols(),a._refreshBorders();break;case"remove_col":var at=function(Ie){var Me=0;I(Ie,function(ar){var xt=pn(ar,2),Be=xt[0],Qe=xt[1],pt=Yt(Be)?a.countCols()-1:Math.max(Be-Me,0),lt=a.toPhysicalColumn(pt);Number.isInteger(Be)&&(Be=Math.max(Be-Me,0));var st=s.removeCol(Be,Qe,x);if(st){var Je=p.fixedColumnsStart;Je>=pt+1&&(p.fixedColumnsStart-=Math.min(Qe,Je-pt)),Array.isArray(p.colHeaders)&&(typeof lt>"u"&&(lt=-1),p.colHeaders.splice(lt,Qe)),Me+=Qe}})};Array.isArray(b)?at(Z(b)):at([[b,F]]),f.adjustRowsAndCols(),a._refreshBorders();break;default:throw new Error('There is no such action "'.concat(m,'"'))}K||f.adjustRowsAndCols()},adjustRowsAndCols:function(){var m=p.minRows,b=p.minSpareRows,E=p.minCols,O=p.minSpareCols;if(a.countRows()===0&&a.countCols()===0&&R.deselect(),m){var F=a.countRows();F<m&&s.createRow(F,m-F,{source:"auto"})}if(b){var x=a.countEmptyRows(!0);if(x<b){var K=b-x,Z=Math.min(K,p.maxRows-a.countSourceRows());s.createRow(a.countRows(),Z,{source:"auto"})}}{var te;(E||O)&&(te=a.countEmptyCols(!0));var ie=a.countCols();if(E&&!p.columns&&ie<E){var se=E-ie;te+=se,s.createCol(ie,se,{source:"auto"})}if(O&&!p.columns&&a.dataType==="array"&&te<O){ie=a.countCols();var Se=O-te,we=Math.min(Se,p.maxCols-ie);s.createCol(ie,we,{source:"auto"})}}if(R.isSelected()){var U=a.countRows(),De=a.countCols();I(R.selectedRange,function(Fe){var ke=!1,Ae=Fe.from.row,Pe=Fe.from.col,_=Fe.to.row,T=Fe.to.col;Ae>U-1?(Ae=U-1,ke=!0,_>Ae&&(_=Ae)):_>U-1&&(_=U-1,ke=!0,Ae>_&&(Ae=_)),Pe>De-1?(Pe=De-1,ke=!0,T>Pe&&(T=Pe)):T>De-1&&(T=De-1,ke=!0,Pe>T&&(Pe=T)),ke&&a.selectCell(Ae,Pe,_,T)})}a.view&&a.view.adjustElementsSize()},populateFromArray:function(m,b,E,O,F){var x,K,Z,te,ie=[],se={},Se=[],we=m.row,U=m.col;if(K=b.length,K===0)return!1;var De=0,Fe=0;switch(Ge(E)&&(De=E.col-U+1,Fe=E.row-we+1),F){case"shift_down":var ke=Dy(b),Ae=ke.length,Pe=Math.max(Ae,De),_=a.getData().slice(we),T=Dy(_).slice(U,U+Pe);for(Z=0;Z<Pe;Z+=1)if(Z<Ae){for(x=0,K=ke[Z].length;x<Fe-K;x+=1)ke[Z].push(ke[Z][x%K]);Z<T.length?Se.push(ke[Z].concat(T[Z])):Se.push(ke[Z].concat(new Array(_.length).fill(null)))}else Se.push(ke[Z%Ae].concat(T[Z]));a.populateFromArray(we,U,Dy(Se));break;case"shift_right":var A=b.length,j=Math.max(A,Fe),M=a.getData().slice(we).map(function(Be){return Be.slice(U)});for(x=0;x<j;x+=1)if(x<A){for(Z=0,te=b[x].length;Z<De-te;Z+=1)b[x].push(b[x][Z%te]);if(x<M.length)for(var B=0;B<M[x].length;B+=1)b[x].push(M[x][B]);else{var N;(N=b[x]).push.apply(N,fl(new Array(M[0].length).fill(null)))}}else b.push(b[x%K].slice(0,j).concat(M[x]));a.populateFromArray(we,U,b);break;case"overwrite":default:se.row=m.row,se.col=m.col;var D=0,V=0,L=!0,z,le=function(Qe){var pt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,lt=b[Qe%b.length];return pt!==null?lt[pt%lt.length]:lt},me=b.length,Re=E?E.row-m.row+1:0;for(E?K=Re:K=Math.max(me,Re),x=0;x<K&&!(E&&se.row>E.row&&Re>me||!p.allowInsertRow&&se.row>a.countRows()-1||se.row>=p.maxRows);x++){var Ne=x-D,Xe=le(Ne).length,at=E?E.col-m.col+1:0;if(E?te=at:te=Math.max(Xe,at),se.col=m.col,z=a.getCellMeta(se.row,se.col),(O==="CopyPaste.paste"||O==="Autofill.fill")&&z.skipRowOnPaste){D+=1,se.row+=1,K+=1;continue}for(V=0,Z=0;Z<te&&!(E&&se.col>E.col&&at>Xe||!p.allowInsertColumn&&se.col>a.countCols()-1||se.col>=p.maxCols);Z++){if(z=a.getCellMeta(se.row,se.col),(O==="CopyPaste.paste"||O==="Autofill.fill")&&z.skipColumnOnPaste){V+=1,se.col+=1,te+=1;continue}if(z.readOnly&&O!=="UndoRedo.undo"){se.col+=1;continue}var We=Z-V,Ie=le(Ne,We),Me=a.getDataAtCell(se.row,se.col);if(Ie!==null&&pr(Ie)==="object")if(Array.isArray(Ie)&&Me===null&&(Me=[]),Me===null||pr(Me)!=="object")L=!1;else{var ar=Rc(Array.isArray(Me)?Me:Me[0]||Me),xt=Rc(Array.isArray(Ie)?Ie:Ie[0]||Ie);cE(ar,xt)||Array.isArray(ar)&&Array.isArray(xt)?Ie=dr(Ie):L=!1}else Me!==null&&pr(Me)==="object"&&(L=!1);L&&ie.push([se.row,se.col,Ie]),L=!0,se.col+=1}se.row+=1}a.setDataAtCell(ie,null,null,O||"populateFromArray");break}}};function Y(g){var m=vW(g);RT(m)?(a.runHooks("beforeLanguageChange",m),w.language=m,a.runHooks("afterLanguageChange",m)):yW(g)}function q(g,m){var b=g==="className"?a.rootElement:a.table;if(h)re(b,m);else{var E=[],O=[];w[g]&&(E=Array.isArray(w[g])?w[g]:V$(w[g])),m&&(O=Array.isArray(m)?m:V$(m));var F=B$(E,O),x=B$(O,E);F.length&&He(b,F),x.length&&re(b,x)}w[g]=m}this.init=function(){u.setData(p.data),a.runHooks("beforeInit"),(An()||xF())&&re(a.rootElement,"mobile"),this.updateSettings(p,!0),this.view=new gye(this),c=_ae.getInstance(a,p,R),a.runHooks("init"),this.forceFullRender=!0,this.view.render(),h&&a.rootElement.offsetParent===null&&Cie(a.rootElement,function(){a.view._wt.wtOverlays.updateLastSpreaderSize(),a.render(),a.view.adjustElementsSize()}),pr(h)==="object"&&(a.runHooks("afterChange",h[0],h[1]),h=!1),a.runHooks("afterInit")};function G(){var g=!1;return{validatorsInQueue:0,valid:!0,addValidatorToQueue:function(){this.validatorsInQueue+=1,g=!1},removeValidatorFormQueue:function(){this.validatorsInQueue=this.validatorsInQueue-1<0?0:this.validatorsInQueue-1,this.checkIfQueueIsEmpty()},onQueueEmpty:function(){},checkIfQueueIsEmpty:function(){this.validatorsInQueue===0&&g===!1&&(g=!0,this.onQueueEmpty(this.valid))}}}function X(g){var m=g.replace(",",".");return isNaN(parseFloat(m))===!1?parseFloat(m):g}function Q(g,m,b){if(g.length){var E=a.getActiveEditor(),O=new G,F=!0;O.onQueueEmpty=function(we){E&&F&&E.cancelChanges(),b(we)};for(var x=g.length-1;x>=0;x--){var K=pn(g[x],4),Z=K[0],te=K[1],ie=K[3],se=s.propToCol(te),Se=a.getCellMeta(Z,se);Se.type==="numeric"&&typeof ie=="string"&&mle(ie)&&(g[x][3]=X(ie)),a.getCellValidator(Se)&&(O.addValidatorToQueue(),a.validateCell(g[x][3],Se,function(we,U){return function(De){if(typeof De!="boolean")throw new Error("Validation error: result is not boolean");if(De===!1&&U.allowInvalid===!1){F=!1,g.splice(we,1),U.valid=!0;var Fe=a.getCell(U.visualRow,U.visualCol);Fe!==null&&He(Fe,p.invalidCellClassName)}O.removeValidatorFormQueue()}}(x,Se),m))}O.checkIfQueueIsEmpty()}}function oe(g,m){var b=g.length-1;if(!(b<0)){for(;b>=0;b--){var E=!1;if(g[b]===null){g.splice(b,1);continue}if(!((g[b][2]===null||g[b][2]===void 0)&&(g[b][3]===null||g[b][3]===void 0))){if(p.allowInsertRow)for(;g[b][0]>a.countRows()-1;){var O=s.createRow(void 0,void 0,{source:m}),F=O.delta;if(F===0){E=!0;break}}if(a.dataType==="array"&&(!p.columns||p.columns.length===0)&&p.allowInsertColumn)for(;s.propToCol(g[b][1])>a.countCols()-1;){var x=s.createCol(void 0,void 0,{source:m}),K=x.delta;if(K===0){E=!0;break}}E||s.set(g[b][0],g[b][1],g[b][3])}}a.forceFullRender=!0,f.adjustRowsAndCols(),a.runHooks("beforeChangeRender",g,m),c.lockEditor(),a._refreshBorders(null),c.unlockEditor(),a.view.adjustElementsSize(),a.runHooks("afterChange",g,m||"edit");var Z=a.getActiveEditor();Z&&ye(Z.refreshValue)&&Z.refreshValue()}}this._createCellCoords=function(g,m){return a.view._wt.createCellCoords(g,m)},this._createCellRange=function(g,m,b){return a.view._wt.createCellRange(g,m,b)},this.validateCell=function(g,m,b,E){var O=a.getCellValidator(m);function F(x){var K=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(!K||m.hidden===!0){b(x);return}var Z=m.visualCol,te=m.visualRow,ie=a.getCell(te,Z,!0);if(ie&&ie.nodeName!=="TH"){var se=a.rowIndexMapper.getRenderableFromVisualIndex(te),Se=a.columnIndexMapper.getRenderableFromVisualIndex(Z);a.view._wt.getSetting("cellRenderer",se,Se,ie)}b(x)}nie(O)&&(O=function(x){return function(K,Z){Z(x.test(K))}}(O)),vt(O)?(g=a.runHooks("beforeValidate",g,m.visualRow,m.prop,E),a._registerImmediate(function(){O.call(m,g,function(x){a&&(x=a.runHooks("afterValidate",x,g,m.visualRow,m.prop,E),m.valid=x,F(x),a.runHooks("postAfterValidate",x,g,m.visualRow,m.prop,E))})})):a._registerImmediate(function(){m.valid=!0,F(m.valid,!1)})};function J(g,m,b){return Array.isArray(g)?g:[[g,m,b]]}function ue(g,m){var b=a.getActiveEditor(),E=a.runHooks("beforeChange",g,m||"edit"),O=g.filter(function(F){return F!==null});return E===!1||O.length===0?(b&&b.cancelChanges(),[]):O}this.setDataAtCell=function(g,m,b,E){var O=J(g,m,b),F=[],x=E,K,Z,te;for(K=0,Z=O.length;K<Z;K++){if(pr(O[K])!=="object")throw new Error("Method `setDataAtCell` accepts row number or changes array of arrays as its first parameter");if(typeof O[K][1]!="number")throw new Error("Method `setDataAtCell` accepts row and column number as its parameters. If you want to use object property name, use method `setDataAtRowProp`");O[K][1]>=this.countCols()?te=O[K][1]:te=s.colToProp(O[K][1]),F.push([O[K][0],te,u.getAtCell(this.toPhysicalRow(O[K][0]),O[K][1]),O[K][2]])}!x&&pr(g)==="object"&&(x=m);var ie=ue(F,E);a.runHooks("afterSetDataAtCell",ie,x),Q(ie,x,function(){oe(ie,x)})},this.setDataAtRowProp=function(g,m,b,E){var O=J(g,m,b),F=[],x=E,K,Z;for(K=0,Z=O.length;K<Z;K++)F.push([O[K][0],O[K][1],u.getAtCell(this.toPhysicalRow(O[K][0]),O[K][1]),O[K][2]]);!x&&pr(g)==="object"&&(x=m);var te=ue(F,E);a.runHooks("afterSetDataAtRowProp",te,x),Q(te,x,function(){oe(te,x)})},this.listen=function(){a&&!a.isListening()&&(mw=a.guid,a.runHooks("afterListen"))},this.unlisten=function(){this.isListening()&&(mw=null,a.runHooks("afterUnlisten"))},this.isListening=function(){return mw===a.guid},this.destroyEditor=function(){var g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;a._refreshBorders(g,m)},this.populateFromArray=function(g,m,b,E,O,F,x){if(!(pr(b)==="object"&&pr(b[0])==="object"))throw new Error("populateFromArray parameter `input` must be an array of arrays");var K=typeof E=="number"?a._createCellCoords(E,O):null;return f.populateFromArray(a._createCellCoords(g,m),b,K,F,x)},this.spliceCol=function(g,m,b){for(var E,O=arguments.length,F=new Array(O>3?O-3:0),x=3;x<O;x++)F[x-3]=arguments[x];return(E=s).spliceCol.apply(E,[g,m,b].concat(F))},this.spliceRow=function(g,m,b){for(var E,O=arguments.length,F=new Array(O>3?O-3:0),x=3;x<O;x++)F[x-3]=arguments[x];return(E=s).spliceRow.apply(E,[g,m,b].concat(F))},this.getSelected=function(){if(R.isSelected())return Ye(R.getSelectedRange(),function(g){var m=g.from,b=g.to;return[m.row,m.col,b.row,b.col]})},this.getSelectedLast=function(){var g=this.getSelected(),m;return g&&g.length>0&&(m=g[g.length-1]),m},this.getSelectedRange=function(){if(R.isSelected())return Array.from(R.getSelectedRange())},this.getSelectedRangeLast=function(){var g=this.getSelectedRange(),m;return g&&g.length>0&&(m=g[g.length-1]),m},this.emptySelectedCells=function(g){var m=this;if(!(!R.isSelected()||this.countRows()===0||this.countCols()===0)){var b=[];I(R.getSelectedRange(),function(E){var O=E.getTopStartCorner(),F=E.getBottomEndCorner();_e(O.row,F.row,function(x){_e(O.col,F.col,function(K){m.getCellMeta(x,K).readOnly||b.push([x,K,null])})})}),b.length>0&&this.setDataAtCell(b,g)}},this.isRenderSuspended=function(){return this.renderSuspendedCounter>0},this.suspendRender=function(){this.renderSuspendedCounter+=1},this.resumeRender=function(){var g=this.renderSuspendedCounter-1;this.renderSuspendedCounter=Math.max(g,0),!this.isRenderSuspended()&&g===this.renderSuspendedCounter&&(this.renderCall?this.render():this._refreshBorders(null))},this.render=function(){this.view&&(this.renderCall=!0,this.forceFullRender=!0,this.isRenderSuspended()||(c.lockEditor(),this._refreshBorders(null),c.unlockEditor()))},this.batchRender=function(g){this.suspendRender();var m=g();return this.resumeRender(),m},this.isExecutionSuspended=function(){return this.executionSuspendedCounter>0},this.suspendExecution=function(){this.executionSuspendedCounter+=1,this.columnIndexMapper.suspendOperations(),this.rowIndexMapper.suspendOperations()},this.resumeExecution=function(){var g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,m=this.executionSuspendedCounter-1;this.executionSuspendedCounter=Math.max(m,0),(!this.isExecutionSuspended()&&m===this.executionSuspendedCounter||g)&&(this.columnIndexMapper.resumeOperations(),this.rowIndexMapper.resumeOperations())},this.batchExecution=function(g){var m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;this.suspendExecution();var b=g();return this.resumeExecution(m),b},this.batch=function(g){this.suspendRender(),this.suspendExecution();var m=g();return this.resumeExecution(),this.resumeRender(),m},this.refreshDimensions=function(){if(a.view){var g=a.view.getLastSize(),m=g.width,b=g.height,E=a.rootElement.getBoundingClientRect(),O=E.width,F=E.height,x=O!==m||F!==b,K=a.runHooks("beforeRefreshDimensions",{width:m,height:b},{width:O,height:F},x)===!1;K||((x||a.view._wt.wtOverlays.scrollableElement===a.rootWindow)&&(a.view.setLastSize(O,F),a.render()),a.runHooks("afterRefreshDimensions",{width:m,height:b},{width:O,height:F},x))}},this.updateData=function(g,m){var b=this;fM(g,function(E){s=E},function(E){s=E,a.columnIndexMapper.fitToLength(b.getInitialColumnCount()),a.rowIndexMapper.fitToLength(b.countSourceRows()),f.adjustRowsAndCols()},{hotInstance:a,dataMap:s,dataSource:u,internalSource:"updateData",source:m,metaManager:y,firstRun:h})},this.loadData=function(g,m){fM(g,function(b){s=b},function(){y.clearCellsCache(),a.initIndexMappers(),f.adjustRowsAndCols(),h&&(h=[null,"loadData"])},{hotInstance:a,dataMap:s,dataSource:u,internalSource:"loadData",source:m,metaManager:y,firstRun:h})},this.getInitialColumnCount=function(){var g=p.columns,m=0;if(Array.isArray(g))m=g.length;else if(vt(g))if(a.dataType==="array")for(var b=this.countSourceCols(),E=0;E<b;E+=1)g(E)&&(m+=1);else(a.dataType==="object"||a.dataType==="function")&&(m=s.colToPropCache.length);else if(ye(p.dataSchema)){var O=s.getSchema();m=Array.isArray(O)?O.length:hE(O)}else m=this.countSourceCols();return m},this.initIndexMappers=function(){this.columnIndexMapper.initToLength(this.getInitialColumnCount()),this.rowIndexMapper.initToLength(this.countSourceRows())},this.getData=function(g,m,b,E){return gt(g)?s.getAll():s.getRange(a._createCellCoords(g,m),a._createCellCoords(b,E),s.DESTINATION_RENDERER)},this.getCopyableText=function(g,m,b,E){return s.getCopyableText(a._createCellCoords(g,m),a._createCellCoords(b,E))},this.getCopyableData=function(g,m){return s.getCopyable(g,s.colToProp(m))},this.getSchema=function(){return s.getSchema()},this.updateSettings=function(g){var m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,b=(h?a.loadData:a.updateData).bind(this),E=!1,O,F;if(ye(g.rows))throw new Error('The "rows" setting is no longer supported. Do you mean startRows, minRows or maxRows?');if(ye(g.cols))throw new Error('The "cols" setting is no longer supported. Do you mean startCols, minCols or maxCols?');if(ye(g.ganttChart))throw new Error('Since 8.0.0 the "ganttChart" setting is no longer supported.');for(O in g)O==="data"||(O==="language"?Y(g.language):O==="className"?q("className",g.className):O==="tableClassName"&&a.table?(q("tableClassName",g.tableClassName),a.view._wt.wtOverlays.syncOverlayTableClassNames()):ge.getSingleton().isRegistered(O)||ge.getSingleton().isDeprecated(O)?(vt(g[O])||Array.isArray(g[O]))&&(g[O].initialHook=!0,a.addHook(O,g[O])):!m&&It(g,O)&&(w[O]=g[O]));g.data===void 0&&p.data===void 0?b(null,"updateSettings"):g.data!==void 0?b(g.data,"updateSettings"):g.columns!==void 0&&(s.createMap(),a.initIndexMappers());var x=a.countCols(),K=p.columns;if(K&&vt(K)&&(E=!0),(g.cell!==void 0||g.cells!==void 0||g.columns!==void 0)&&y.clearCache(),x>0)for(O=0,F=0;O<x;O++){if(K){var Z=E?K(O):K[F];Z&&y.updateColumnMeta(F,Z)}F+=1}ye(g.cell)&&Ke(g.cell,function(U){a.setCellMetaObject(U.row,U.col,U)}),a.runHooks("afterCellMetaReset");var te=a.rootElement.style.height;te!==""&&(te=parseInt(a.rootElement.style.height,10));var ie=g.height;if(vt(ie)&&(ie=ie()),m){var se=a.rootElement.getAttribute("style");se&&a.rootElement.setAttribute("data-initialstyle",a.rootElement.getAttribute("style"))}if(ie===null){var Se=a.rootElement.getAttribute("data-initialstyle");Se&&(Se.indexOf("height")>-1||Se.indexOf("overflow")>-1)?a.rootElement.setAttribute("style",Se):(a.rootElement.style.height="",a.rootElement.style.overflow="")}else ie!==void 0&&(a.rootElement.style.height=isNaN(ie)?"".concat(ie):"".concat(ie,"px"),a.rootElement.style.overflow="hidden");if(typeof g.width<"u"){var we=g.width;vt(we)&&(we=we()),a.rootElement.style.width=isNaN(we)?"".concat(we):"".concat(we,"px")}m||(a.view&&(a.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked(),a.view._wt.exportSettingsAsClassNames()),a.runHooks("afterUpdateSettings",g)),f.adjustRowsAndCols(),a.view&&!h&&(a.forceFullRender=!0,c.lockEditor(),a._refreshBorders(null),a.view._wt.wtOverlays.adjustElementsSize(),c.unlockEditor()),!m&&a.view&&(te===""||ie===""||ie===void 0)&&te!==ie&&a.view._wt.wtOverlays.updateMainScrollableElements()},this.getValue=function(){var g=a.getSelectedLast();if(p.getValue){if(vt(p.getValue))return p.getValue.call(a);if(g)return a.getData()[g[0][0]][p.getValue]}else if(g)return a.getDataAtCell(g[0],g[1])},this.getSettings=function(){return p},this.clear=function(){this.selectAll(),this.emptySelectedCells()},this.alter=function(g,m,b,E,O){f.alter(g,m,b,E,O)},this.getCell=function(g,m){var b=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,E=m,O=g;if(m>=0){if(this.columnIndexMapper.isHidden(this.toPhysicalColumn(m)))return null;E=this.columnIndexMapper.getRenderableFromVisualIndex(m)}if(g>=0){if(this.rowIndexMapper.isHidden(this.toPhysicalRow(g)))return null;O=this.rowIndexMapper.getRenderableFromVisualIndex(g)}return O===null||E===null?null:a.view.getCellAtCoords(a._createCellCoords(O,E),b)},this.getCoords=function(g){var m=this.view._wt.wtTable.getCoords(g);if(m===null)return null;var b=m.row,E=m.col,O=b,F=E;return b>=0&&(O=this.rowIndexMapper.getVisualFromRenderableIndex(b)),E>=0&&(F=this.columnIndexMapper.getVisualFromRenderableIndex(E)),a._createCellCoords(O,F)},this.colToProp=function(g){return s.colToProp(g)},this.propToCol=function(g){return s.propToCol(g)},this.toVisualRow=function(g){return n.rowIndexMapper.getVisualFromPhysicalIndex(g)},this.toVisualColumn=function(g){return n.columnIndexMapper.getVisualFromPhysicalIndex(g)},this.toPhysicalRow=function(g){return n.rowIndexMapper.getPhysicalFromVisualIndex(g)},this.toPhysicalColumn=function(g){return n.columnIndexMapper.getPhysicalFromVisualIndex(g)},this.getDataAtCell=function(g,m){return s.get(g,s.colToProp(m))},this.getDataAtRowProp=function(g,m){return s.get(g,m)},this.getDataAtCol=function(g){for(var m=[],b=s.getRange(a._createCellCoords(0,g),a._createCellCoords(p.data.length-1,g),s.DESTINATION_RENDERER),E=0;E<b.length;E+=1)for(var O=0;O<b[E].length;O+=1)m.push(b[E][O]);return m},this.getDataAtProp=function(g){for(var m=[],b=s.getRange(a._createCellCoords(0,s.propToCol(g)),a._createCellCoords(p.data.length-1,s.propToCol(g)),s.DESTINATION_RENDERER),E=0;E<b.length;E+=1)for(var O=0;O<b[E].length;O+=1)m.push(b[E][O]);return m},this.getSourceData=function(g,m,b,E){var O;return g===void 0?O=u.getData():O=u.getByRange(a._createCellCoords(g,m),a._createCellCoords(b,E)),O},this.getSourceDataArray=function(g,m,b,E){var O;return g===void 0?O=u.getData(!0):O=u.getByRange(a._createCellCoords(g,m),a._createCellCoords(b,E),!0),O},this.getSourceDataAtCol=function(g){return u.getAtColumn(g)},this.setSourceDataAtCell=function(g,m,b,E){var O=J(g,m,b),F=this.hasHook("afterSetSourceDataAtCell"),x=[];F&&I(O,function(Z){var te=pn(Z,3),ie=te[0],se=te[1],Se=te[2];x.push([ie,se,u.getAtCell(ie,se),Se])}),I(O,function(Z){var te=pn(Z,3),ie=te[0],se=te[1],Se=te[2];u.setAtCell(ie,se,Se)}),F&&this.runHooks("afterSetSourceDataAtCell",x,E),this.render();var K=a.getActiveEditor();K&&ye(K.refreshValue)&&K.refreshValue()},this.getSourceDataAtRow=function(g){return u.getAtRow(g)},this.getSourceDataAtCell=function(g,m){return u.getAtCell(g,m)},this.getDataAtRow=function(g){var m=s.getRange(a._createCellCoords(g,0),a._createCellCoords(g,this.countCols()-1),s.DESTINATION_RENDERER);return m[0]||[]},this.getDataType=function(g,m,b,E){var O=this,F=g===void 0?[0,0,this.countRows(),this.countCols()]:[g,m,b,E],x=F[0],K=F[1],Z=F[2],te=F[3],ie=null,se=null;Z===void 0&&(Z=x),te===void 0&&(te=K);var Se="mixed";return _e(Math.max(Math.min(x,Z),0),Math.max(x,Z),function(we){var U=!0;return _e(Math.max(Math.min(K,te),0),Math.max(K,te),function(De){var Fe=O.getCellMeta(we,De);return se=Fe.type,ie?U=ie===se:ie=se,U}),Se=U?se:"mixed",U}),Se},this.removeCellMeta=function(g,m,b){var E=[this.toPhysicalRow(g),this.toPhysicalColumn(m)],O=E[0],F=E[1],x=y.getCellMetaKeyValue(O,F,b),K=a.runHooks("beforeRemoveCellMeta",g,m,b,x);K!==!1&&(y.removeCellMeta(O,F,b),a.runHooks("afterRemoveCellMeta",g,m,b,x)),x=null},this.spliceCellsMeta=function(g){for(var m=this,b=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,E=arguments.length,O=new Array(E>2?E-2:0),F=2;F<E;F++)O[F-2]=arguments[F];if(O.length>0&&!Array.isArray(O[0]))throw new Error("The 3rd argument (cellMetaRows) has to be passed as an array of cell meta objects array.");b>0&&y.removeRow(this.toPhysicalRow(g),b),O.length>0&&I(O.reverse(),function(x){y.createRow(m.toPhysicalRow(g)),I(x,function(K,Z){return m.setCellMetaObject(g,Z,K)})}),a.render()},this.setCellMetaObject=function(g,m,b){var E=this;pr(b)==="object"&&Ke(b,function(O,F){E.setCellMeta(g,m,F,O)})},this.setCellMeta=function(g,m,b,E){var O=a.runHooks("beforeSetCellMeta",g,m,b,E);if(O!==!1){var F=g,x=m;g<this.countRows()&&(F=this.toPhysicalRow(g)),m<this.countCols()&&(x=this.toPhysicalColumn(m)),y.setCellMeta(F,x,b,E),a.runHooks("afterSetCellMeta",g,m,b,E)}},this.getCellsMeta=function(){return y.getCellsMeta()},this.getCellMeta=function(g,m){var b=this.toPhysicalRow(g),E=this.toPhysicalColumn(m);return b===null&&(b=g),E===null&&(E=m),y.getCellMeta(b,E,{visualRow:g,visualColumn:m})},this.getCellMetaAtRow=function(g){return y.getCellsMetaAtRow(g)},this.isColumnModificationAllowed=function(){return!(a.dataType==="object"||p.columns)},this.getCellRenderer=function(g,m){var b=typeof g=="number"?a.getCellMeta(g,m).renderer:g.renderer;return typeof b=="string"?UA(b):gt(b)?UA("text"):b},this.getCellEditor=function(g,m){var b=typeof g=="number"?a.getCellMeta(g,m).editor:g.editor;return typeof b=="string"?$A(b):gt(b)?$A("text"):b},this.getCellValidator=function(g,m){var b=typeof g=="number"?a.getCellMeta(g,m).validator:g.validator;return typeof b=="string"?fse(b):b},this.validateCells=function(g){this._validateCells(g)},this.validateRows=function(g,m){if(!Array.isArray(g))throw new Error("validateRows parameter `rows` must be an array");this._validateCells(m,g)},this.validateColumns=function(g,m){if(!Array.isArray(g))throw new Error("validateColumns parameter `columns` must be an array");this._validateCells(m,void 0,g)},this._validateCells=function(g,m,b){var E=new G;g&&(E.onQueueEmpty=g);for(var O=a.countRows()-1;O>=0;){if(m!==void 0&&m.indexOf(O)===-1){O-=1;continue}for(var F=a.countCols()-1;F>=0;){if(b!==void 0&&b.indexOf(F)===-1){F-=1;continue}E.addValidatorToQueue(),a.validateCell(a.getDataAtCell(O,F),a.getCellMeta(O,F),function(x){if(typeof x!="boolean")throw new Error("Validation error: result is not boolean");x===!1&&(E.valid=!1),E.removeValidatorFormQueue()},"validateCells"),F-=1}O-=1}E.checkIfQueueIsEmpty()},this.getRowHeader=function(g){var m=p.rowHeaders,b=g;return b!==void 0&&(b=a.runHooks("modifyRowHeader",b)),b===void 0?(m=[],_e(a.countRows()-1,function(E){m.push(a.getRowHeader(E))})):Array.isArray(m)&&m[b]!==void 0?m=m[b]:vt(m)?m=m(b):m&&typeof m!="string"&&typeof m!="number"&&(m=b+1),m},this.hasRowHeaders=function(){return!!p.rowHeaders},this.hasColHeaders=function(){if(p.colHeaders!==void 0&&p.colHeaders!==null)return!!p.colHeaders;for(var g=0,m=a.countCols();g<m;g++)if(a.getColHeader(g))return!0;return!1},this.getColHeader=function(g){var m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:-1,b=a.runHooks("modifyColHeader",g);if(b===void 0){for(var E=[],O=a.countCols(),F=0;F<O;F++)E.push(a.getColHeader(F));return E}var x=p.colHeaders,K=function(se){for(var Se=[],we=a.countCols(),U=0;U<we;U++)vt(p.columns)&&p.columns(U)&&Se.push(U);return Se[se]},Z=a.toPhysicalColumn(b),te=K(Z);return p.colHeaders===!1?x=null:p.columns&&vt(p.columns)&&p.columns(te)&&p.columns(te).title?x=p.columns(te).title:p.columns&&p.columns[Z]&&p.columns[Z].title?x=p.columns[Z].title:Array.isArray(p.colHeaders)&&p.colHeaders[Z]!==void 0?x=p.colHeaders[Z]:vt(p.colHeaders)?x=p.colHeaders(Z):p.colHeaders&&typeof p.colHeaders!="string"&&typeof p.colHeaders!="number"&&(x=pye(b)),x=a.runHooks("modifyColumnHeaderValue",x,g,m),x},this._getColWidthFromSettings=function(g){var m;if(g>=0){var b=a.getCellMeta(0,g);m=b.width}if((m===void 0||m===p.width)&&(m=p.colWidths),m!=null){switch(pr(m)){case"object":m=m[g];break;case"function":m=m(g);break}typeof m=="string"&&(m=parseInt(m,10))}return m},this.getColWidth=function(g){var m=a._getColWidthFromSettings(g);return m=a.runHooks("modifyColWidth",m,g),m===void 0&&(m=BE.DEFAULT_WIDTH),m},this._getRowHeightFromSettings=function(g){var m=p.rowHeights;if(m!=null){switch(pr(m)){case"object":m=m[g];break;case"function":m=m(g);break}typeof m=="string"&&(m=parseInt(m,10))}return m},this.getRowHeight=function(g){var m=a._getRowHeightFromSettings(g);return m=a.runHooks("modifyRowHeight",m,g),m},this.countSourceRows=function(){return u.countRows()},this.countSourceCols=function(){return u.countFirstRowKeys()},this.countRows=function(){return s.getLength()},this.countCols=function(){var g=p.maxCols,m=this.columnIndexMapper.getNotTrimmedIndexesLength();return Math.min(g,m)},this.countRenderedRows=function(){return a.view._wt.drawn?a.view._wt.wtTable.getRenderedRowsCount():-1},this.countVisibleRows=function(){return a.view._wt.drawn?a.view._wt.wtTable.getVisibleRowsCount():-1},this.countRenderedCols=function(){return a.view._wt.drawn?a.view._wt.wtTable.getRenderedColumnsCount():-1},this.countVisibleCols=function(){return a.view._wt.drawn?a.view._wt.wtTable.getVisibleColumnsCount():-1},this.countEmptyRows=function(){var g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,m=0;return CC(a.countRows()-1,function(b){if(a.isEmptyRow(b))m+=1;else if(g===!0)return!1}),m},this.countEmptyCols=function(){var g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,m=0;return CC(a.countCols()-1,function(b){if(a.isEmptyCol(b))m+=1;else if(g===!0)return!1}),m},this.isEmptyRow=function(g){return p.isEmptyRow.call(a,g)},this.isEmptyCol=function(g){return p.isEmptyCol.call(a,g)},this.selectCell=function(g,m,b,E){var O=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,F=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;return gt(g)||gt(m)?!1:this.selectCells([[g,m,b,E]],O,F)},this.selectCells=function(){var g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[[]],m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,b=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;m===!1&&(i=!0);var E=R.selectCells(g);return E&&b&&a.listen(),i=!1,E},this.selectColumns=function(g){var m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:g;return R.selectColumns(g,m)},this.selectRows=function(g){var m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:g;return R.selectRows(g,m)},this.deselectCell=function(){R.deselect()},this.selectAll=function(){var g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,m=g&&this.hasRowHeaders(),b=g&&this.hasColHeaders();i=!0,R.selectAll(m,b),i=!1};var de=function(m,b){return m.getNearestNotHiddenIndex(b,1,!0)};this.scrollViewportTo=function(g,m){var b=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,E=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,O=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,F=!b,x=!E,K=g,Z=m;if(O){var te=Number.isInteger(g),ie=Number.isInteger(m),se=te?de(this.rowIndexMapper,g):void 0,Se=ie?de(this.columnIndexMapper,m):void 0;if(se===null||Se===null)return!1;K=te?a.rowIndexMapper.getRenderableFromVisualIndex(se):void 0,Z=ie?a.columnIndexMapper.getRenderableFromVisualIndex(Se):void 0}var we=Number.isInteger(K),U=Number.isInteger(Z);return we&&U?a.view.scrollViewport(a._createCellCoords(K,Z),F,E,b,x):we&&U===!1?a.view.scrollViewportVertically(K,F,b):U&&we===!1?a.view.scrollViewportHorizontally(Z,E,x):!1},this.destroy=function(){if(a._clearTimeouts(),a._clearImmediates(),a.view&&a.view.destroy(),u&&u.destroy(),u=null,this.getShortcutManager().destroy(),y.clearCache(),KC(a)){var g=this.rootDocument.querySelector(".hot-display-license-info");g&&g.parentNode.removeChild(g)}xn(a.rootElement),l.destroy(),c&&c.destroy(),a.batchExecution(function(){a.rowIndexMapper.unregisterAll(),a.columnIndexMapper.unregisterAll(),S.getItems().forEach(function(m){var b=pn(m,2),E=b[1];E.destroy()}),S.clear(),a.runHooks("afterDestroy")},!0),ge.getSingleton().destroy(a),Ke(a,function(m,b,E){vt(m)?E[b]=Oe(b):b!=="guid"&&(E[b]=null)}),a.isDestroyed=!0,s&&s.destroy(),s=null,f=null,R=null,c=null,a=null};function Oe(g){return function(){throw new Error('The "'.concat(g,'" method cannot be called because this Handsontable instance has been destroyed'))}}this.getActiveEditor=function(){return c.getActiveEditor()},this.getPlugin=function(g){var m=un(g);return m==="UndoRedo"?this.undoRedo:S.getItem(m)},this.getPluginName=function(g){return g===this.undoRedo?this.undoRedo.constructor.PLUGIN_KEY:S.getId(g)},this.getInstance=function(){return a},this.addHook=function(g,m){ge.getSingleton().add(g,m,a)},this.hasHook=function(g){return ge.getSingleton().has(g,a)||ge.getSingleton().has(g)},this.addHookOnce=function(g,m){ge.getSingleton().once(g,m,a)},this.removeHook=function(g,m){ge.getSingleton().remove(g,m,a)},this.runHooks=function(g,m,b,E,O,F,x){return ge.getSingleton().run(a,g,m,b,E,O,F,x)},this.getTranslatedPhrase=function(g,m){return CW(p.language,g,m)},this.toHTML=function(){return jA(n)},this.toTableElement=function(){var g=n.rootDocument.createElement("div");return g.insertAdjacentHTML("afterbegin",jA(n)),g.firstElementChild},this.timeouts=[],this._registerTimeout=function(g){var m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,b=g;typeof b=="function"&&(b=setTimeout(b,m)),this.timeouts.push(b)},this._clearTimeouts=function(){I(this.timeouts,function(g){clearTimeout(g)})},this.immediates=[],this._registerImmediate=function(g){this.immediates.push(setImmediate(g))},this._clearImmediates=function(){I(this.immediates,function(g){clearImmediate(g)})},this._refreshBorders=function(){var g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;c.destroyEditor(g),a.view.render(),m&&R.isSelected()&&c.prepareEditor()},this.isRtl=function(){return a.rootWindow.getComputedStyle(a.rootElement).direction==="rtl"},this.isLtr=function(){return!a.isRtl()},this.getDirectionFactor=function(){return a.isLtr()?1:-1};var be=NSe({handleEvent:function(m){var b=a.isListening(),E=(m==null?void 0:m.key)!==void 0;return b&&E},beforeKeyDown:function(m){return n.runHooks("beforeKeyDown",m)},afterKeyDown:function(m){n.isDestroyed||a.runHooks("afterDocumentKeyDown",m)},ownerWindow:this.rootWindow});this.addHook("beforeOnCellMouseDown",function(g){g.ctrlKey===!1&&g.metaKey===!1&&be.releasePressedKeys()}),this.getShortcutManager=function(){return be};var $=be.addContext("grid"),k={runOnlyIf:function(){return ye(a.getSelected())&&a.countRenderedRows()>0&&a.countRenderedCols()>0},group:WSe};be.setActiveContextName("grid"),$.addShortcuts([{keys:[["Control/Meta","A"]],callback:function(){a.selectAll()}},{keys:[["Control/Meta","Enter"]],callback:function(){for(var m=a.getSelectedRange(),b=m[m.length-1].highlight,E=b.row,O=b.col,F=a.getDataAtCell(E,O),x=new Map,K=0;K<m.length;K++)m[K].forAll(function(Z,te){if(Z>=0&&te>=0&&(Z!==E||te!==O)){var ie=a.getCellMeta(Z,te),se=ie.readOnly;se||x.set("".concat(Z,"x").concat(te),[Z,te,F])}});a.setDataAtCell(Array.from(x.values()))},runOnlyIf:function(){return a.getSelectedRangeLast().getCellsCount()>1}},{keys:[["ArrowUp"]],callback:function(){R.transformStart(-1,0)}},{keys:[["ArrowUp","Control/Meta"]],captureCtrl:!0,callback:function(){R.setRangeStart(a._createCellCoords(a.rowIndexMapper.getNearestNotHiddenIndex(0,1),a.getSelectedRangeLast().highlight.col))}},{keys:[["ArrowUp","Shift"]],callback:function(){R.transformEnd(-1,0)}},{keys:[["ArrowUp","Shift","Control/Meta"]],captureCtrl:!0,callback:function(){var m=a.getSelectedRangeLast(),b=m.from,E=m.to,O=a.rowIndexMapper.getNearestNotHiddenIndex(0,1);R.setRangeStart(b.clone()),R.setRangeEnd(a._createCellCoords(O,E.col))},runOnlyIf:function(){return!(a.selection.isSelectedByCorner()||a.selection.isSelectedByColumnHeader())}},{keys:[["ArrowDown"]],callback:function(){R.transformStart(1,0)}},{keys:[["ArrowDown","Control/Meta"]],captureCtrl:!0,callback:function(){R.setRangeStart(a._createCellCoords(a.rowIndexMapper.getNearestNotHiddenIndex(a.countRows()-1,-1),a.getSelectedRangeLast().highlight.col))}},{keys:[["ArrowDown","Shift"]],callback:function(){R.transformEnd(1,0)}},{keys:[["ArrowDown","Shift","Control/Meta"]],captureCtrl:!0,callback:function(){var m=a.getSelectedRangeLast(),b=m.from,E=m.to,O=a.rowIndexMapper.getNearestNotHiddenIndex(a.countRows()-1,-1);R.setRangeStart(b.clone()),R.setRangeEnd(a._createCellCoords(O,E.col))},runOnlyIf:function(){return!(a.selection.isSelectedByCorner()||a.selection.isSelectedByColumnHeader())}},{keys:[["ArrowLeft"]],callback:function(){R.transformStart(0,-1*a.getDirectionFactor())}},{keys:[["ArrowLeft","Control/Meta"]],captureCtrl:!0,callback:function(){var m,b=a.getSelectedRangeLast().highlight.row,E=(m=a.columnIndexMapper).getNearestNotHiddenIndex.apply(m,fl(a.isRtl()?[a.countCols()-1,-1]:[0,1]));R.setRangeStart(a._createCellCoords(b,E))}},{keys:[["ArrowLeft","Shift"]],callback:function(){R.transformEnd(0,-1*a.getDirectionFactor())}},{keys:[["ArrowLeft","Shift","Control/Meta"]],captureCtrl:!0,callback:function(){var m,b=a.getSelectedRangeLast(),E=b.from,O=b.to,F=(m=a.columnIndexMapper).getNearestNotHiddenIndex.apply(m,fl(a.isRtl()?[a.countCols()-1,-1]:[0,1]));R.setRangeStart(E.clone()),R.setRangeEnd(a._createCellCoords(O.row,F))},runOnlyIf:function(){return!(a.selection.isSelectedByCorner()||a.selection.isSelectedByRowHeader())}},{keys:[["ArrowRight"]],callback:function(){R.transformStart(0,a.getDirectionFactor())}},{keys:[["ArrowRight","Control/Meta"]],captureCtrl:!0,callback:function(){var m,b=a.getSelectedRangeLast().highlight.row,E=(m=a.columnIndexMapper).getNearestNotHiddenIndex.apply(m,fl(a.isRtl()?[0,1]:[a.countCols()-1,-1]));R.setRangeStart(a._createCellCoords(b,E))}},{keys:[["ArrowRight","Shift"]],callback:function(){R.transformEnd(0,a.getDirectionFactor())}},{keys:[["ArrowRight","Shift","Control/Meta"]],captureCtrl:!0,callback:function(){var m,b=a.getSelectedRangeLast(),E=b.from,O=b.to,F=(m=a.columnIndexMapper).getNearestNotHiddenIndex.apply(m,fl(a.isRtl()?[0,1]:[a.countCols()-1,-1]));R.setRangeStart(E.clone()),R.setRangeEnd(a._createCellCoords(O.row,F))},runOnlyIf:function(){return!(a.selection.isSelectedByCorner()||a.selection.isSelectedByRowHeader())}},{keys:[["Home"]],captureCtrl:!0,callback:function(){var m=parseInt(a.getSettings().fixedColumnsStart,10),b=a.getSelectedRangeLast().highlight.row,E=a.columnIndexMapper.getNearestNotHiddenIndex(m,1);R.setRangeStart(a._createCellCoords(b,E))},runOnlyIf:function(){return a.view.isMainTableNotFullyCoveredByOverlays()}},{keys:[["Home","Shift"]],callback:function(){R.setRangeEnd(a._createCellCoords(R.selectedRange.current().from.row,a.columnIndexMapper.getNearestNotHiddenIndex(0,1)))}},{keys:[["Home","Control/Meta"]],captureCtrl:!0,callback:function(){var m=parseInt(a.getSettings().fixedRowsTop,10),b=parseInt(a.getSettings().fixedColumnsStart,10),E=a.rowIndexMapper.getNearestNotHiddenIndex(m,1),O=a.columnIndexMapper.getNearestNotHiddenIndex(b,1);R.setRangeStart(a._createCellCoords(E,O))},runOnlyIf:function(){return a.view.isMainTableNotFullyCoveredByOverlays()}},{keys:[["End"]],captureCtrl:!0,callback:function(){R.setRangeStart(a._createCellCoords(a.getSelectedRangeLast().highlight.row,a.columnIndexMapper.getNearestNotHiddenIndex(a.countCols()-1,-1)))},runOnlyIf:function(){return a.view.isMainTableNotFullyCoveredByOverlays()}},{keys:[["End","Shift"]],callback:function(){R.setRangeEnd(a._createCellCoords(R.selectedRange.current().from.row,a.columnIndexMapper.getNearestNotHiddenIndex(a.countCols()-1,-1)))}},{keys:[["End","Control/Meta"]],captureCtrl:!0,callback:function(){var m=parseInt(a.getSettings().fixedRowsBottom,10),b=a.rowIndexMapper.getNearestNotHiddenIndex(a.countRows()-m-1,-1),E=a.columnIndexMapper.getNearestNotHiddenIndex(a.countCols()-1,-1);R.setRangeStart(a._createCellCoords(b,E))},runOnlyIf:function(){return a.view.isMainTableNotFullyCoveredByOverlays()}},{keys:[["PageUp"]],callback:function(){R.transformStart(-a.countVisibleRows(),0)}},{keys:[["PageUp","Shift"]],callback:function(){var m=a.getSelectedRangeLast(),b=m.to,E=Math.max(b.row-a.countVisibleRows(),0),O=a.rowIndexMapper.getNearestNotHiddenIndex(E,1);if(O!==null){var F=a._createCellCoords(O,b.col),x=b.row-a.view.getFirstFullyVisibleRow(),K=Math.max(F.row-x,0);R.setRangeEnd(F),a.scrollViewportTo(K)}}},{keys:[["PageDown"]],callback:function(){R.transformStart(a.countVisibleRows(),0)}},{keys:[["PageDown","Shift"]],callback:function(){var m=a.getSelectedRangeLast(),b=m.to,E=Math.min(b.row+a.countVisibleRows(),a.countRows()-1),O=a.rowIndexMapper.getNearestNotHiddenIndex(E,-1);if(O!==null){var F=a._createCellCoords(O,b.col),x=b.row-a.view.getFirstFullyVisibleRow(),K=Math.min(F.row-x,a.countRows()-1);R.setRangeEnd(F),a.scrollViewportTo(K)}}},{keys:[["Tab"]],callback:function(m){var b=typeof p.tabMoves=="function"?p.tabMoves(m):p.tabMoves;R.transformStart(b.row,b.col,!0)}},{keys:[["Shift","Tab"]],callback:function(m){var b=typeof p.tabMoves=="function"?p.tabMoves(m):p.tabMoves;R.transformStart(-b.row,-b.col)}}],k),lV().forEach(function(g){var m=FE(g);S.addItem(g,new m(n))}),ge.getSingleton().run(a,"construct")}var USe="hooksRefRegisterer",BW={_hooksStorage:Object.create(null),addHook:function(t,r){return this._hooksStorage[t]||(this._hooksStorage[t]=[]),this.hot.addHook(t,r),this._hooksStorage[t].push(r),this},removeHooksByKey:function(t){var r=this;I(this._hooksStorage[t]||[],function(n){r.hot.removeHook(t,n)})},clearHooks:function(){var t=this;Ke(this._hooksStorage,function(r,n){return t.removeHooksByKey(n)}),this._hooksStorage={}}};Lo(BW,"MIXIN_NAME",USe,{writable:!1,enumerable:!1});const zSe=BW;function xs(e){"@babel/helpers - typeof";return xs=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},xs(e)}function YSe(e,t){return XSe(e)||qSe(e,t)||KSe(e,t)||GSe()}function GSe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function KSe(e,t){if(e){if(typeof e=="string")return gM(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return gM(e,t)}}function gM(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function qSe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function XSe(e){if(Array.isArray(e))return e}function ZSe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&b_(e,t)}function b_(e,t){return b_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},b_(e,t)}function QSe(e){var t=tCe();return function(){var n=dm(e),o;if(t){var i=dm(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return JSe(this,o)}}function JSe(e,t){if(t&&(xs(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return eCe(e)}function eCe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function tCe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function dm(e){return dm=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},dm(e)}function mM(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function pM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,rCe(n.key),n)}}function bM(e,t,r){return t&&pM(e.prototype,t),r&&pM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function rCe(e){var t=nCe(e,"string");return xs(t)==="symbol"?t:String(t)}function nCe(e,t){if(xs(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(xs(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var oCe="base",Kt=Object.freeze({VIRGIN:"STATE_VIRGIN",EDITING:"STATE_EDITING",WAITING:"STATE_WAITING",FINISHED:"STATE_FINISHED"}),w_="baseEditor",pf=function(){function e(t){mM(this,e),this.hot=t,this.instance=t,this.state=Kt.VIRGIN,this._opened=!1,this._fullEditMode=!1,this._closeCallback=null,this.TD=null,this.row=null,this.col=null,this.prop=null,this.originalValue=null,this.cellProperties=null,this.init()}return bM(e,[{key:"_fireCallbacks",value:function(r){this._closeCallback&&(this._closeCallback(r),this._closeCallback=null)}},{key:"init",value:function(){}},{key:"getValue",value:function(){throw Error("Editor getValue() method unimplemented")}},{key:"setValue",value:function(){throw Error("Editor setValue() method unimplemented")}},{key:"open",value:function(){throw Error("Editor open() method unimplemented")}},{key:"close",value:function(){throw Error("Editor close() method unimplemented")}},{key:"prepare",value:function(r,n,o,i,a,l){this.TD=i,this.row=r,this.col=n,this.prop=o,this.originalValue=a,this.cellProperties=l,this.state=Kt.VIRGIN}},{key:"extend",value:function(){return function(r){ZSe(o,r);var n=QSe(o);function o(){return mM(this,o),n.apply(this,arguments)}return bM(o)}(this.constructor)}},{key:"saveValue",value:function(r,n){var o=this,i,a,l,s;if(n){var u=this.hot.getSelectedLast();i=Math.max(Math.min(u[0],u[2]),0),a=Math.max(Math.min(u[1],u[3]),0),l=Math.max(u[0],u[2]),s=Math.max(u[1],u[3])}else{var f=[this.row,this.col,null,null];i=f[0],a=f[1],l=f[2],s=f[3]}var c=this.hot.runHooks("modifyGetCellCoords",i,a);if(Array.isArray(c)){var h=YSe(c,2);i=h[0],a=h[1]}var d=this.hot.getShortcutManager(),v=d.getContext("editor"),y={runOnlyIf:function(){return ye(o.hot.getSelected())},group:w_};this.isInFullEditMode()&&v.addShortcuts([{keys:[["ArrowUp"]],callback:function(){o.hot.selection.transformStart(-1,0)}},{keys:[["ArrowDown"]],callback:function(){o.hot.selection.transformStart(1,0)}},{keys:[["ArrowLeft"]],callback:function(){o.hot.selection.transformStart(0,-1*o.hot.getDirectionFactor())}},{keys:[["ArrowRight"]],callback:function(){o.hot.selection.transformStart(0,o.hot.getDirectionFactor())}}],y),this.hot.populateFromArray(i,a,r,l,s,"edit")}},{key:"beginEditing",value:function(r,n){if(this.state===Kt.VIRGIN){var o=this.hot,i=o.rowIndexMapper.getRenderableFromVisualIndex(this.row),a=o.columnIndexMapper.getRenderableFromVisualIndex(this.col);if(o.view.scrollViewport(o._createCellCoords(i,a)),this.state=Kt.EDITING,this.isInFullEditMode()){var l=typeof r=="string"?r:Ht(this.originalValue);this.setValue(l)}this.open(n),this._opened=!0,this.focus(),o.view.render(),o.runHooks("afterBeginEditing",this.row,this.col)}}},{key:"finishEditing",value:function(r,n,o){var i=this,a;if(o){var l=this._closeCallback;this._closeCallback=function(c){l&&l(c),o(c),i.hot.view.render()}}if(!this.isWaiting()){var s=this.hot.getShortcutManager(),u=s.getContext("editor");if(u.removeShortcutsByGroup(w_),u.removeShortcutsByGroup(yp),this.state===Kt.VIRGIN){this.hot._registerTimeout(function(){i._fireCallbacks(!0)});return}if(this.state===Kt.EDITING){if(r){this.cancelChanges(),this.hot.view.render();return}var f=this.getValue();this.cellProperties.trimWhitespace?a=[[typeof f=="string"?String.prototype.trim.call(f||""):f]]:a=[[f]],this.state=Kt.WAITING,this.saveValue(a,n),this.hot.getCellValidator(this.cellProperties)?this.hot.addHookOnce("postAfterValidate",function(c){i.state=Kt.FINISHED,i.discardEditor(c)}):(this.state=Kt.FINISHED,this.discardEditor(!0))}}}},{key:"cancelChanges",value:function(){this.state=Kt.FINISHED,this.discardEditor()}},{key:"discardEditor",value:function(r){if(this.state===Kt.FINISHED)if(r===!1&&this.cellProperties.allowInvalid!==!0)this.hot.selectCell(this.row,this.col),this.focus(),this.state=Kt.EDITING,this._fireCallbacks(!1);else{this.close(),this._opened=!1,this._fullEditMode=!1,this.state=Kt.VIRGIN,this._fireCallbacks(!0);var n=this.hot.getShortcutManager();n.setActiveContextName("grid")}}},{key:"enableFullEditMode",value:function(){this._fullEditMode=!0}},{key:"isInFullEditMode",value:function(){return this._fullEditMode}},{key:"isOpened",value:function(){return this._opened}},{key:"isWaiting",value:function(){return this.state===Kt.WAITING}},{key:"getEditedCellRect",value:function(){var r,n=this.getEditedCell();if(n){var o=this.hot.view._wt,i=o.wtOverlays,a=o.wtViewport,l=this.hot.rootWindow,s=Vt(n),u=ut(n),f=Vt(this.hot.rootElement),c=ut(this.hot.rootElement),h=i.topOverlay.holder,d=i.inlineStartOverlay.holder,v=h!==l?h.scrollTop:0,y=d!==l?d.scrollLeft:0,p=l.innerWidth-f.left-c,w=(r=i.getParentOverlay(n))!==null&&r!==void 0?r:this.hot.view._wt,S=w.wtTable,C=S.name,P=["master","inline_start"].includes(C)?v:0,R=["master","top","bottom"].includes(C)?y:0,W=s.top===f.top?0:1,Y=s.top-f.top-W-P,q=0;this.hot.isRtl()?q=l.innerWidth-s.left-u-p-1+R:q=s.left-f.left-1-R,["top","top_inline_start_corner"].includes(C)&&(Y+=i.topOverlay.getOverlayOffset()),["inline_start","top_inline_start_corner"].includes(C)&&(q+=Math.abs(i.inlineStartOverlay.getOverlayOffset()));var G=this.hot.hasColHeaders(),X=this.hot.rowIndexMapper.getRenderableFromVisualIndex(this.row),Q=this.hot.columnIndexMapper.getRenderableFromVisualIndex(this.col),oe=this.hot.rowIndexMapper.getRenderableIndexesLength(),J=oe-this.hot.view._wt.getSetting("fixedRowsBottom");(G&&X<=0||X===J)&&(Y+=1),Q<=0&&(q+=1);var ue=a.rowsRenderCalculator.startPosition,de=a.columnsRenderCalculator.startPosition,Oe=Math.abs(i.inlineStartOverlay.getScrollPosition()),be=i.topOverlay.getScrollPosition(),$=Zt(this.hot.rootDocument),k=n.offsetTop+ue-be,g=0;if(this.hot.isRtl()){var m=n.offsetLeft;m>=0?g=S.getWidth()-n.offsetLeft:g=Math.abs(m),g+=de-Oe-u}else g=n.offsetLeft+de-Oe;var b=Pa(this.TD,this.hot.rootWindow),E=this.hot.isRtl()?"borderRightWidth":"borderLeftWidth",O=parseInt(b[E],10)>0?0:1,F=parseInt(b.borderTopWidth,10)>0?0:1,x=ut(n)+O,K=Tt(n)+F,Z=bie(h)?$:0,te=wie(d)?$:0,ie=this.hot.view.maximumVisibleElementWidth(g)-Z+O,se=Math.max(this.hot.view.maximumVisibleElementHeight(k)-te+F,23);return{top:Y,start:q,height:K,maxHeight:se,width:x,maxWidth:ie}}}},{key:"getEditedCellsLayerClass",value:function(){var r=this.checkEditorSection();switch(r){case"inline-start":return"ht_clone_left ht_clone_inline_start";case"bottom":return"ht_clone_bottom";case"bottom-inline-start-corner":return"ht_clone_bottom_left_corner ht_clone_bottom_inline_start_corner";case"top":return"ht_clone_top";case"top-inline-start-corner":return"ht_clone_top_left_corner ht_clone_top_inline_start_corner";default:return"ht_clone_master"}}},{key:"getEditedCell",value:function(){return this.hot.getCell(this.row,this.col,!0)}},{key:"checkEditorSection",value:function(){var r=this.hot.countRows(),n="";return this.row<this.hot.getSettings().fixedRowsTop?this.col<this.hot.getSettings().fixedColumnsStart?n="top-inline-start-corner":n="top":this.hot.getSettings().fixedRowsBottom&&this.row>=r-this.hot.getSettings().fixedRowsBottom?this.col<this.hot.getSettings().fixedColumnsStart?n="bottom-inline-start-corner":n="bottom":this.col<this.hot.getSettings().fixedColumnsStart&&(n="inline-start"),n}}],[{key:"EDITOR_TYPE",get:function(){return oCe}}]),e}();dt(pf,zSe);function iCe(){var e={minHeight:200,maxHeight:300,minWidth:100,maxWidth:300},t,r=document.body,n=document.createTextNode(""),o=document.createElement("SPAN"),i=function(d,v,y){d.addEventListener(v,y,!1)},a=function(d,v,y){d.removeEventListener(v,y,!1)},l=function(d){var v,y;d?/^[a-zA-Z \.,\\\/\|0-9]$/.test(d)||(d="."):d="",n.textContent!==void 0?n.textContent=t.value+d:n.data=t.value+d,o.style.position="absolute",o.style.fontSize=c(t).fontSize,o.style.fontFamily=c(t).fontFamily,o.style.whiteSpace="pre",r.appendChild(o),v=o.clientWidth+2,r.removeChild(o),t.style.height=e.minHeight+"px",e.minWidth>v?t.style.width=e.minWidth+"px":v>e.maxWidth?t.style.width=e.maxWidth+"px":t.style.width=v+"px",y=t.scrollHeight?t.scrollHeight-1:0,e.minHeight>y?t.style.height=e.minHeight+"px":e.maxHeight<y?(t.style.height=e.maxHeight+"px",t.style.overflowY="visible"):t.style.height=y+"px"},s=function(){window.setTimeout(l,0)},u=function(d){if(d&&d.minHeight)if(d.minHeight=="inherit")e.minHeight=t.clientHeight;else{var v=parseInt(d.minHeight);isNaN(v)||(e.minHeight=v)}if(d&&d.maxHeight)if(d.maxHeight=="inherit")e.maxHeight=t.clientHeight;else{var y=parseInt(d.maxHeight);isNaN(y)||(e.maxHeight=y)}if(d&&d.minWidth)if(d.minWidth=="inherit")e.minWidth=t.clientWidth;else{var p=parseInt(d.minWidth);isNaN(p)||(e.minWidth=p)}if(d&&d.maxWidth)if(d.maxWidth=="inherit")e.maxWidth=t.clientWidth;else{var w=parseInt(d.maxWidth);isNaN(w)||(e.maxWidth=w)}o.firstChild||(o.className="autoResize",o.style.display="inline-block",o.appendChild(n))},f=function(d,v,y){t=d,u(v),t.nodeName=="TEXTAREA"&&(t.style.resize="none",t.style.overflowY="",t.style.height=e.minHeight+"px",t.style.minWidth=e.minWidth+"px",t.style.maxWidth=e.maxWidth+"px",t.style.overflowY="hidden"),y&&(i(t,"change",l),i(t,"cut",s),i(t,"paste",s),i(t,"drop",s),i(t,"keydown",s),i(t,"focus",l),i(t,"compositionstart",s),i(t,"compositionupdate",s),i(t,"compositionend",s)),l()};function c(h){return h.currentStyle||document.defaultView.getComputedStyle(h)}return{init:function(d,v,y){f(d,v,y)},unObserve:function(){a(t,"change",l),a(t,"cut",s),a(t,"paste",s),a(t,"drop",s),a(t,"keydown",s),a(t,"focus",l),a(t,"compositionstart",s),a(t,"compositionupdate",s),a(t,"compositionend",s)},resize:l}}function wM(e,t){for(var r=MB(t),n=t.value.split(`
`),o=r,i=0,a=0;a<n.length;a++){var l=n[a];a!==0&&(i+=n[a-1].length+1);var s=i+l.length;if(e==="home"?o=i:e==="end"&&(o=s),r<=s)break}dp(t,o)}function Ds(e){"@babel/helpers - typeof";return Ds=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ds(e)}function SM(e,t){return uCe(e)||sCe(e,t)||lCe(e,t)||aCe()}function aCe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function lCe(e,t){if(e){if(typeof e=="string")return CM(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return CM(e,t)}}function CM(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function sCe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function uCe(e){if(Array.isArray(e))return e}function fCe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _M(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,hCe(n.key),n)}}function cCe(e,t,r){return t&&_M(e.prototype,t),r&&_M(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function hCe(e){var t=dCe(e,"string");return Ds(t)==="symbol"?t:String(t)}function dCe(e,t){if(Ds(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ds(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function yc(){return typeof Reflect<"u"&&Reflect.get?yc=Reflect.get.bind():yc=function(t,r,n){var o=vCe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},yc.apply(this,arguments)}function vCe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Na(e),e!==null););return e}function yCe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&S_(e,t)}function S_(e,t){return S_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},S_(e,t)}function gCe(e){var t=pCe();return function(){var n=Na(e),o;if(t){var i=Na(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return mCe(this,o)}}function mCe(e,t){if(t&&(Ds(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return VW(e)}function VW(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function pCe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Na(e){return Na=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Na(e)}var bCe="ht_editor_visible",Zv="ht_editor_hidden",OM="textEditor",wCe="text",Za=function(e){yCe(r,e);var t=gCe(r);function r(n){var o;return fCe(this,r),o=t.call(this,n),o.eventManager=new Pt(VW(o)),o.autoResize=iCe(),o.TEXTAREA=void 0,o.textareaStyle=void 0,o.TEXTAREA_PARENT=void 0,o.textareaParentStyle=void 0,o.layerClass=void 0,o.createElements(),o.bindEvents(),o.hot.addHookOnce("afterDestroy",function(){return o.destroy()}),o}return cCe(r,[{key:"getValue",value:function(){return this.TEXTAREA.value}},{key:"setValue",value:function(o){this.TEXTAREA.value=o}},{key:"open",value:function(){var o=this;this.refreshDimensions(),this.showEditableElement();var i=this.hot.getShortcutManager();i.setActiveContextName("editor"),this.addHook("afterDocumentKeyDown",function(a){return o.onAfterDocumentKeyDown(a)}),this.registerShortcuts()}},{key:"close",value:function(){this.autoResize.unObserve(),this.hot.rootDocument.activeElement===this.TEXTAREA&&this.hot.listen(),this.hideEditableElement(),this.unregisterShortcuts(),this.removeHooksByKey("afterDocumentKeyDown")}},{key:"prepare",value:function(o,i,a,l,s,u){var f=this.state;if(yc(Na(r.prototype),"prepare",this).call(this,o,i,a,l,s,u),!u.readOnly){this.refreshDimensions(!0);var c=u.allowInvalid,h=u.fragmentSelection;c&&(this.TEXTAREA.value=""),f!==Kt.FINISHED&&this.hideEditableElement();var d=!h;d&&!An()&&this.focus()}}},{key:"beginEditing",value:function(o,i){this.state===Kt.VIRGIN&&(this.TEXTAREA.value="",yc(Na(r.prototype),"beginEditing",this).call(this,o,i))}},{key:"focus",value:function(){this.TEXTAREA.select(),dp(this.TEXTAREA,this.TEXTAREA.value.length)}},{key:"createElements",value:function(){var o=this.hot.rootDocument;this.TEXTAREA=o.createElement("TEXTAREA"),this.TEXTAREA.setAttribute("data-hot-input",""),this.TEXTAREA.tabIndex=-1,re(this.TEXTAREA,"handsontableInput"),this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.textareaStyle.overflowY="visible",this.TEXTAREA_PARENT=o.createElement("DIV"),re(this.TEXTAREA_PARENT,"handsontableInputHolder"),xe(this.TEXTAREA_PARENT,this.layerClass)&&He(this.TEXTAREA_PARENT,this.layerClass),re(this.TEXTAREA_PARENT,Zv),this.textareaParentStyle=this.TEXTAREA_PARENT.style,this.TEXTAREA_PARENT.appendChild(this.TEXTAREA),this.hot.rootElement.appendChild(this.TEXTAREA_PARENT)}},{key:"hideEditableElement",value:function(){(tee()||eee())&&(this.textareaStyle.textIndent="-99999px"),this.textareaStyle.overflowY="visible",this.textareaParentStyle.opacity="0",this.textareaParentStyle.height="1px",He(this.TEXTAREA_PARENT,this.layerClass),re(this.TEXTAREA_PARENT,Zv)}},{key:"showEditableElement",value:function(){this.textareaParentStyle.height="",this.textareaParentStyle.overflow="",this.textareaParentStyle.position="",this.textareaParentStyle[this.hot.isRtl()?"left":"right"]="auto",this.textareaParentStyle.opacity="1",this.textareaStyle.textIndent="",this.textareaStyle.overflowY="hidden";var o=this.TEXTAREA_PARENT.childNodes,i=!1;_e(o.length-1,function(a){var l=o[a];if(xe(l,"handsontableEditor"))return i=!0,!1}),xe(this.TEXTAREA_PARENT,Zv)&&He(this.TEXTAREA_PARENT,Zv),i?(this.layerClass=bCe,re(this.TEXTAREA_PARENT,this.layerClass)):(this.layerClass=this.getEditedCellsLayerClass(),re(this.TEXTAREA_PARENT,this.layerClass))}},{key:"refreshValue",value:function(){var o=this.hot.toPhysicalRow(this.row),i=this.hot.getSourceDataAtCell(o,this.col);this.originalValue=i,this.setValue(i),this.refreshDimensions()}},{key:"refreshDimensions",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(!(this.state!==Kt.EDITING&&!o)){if(this.TD=this.getEditedCell(),!this.TD){o||this.close();return}var i=this.getEditedCellRect(),a=i.top,l=i.start,s=i.width,u=i.maxWidth,f=i.height,c=i.maxHeight;this.textareaParentStyle.top="".concat(a,"px"),this.textareaParentStyle[this.hot.isRtl()?"right":"left"]="".concat(l,"px"),this.showEditableElement();var h=Pa(this.TD,this.hot.rootWindow);this.TEXTAREA.style.fontSize=h.fontSize,this.TEXTAREA.style.fontFamily=h.fontFamily,this.TEXTAREA.style.backgroundColor=this.TD.style.backgroundColor;var d=Pa(this.TEXTAREA),v=parseInt(d.paddingLeft,10)+parseInt(d.paddingRight,10),y=parseInt(d.paddingTop,10)+parseInt(d.paddingBottom,10),p=s-v,w=f-y,S=u-v,C=c-y;this.autoResize.init(this.TEXTAREA,{minWidth:Math.min(p,S),minHeight:Math.min(w,C),maxWidth:S,maxHeight:C},!0)}}},{key:"bindEvents",value:function(){var o=this;this.eventManager.addEventListener(this.TEXTAREA,"cut",function(i){return i.stopPropagation()}),this.eventManager.addEventListener(this.TEXTAREA,"paste",function(i){return i.stopPropagation()}),MF()&&this.eventManager.addEventListener(this.TEXTAREA,"focusout",function(){return o.finishEditing(!1)}),this.addHook("afterScrollHorizontally",function(){return o.refreshDimensions()}),this.addHook("afterScrollVertically",function(){return o.refreshDimensions()}),this.addHook("afterColumnResize",function(){o.refreshDimensions(),o.focus()}),this.addHook("afterRowResize",function(){o.refreshDimensions(),o.focus()})}},{key:"allowKeyEventPropagation",value:function(){}},{key:"destroy",value:function(){this.eventManager.destroy(),this.clearHooks()}},{key:"registerShortcuts",value:function(){var o=this,i=this.hot.getShortcutManager(),a=i.getContext("editor"),l={runOnlyIf:function(){return ye(o.hot.getSelected())},group:OM},s=function(){o.hot.rootDocument.execCommand("insertText",!1,`
`)};a.addShortcuts([{keys:[["Tab"]],callback:function(f){var c=o.hot.getSettings(),h=typeof c.tabMoves=="function"?c.tabMoves(f):c.tabMoves;o.hot.selection.transformStart(h.row,h.col,!0)}},{keys:[["Shift","Tab"]],callback:function(f){var c=o.hot.getSettings(),h=typeof c.tabMoves=="function"?c.tabMoves(f):c.tabMoves;o.hot.selection.transformStart(-h.row,-h.col)}},{keys:[["Control","Enter"]],callback:function(){return s(),!1},runOnlyIf:function(f){return!o.hot.selection.isMultiple()&&!f.altKey},relativeToGroup:cc,position:"before"},{keys:[["Meta","Enter"]],callback:function(){return s(),!1},runOnlyIf:function(){return!o.hot.selection.isMultiple()},relativeToGroup:cc,position:"before"},{keys:[["Alt","Enter"]],callback:function(){return s(),!1},relativeToGroup:cc,position:"before"},{keys:[["PageUp"]],callback:function(){o.hot.selection.transformStart(-o.hot.countVisibleRows(),0)}},{keys:[["PageDown"]],callback:function(){o.hot.selection.transformStart(o.hot.countVisibleRows(),0)}},{keys:[["Home"]],callback:function(f,c){var h=SM(c,1),d=h[0];wM(d,o.TEXTAREA)}},{keys:[["End"]],callback:function(f,c){var h=SM(c,1),d=h[0];wM(d,o.TEXTAREA)}},{keys:[["Control/Meta","Z"]],preventDefault:!1,callback:function(){o.hot._registerTimeout(function(){o.autoResize.resize()},10)}},{keys:[["Control/Meta","Shift","Z"]],preventDefault:!1,callback:function(){o.hot._registerTimeout(function(){o.autoResize.resize()},10)}}],l)}},{key:"unregisterShortcuts",value:function(){var o=this.hot.getShortcutManager(),i=o.getContext("editor");i.removeShortcutsByGroup(yp),i.removeShortcutsByGroup(OM),i.removeShortcutsByGroup(w_)}},{key:"onAfterDocumentKeyDown",value:function(o){var i=[Ce.ARROW_UP,Ce.ARROW_RIGHT,Ce.ARROW_DOWN,Ce.ARROW_LEFT];i.indexOf(o.keyCode)===-1&&this.autoResize.resize(String.fromCharCode(o.keyCode))}}],[{key:"EDITOR_TYPE",get:function(){return wCe}}]),r}(pf),SCe="base";function hv(e,t,r,n,o,i,a){var l=[],s=[];a.className&&re(t,a.className),a.readOnly&&l.push(a.readOnlyCellClassName),a.valid===!1&&a.invalidCellClassName?l.push(a.invalidCellClassName):s.push(a.invalidCellClassName),a.wordWrap===!1&&a.noWordWrapClassName&&l.push(a.noWordWrapClassName),!i&&a.placeholder&&l.push(a.placeholderCellClassName),He(t,s),re(t,l)}hv.RENDERER_TYPE=SCe;var CCe="text";function Ei(e,t,r,n,o,i,a){hv.apply(this,[e,t,r,n,o,i,a]);var l=i;if(!l&&a.placeholder&&(l=a.placeholder),l=Ht(l),a.trimWhitespace&&(l=l.trim()),a.rendererTemplate){xn(t);var s=e.rootDocument.createElement("TEMPLATE");s.setAttribute("bind","{{}}"),s.innerHTML=a.rendererTemplate,HTMLTemplateElement.decorate(s),s.model=e.getSourceDataAtRow(r),t.appendChild(s)}else ka(t,l)}Ei.RENDERER_TYPE=CCe;var _Ce="text",WW={CELL_TYPE:_Ce,editor:Za,renderer:Ei};Rn(WW);Hr.editors={BaseEditor:pf};function Hr(e,t){var r=new PT(e,t||{},JE);return r.init(),r}Hr.Core=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new PT(e,t,JE)};Hr.DefaultSettings=xW();Hr.hooks=ge.getSingleton();Hr.CellCoords=Dg;Hr.CellRange=VE;Hr.packageName="handsontable";Hr.buildDate="22/06/2023 12:51:08";Hr.version="13.0.0";Hr.languages={dictionaryKeys:Ume,getLanguageDictionary:SW,getLanguagesDictionaries:Qme,registerLanguageDictionary:wW,getTranslatedPhrase:CW};var Wl=Symbol("unassigned"),OCe="The Handsontable instance bound to this component was destroyed and cannot be used properly.";function vm(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function UW(e){var t=Hr.hooks.getRegistered(),r={};Object.assign(r,Hr.DefaultSettings);for(var n in r)r[n]={default:Wl};for(var o=0;o<t.length;o++)r[t[o]]={default:Wl};return r.settings={default:Wl},e==="HotTable"&&(r.id={type:String,default:"hot-".concat(Math.random().toString(36).substring(5))}),r}function zW(e){var t={},r=e.settings;if(r!==Wl)for(var n in r)vm(r,n)&&r[n]!==Wl&&(t[n]=r[n]);for(var o in e)vm(e,o)&&o!=="settings"&&e[o]!==Wl&&(t[o]=e[o]);return t}function RM(e,t){var r=zW(e),n=e.settings?e.settings:r,o=e.settings?r:null,i={};for(var a in n)vm(n,a)&&n[a]!==void 0&&(!(t&&a!=="data")||!EM(t[a],n[a]))&&(i[a]=n[a]);for(var l in o)vm(o,l)&&l!=="id"&&l!=="settings"&&o[l]!==void 0&&(!(t&&l!=="data")||!EM(t[l],o[l]))&&(i[l]=o[l]);return i}function EM(e,t){return JSON.stringify(e)===JSON.stringify(t)}var RCe="13.0.0",YW=cL({name:"HotTable",props:UW("HotTable"),provide:function(){return{columnsCache:this.columnsCache}},watch:{$props:{handler:function(t){var r=RM(t,this.hotInstance?this.hotInstance.getSettings():void 0);!this.hotInstance||r===void 0||(r.data&&(this.hotInstance.isColumnModificationAllowed()||!this.hotInstance.isColumnModificationAllowed()&&this.hotInstance.countSourceCols()===this.miscCache.currentSourceColumns)&&(this.matchHotMappersSize(),delete r.data),Object.keys(r).length?this.hotInstance.updateSettings(r):this.hotInstance.render(),this.miscCache.currentSourceColumns=this.hotInstance.countSourceCols())},deep:!0,immediate:!0}},data:function(){return{__hotInstance:null,miscCache:{currentSourceColumns:null},columnSettings:null,columnsCache:new Map,get hotInstance(){return!this.__hotInstance||this.__hotInstance&&!this.__hotInstance.isDestroyed?this.__hotInstance:(console.warn(OCe),null)},set hotInstance(t){this.__hotInstance=t}}},methods:{hotInit:function(){var t=RM(this.$props);t.columns=this.columnSettings?this.columnSettings:t.columns,this.hotInstance=pz(new Hr.Core(this.$el,t)),this.hotInstance.init(),this.miscCache.currentSourceColumns=this.hotInstance.countSourceCols()},matchHotMappersSize:function(){var t=this;if(this.hotInstance){var r=this.hotInstance.getSourceData(),n=[],o=[],i=this.hotInstance.rowIndexMapper.getNumberOfIndexes(),a=this.hotInstance.isColumnModificationAllowed(),l=0;if(r&&r.length!==i&&r.length<i)for(var s=r.length;s<i;s++)n.push(s);if(a){var u;if(l=this.hotInstance.columnIndexMapper.getNumberOfIndexes(),r&&r[0]&&((u=r[0])===null||u===void 0?void 0:u.length)!==l&&r[0].length<l)for(var f=r[0].length;f<l;f++)o.push(f)}this.hotInstance.batch(function(){n.length>0?t.hotInstance.rowIndexMapper.removeIndexes(n):t.hotInstance.rowIndexMapper.insertIndexes(i-1,r.length-i),a&&r.length!==0&&(o.length>0?t.hotInstance.columnIndexMapper.removeIndexes(o):t.hotInstance.columnIndexMapper.insertIndexes(l-1,r[0].length-l))})}},getColumnSettings:function(){var t=Array.from(this.columnsCache.values());return t.length?t:void 0}},mounted:function(){this.columnSettings=this.getColumnSettings(),this.hotInit()},beforeUnmount:function(){this.hotInstance&&this.hotInstance.destroy()},version:RCe}),ECe=["id"];function TCe(e,t,r,n,o,i){return bz(),wz("div",{id:e.id},[Sz(e.$slots,"default")],8,ECe)}YW.render=TCe;YW.__file="src/HotTable.vue";function TM(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function kCe(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?TM(Object(r),!0).forEach(function(n){PCe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):TM(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function PCe(e,t,r){return t=ACe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function $Ce(e,t){if(typeof e!="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ACe(e){var t=$Ce(e,"string");return typeof t=="symbol"?t:String(t)}var ICe=cL({name:"HotColumn",props:UW("HotColumn"),inject:["columnsCache"],methods:{createColumnSettings:function(){var t=zW(this.$props),r=kCe({},t);t.renderer&&(r.renderer=t.renderer),t.editor&&(r.editor=t.editor),this.columnsCache.set(this,r)}},mounted:function(){this.createColumnSettings()},unmounted:function(){this.columnsCache.delete(this)},render:function(){return null}});ICe.__file="src/HotColumn.vue";function Ns(e){"@babel/helpers - typeof";return Ns=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ns(e)}function MCe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function kM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,DCe(n.key),n)}}function xCe(e,t,r){return t&&kM(e.prototype,t),r&&kM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function DCe(e){var t=NCe(e,"string");return Ns(t)==="symbol"?t:String(t)}function NCe(e,t){if(Ns(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ns(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function nn(){return typeof Reflect<"u"&&Reflect.get?nn=Reflect.get.bind():nn=function(t,r,n){var o=HCe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},nn.apply(this,arguments)}function HCe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=xr(e),e!==null););return e}function LCe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&C_(e,t)}function C_(e,t){return C_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},C_(e,t)}function jCe(e){var t=VCe();return function(){var n=xr(e),o;if(t){var i=xr(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return FCe(this,o)}}function FCe(e,t){if(t&&(Ns(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return BCe(e)}function BCe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function VCe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function xr(e){return xr=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},xr(e)}var PM="handsontableEditor",WCe="handsontable",$T=function(e){LCe(r,e);var t=jCe(r);function r(){return MCe(this,r),t.apply(this,arguments)}return xCe(r,[{key:"open",value:function(){nn(xr(r.prototype),"open",this).call(this),this.htEditor&&this.htEditor.destroy(),this.htContainer.style.display==="none"&&(this.htContainer.style.display=""),this.htEditor=new this.hot.constructor(this.htContainer,this.htOptions),this.htEditor.init(),this.htEditor.rootElement.style.display="",this.cellProperties.strict?this.htEditor.selectCell(0,0):this.htEditor.deselectCell(),dp(this.TEXTAREA,0,this.TEXTAREA.value.length),this.refreshDimensions()}},{key:"close",value:function(){this.htEditor&&(this.htEditor.rootElement.style.display="none"),this.removeHooksByKey("beforeKeyDown"),nn(xr(r.prototype),"close",this).call(this)}},{key:"prepare",value:function(o,i,a,l,s,u){nn(xr(r.prototype),"prepare",this).call(this,o,i,a,l,s,u);var f=this,c={startRows:0,startCols:0,minRows:0,minCols:0,className:"listbox",copyPaste:!1,autoColumnSize:!1,autoRowSize:!1,readOnly:!0,fillHandle:!1,autoWrapCol:!1,autoWrapRow:!1,afterOnCellMouseDown:function(d,v){var y=this.getSourceData(v.row,v.col);y!==void 0&&f.setValue(y),f.instance.destroyEditor()},preventWheel:!0,layoutDirection:this.hot.isRtl()?"rtl":"ltr"};this.cellProperties.handsontable&&Wt(c,u.handsontable),this.htOptions=c}},{key:"beginEditing",value:function(o,i){var a=this.hot.getSettings().onBeginEditing;a&&a()===!1||nn(xr(r.prototype),"beginEditing",this).call(this,o,i)}},{key:"createElements",value:function(){nn(xr(r.prototype),"createElements",this).call(this);var o=this.hot.rootDocument.createElement("DIV");o.className="handsontableEditor",this.TEXTAREA_PARENT.appendChild(o),this.htContainer=o,this.assignHooks()}},{key:"finishEditing",value:function(o,i,a){if(this.htEditor&&this.htEditor.isListening()&&this.hot.listen(),this.htEditor&&this.htEditor.getSelectedLast()){var l=this.htEditor.getInstance().getValue();l!==void 0&&this.setValue(l)}nn(xr(r.prototype),"finishEditing",this).call(this,o,i,a)}},{key:"assignHooks",value:function(){var o=this;this.hot.addHook("afterDestroy",function(){o.htEditor&&o.htEditor.destroy()})}},{key:"registerShortcuts",value:function(){var o=this,i=this.hot.getShortcutManager(),a=i.getContext("editor");nn(xr(r.prototype),"registerShortcuts",this).call(this);var l={group:PM,relativeToGroup:yp,position:"before"},s=function(f,c){var h=o.htEditor.getInstance();if(f!==void 0&&(f<0||h.flipped&&f>h.countRows()-1?h.deselectCell():h.selectCell(f,0),h.getData().length))return c.preventDefault(),Dn(c),o.hot.listen(),o.TEXTAREA.focus(),!1};a.addShortcuts([{keys:[["ArrowUp"]],callback:function(f){var c=o.htEditor.getInstance(),h,d;return!c.getSelectedLast()&&c.flipped?h=c.countRows()-1:c.getSelectedLast()&&(c.flipped?(d=c.getSelectedLast()[0],h=Math.max(0,d-1)):(d=c.getSelectedLast()[0],h=d-1)),s(h,f)},preventDefault:!1},{keys:[["ArrowDown"]],callback:function(f){var c=o.htEditor.getInstance(),h,d;if(!c.getSelectedLast()&&!c.flipped)h=0;else if(c.getSelectedLast()){if(c.flipped)h=c.getSelectedLast()[0]+1;else if(!c.flipped){var v=c.countRows()-1;d=c.getSelectedLast()[0],h=Math.min(v,d+1)}}return s(h,f)},preventDefault:!1}],l)}},{key:"unregisterShortcuts",value:function(){nn(xr(r.prototype),"unregisterShortcuts",this).call(this);var o=this.hot.getShortcutManager(),i=o.getContext("editor");i.removeShortcutsByGroup(PM)}}],[{key:"EDITOR_TYPE",get:function(){return WCe}}]),r}(Za);function Hs(e){"@babel/helpers - typeof";return Hs=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Hs(e)}function UCe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function $M(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,GW(n.key),n)}}function zCe(e,t,r){return t&&$M(e.prototype,t),r&&$M(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Xi(){return typeof Reflect<"u"&&Reflect.get?Xi=Reflect.get.bind():Xi=function(t,r,n){var o=YCe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Xi.apply(this,arguments)}function YCe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=io(e),e!==null););return e}function GCe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&__(e,t)}function __(e,t){return __=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},__(e,t)}function KCe(e){var t=XCe();return function(){var n=io(e),o;if(t){var i=io(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return qCe(this,o)}}function qCe(e,t){if(t&&(Hs(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return O_(e)}function O_(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function XCe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function io(e){return io=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},io(e)}function ZCe(e,t,r){return t=GW(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function GW(e){var t=QCe(e,"string");return Hs(t)==="symbol"?t:String(t)}function QCe(e,t){if(Hs(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Hs(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var pw=new WeakMap,JCe="autocomplete",AT=function(e){GCe(r,e);var t=KCe(r);function r(n){var o;return UCe(this,r),o=t.call(this,n),ZCe(O_(o),"sortByRelevance",function(i,a,l){var s=[],u=[],f=i.length,c=a.length,h,d,v,y;if(f===0){for(v=0;v<c;v++)u.push(v);return u}for(v=0;v<c;v++){if(d=yA(Ht(a[v])),l)y=d.indexOf(i);else{var p=this.cellProperties.locale;y=d.toLocaleLowerCase(p).indexOf(i.toLocaleLowerCase(p))}y!==-1&&(h=d.length-y-f,s.push({baseIndex:v,index:y,charsLeft:h,value:d}))}for(s.sort(function(w,S){if(S.index===-1)return-1;if(w.index===-1)return 1;if(w.index<S.index)return-1;if(S.index<w.index)return 1;if(w.index===S.index){if(w.charsLeft<S.charsLeft)return-1;if(w.charsLeft>S.charsLeft)return 1}return 0}),v=0,c=s.length;v<c;v++)u.push(s[v].baseIndex);return u}),o.query=null,o.strippedChoices=[],o.rawChoices=[],pw.set(O_(o),{skipOne:!1,isMacOS:o.hot.rootWindow.navigator.platform.indexOf("Mac")>-1}),o}return zCe(r,[{key:"getValue",value:function(){var o=this,i=this.rawChoices.find(function(a){var l=o.stripValueIfNeeded(a);return l===o.TEXTAREA.value});return ye(i)?i:this.TEXTAREA.value}},{key:"createElements",value:function(){Xi(io(r.prototype),"createElements",this).call(this),re(this.htContainer,"autocompleteEditor"),re(this.htContainer,this.hot.rootWindow.navigator.platform.indexOf("Mac")===-1?"":"htMacScroll")}},{key:"open",value:function(){var o=this,i=pw.get(this);Xi(io(r.prototype),"open",this).call(this);var a=this.htEditor.getInstance(),l=this.cellProperties.trimDropdown===void 0?!0:this.cellProperties.trimDropdown;this.showEditableElement(),this.focus();var s=Zt();s===0&&i.isMacOS&&(s+=15),this.addHook("beforeKeyDown",function(u){return o.onBeforeKeyDown(u)}),a.updateSettings({colWidths:l?[ut(this.TEXTAREA)-2]:void 0,width:l?ut(this.TEXTAREA)+s:void 0,renderer:function(f,c,h,d,v,y,p){Ei(f,c,h,d,v,y,p);var w=o.cellProperties,S=w.filteringCaseSensitive,C=w.allowHtml,P=w.locale,R=o.query,W=Ht(y),Y,q;W&&!C&&(Y=S===!0?W.indexOf(R):W.toLocaleLowerCase(P).indexOf(R.toLocaleLowerCase(P)),Y!==-1&&(q=W.substr(Y,R.length),W=W.replace(q,"<strong>".concat(q,"</strong>")))),c.innerHTML=W},autoColumnSize:!0}),i.skipOne&&(i.skipOne=!1),this.hot._registerTimeout(function(){o.queryChoices(o.TEXTAREA.value)})}},{key:"close",value:function(){this.removeHooksByKey("beforeKeyDown"),Xi(io(r.prototype),"close",this).call(this)}},{key:"discardEditor",value:function(o){Xi(io(r.prototype),"discardEditor",this).call(this,o),this.hot.view.render()}},{key:"queryChoices",value:function(o){var i=this,a=this.cellProperties.source;this.query=o,typeof a=="function"?a.call(this.cellProperties,o,function(l){i.rawChoices=l,i.updateChoicesList(i.stripValuesIfNeeded(l))}):Array.isArray(a)?(this.rawChoices=a,this.updateChoicesList(this.stripValuesIfNeeded(a))):this.updateChoicesList([])}},{key:"updateChoicesList",value:function(o){var i=MB(this.TEXTAREA),a=gie(this.TEXTAREA),l=this.cellProperties.sortByRelevance,s=this.cellProperties.filter,u=null,f=null,c=o;l&&(u=this.sortByRelevance(this.stripValueIfNeeded(this.getValue()),c,this.cellProperties.filteringCaseSensitive));var h=Array.isArray(u)?u.length:0;if(s===!1)h&&(f=u[0]);else{for(var d=[],v=0,y=c.length;v<y&&!(l&&h<=v);v++)h?d.push(c[u[v]]):d.push(c[v]);f=0,c=d}this.strippedChoices=c,this.htEditor.loadData(Dy([c])),this.updateDropdownHeight(),this.flipDropdownIfNeeded(),this.cellProperties.strict===!0&&this.highlightBestMatchingChoice(f),this.hot.listen(),dp(this.TEXTAREA,i,i===a?void 0:a)}},{key:"flipDropdownIfNeeded",value:function(){var o=ns(this.hot.view._wt.wtTable.TABLE),i=o===this.hot.rootWindow,a=this.cellProperties.preventOverflow;if(i||!i&&(a||a==="horizontal"))return!1;var l=Vt(this.TEXTAREA),s=Tt(this.TEXTAREA),u=this.getDropdownHeight(),f=o.scrollTop,c=Tt(this.hot.view._wt.wtTable.THEAD),h=Vt(o),d=l.top-h.top-c+f,v=o.scrollHeight-d-c-s,y=u>v&&d>v;return y?this.flipDropdown(u):this.unflipDropdown(),this.limitDropdownIfNeeded(y?d:v,u),y}},{key:"limitDropdownIfNeeded",value:function(o,i){if(i>o){var a=0,l=0,s=0,u=null;do s=this.htEditor.getRowHeight(l)||this.htEditor.view._wt.getSetting("defaultRowHeight"),a+=s,l+=1;while(a<o);u=a-s,this.htEditor.flipped&&(this.htEditor.rootElement.style.top="".concat(parseInt(this.htEditor.rootElement.style.top,10)+i-u,"px")),this.setDropdownHeight(a-s)}}},{key:"flipDropdown",value:function(o){var i=this.htEditor.rootElement.style;i.position="absolute",i.top="".concat(-o,"px"),this.htEditor.flipped=!0}},{key:"unflipDropdown",value:function(){var o=this.htEditor.rootElement.style;o.position="absolute",o.top="",this.htEditor.flipped=void 0}},{key:"updateDropdownHeight",value:function(){var o=this.htEditor.getColWidth(0)+Zt(this.hot.rootDocument)+2,i=this.cellProperties.trimDropdown;this.htEditor.updateSettings({height:this.getDropdownHeight(),width:i?void 0:o}),this.htEditor.view._wt.wtTable.alignOverlaysWithTrimmingContainer()}},{key:"setDropdownHeight",value:function(o){this.htEditor.updateSettings({height:o})}},{key:"highlightBestMatchingChoice",value:function(o){typeof o=="number"?this.htEditor.selectCell(o,0,void 0,void 0,void 0,!1):this.htEditor.deselectCell()}},{key:"getDropdownHeight",value:function(){var o=this.htEditor.getInstance().getRowHeight(0)||23,i=this.cellProperties.visibleRows;return this.strippedChoices.length>=i?i*o:this.strippedChoices.length*o+8}},{key:"stripValueIfNeeded",value:function(o){return this.stripValuesIfNeeded([o])[0]}},{key:"stripValuesIfNeeded",value:function(o){var i=this.cellProperties.allowHtml,a=Ye(o,function(s){return Ht(s)}),l=Ye(a,function(s){return i?s:yA(s)});return l}},{key:"allowKeyEventPropagation",value:function(o){var i=this.htEditor.getSelectedRangeLast(),a={row:i?i.from.row:-1},l=!1;return o===Ce.ARROW_DOWN&&a.row>0&&a.row<this.htEditor.countRows()-1&&(l=!0),o===Ce.ARROW_UP&&a.row>-1&&(l=!0),l}},{key:"onBeforeKeyDown",value:function(o){var i=this,a=pw.get(this);if(a.skipOne=!1,Yie(o.keyCode)||o.keyCode===Ce.BACKSPACE||o.keyCode===Ce.DELETE||o.keyCode===Ce.INSERT){var l=10;if(o.keyCode===Ce.C&&(o.ctrlKey||o.metaKey))return;this.isOpened()||(l+=10),this.htEditor&&this.hot._registerTimeout(function(){i.queryChoices(i.TEXTAREA.value),a.skipOne=!0},l)}}}],[{key:"EDITOR_TYPE",get:function(){return JCe}}]),r}($T);function Ls(e){"@babel/helpers - typeof";return Ls=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ls(e)}function e_e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function AM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,r_e(n.key),n)}}function t_e(e,t,r){return t&&AM(e.prototype,t),r&&AM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function r_e(e){var t=n_e(e,"string");return Ls(t)==="symbol"?t:String(t)}function n_e(e,t){if(Ls(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ls(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function o_e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&R_(e,t)}function R_(e,t){return R_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},R_(e,t)}function i_e(e){var t=s_e();return function(){var n=ym(e),o;if(t){var i=ym(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return a_e(this,o)}}function a_e(e,t){if(t&&(Ls(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return l_e(e)}function l_e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function s_e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function ym(e){return ym=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},ym(e)}var u_e="checkbox",KW=function(e){o_e(r,e);var t=i_e(r);function r(){return e_e(this,r),t.apply(this,arguments)}return t_e(r,[{key:"beginEditing",value:function(o,i){if(i&&i.type==="mouseup"){var a=this.TD.querySelector('input[type="checkbox"]');xe(a,"htBadValue")||a.click()}}},{key:"finishEditing",value:function(){}},{key:"init",value:function(){}},{key:"open",value:function(){}},{key:"close",value:function(){}},{key:"getValue",value:function(){}},{key:"setValue",value:function(){}},{key:"focus",value:function(){}}],[{key:"EDITOR_TYPE",get:function(){return u_e}}]),r}(pf),qW={exports:{}};const f_e=Cz(rie);/*!
 * Pikaday
 *
 * Copyright Â© 2014 David Bushell | BSD & MIT license | https://github.com/Pikaday/Pikaday
 */(function(e,t){(function(r,n){var o;{try{o=f_e}catch{}e.exports=n(o)}})(Py,function(r){var n=typeof r=="function",o=!!window.addEventListener,i=window.document,a=window.setTimeout,l=function($,k,g,m){o?$.addEventListener(k,g,!!m):$.attachEvent("on"+k,g)},s=function($,k,g,m){o?$.removeEventListener(k,g,!!m):$.detachEvent("on"+k,g)},u=function($){return $.trim?$.trim():$.replace(/^\s+|\s+$/g,"")},f=function($,k){return(" "+$.className+" ").indexOf(" "+k+" ")!==-1},c=function($,k){f($,k)||($.className=$.className===""?k:$.className+" "+k)},h=function($,k){$.className=u((" "+$.className+" ").replace(" "+k+" "," "))},d=function($){return/Array/.test(Object.prototype.toString.call($))},v=function($){return/Date/.test(Object.prototype.toString.call($))&&!isNaN($.getTime())},y=function($){var k=$.getDay();return k===0||k===6},p=function($){return $%4===0&&$%100!==0||$%400===0},w=function($,k){return[31,p($)?29:28,31,30,31,30,31,31,30,31,30,31][k]},S=function($){v($)&&$.setHours(0,0,0,0)},C=function($,k){return $.getTime()===k.getTime()},P=function($,k,g){var m,b;for(m in k)b=$[m]!==void 0,b&&typeof k[m]=="object"&&k[m]!==null&&k[m].nodeName===void 0?v(k[m])?g&&($[m]=new Date(k[m].getTime())):d(k[m])?g&&($[m]=k[m].slice(0)):$[m]=P({},k[m],g):(g||!b)&&($[m]=k[m]);return $},R=function($,k,g){var m;i.createEvent?(m=i.createEvent("HTMLEvents"),m.initEvent(k,!0,!1),m=P(m,g),$.dispatchEvent(m)):i.createEventObject&&(m=i.createEventObject(),m=P(m,g),$.fireEvent("on"+k,m))},W=function($){return $.month<0&&($.year-=Math.ceil(Math.abs($.month)/12),$.month+=12),$.month>11&&($.year+=Math.floor(Math.abs($.month)/12),$.month-=12),$},Y={field:null,bound:void 0,ariaLabel:"Use the arrow keys to pick a date",position:"bottom left",reposition:!0,format:"YYYY-MM-DD",toString:null,parse:null,defaultDate:null,setDefaultDate:!1,firstDay:0,firstWeekOfYearMinDays:4,formatStrict:!1,minDate:null,maxDate:null,yearRange:10,showWeekNumber:!1,pickWholeWeek:!1,minYear:0,maxYear:9999,minMonth:void 0,maxMonth:void 0,startRange:null,endRange:null,isRTL:!1,yearSuffix:"",showMonthAfterYear:!1,showDaysInNextAndPreviousMonths:!1,enableSelectionDaysInNextAndPreviousMonths:!1,numberOfMonths:1,mainCalendar:"left",container:void 0,blurFieldOnSelect:!0,i18n:{previousMonth:"Previous Month",nextMonth:"Next Month",months:["January","February","March","April","May","June","July","August","September","October","November","December"],weekdays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],weekdaysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},theme:null,events:[],onSelect:null,onOpen:null,onClose:null,onDraw:null,keyboardInput:!0},q=function($,k,g){for(k+=$.firstDay;k>=7;)k-=7;return g?$.i18n.weekdaysShort[k]:$.i18n.weekdays[k]},G=function($){var k=[],g="false";if($.isEmpty)if($.showDaysInNextAndPreviousMonths)k.push("is-outside-current-month"),$.enableSelectionDaysInNextAndPreviousMonths||k.push("is-selection-disabled");else return'<td class="is-empty"></td>';return $.isDisabled&&k.push("is-disabled"),$.isToday&&k.push("is-today"),$.isSelected&&(k.push("is-selected"),g="true"),$.hasEvent&&k.push("has-event"),$.isInRange&&k.push("is-inrange"),$.isStartRange&&k.push("is-startrange"),$.isEndRange&&k.push("is-endrange"),'<td data-day="'+$.day+'" class="'+k.join(" ")+'" aria-selected="'+g+'"><button class="pika-button pika-day" type="button" data-pika-year="'+$.year+'" data-pika-month="'+$.month+'" data-pika-day="'+$.day+'">'+$.day+"</button></td>"},X=function($,k){$.setHours(0,0,0,0);var g=$.getDate(),m=$.getDay(),b=k,E=b-1,O=7,F=function(ie){return(ie+O-1)%O};$.setDate(g+E-F(m));var x=new Date($.getFullYear(),0,b),K=24*60*60*1e3,Z=($.getTime()-x.getTime())/K,te=1+Math.round((Z-E+F(x.getDay()))/O);return te},Q=function($,k,g,m){var b=new Date(g,k,$),E=n?r(b).isoWeek():X(b,m);return'<td class="pika-week">'+E+"</td>"},oe=function($,k,g,m){return'<tr class="pika-row'+(g?" pick-whole-week":"")+(m?" is-selected":"")+'">'+(k?$.reverse():$).join("")+"</tr>"},J=function($){return"<tbody>"+$.join("")+"</tbody>"},ue=function($){var k,g=[];for($.showWeekNumber&&g.push("<th></th>"),k=0;k<7;k++)g.push('<th scope="col"><abbr title="'+q($,k)+'">'+q($,k,!0)+"</abbr></th>");return"<thead><tr>"+($.isRTL?g.reverse():g).join("")+"</tr></thead>"},de=function($,k,g,m,b,E){var O,F,x,K=$._o,Z=g===K.minYear,te=g===K.maxYear,ie='<div id="'+E+'" class="pika-title" role="heading" aria-live="assertive">',se,Se,we=!0,U=!0;for(x=[],O=0;O<12;O++)x.push('<option value="'+(g===b?O-k:12+O-k)+'"'+(O===m?' selected="selected"':"")+(Z&&O<K.minMonth||te&&O>K.maxMonth?' disabled="disabled"':"")+">"+K.i18n.months[O]+"</option>");for(se='<div class="pika-label">'+K.i18n.months[m]+'<select class="pika-select pika-select-month" tabindex="-1">'+x.join("")+"</select></div>",d(K.yearRange)?(O=K.yearRange[0],F=K.yearRange[1]+1):(O=g-K.yearRange,F=1+g+K.yearRange),x=[];O<F&&O<=K.maxYear;O++)O>=K.minYear&&x.push('<option value="'+O+'"'+(O===g?' selected="selected"':"")+">"+O+"</option>");return Se='<div class="pika-label">'+g+K.yearSuffix+'<select class="pika-select pika-select-year" tabindex="-1">'+x.join("")+"</select></div>",K.showMonthAfterYear?ie+=Se+se:ie+=se+Se,Z&&(m===0||K.minMonth>=m)&&(we=!1),te&&(m===11||K.maxMonth<=m)&&(U=!1),k===0&&(ie+='<button class="pika-prev'+(we?"":" is-disabled")+'" type="button">'+K.i18n.previousMonth+"</button>"),k===$._o.numberOfMonths-1&&(ie+='<button class="pika-next'+(U?"":" is-disabled")+'" type="button">'+K.i18n.nextMonth+"</button>"),ie+="</div>"},Oe=function($,k,g){return'<table cellpadding="0" cellspacing="0" class="pika-table" role="grid" aria-labelledby="'+g+'">'+ue($)+J(k)+"</table>"},be=function($){var k=this,g=k.config($);k._onMouseDown=function(b){if(k._v){b=b||window.event;var E=b.target||b.srcElement;if(E)if(f(E,"is-disabled")||(f(E,"pika-button")&&!f(E,"is-empty")&&!f(E.parentNode,"is-disabled")?(k.setDate(new Date(E.getAttribute("data-pika-year"),E.getAttribute("data-pika-month"),E.getAttribute("data-pika-day"))),g.bound&&a(function(){k.hide(),g.blurFieldOnSelect&&g.field&&g.field.blur()},100)):f(E,"pika-prev")?k.prevMonth():f(E,"pika-next")&&k.nextMonth()),f(E,"pika-select"))k._c=!0;else if(b.preventDefault)b.preventDefault();else return b.returnValue=!1,!1}},k._onChange=function(b){b=b||window.event;var E=b.target||b.srcElement;E&&(f(E,"pika-select-month")?k.gotoMonth(E.value):f(E,"pika-select-year")&&k.gotoYear(E.value))},k._onKeyChange=function(b){if(b=b||window.event,k.isVisible())switch(b.keyCode){case 13:case 27:g.field&&g.field.blur();break;case 37:k.adjustDate("subtract",1);break;case 38:k.adjustDate("subtract",7);break;case 39:k.adjustDate("add",1);break;case 40:k.adjustDate("add",7);break;case 8:case 46:k.setDate(null);break}},k._parseFieldValue=function(){if(g.parse)return g.parse(g.field.value,g.format);if(n){var b=r(g.field.value,g.format,g.formatStrict);return b&&b.isValid()?b.toDate():null}else return new Date(Date.parse(g.field.value))},k._onInputChange=function(b){var E;b.firedBy!==k&&(E=k._parseFieldValue(),v(E)&&k.setDate(E),k._v||k.show())},k._onInputFocus=function(){k.show()},k._onInputClick=function(){k.show()},k._onInputBlur=function(){var b=i.activeElement;do if(f(b,"pika-single"))return;while(b=b.parentNode);k._c||(k._b=a(function(){k.hide()},50)),k._c=!1},k._onClick=function(b){b=b||window.event;var E=b.target||b.srcElement,O=E;if(E){!o&&f(E,"pika-select")&&(E.onchange||(E.setAttribute("onchange","return;"),l(E,"change",k._onChange)));do if(f(O,"pika-single")||O===g.trigger)return;while(O=O.parentNode);k._v&&E!==g.trigger&&O!==g.trigger&&k.hide()}},k.el=i.createElement("div"),k.el.className="pika-single"+(g.isRTL?" is-rtl":"")+(g.theme?" "+g.theme:""),l(k.el,"mousedown",k._onMouseDown,!0),l(k.el,"touchend",k._onMouseDown,!0),l(k.el,"change",k._onChange),g.keyboardInput&&l(i,"keydown",k._onKeyChange),g.field&&(g.container?g.container.appendChild(k.el):g.bound?i.body.appendChild(k.el):g.field.parentNode.insertBefore(k.el,g.field.nextSibling),l(g.field,"change",k._onInputChange),g.defaultDate||(g.defaultDate=k._parseFieldValue(),g.setDefaultDate=!0));var m=g.defaultDate;v(m)?g.setDefaultDate?k.setDate(m,!0):k.gotoDate(m):k.gotoDate(new Date),g.bound?(this.hide(),k.el.className+=" is-bound",l(g.trigger,"click",k._onInputClick),l(g.trigger,"focus",k._onInputFocus),l(g.trigger,"blur",k._onInputBlur)):this.show()};return be.prototype={config:function($){this._o||(this._o=P({},Y,!0));var k=P(this._o,$,!0);k.isRTL=!!k.isRTL,k.field=k.field&&k.field.nodeName?k.field:null,k.theme=typeof k.theme=="string"&&k.theme?k.theme:null,k.bound=!!(k.bound!==void 0?k.field&&k.bound:k.field),k.trigger=k.trigger&&k.trigger.nodeName?k.trigger:k.field,k.disableWeekends=!!k.disableWeekends,k.disableDayFn=typeof k.disableDayFn=="function"?k.disableDayFn:null;var g=parseInt(k.numberOfMonths,10)||1;if(k.numberOfMonths=g>4?4:g,v(k.minDate)||(k.minDate=!1),v(k.maxDate)||(k.maxDate=!1),k.minDate&&k.maxDate&&k.maxDate<k.minDate&&(k.maxDate=k.minDate=!1),k.minDate&&this.setMinDate(k.minDate),k.maxDate&&this.setMaxDate(k.maxDate),d(k.yearRange)){var m=new Date().getFullYear()-10;k.yearRange[0]=parseInt(k.yearRange[0],10)||m,k.yearRange[1]=parseInt(k.yearRange[1],10)||m}else k.yearRange=Math.abs(parseInt(k.yearRange,10))||Y.yearRange,k.yearRange>100&&(k.yearRange=100);return k},toString:function($){return $=$||this._o.format,v(this._d)?this._o.toString?this._o.toString(this._d,$):n?r(this._d).format($):this._d.toDateString():""},getMoment:function(){return n?r(this._d):null},setMoment:function($,k){n&&r.isMoment($)&&this.setDate($.toDate(),k)},getDate:function(){return v(this._d)?new Date(this._d.getTime()):null},setDate:function($,k){if(!$)return this._d=null,this._o.field&&(this._o.field.value="",R(this._o.field,"change",{firedBy:this})),this.draw();if(typeof $=="string"&&($=new Date(Date.parse($))),!!v($)){var g=this._o.minDate,m=this._o.maxDate;v(g)&&$<g?$=g:v(m)&&$>m&&($=m),this._d=new Date($.getTime()),S(this._d),this.gotoDate(this._d),this._o.field&&(this._o.field.value=this.toString(),R(this._o.field,"change",{firedBy:this})),!k&&typeof this._o.onSelect=="function"&&this._o.onSelect.call(this,this.getDate())}},clear:function(){this.setDate(null)},gotoDate:function($){var k=!0;if(v($)){if(this.calendars){var g=new Date(this.calendars[0].year,this.calendars[0].month,1),m=new Date(this.calendars[this.calendars.length-1].year,this.calendars[this.calendars.length-1].month,1),b=$.getTime();m.setMonth(m.getMonth()+1),m.setDate(m.getDate()-1),k=b<g.getTime()||m.getTime()<b}k&&(this.calendars=[{month:$.getMonth(),year:$.getFullYear()}],this._o.mainCalendar==="right"&&(this.calendars[0].month+=1-this._o.numberOfMonths)),this.adjustCalendars()}},adjustDate:function($,k){var g=this.getDate()||new Date,m=parseInt(k)*24*60*60*1e3,b;$==="add"?b=new Date(g.valueOf()+m):$==="subtract"&&(b=new Date(g.valueOf()-m)),this.setDate(b)},adjustCalendars:function(){this.calendars[0]=W(this.calendars[0]);for(var $=1;$<this._o.numberOfMonths;$++)this.calendars[$]=W({month:this.calendars[0].month+$,year:this.calendars[0].year});this.draw()},gotoToday:function(){this.gotoDate(new Date)},gotoMonth:function($){isNaN($)||(this.calendars[0].month=parseInt($,10),this.adjustCalendars())},nextMonth:function(){this.calendars[0].month++,this.adjustCalendars()},prevMonth:function(){this.calendars[0].month--,this.adjustCalendars()},gotoYear:function($){isNaN($)||(this.calendars[0].year=parseInt($,10),this.adjustCalendars())},setMinDate:function($){$ instanceof Date?(S($),this._o.minDate=$,this._o.minYear=$.getFullYear(),this._o.minMonth=$.getMonth()):(this._o.minDate=Y.minDate,this._o.minYear=Y.minYear,this._o.minMonth=Y.minMonth,this._o.startRange=Y.startRange),this.draw()},setMaxDate:function($){$ instanceof Date?(S($),this._o.maxDate=$,this._o.maxYear=$.getFullYear(),this._o.maxMonth=$.getMonth()):(this._o.maxDate=Y.maxDate,this._o.maxYear=Y.maxYear,this._o.maxMonth=Y.maxMonth,this._o.endRange=Y.endRange),this.draw()},setStartRange:function($){this._o.startRange=$},setEndRange:function($){this._o.endRange=$},draw:function($){if(!(!this._v&&!$)){var k=this._o,g=k.minYear,m=k.maxYear,b=k.minMonth,E=k.maxMonth,O="",F;this._y<=g&&(this._y=g,!isNaN(b)&&this._m<b&&(this._m=b)),this._y>=m&&(this._y=m,!isNaN(E)&&this._m>E&&(this._m=E));for(var x=0;x<k.numberOfMonths;x++)F="pika-title-"+Math.random().toString(36).replace(/[^a-z]+/g,"").substr(0,2),O+='<div class="pika-lendar">'+de(this,x,this.calendars[x].year,this.calendars[x].month,this.calendars[0].year,F)+this.render(this.calendars[x].year,this.calendars[x].month,F)+"</div>";this.el.innerHTML=O,k.bound&&k.field.type!=="hidden"&&a(function(){k.trigger.focus()},1),typeof this._o.onDraw=="function"&&this._o.onDraw(this),k.bound&&k.field.setAttribute("aria-label",k.ariaLabel)}},adjustPosition:function(){var $,k,g,m,b,E,O,F,x,K,Z,te;if(!this._o.container){if(this.el.style.position="absolute",$=this._o.trigger,k=$,g=this.el.offsetWidth,m=this.el.offsetHeight,b=window.innerWidth||i.documentElement.clientWidth,E=window.innerHeight||i.documentElement.clientHeight,O=window.pageYOffset||i.body.scrollTop||i.documentElement.scrollTop,Z=!0,te=!0,typeof $.getBoundingClientRect=="function")K=$.getBoundingClientRect(),F=K.left+window.pageXOffset,x=K.bottom+window.pageYOffset;else for(F=k.offsetLeft,x=k.offsetTop+k.offsetHeight;k=k.offsetParent;)F+=k.offsetLeft,x+=k.offsetTop;(this._o.reposition&&F+g>b||this._o.position.indexOf("right")>-1&&F-g+$.offsetWidth>0)&&(F=F-g+$.offsetWidth,Z=!1),(this._o.reposition&&x+m>E+O||this._o.position.indexOf("top")>-1&&x-m-$.offsetHeight>0)&&(x=x-m-$.offsetHeight,te=!1),this.el.style.left=F+"px",this.el.style.top=x+"px",c(this.el,Z?"left-aligned":"right-aligned"),c(this.el,te?"bottom-aligned":"top-aligned"),h(this.el,Z?"right-aligned":"left-aligned"),h(this.el,te?"top-aligned":"bottom-aligned")}},render:function($,k,g){var m=this._o,b=new Date,E=w($,k),O=new Date($,k,1).getDay(),F=[],x=[];S(b),m.firstDay>0&&(O-=m.firstDay,O<0&&(O+=7));for(var K=k===0?11:k-1,Z=k===11?0:k+1,te=k===0?$-1:$,ie=k===11?$+1:$,se=w(te,K),Se=E+O,we=Se;we>7;)we-=7;Se+=7-we;for(var U=!1,De=0,Fe=0;De<Se;De++){var ke=new Date($,k,1+(De-O)),Ae=v(this._d)?C(ke,this._d):!1,Pe=C(ke,b),_=m.events.indexOf(ke.toDateString())!==-1,T=De<O||De>=E+O,A=1+(De-O),j=k,M=$,B=m.startRange&&C(m.startRange,ke),N=m.endRange&&C(m.endRange,ke),D=m.startRange&&m.endRange&&m.startRange<ke&&ke<m.endRange,V=m.minDate&&ke<m.minDate||m.maxDate&&ke>m.maxDate||m.disableWeekends&&y(ke)||m.disableDayFn&&m.disableDayFn(ke);T&&(De<O?(A=se+A,j=K,M=te):(A=A-E,j=Z,M=ie));var L={day:A,month:j,year:M,hasEvent:_,isSelected:Ae,isToday:Pe,isDisabled:V,isEmpty:T,isStartRange:B,isEndRange:N,isInRange:D,showDaysInNextAndPreviousMonths:m.showDaysInNextAndPreviousMonths,enableSelectionDaysInNextAndPreviousMonths:m.enableSelectionDaysInNextAndPreviousMonths};m.pickWholeWeek&&Ae&&(U=!0),x.push(G(L)),++Fe===7&&(m.showWeekNumber&&x.unshift(Q(De-O,k,$,m.firstWeekOfYearMinDays)),F.push(oe(x,m.isRTL,m.pickWholeWeek,U)),x=[],Fe=0,U=!1)}return Oe(m,F,g)},isVisible:function(){return this._v},show:function(){this.isVisible()||(this._v=!0,this.draw(),h(this.el,"is-hidden"),this._o.bound&&(l(i,"click",this._onClick),this.adjustPosition()),typeof this._o.onOpen=="function"&&this._o.onOpen.call(this))},hide:function(){var $=this._v;$!==!1&&(this._o.bound&&s(i,"click",this._onClick),this._o.container||(this.el.style.position="static",this.el.style.left="auto",this.el.style.top="auto"),c(this.el,"is-hidden"),this._v=!1,$!==void 0&&typeof this._o.onClose=="function"&&this._o.onClose.call(this))},destroy:function(){var $=this._o;this.hide(),s(this.el,"mousedown",this._onMouseDown,!0),s(this.el,"touchend",this._onMouseDown,!0),s(this.el,"change",this._onChange),$.keyboardInput&&s(i,"keydown",this._onKeyChange),$.field&&(s($.field,"change",this._onInputChange),$.bound&&(s($.trigger,"click",this._onInputClick),s($.trigger,"focus",this._onInputFocus),s($.trigger,"blur",this._onInputBlur))),this.el.parentNode&&this.el.parentNode.removeChild(this.el)}},be})})(qW);var c_e=qW.exports;const IM=hL(c_e);function js(e){"@babel/helpers - typeof";return js=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},js(e)}function h_e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function MM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,v_e(n.key),n)}}function d_e(e,t,r){return t&&MM(e.prototype,t),r&&MM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function v_e(e){var t=y_e(e,"string");return js(t)==="symbol"?t:String(t)}function y_e(e,t){if(js(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(js(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ro(){return typeof Reflect<"u"&&Reflect.get?ro=Reflect.get.bind():ro=function(t,r,n){var o=g_e(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},ro.apply(this,arguments)}function g_e(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=ln(e),e!==null););return e}function m_e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&E_(e,t)}function E_(e,t){return E_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},E_(e,t)}function p_e(e){var t=S_e();return function(){var n=ln(e),o;if(t){var i=ln(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return b_e(this,o)}}function b_e(e,t){if(t&&(js(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return w_e(e)}function w_e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function S_e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function ln(e){return ln=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},ln(e)}var XW="date",xM="dateEditor",ZW=function(e){m_e(r,e);var t=p_e(r);function r(n){var o;return h_e(this,r),o=t.call(this,n),o.defaultDateFormat="DD/MM/YYYY",o.isCellEdited=!1,o.parentDestroyed=!1,o.$datePicker=null,o}return d_e(r,[{key:"init",value:function(){var o=this;if(typeof ee!="function")throw new Error("You need to include moment.js to your project.");if(typeof IM!="function")throw new Error("You need to include Pikaday to your project.");ro(ln(r.prototype),"init",this).call(this),this.instance.addHook("afterDestroy",function(){o.parentDestroyed=!0,o.destroyElements()})}},{key:"createElements",value:function(){ro(ln(r.prototype),"createElements",this).call(this),this.datePicker=this.hot.rootDocument.createElement("DIV"),this.datePickerStyle=this.datePicker.style,this.datePickerStyle.position="absolute",this.datePickerStyle.top=0,this.datePickerStyle.left=0,this.datePickerStyle.zIndex=9999,this.datePicker.setAttribute("dir",this.hot.isRtl()?"rtl":"ltr"),re(this.datePicker,"htDatepickerHolder"),this.hot.rootDocument.body.appendChild(this.datePicker);var o=new Pt(this);o.addEventListener(this.datePicker,"mousedown",function(i){return i.stopPropagation()})}},{key:"destroyElements",value:function(){var o=this.datePicker.parentNode;this.$datePicker&&this.$datePicker.destroy(),o&&o.removeChild(this.datePicker)}},{key:"prepare",value:function(o,i,a,l,s,u){ro(ln(r.prototype),"prepare",this).call(this,o,i,a,l,s,u)}},{key:"open",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,i=this.hot.getShortcutManager(),a=i.getContext("editor");ro(ln(r.prototype),"open",this).call(this),this.showDatepicker(o),a.addShortcut({keys:[["Enter"]],callback:function(s){s.stopPropagation()},group:xM})}},{key:"close",value:function(){var o,i=this;this._opened=!1,(o=this.$datePicker)!==null&&o!==void 0&&o.destroy&&this.$datePicker.destroy(),this.instance._registerTimeout(function(){i.instance._refreshBorders()});var a=this.hot.getShortcutManager(),l=a.getContext("editor");l.removeShortcutsByGroup(xM),ro(ln(r.prototype),"close",this).call(this)}},{key:"finishEditing",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(o){var a=this.originalValue;a!==void 0&&this.setValue(a)}ro(ln(r.prototype),"finishEditing",this).call(this,o,i)}},{key:"showDatepicker",value:function(o){var i=this.TD.getBoundingClientRect(),a=this.cellProperties.dateFormat||this.defaultDateFormat,l=this.instance.view.isMouseDown(),s=o?YB(o.keyCode):!1,u;this.datePicker.style.display="block",this.$datePicker=new IM(this.getDatePickerConfig()),this.$datePicker._onInputFocus=function(){},this.datePickerStyle.top="".concat(this.hot.rootWindow.pageYOffset+i.top+Tt(this.TD),"px");var f=this.hot.rootWindow.pageXOffset;this.hot.isRtl()?f=i.right-ut(this.datePicker):f=i.left,this.datePickerStyle.left="".concat(f,"px"),this.originalValue?(u=this.originalValue,ee(u,a,!0).isValid()&&this.$datePicker.setMoment(ee(u,a),!0),this.getValue()!==this.originalValue&&this.setValue(this.originalValue),!s&&!l&&this.setValue("")):this.cellProperties.defaultDate?(u=this.cellProperties.defaultDate,ee(u,a,!0).isValid()&&this.$datePicker.setMoment(ee(u,a),!0),!s&&!l&&this.setValue("")):this.$datePicker.gotoToday()}},{key:"hideDatepicker",value:function(){this.datePickerStyle.display="none",this.$datePicker.hide()}},{key:"getDatePickerConfig",value:function(){var o=this,i=this.TEXTAREA,a={};this.cellProperties&&this.cellProperties.datePickerConfig&&ep(a,this.cellProperties.datePickerConfig);var l=a.onSelect,s=a.onClose;return a.field=i,a.trigger=i,a.container=this.datePicker,a.bound=!1,a.format=a.format||this.defaultDateFormat,a.reposition=a.reposition||!1,a.isRTL=!1,a.onSelect=function(u){var f=u;isNaN(f.getTime())||(f=ee(f).format(o.cellProperties.dateFormat||o.defaultDateFormat)),o.setValue(f),o.hideDatepicker(),l&&l()},a.onClose=function(){o.parentDestroyed||o.finishEditing(!1),s&&s()},a}}],[{key:"EDITOR_TYPE",get:function(){return XW}}]),r}(Za);function Fs(e){"@babel/helpers - typeof";return Fs=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Fs(e)}function C_e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function DM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,O_e(n.key),n)}}function __e(e,t,r){return t&&DM(e.prototype,t),r&&DM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function O_e(e){var t=R_e(e,"string");return Fs(t)==="symbol"?t:String(t)}function R_e(e,t){if(Fs(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Fs(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Jy(){return typeof Reflect<"u"&&Reflect.get?Jy=Reflect.get.bind():Jy=function(t,r,n){var o=E_e(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Jy.apply(this,arguments)}function E_e(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Bs(e),e!==null););return e}function T_e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&T_(e,t)}function T_(e,t){return T_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},T_(e,t)}function k_e(e){var t=A_e();return function(){var n=Bs(e),o;if(t){var i=Bs(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return P_e(this,o)}}function P_e(e,t){if(t&&(Fs(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return $_e(e)}function $_e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function A_e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Bs(e){return Bs=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Bs(e)}var I_e="dropdown",IT=function(e){T_e(r,e);var t=k_e(r);function r(){return C_e(this,r),t.apply(this,arguments)}return __e(r,[{key:"prepare",value:function(o,i,a,l,s,u){Jy(Bs(r.prototype),"prepare",this).call(this,o,i,a,l,s,u),this.cellProperties.filter=!1,this.cellProperties.strict=!0}}],[{key:"EDITOR_TYPE",get:function(){return I_e}}]),r}(AT);ge.getSingleton().add("beforeValidate",function(e,t,r){var n=this.getCellMeta(t,this.propToCol(r));n.editor===IT&&n.strict===void 0&&(n.filter=!1,n.strict=!0)});function Vs(e){"@babel/helpers - typeof";return Vs=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Vs(e)}function M_e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function NM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,D_e(n.key),n)}}function x_e(e,t,r){return t&&NM(e.prototype,t),r&&NM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function D_e(e){var t=N_e(e,"string");return Vs(t)==="symbol"?t:String(t)}function N_e(e,t){if(Vs(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Vs(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function H_e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&k_(e,t)}function k_(e,t){return k_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},k_(e,t)}function L_e(e){var t=B_e();return function(){var n=gm(e),o;if(t){var i=gm(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return j_e(this,o)}}function j_e(e,t){if(t&&(Vs(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return F_e(e)}function F_e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function B_e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function gm(e){return gm=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},gm(e)}var V_e="numeric",QW=function(e){H_e(r,e);var t=L_e(r);function r(){return M_e(this,r),t.apply(this,arguments)}return x_e(r,null,[{key:"EDITOR_TYPE",get:function(){return V_e}}]),r}(Za);function Ws(e){"@babel/helpers - typeof";return Ws=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ws(e)}function W_e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function HM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,z_e(n.key),n)}}function U_e(e,t,r){return t&&HM(e.prototype,t),r&&HM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function z_e(e){var t=Y_e(e,"string");return Ws(t)==="symbol"?t:String(t)}function Y_e(e,t){if(Ws(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ws(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function eg(){return typeof Reflect<"u"&&Reflect.get?eg=Reflect.get.bind():eg=function(t,r,n){var o=G_e(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},eg.apply(this,arguments)}function G_e(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Us(e),e!==null););return e}function K_e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&P_(e,t)}function P_(e,t){return P_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},P_(e,t)}function q_e(e){var t=Q_e();return function(){var n=Us(e),o;if(t){var i=Us(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return X_e(this,o)}}function X_e(e,t){if(t&&(Ws(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Z_e(e)}function Z_e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Q_e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Us(e){return Us=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Us(e)}var J_e="password",JW=function(e){K_e(r,e);var t=q_e(r);function r(){return W_e(this,r),t.apply(this,arguments)}return U_e(r,[{key:"createElements",value:function(){eg(Us(r.prototype),"createElements",this).call(this),this.TEXTAREA=this.hot.rootDocument.createElement("input"),this.TEXTAREA.setAttribute("type","password"),this.TEXTAREA.setAttribute("data-hot-input",""),this.TEXTAREA.className="handsontableInput",this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,xn(this.TEXTAREA_PARENT),this.TEXTAREA_PARENT.appendChild(this.TEXTAREA)}}],[{key:"EDITOR_TYPE",get:function(){return J_e}}]),r}(Za);function Ha(e){"@babel/helpers - typeof";return Ha=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ha(e)}function eOe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function LM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,rOe(n.key),n)}}function tOe(e,t,r){return t&&LM(e.prototype,t),r&&LM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function rOe(e){var t=nOe(e,"string");return Ha(t)==="symbol"?t:String(t)}function nOe(e,t){if(Ha(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ha(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function tg(){return typeof Reflect<"u"&&Reflect.get?tg=Reflect.get.bind():tg=function(t,r,n){var o=oOe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},tg.apply(this,arguments)}function oOe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=zs(e),e!==null););return e}function iOe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&$_(e,t)}function $_(e,t){return $_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},$_(e,t)}function aOe(e){var t=uOe();return function(){var n=zs(e),o;if(t){var i=zs(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return lOe(this,o)}}function lOe(e,t){if(t&&(Ha(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return sOe(e)}function sOe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function uOe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function zs(e){return zs=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},zs(e)}var bw="ht_editor_visible",jM="selectEditor",fOe="select",cOe=function(e){iOe(r,e);var t=aOe(r);function r(){return eOe(this,r),t.apply(this,arguments)}return tOe(r,[{key:"init",value:function(){this.select=this.hot.rootDocument.createElement("SELECT"),re(this.select,"htSelectEditor"),this.select.style.display="none",this.hot.rootElement.appendChild(this.select),this.registerHooks()}},{key:"getValue",value:function(){return this.select.value}},{key:"setValue",value:function(o){this.select.value=o}},{key:"open",value:function(){this._opened=!0,this.refreshDimensions(),this.select.style.display="";var o=this.hot.getShortcutManager();o.setActiveContextName("editor"),this.registerShortcuts()}},{key:"close",value:function(){this._opened=!1,this.select.style.display="none",xe(this.select,bw)&&He(this.select,bw),this.unregisterShortcuts(),this.clearHooks()}},{key:"focus",value:function(){this.select.focus()}},{key:"registerHooks",value:function(){var o=this;this.addHook("afterScrollHorizontally",function(){return o.refreshDimensions()}),this.addHook("afterScrollVertically",function(){return o.refreshDimensions()}),this.addHook("afterColumnResize",function(){return o.refreshDimensions()}),this.addHook("afterRowResize",function(){return o.refreshDimensions()})}},{key:"prepare",value:function(o,i,a,l,s,u){var f=this;tg(zs(r.prototype),"prepare",this).call(this,o,i,a,l,s,u);var c=this.cellProperties.selectOptions,h;typeof c=="function"?h=this.prepareOptions(c(this.row,this.col,this.prop)):h=this.prepareOptions(c),xn(this.select),Ke(h,function(d,v){var y=f.hot.rootDocument.createElement("OPTION");y.value=v,vf(y,d),f.select.appendChild(y)})}},{key:"prepareOptions",value:function(o){var i={};if(Array.isArray(o))for(var a=0,l=o.length;a<l;a++)i[o[a]]=o[a];else Ha(o)==="object"&&(i=o);return i}},{key:"refreshValue",value:function(){var o=this.hot.getSourceDataAtCell(this.row,this.prop);this.originalValue=o,this.setValue(o),this.refreshDimensions()}},{key:"refreshDimensions",value:function(){if(this.state===Kt.EDITING){if(this.TD=this.getEditedCell(),!this.TD){this.close();return}var o=this.getEditedCellRect(),i=o.top,a=o.start,l=o.width,s=o.height,u=this.select.style;u.height="".concat(s,"px"),u.width="".concat(l,"px"),u.top="".concat(i,"px"),u[this.hot.isRtl()?"right":"left"]="".concat(a,"px"),u.margin="0px",re(this.select,bw)}}},{key:"registerShortcuts",value:function(){var o=this,i=this.hot.getShortcutManager(),a=i.getContext("editor"),l={group:jM};this.isInFullEditMode()!==!1&&a.addShortcuts([{keys:[["ArrowUp"]],callback:function(){var u=o.select.selectedIndex-1;u>=0&&(o.select[u].selected=!0)}},{keys:[["ArrowDown"]],callback:function(){var u=o.select.selectedIndex+1;u<=o.select.length-1&&(o.select[u].selected=!0)}}],l)}},{key:"unregisterShortcuts",value:function(){var o=this.hot.getShortcutManager(),i=o.getContext("editor");i.removeShortcutsByGroup(jM)}}],[{key:"EDITOR_TYPE",get:function(){return fOe}}]),r}(pf);function Ys(e){"@babel/helpers - typeof";return Ys=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ys(e)}function hOe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function FM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,vOe(n.key),n)}}function dOe(e,t,r){return t&&FM(e.prototype,t),r&&FM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function vOe(e){var t=yOe(e,"string");return Ys(t)==="symbol"?t:String(t)}function yOe(e,t){if(Ys(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ys(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function rg(){return typeof Reflect<"u"&&Reflect.get?rg=Reflect.get.bind():rg=function(t,r,n){var o=gOe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},rg.apply(this,arguments)}function gOe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Gs(e),e!==null););return e}function mOe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&A_(e,t)}function A_(e,t){return A_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},A_(e,t)}function pOe(e){var t=SOe();return function(){var n=Gs(e),o;if(t){var i=Gs(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return bOe(this,o)}}function bOe(e,t){if(t&&(Ys(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return wOe(e)}function wOe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function SOe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Gs(e){return Gs=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Gs(e)}var COe="time",e2=function(e){mOe(r,e);var t=pOe(r);function r(){return hOe(this,r),t.apply(this,arguments)}return dOe(r,[{key:"prepare",value:function(o,i,a,l,s,u){rg(Gs(r.prototype),"prepare",this).call(this,o,i,a,l,s,u),this.TEXTAREA.dir="ltr"}}],[{key:"EDITOR_TYPE",get:function(){return COe}}]),r}(Za);function _Oe(){Ir(pf),Ir(AT),Ir(KW),Ir(ZW),Ir(IT),Ir($T),Ir(QW),Ir(JW),Ir(cOe),Ir(Za),Ir(e2)}var OOe="html";function MT(e,t,r,n,o,i,a){hv.apply(this,[e,t,r,n,o,i,a]),vf(t,i??"",!1)}MT.RENDERER_TYPE=OOe;var ROe="autocomplete";function bf(e,t,r,n,o,i,a){var l=e.rootDocument,s=a.allowHtml?MT:Ei,u=l.createElement("DIV");if(u.className="htAutocompleteArrow",u.appendChild(l.createTextNode(String.fromCharCode(9660))),s.apply(this,[e,t,r,n,o,i,a]),t.firstChild||t.appendChild(l.createTextNode(String.fromCharCode(160))),t.insertBefore(u,t.firstChild),re(t,"htAutocomplete"),!e.acArrowListener){var f=new Pt(e);e.acArrowListener=function(c){xe(c.target,"htAutocompleteArrow")&&e.view._wt.getSetting("onCellDblClick",null,e._createCellCoords(r,n),t)},f.addEventListener(e.rootElement,"mousedown",e.acArrowListener),e.addHookOnce("afterDestroy",function(){f.destroy()})}}bf.RENDERER_TYPE=ROe;var BM=new WeakMap,VM=new WeakMap,EOe="htBadValue",Ks="data-row",qs="data-col",TOe="checkboxRenderer",t2="checkbox";ge.getSingleton().add("modifyAutoColumnSizeSeed",function(e,t,r){var n=t.label,o=t.type,i=t.row,a=t.column,l=t.prop;if(o===t2){if(n){var s=n.value,u=n.property,f=r;if(s)f=typeof s=="function"?s(i,a,l,r):s;else if(u){var c=this.getDataAtRowProp(i,u);f=c!==null?c:r}e=f}return e}});function xT(e,t,r,n,o,i,a){var l=e.rootDocument;hv.apply(this,[e,t,r,n,o,i,a]),kOe(e);var s=POe(l),u=a.label,f=!1;if(typeof a.checkedTemplate>"u"&&(a.checkedTemplate=!0),typeof a.uncheckedTemplate>"u"&&(a.uncheckedTemplate=!1),xn(t),i===a.checkedTemplate||Ht(i).toLocaleLowerCase(a.locale)===Ht(a.checkedTemplate).toLocaleLowerCase(a.locale)?s.checked=!0:i===a.uncheckedTemplate||Ht(i).toLocaleLowerCase(a.locale)===Ht(a.uncheckedTemplate).toLocaleLowerCase(a.locale)?s.checked=!1:Yt(i)?re(s,"noValue"):(s.style.display="none",re(s,EOe),f=!0),s.setAttribute(Ks,r),s.setAttribute(qs,n),!f&&u){var c="";if(u.value)c=typeof u.value=="function"?u.value.call(this,r,n,o,i):u.value;else if(u.property){var h=e.getDataAtRowProp(r,u.property);c=h!==null?h:""}var d=$Oe(l,c,u.separated!==!0);u.position==="before"?u.separated?(t.appendChild(d),t.appendChild(s)):(d.appendChild(s),s=d):(!u.position||u.position==="after")&&(u.separated?(t.appendChild(s),t.appendChild(d)):(d.insertBefore(s,d.firstChild),s=d))}(!u||u&&!u.separated)&&t.appendChild(s),f&&t.appendChild(l.createTextNode("#bad-value#")),BM.has(e)||(BM.set(e,!0),v());function v(){var w=e.getShortcutManager(),S=w.getContext("grid"),C={group:TOe};S.addShortcuts([{keys:[["space"]],callback:function(){return y(),!p()}},{keys:[["enter"]],callback:function(){return y(),!p()},runOnlyIf:function(){return e.getSettings().enterBeginsEditing}},{keys:[["delete"],["backspace"]],callback:function(){return y(!0),!p()},relativeToGroup:cc,position:"before"}],C)}function y(){var w=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,S=e.getSelectedRange();if(S)for(var C=0;C<S.length;C++){for(var P=S[C].getTopStartCorner(),R=P.row,W=P.col,Y=S[C].getBottomEndCorner(),q=Y.row,G=Y.col,X=[],Q=R;Q<=q;Q+=1)for(var oe=W;oe<=G;oe+=1){var J=e.getCellMeta(Q,oe);if(J.type!=="checkbox")return;if(J.readOnly!==!0){typeof J.checkedTemplate>"u"&&(J.checkedTemplate=!0),typeof J.uncheckedTemplate>"u"&&(J.uncheckedTemplate=!1);var ue=e.getDataAtCell(Q,oe);w===!1?[J.checkedTemplate,J.checkedTemplate.toString()].includes(ue)?X.push([Q,oe,J.uncheckedTemplate]):[J.uncheckedTemplate,J.uncheckedTemplate.toString(),null,void 0].includes(ue)&&X.push([Q,oe,J.checkedTemplate]):X.push([Q,oe,J.uncheckedTemplate])}}X.length>0&&e.setDataAtCell(X)}}function p(){var w=e.getSelectedRange();if(w){for(var S=0;S<w.length;S++)for(var C=w[S].getTopStartCorner(),P=w[S].getBottomEndCorner(),R=C.row;R<=P.row;R++)for(var W=C.col;W<=P.col;W++){var Y=e.getCellMeta(R,W);if(Y.type!=="checkbox")return!1;var q=e.getCell(R,W);if(q==null)return!0;var G=q.querySelectorAll("input[type=checkbox]");if(G.length>0&&!Y.readOnly)return!0}return!1}}}xT.RENDERER_TYPE=t2;function kOe(e){var t=VM.get(e);if(!t){var r=e.rootElement;t=new Pt(e),t.addEventListener(r,"click",function(n){return IOe(n,e)}),t.addEventListener(r,"mouseup",function(n){return AOe(n,e)}),t.addEventListener(r,"change",function(n){return MOe(n,e)}),VM.set(e,t)}return t}function POe(e){var t=e.createElement("input");return t.className="htCheckboxRendererInput",t.type="checkbox",t.setAttribute("autocomplete","off"),t.setAttribute("tabindex","-1"),t.cloneNode(!1)}function $Oe(e,t,r){var n=e.createElement("label");return n.className="htCheckboxRendererLabel ".concat(r?"fullWidth":""),n.appendChild(e.createTextNode(t)),n.cloneNode(!0)}function AOe(e,t){var r=e.target;DT(r)&&(!r.hasAttribute(Ks)||!r.hasAttribute(qs)||setTimeout(t.listen,10))}function IOe(e,t){var r=e.target;if(DT(r)&&!(!r.hasAttribute(Ks)||!r.hasAttribute(qs))){var n=parseInt(r.getAttribute(Ks),10),o=parseInt(r.getAttribute(qs),10),i=t.getCellMeta(n,o);i.readOnly&&e.preventDefault()}}function MOe(e,t){var r=e.target;if(DT(r)&&!(!r.hasAttribute(Ks)||!r.hasAttribute(qs))){var n=parseInt(r.getAttribute(Ks),10),o=parseInt(r.getAttribute(qs),10),i=t.getCellMeta(n,o);if(!i.readOnly){var a=null;e.target.checked?a=i.uncheckedTemplate===void 0?!0:i.checkedTemplate:a=i.uncheckedTemplate===void 0?!1:i.uncheckedTemplate,t.setDataAtCell(n,o,a)}}}function DT(e){return e.tagName==="INPUT"&&e.getAttribute("type")==="checkbox"}function Qv(e){throw new Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var r2={exports:{}};(function(e,t){(function(r){e.exports=r()})(function(){return function r(n,o,i){function a(u,f){if(!o[u]){if(!n[u]){var c=typeof Qv=="function"&&Qv;if(!f&&c)return c(u,!0);if(l)return l(u,!0);var h=new Error("Cannot find module '"+u+"'");throw h.code="MODULE_NOT_FOUND",h}var d=o[u]={exports:{}};n[u][0].call(d.exports,function(v){return a(n[u][1][v]||v)},d,d.exports,r,n,o,i)}return o[u].exports}for(var l=typeof Qv=="function"&&Qv,s=0;s<i.length;s++)a(i[s]);return a}({1:[function(r,n,o){(function(i){var a,l=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,s=Math.ceil,u=Math.floor,f="[BigNumber Error] ",c=f+"Number primitive has more than 15 significant digits: ",h=1e14,d=14,v=9007199254740991,y=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],p=1e7,w=1e9;function S(G){var X=0|G;return 0<G||G===X?X:X-1}function C(G){for(var X,Q,oe=1,J=G.length,ue=G[0]+"";oe<J;){for(X=G[oe++]+"",Q=d-X.length;Q--;X="0"+X);ue+=X}for(J=ue.length;ue.charCodeAt(--J)===48;);return ue.slice(0,J+1||1)}function P(G,X){var Q,oe,J=G.c,ue=X.c,de=G.s,Oe=X.s,be=G.e,$=X.e;if(!de||!Oe)return null;if(Q=J&&!J[0],oe=ue&&!ue[0],Q||oe)return Q?oe?0:-Oe:de;if(de!=Oe)return de;if(Q=de<0,oe=be==$,!J||!ue)return oe?0:!J^Q?1:-1;if(!oe)return $<be^Q?1:-1;for(Oe=(be=J.length)<($=ue.length)?be:$,de=0;de<Oe;de++)if(J[de]!=ue[de])return J[de]>ue[de]^Q?1:-1;return be==$?0:$<be^Q?1:-1}function R(G,X,Q,oe){if(G<X||Q<G||G!==(G<0?s(G):u(G)))throw Error(f+(oe||"Argument")+(typeof G=="number"?G<X||Q<G?" out of range: ":" not an integer: ":" not a primitive number: ")+String(G))}function W(G){var X=G.c.length-1;return S(G.e/d)==X&&G.c[X]%2!=0}function Y(G,X){return(1<G.length?G.charAt(0)+"."+G.slice(1):G)+(X<0?"e":"e+")+X}function q(G,X,Q){var oe,J;if(X<0){for(J=Q+".";++X;J+=Q);G=J+G}else if(++X>(oe=G.length)){for(J=Q,X-=oe;--X;J+=Q);G+=J}else X<oe&&(G=G.slice(0,X)+"."+G.slice(X));return G}(a=function G(X){var Q,oe,J,ue,de,Oe,be,$,k,g,m=U.prototype={constructor:U,toString:null,valueOf:null},b=new U(1),E=20,O=4,F=-7,x=21,K=-1e7,Z=1e7,te=!1,ie=1,se=0,Se={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:"Â ",suffix:""},we="0123456789abcdefghijklmnopqrstuvwxyz";function U(_,T){var A,j,M,B,N,D,V,L,z=this;if(!(z instanceof U))return new U(_,T);if(T==null){if(_ instanceof U)return z.s=_.s,z.e=_.e,void(z.c=(_=_.c)?_.slice():_);if((D=typeof _=="number")&&0*_==0){if(z.s=1/_<0?(_=-_,-1):1,_===~~_){for(B=0,N=_;10<=N;N/=10,B++);return z.e=B,void(z.c=[_])}L=String(_)}else{if(L=String(_),!l.test(L))return J(z,L,D);z.s=L.charCodeAt(0)==45?(L=L.slice(1),-1):1}-1<(B=L.indexOf("."))&&(L=L.replace(".","")),0<(N=L.search(/e/i))?(B<0&&(B=N),B+=+L.slice(N+1),L=L.substring(0,N)):B<0&&(B=L.length)}else{if(R(T,2,we.length,"Base"),L=String(_),T==10)return Ae(z=new U(_ instanceof U?_:L),E+z.e+1,O);if(D=typeof _=="number"){if(0*_!=0)return J(z,L,D,T);if(z.s=1/_<0?(L=L.slice(1),-1):1,U.DEBUG&&15<L.replace(/^0\.0*|\./,"").length)throw Error(c+_);D=!1}else z.s=L.charCodeAt(0)===45?(L=L.slice(1),-1):1;for(A=we.slice(0,T),B=N=0,V=L.length;N<V;N++)if(A.indexOf(j=L.charAt(N))<0){if(j=="."){if(B<N){B=V;continue}}else if(!M&&(L==L.toUpperCase()&&(L=L.toLowerCase())||L==L.toLowerCase()&&(L=L.toUpperCase()))){M=!0,N=-1,B=0;continue}return J(z,String(_),D,T)}-1<(B=(L=oe(L,T,10,z.s)).indexOf("."))?L=L.replace(".",""):B=L.length}for(N=0;L.charCodeAt(N)===48;N++);for(V=L.length;L.charCodeAt(--V)===48;);if(L=L.slice(N,++V)){if(V-=N,D&&U.DEBUG&&15<V&&(v<_||_!==u(_)))throw Error(c+z.s*_);if(Z<(B=B-N-1))z.c=z.e=null;else if(B<K)z.c=[z.e=0];else{if(z.e=B,z.c=[],N=(B+1)%d,B<0&&(N+=d),N<V){for(N&&z.c.push(+L.slice(0,N)),V-=d;N<V;)z.c.push(+L.slice(N,N+=d));L=L.slice(N),N=d-L.length}else N-=V;for(;N--;L+="0");z.c.push(+L)}}else z.c=[z.e=0]}function De(_,T,A,j){var M,B,N,D,V;if(A==null?A=O:R(A,0,8),!_.c)return _.toString();if(M=_.c[0],N=_.e,T==null)V=C(_.c),V=j==1||j==2&&(N<=F||x<=N)?Y(V,N):q(V,N,"0");else if(B=(_=Ae(new U(_),T,A)).e,D=(V=C(_.c)).length,j==1||j==2&&(T<=B||B<=F)){for(;D<T;V+="0",D++);V=Y(V,B)}else if(T-=N,V=q(V,B,"0"),D<B+1){if(0<--T)for(V+=".";T--;V+="0");}else if(0<(T+=B-D))for(B+1==D&&(V+=".");T--;V+="0");return _.s<0&&M?"-"+V:V}function Fe(_,T){for(var A,j=1,M=new U(_[0]);j<_.length;j++){if(!(A=new U(_[j])).s){M=A;break}T.call(M,A)&&(M=A)}return M}function ke(_,T,A){for(var j=1,M=T.length;!T[--M];T.pop());for(M=T[0];10<=M;M/=10,j++);return(A=j+A*d-1)>Z?_.c=_.e=null:_.c=A<K?[_.e=0]:(_.e=A,T),_}function Ae(_,T,A,j){var M,B,N,D,V,L,z,le=_.c,me=y;if(le){e:{for(M=1,D=le[0];10<=D;D/=10,M++);if((B=T-M)<0)B+=d,N=T,z=(V=le[L=0])/me[M-N-1]%10|0;else if((L=s((B+1)/d))>=le.length){if(!j)break e;for(;le.length<=L;le.push(0));V=z=0,N=(B%=d)-d+(M=1)}else{for(V=D=le[L],M=1;10<=D;D/=10,M++);z=(N=(B%=d)-d+M)<0?0:V/me[M-N-1]%10|0}if(j=j||T<0||le[L+1]!=null||(N<0?V:V%me[M-N-1]),j=A<4?(z||j)&&(A==0||A==(_.s<0?3:2)):5<z||z==5&&(A==4||j||A==6&&(0<B?0<N?V/me[M-N]:0:le[L-1])%10&1||A==(_.s<0?8:7)),T<1||!le[0])return le.length=0,j?(T-=_.e+1,le[0]=me[(d-T%d)%d],_.e=-T||0):le[0]=_.e=0,_;if(B==0?(le.length=L,D=1,L--):(le.length=L+1,D=me[d-B],le[L]=0<N?u(V/me[M-N]%me[N])*D:0),j)for(;;){if(L==0){for(B=1,N=le[0];10<=N;N/=10,B++);for(N=le[0]+=D,D=1;10<=N;N/=10,D++);B!=D&&(_.e++,le[0]==h&&(le[0]=1));break}if(le[L]+=D,le[L]!=h)break;le[L--]=0,D=1}for(B=le.length;le[--B]===0;le.pop());}_.e>Z?_.c=_.e=null:_.e<K&&(_.c=[_.e=0])}return _}function Pe(_){var T,A=_.e;return A===null?_.toString():(T=C(_.c),T=A<=F||x<=A?Y(T,A):q(T,A,"0"),_.s<0?"-"+T:T)}return U.clone=G,U.ROUND_UP=0,U.ROUND_DOWN=1,U.ROUND_CEIL=2,U.ROUND_FLOOR=3,U.ROUND_HALF_UP=4,U.ROUND_HALF_DOWN=5,U.ROUND_HALF_EVEN=6,U.ROUND_HALF_CEIL=7,U.ROUND_HALF_FLOOR=8,U.EUCLID=9,U.config=U.set=function(_){var T,A;if(_!=null){if(typeof _!="object")throw Error(f+"Object expected: "+_);if(_.hasOwnProperty(T="DECIMAL_PLACES")&&(R(A=_[T],0,w,T),E=A),_.hasOwnProperty(T="ROUNDING_MODE")&&(R(A=_[T],0,8,T),O=A),_.hasOwnProperty(T="EXPONENTIAL_AT")&&((A=_[T])&&A.pop?(R(A[0],-w,0,T),R(A[1],0,w,T),F=A[0],x=A[1]):(R(A,-w,w,T),F=-(x=A<0?-A:A))),_.hasOwnProperty(T="RANGE"))if((A=_[T])&&A.pop)R(A[0],-w,-1,T),R(A[1],1,w,T),K=A[0],Z=A[1];else{if(R(A,-w,w,T),!A)throw Error(f+T+" cannot be zero: "+A);K=-(Z=A<0?-A:A)}if(_.hasOwnProperty(T="CRYPTO")){if((A=_[T])!==!!A)throw Error(f+T+" not true or false: "+A);if(A){if(typeof crypto>"u"||!crypto||!crypto.getRandomValues&&!crypto.randomBytes)throw te=!A,Error(f+"crypto unavailable");te=A}else te=A}if(_.hasOwnProperty(T="MODULO_MODE")&&(R(A=_[T],0,9,T),ie=A),_.hasOwnProperty(T="POW_PRECISION")&&(R(A=_[T],0,w,T),se=A),_.hasOwnProperty(T="FORMAT")){if(typeof(A=_[T])!="object")throw Error(f+T+" not an object: "+A);Se=A}if(_.hasOwnProperty(T="ALPHABET")){if(typeof(A=_[T])!="string"||/^.$|[+-.\s]|(.).*\1/.test(A))throw Error(f+T+" invalid: "+A);we=A}}return{DECIMAL_PLACES:E,ROUNDING_MODE:O,EXPONENTIAL_AT:[F,x],RANGE:[K,Z],CRYPTO:te,MODULO_MODE:ie,POW_PRECISION:se,FORMAT:Se,ALPHABET:we}},U.isBigNumber=function(_){return _ instanceof U||_&&_._isBigNumber===!0||!1},U.maximum=U.max=function(){return Fe(arguments,m.lt)},U.minimum=U.min=function(){return Fe(arguments,m.gt)},U.random=(ue=9007199254740992,de=Math.random()*ue&2097151?function(){return u(Math.random()*ue)}:function(){return 8388608*(1073741824*Math.random()|0)+(8388608*Math.random()|0)},function(_){var T,A,j,M,B,N=0,D=[],V=new U(b);if(_==null?_=E:R(_,0,w),M=s(_/d),te)if(crypto.getRandomValues){for(T=crypto.getRandomValues(new Uint32Array(M*=2));N<M;)9e15<=(B=131072*T[N]+(T[N+1]>>>11))?(A=crypto.getRandomValues(new Uint32Array(2)),T[N]=A[0],T[N+1]=A[1]):(D.push(B%1e14),N+=2);N=M/2}else{if(!crypto.randomBytes)throw te=!1,Error(f+"crypto unavailable");for(T=crypto.randomBytes(M*=7);N<M;)9e15<=(B=281474976710656*(31&T[N])+1099511627776*T[N+1]+4294967296*T[N+2]+16777216*T[N+3]+(T[N+4]<<16)+(T[N+5]<<8)+T[N+6])?crypto.randomBytes(7).copy(T,N):(D.push(B%1e14),N+=7);N=M/7}if(!te)for(;N<M;)(B=de())<9e15&&(D[N++]=B%1e14);for(M=D[--N],_%=d,M&&_&&(B=y[d-_],D[N]=u(M/B)*B);D[N]===0;D.pop(),N--);if(N<0)D=[j=0];else{for(j=-1;D[0]===0;D.splice(0,1),j-=d);for(N=1,B=D[0];10<=B;B/=10,N++);N<d&&(j-=d-N)}return V.e=j,V.c=D,V}),U.sum=function(){for(var _=1,T=arguments,A=new U(T[0]);_<T.length;)A=A.plus(T[_++]);return A},oe=function(){var _="0123456789";function T(A,j,M,B){for(var N,D,V=[0],L=0,z=A.length;L<z;){for(D=V.length;D--;V[D]*=j);for(V[0]+=B.indexOf(A.charAt(L++)),N=0;N<V.length;N++)V[N]>M-1&&(V[N+1]==null&&(V[N+1]=0),V[N+1]+=V[N]/M|0,V[N]%=M)}return V.reverse()}return function(A,j,M,B,N){var D,V,L,z,le,me,Re,Ne,Xe=A.indexOf("."),at=E,We=O;for(0<=Xe&&(z=se,se=0,A=A.replace(".",""),me=(Ne=new U(j)).pow(A.length-Xe),se=z,Ne.c=T(q(C(me.c),me.e,"0"),10,M,_),Ne.e=Ne.c.length),L=z=(Re=T(A,j,M,N?(D=we,_):(D=_,we))).length;Re[--z]==0;Re.pop());if(!Re[0])return D.charAt(0);if(Xe<0?--L:(me.c=Re,me.e=L,me.s=B,Re=(me=Q(me,Ne,at,We,M)).c,le=me.r,L=me.e),Xe=Re[V=L+at+1],z=M/2,le=le||V<0||Re[V+1]!=null,le=We<4?(Xe!=null||le)&&(We==0||We==(me.s<0?3:2)):z<Xe||Xe==z&&(We==4||le||We==6&&1&Re[V-1]||We==(me.s<0?8:7)),V<1||!Re[0])A=le?q(D.charAt(1),-at,D.charAt(0)):D.charAt(0);else{if(Re.length=V,le)for(--M;++Re[--V]>M;)Re[V]=0,V||(++L,Re=[1].concat(Re));for(z=Re.length;!Re[--z];);for(Xe=0,A="";Xe<=z;A+=D.charAt(Re[Xe++]));A=q(A,L,D.charAt(0))}return A}}(),Q=function(){function _(j,M,B){var N,D,V,L,z=0,le=j.length,me=M%p,Re=M/p|0;for(j=j.slice();le--;)z=((D=me*(V=j[le]%p)+(N=Re*V+(L=j[le]/p|0)*me)%p*p+z)/B|0)+(N/p|0)+Re*L,j[le]=D%B;return z&&(j=[z].concat(j)),j}function T(j,M,B,N){var D,V;if(B!=N)V=N<B?1:-1;else for(D=V=0;D<B;D++)if(j[D]!=M[D]){V=j[D]>M[D]?1:-1;break}return V}function A(j,M,B,N){for(var D=0;B--;)j[B]-=D,D=j[B]<M[B]?1:0,j[B]=D*N+j[B]-M[B];for(;!j[0]&&1<j.length;j.splice(0,1));}return function(j,M,B,N,D){var V,L,z,le,me,Re,Ne,Xe,at,We,Ie,Me,ar,xt,Be,Qe,pt,lt=j.s==M.s?1:-1,st=j.c,Je=M.c;if(!(st&&st[0]&&Je&&Je[0]))return new U(j.s&&M.s&&(st?!Je||st[0]!=Je[0]:Je)?st&&st[0]==0||!Je?0*lt:lt/0:NaN);for(at=(Xe=new U(lt)).c=[],lt=B+(L=j.e-M.e)+1,D||(D=h,L=S(j.e/d)-S(M.e/d),lt=lt/d|0),z=0;Je[z]==(st[z]||0);z++);if(Je[z]>(st[z]||0)&&L--,lt<0)at.push(1),le=!0;else{for(xt=st.length,Qe=Je.length,lt+=2,1<(me=u(D/(Je[z=0]+1)))&&(Je=_(Je,me,D),st=_(st,me,D),Qe=Je.length,xt=st.length),ar=Qe,Ie=(We=st.slice(0,Qe)).length;Ie<Qe;We[Ie++]=0);pt=Je.slice(),pt=[0].concat(pt),Be=Je[0],Je[1]>=D/2&&Be++;do{if(me=0,(V=T(Je,We,Qe,Ie))<0){if(Me=We[0],Qe!=Ie&&(Me=Me*D+(We[1]||0)),1<(me=u(Me/Be)))for(D<=me&&(me=D-1),Ne=(Re=_(Je,me,D)).length,Ie=We.length;T(Re,We,Ne,Ie)==1;)me--,A(Re,Qe<Ne?pt:Je,Ne,D),Ne=Re.length,V=1;else me==0&&(V=me=1),Ne=(Re=Je.slice()).length;if(Ne<Ie&&(Re=[0].concat(Re)),A(We,Re,Ie,D),Ie=We.length,V==-1)for(;T(Je,We,Qe,Ie)<1;)me++,A(We,Qe<Ie?pt:Je,Ie,D),Ie=We.length}else V===0&&(me++,We=[0]);at[z++]=me,We[0]?We[Ie++]=st[ar]||0:(We=[st[ar]],Ie=1)}while((ar++<xt||We[0]!=null)&&lt--);le=We[0]!=null,at[0]||at.splice(0,1)}if(D==h){for(z=1,lt=at[0];10<=lt;lt/=10,z++);Ae(Xe,B+(Xe.e=z+L*d-1)+1,N,le)}else Xe.e=L,Xe.r=+le;return Xe}}(),Oe=/^(-?)0([xbo])(?=\w[\w.]*$)/i,be=/^([^.]+)\.$/,$=/^\.([^.]+)$/,k=/^-?(Infinity|NaN)$/,g=/^\s*\+(?=[\w.])|^\s+|\s+$/g,J=function(_,T,A,j){var M,B=A?T:T.replace(g,"");if(k.test(B))_.s=isNaN(B)?null:B<0?-1:1,_.c=_.e=null;else{if(!A&&(B=B.replace(Oe,function(N,D,V){return M=(V=V.toLowerCase())=="x"?16:V=="b"?2:8,j&&j!=M?N:D}),j&&(M=j,B=B.replace(be,"$1").replace($,"0.$1")),T!=B))return new U(B,M);if(U.DEBUG)throw Error(f+"Not a"+(j?" base "+j:"")+" number: "+T);_.c=_.e=_.s=null}},m.absoluteValue=m.abs=function(){var _=new U(this);return _.s<0&&(_.s=1),_},m.comparedTo=function(_,T){return P(this,new U(_,T))},m.decimalPlaces=m.dp=function(_,T){var A,j,M;if(_!=null)return R(_,0,w),T==null?T=O:R(T,0,8),Ae(new U(this),_+this.e+1,T);if(!(A=this.c))return null;if(j=((M=A.length-1)-S(this.e/d))*d,M=A[M])for(;M%10==0;M/=10,j--);return j<0&&(j=0),j},m.dividedBy=m.div=function(_,T){return Q(this,new U(_,T),E,O)},m.dividedToIntegerBy=m.idiv=function(_,T){return Q(this,new U(_,T),0,1)},m.exponentiatedBy=m.pow=function(_,T){var A,j,M,B,N,D,V,L,z=this;if((_=new U(_)).c&&!_.isInteger())throw Error(f+"Exponent not an integer: "+Pe(_));if(T!=null&&(T=new U(T)),N=14<_.e,!z.c||!z.c[0]||z.c[0]==1&&!z.e&&z.c.length==1||!_.c||!_.c[0])return L=new U(Math.pow(+Pe(z),N?2-W(_):+Pe(_))),T?L.mod(T):L;if(D=_.s<0,T){if(T.c?!T.c[0]:!T.s)return new U(NaN);(j=!D&&z.isInteger()&&T.isInteger())&&(z=z.mod(T))}else{if(9<_.e&&(0<z.e||z.e<-1||(z.e==0?1<z.c[0]||N&&24e7<=z.c[1]:z.c[0]<8e13||N&&z.c[0]<=9999975e7)))return B=z.s<0&&W(_)?-0:0,-1<z.e&&(B=1/B),new U(D?1/B:B);se&&(B=s(se/d+2))}for(V=N?(A=new U(.5),D&&(_.s=1),W(_)):(M=Math.abs(+Pe(_)))%2,L=new U(b);;){if(V){if(!(L=L.times(z)).c)break;B?L.c.length>B&&(L.c.length=B):j&&(L=L.mod(T))}if(M){if((M=u(M/2))===0)break;V=M%2}else if(Ae(_=_.times(A),_.e+1,1),14<_.e)V=W(_);else{if((M=+Pe(_))==0)break;V=M%2}z=z.times(z),B?z.c&&z.c.length>B&&(z.c.length=B):j&&(z=z.mod(T))}return j?L:(D&&(L=b.div(L)),T?L.mod(T):B?Ae(L,se,O,void 0):L)},m.integerValue=function(_){var T=new U(this);return _==null?_=O:R(_,0,8),Ae(T,T.e+1,_)},m.isEqualTo=m.eq=function(_,T){return P(this,new U(_,T))===0},m.isFinite=function(){return!!this.c},m.isGreaterThan=m.gt=function(_,T){return 0<P(this,new U(_,T))},m.isGreaterThanOrEqualTo=m.gte=function(_,T){return(T=P(this,new U(_,T)))===1||T===0},m.isInteger=function(){return!!this.c&&S(this.e/d)>this.c.length-2},m.isLessThan=m.lt=function(_,T){return P(this,new U(_,T))<0},m.isLessThanOrEqualTo=m.lte=function(_,T){return(T=P(this,new U(_,T)))===-1||T===0},m.isNaN=function(){return!this.s},m.isNegative=function(){return this.s<0},m.isPositive=function(){return 0<this.s},m.isZero=function(){return!!this.c&&this.c[0]==0},m.minus=function(_,T){var A,j,M,B,N=this,D=N.s;if(T=(_=new U(_,T)).s,!D||!T)return new U(NaN);if(D!=T)return _.s=-T,N.plus(_);var V=N.e/d,L=_.e/d,z=N.c,le=_.c;if(!V||!L){if(!z||!le)return z?(_.s=-T,_):new U(le?N:NaN);if(!z[0]||!le[0])return le[0]?(_.s=-T,_):new U(z[0]?N:O==3?-0:0)}if(V=S(V),L=S(L),z=z.slice(),D=V-L){for((M=(B=D<0)?(D=-D,z):(L=V,le)).reverse(),T=D;T--;M.push(0));M.reverse()}else for(j=(B=(D=z.length)<(T=le.length))?D:T,D=T=0;T<j;T++)if(z[T]!=le[T]){B=z[T]<le[T];break}if(B&&(M=z,z=le,le=M,_.s=-_.s),0<(T=(j=le.length)-(A=z.length)))for(;T--;z[A++]=0);for(T=h-1;D<j;){if(z[--j]<le[j]){for(A=j;A&&!z[--A];z[A]=T);--z[A],z[j]+=h}z[j]-=le[j]}for(;z[0]==0;z.splice(0,1),--L);return z[0]?ke(_,z,L):(_.s=O==3?-1:1,_.c=[_.e=0],_)},m.modulo=m.mod=function(_,T){var A,j,M=this;return _=new U(_,T),!M.c||!_.s||_.c&&!_.c[0]?new U(NaN):!_.c||M.c&&!M.c[0]?new U(M):(ie==9?(j=_.s,_.s=1,A=Q(M,_,0,3),_.s=j,A.s*=j):A=Q(M,_,0,ie),(_=M.minus(A.times(_))).c[0]||ie!=1||(_.s=M.s),_)},m.multipliedBy=m.times=function(_,T){var A,j,M,B,N,D,V,L,z,le,me,Re,Ne,Xe,at,We=this,Ie=We.c,Me=(_=new U(_,T)).c;if(!(Ie&&Me&&Ie[0]&&Me[0]))return!We.s||!_.s||Ie&&!Ie[0]&&!Me||Me&&!Me[0]&&!Ie?_.c=_.e=_.s=null:(_.s*=We.s,Ie&&Me?(_.c=[0],_.e=0):_.c=_.e=null),_;for(j=S(We.e/d)+S(_.e/d),_.s*=We.s,(V=Ie.length)<(le=Me.length)&&(Ne=Ie,Ie=Me,Me=Ne,M=V,V=le,le=M),M=V+le,Ne=[];M--;Ne.push(0));for(Xe=h,at=p,M=le;0<=--M;){for(A=0,me=Me[M]%at,Re=Me[M]/at|0,B=M+(N=V);M<B;)A=((L=me*(L=Ie[--N]%at)+(D=Re*L+(z=Ie[N]/at|0)*me)%at*at+Ne[B]+A)/Xe|0)+(D/at|0)+Re*z,Ne[B--]=L%Xe;Ne[B]=A}return A?++j:Ne.splice(0,1),ke(_,Ne,j)},m.negated=function(){var _=new U(this);return _.s=-_.s||null,_},m.plus=function(_,T){var A,j=this,M=j.s;if(T=(_=new U(_,T)).s,!M||!T)return new U(NaN);if(M!=T)return _.s=-T,j.minus(_);var B=j.e/d,N=_.e/d,D=j.c,V=_.c;if(!B||!N){if(!D||!V)return new U(M/0);if(!D[0]||!V[0])return V[0]?_:new U(D[0]?j:0*M)}if(B=S(B),N=S(N),D=D.slice(),M=B-N){for((A=0<M?(N=B,V):(M=-M,D)).reverse();M--;A.push(0));A.reverse()}for((M=D.length)-(T=V.length)<0&&(A=V,V=D,D=A,T=M),M=0;T;)M=(D[--T]=D[T]+V[T]+M)/h|0,D[T]=h===D[T]?0:D[T]%h;return M&&(D=[M].concat(D),++N),ke(_,D,N)},m.precision=m.sd=function(_,T){var A,j,M;if(_!=null&&_!==!!_)return R(_,1,w),T==null?T=O:R(T,0,8),Ae(new U(this),_,T);if(!(A=this.c))return null;if(j=(M=A.length-1)*d+1,M=A[M]){for(;M%10==0;M/=10,j--);for(M=A[0];10<=M;M/=10,j++);}return _&&this.e+1>j&&(j=this.e+1),j},m.shiftedBy=function(_){return R(_,-v,v),this.times("1e"+_)},m.squareRoot=m.sqrt=function(){var _,T,A,j,M,B=this,N=B.c,D=B.s,V=B.e,L=E+4,z=new U("0.5");if(D!==1||!N||!N[0])return new U(!D||D<0&&(!N||N[0])?NaN:N?B:1/0);if((A=(D=Math.sqrt(+Pe(B)))==0||D==1/0?(((T=C(N)).length+V)%2==0&&(T+="0"),D=Math.sqrt(+T),V=S((V+1)/2)-(V<0||V%2),new U(T=D==1/0?"1e"+V:(T=D.toExponential()).slice(0,T.indexOf("e")+1)+V)):new U(D+"")).c[0]){for((D=(V=A.e)+L)<3&&(D=0);;)if(M=A,A=z.times(M.plus(Q(B,M,L,1))),C(M.c).slice(0,D)===(T=C(A.c)).slice(0,D)){if(A.e<V&&--D,(T=T.slice(D-3,D+1))!="9999"&&(j||T!="4999")){+T&&(+T.slice(1)||T.charAt(0)!="5")||(Ae(A,A.e+E+2,1),_=!A.times(A).eq(B));break}if(!j&&(Ae(M,M.e+E+2,0),M.times(M).eq(B))){A=M;break}L+=4,D+=4,j=1}}return Ae(A,A.e+E+1,O,_)},m.toExponential=function(_,T){return _!=null&&(R(_,0,w),_++),De(this,_,T,1)},m.toFixed=function(_,T){return _!=null&&(R(_,0,w),_=_+this.e+1),De(this,_,T)},m.toFormat=function(_,T,A){var j;if(A==null)_!=null&&T&&typeof T=="object"?(A=T,T=null):_&&typeof _=="object"?(A=_,_=T=null):A=Se;else if(typeof A!="object")throw Error(f+"Argument not an object: "+A);if(j=this.toFixed(_,T),this.c){var M,B=j.split("."),N=+A.groupSize,D=+A.secondaryGroupSize,V=A.groupSeparator||"",L=B[0],z=B[1],le=this.s<0,me=le?L.slice(1):L,Re=me.length;if(D&&(M=N,N=D,Re-=D=M),0<N&&0<Re){for(M=Re%N||N,L=me.substr(0,M);M<Re;M+=N)L+=V+me.substr(M,N);0<D&&(L+=V+me.slice(M)),le&&(L="-"+L)}j=z?L+(A.decimalSeparator||"")+((D=+A.fractionGroupSize)?z.replace(new RegExp("\\d{"+D+"}\\B","g"),"$&"+(A.fractionGroupSeparator||"")):z):L}return(A.prefix||"")+j+(A.suffix||"")},m.toFraction=function(_){var T,A,j,M,B,N,D,V,L,z,le,me,Re=this,Ne=Re.c;if(_!=null&&(!(D=new U(_)).isInteger()&&(D.c||D.s!==1)||D.lt(b)))throw Error(f+"Argument "+(D.isInteger()?"out of range: ":"not an integer: ")+Pe(D));if(!Ne)return new U(Re);for(T=new U(b),L=A=new U(b),j=V=new U(b),me=C(Ne),B=T.e=me.length-Re.e-1,T.c[0]=y[(N=B%d)<0?d+N:N],_=!_||0<D.comparedTo(T)?0<B?T:L:D,N=Z,Z=1/0,D=new U(me),V.c[0]=0;z=Q(D,T,0,1),(M=A.plus(z.times(j))).comparedTo(_)!=1;)A=j,j=M,L=V.plus(z.times(M=L)),V=M,T=D.minus(z.times(M=T)),D=M;return M=Q(_.minus(A),j,0,1),V=V.plus(M.times(L)),A=A.plus(M.times(j)),V.s=L.s=Re.s,le=Q(L,j,B*=2,O).minus(Re).abs().comparedTo(Q(V,A,B,O).minus(Re).abs())<1?[L,j]:[V,A],Z=N,le},m.toNumber=function(){return+Pe(this)},m.toPrecision=function(_,T){return _!=null&&R(_,1,w),De(this,_,T,2)},m.toString=function(_){var T,A=this,j=A.s,M=A.e;return M===null?j?(T="Infinity",j<0&&(T="-"+T)):T="NaN":(T=_==null?M<=F||x<=M?Y(C(A.c),M):q(C(A.c),M,"0"):_===10?q(C((A=Ae(new U(A),E+M+1,O)).c),A.e,"0"):(R(_,2,we.length,"Base"),oe(q(C(A.c),M,"0"),10,_,j,!0)),j<0&&A.c[0]&&(T="-"+T)),T},m.valueOf=m.toJSON=function(){return Pe(this)},m._isBigNumber=!0,typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"&&(m[Symbol.toStringTag]="BigNumber",m[Symbol.for("nodejs.util.inspect.custom")]=m.valueOf),X!=null&&U.set(X),U}()).default=a.BigNumber=a,n!==void 0&&n.exports?n.exports=a:(i||(i=typeof self<"u"&&self?self:window),i.BigNumber=a)})(this)},{}],2:[function(r,n,o){n.exports={languageTag:"en-US",delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},spaceSeparated:!1,ordinal:function(i){var a=i%10;return~~(i%100/10)==1?"th":a===1?"st":a===2?"nd":a===3?"rd":"th"},currency:{symbol:"$",position:"prefix",code:"USD"},currencyFormat:{thousandSeparated:!0,totalLength:4,spaceSeparated:!0},formats:{fourDigits:{totalLength:4,spaceSeparated:!0},fullWithTwoDecimals:{output:"currency",thousandSeparated:!0,mantissa:2},fullWithTwoDecimalsNoCurrency:{thousandSeparated:!0,mantissa:2},fullWithNoDecimals:{output:"currency",thousandSeparated:!0,mantissa:0}}}},{}],3:[function(r,n,o){function i(S,C){return function(P){if(Array.isArray(P))return P}(S)||function(P,R){var W=[],Y=!0,q=!1,G=void 0;try{for(var X,Q=P[Symbol.iterator]();!(Y=(X=Q.next()).done)&&(W.push(X.value),!R||W.length!==R);Y=!0);}catch(oe){q=!0,G=oe}finally{try{Y||Q.return==null||Q.return()}finally{if(q)throw G}}return W}(S,C)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var a=r("./globalState"),l=r("./validating"),s=r("./parsing"),u=["B","KB","MB","GB","TB","PB","EB","ZB","YB"],f={general:{scale:1024,suffixes:u,marker:"bd"},binary:{scale:1024,suffixes:["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],marker:"b"},decimal:{scale:1e3,suffixes:u,marker:"d"}},c={totalLength:0,characteristic:0,forceAverage:!1,average:!1,mantissa:-1,optionalMantissa:!0,thousandSeparated:!1,spaceSeparated:!1,negative:"sign",forceSign:!1};function h(S){var C=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{},P=2<arguments.length?arguments[2]:void 0;if(typeof C=="string"&&(C=s.parseFormat(C)),!l.validateFormat(C))return"ERROR: invalid format";var R=C.prefix||"",W=C.postfix||"",Y=function(q,G,X){switch(G.output){case"currency":return G=w(G,a.currentCurrencyDefaultFormat()),function(we,U,De){var Fe=De.currentCurrency(),ke=Object.assign({},c,U),Ae=void 0,Pe="",_=!!ke.totalLength||!!ke.forceAverage||ke.average,T=U.currencyPosition||Fe.position,A=U.currencySymbol||Fe.symbol;ke.spaceSeparated&&(Pe=" "),T==="infix"&&(Ae=Pe+A+Pe);var j=p({instance:we,providedFormat:U,state:De,decimalSeparator:Ae});return T==="prefix"&&(j=we._value<0&&ke.negative==="sign"?"-".concat(Pe).concat(A).concat(j.slice(1)):A+Pe+j),T&&T!=="postfix"||(j=j+(Pe=_?"":Pe)+A),j}(q,G,a);case"percent":return G=w(G,a.currentPercentageDefaultFormat()),function(we,U,De,Fe){var ke=U.prefixSymbol,Ae=p({instance:Fe(100*we._value),providedFormat:U,state:De}),Pe=Object.assign({},c,U);return ke?"%".concat(Pe.spaceSeparated?" ":"").concat(Ae):"".concat(Ae).concat(Pe.spaceSeparated?" ":"","%")}(q,G,a,X);case"byte":return G=w(G,a.currentByteDefaultFormat()),b=q,O=a,F=X,x=(E=G).base||"binary",K=f[x],Z=d(b._value,K.suffixes,K.scale),te=Z.value,ie=Z.suffix,se=p({instance:F(te),providedFormat:E,state:O,defaults:O.currentByteDefaultFormat()}),Se=O.currentAbbreviations(),"".concat(se).concat(Se.spaced?" ":"").concat(ie);case"time":return G=w(G,a.currentTimeDefaultFormat()),$=q,k=Math.floor($._value/60/60),g=Math.floor(($._value-60*k*60)/60),m=Math.round($._value-60*k*60-60*g),"".concat(k,":").concat(g<10?"0":"").concat(g,":").concat(m<10?"0":"").concat(m);case"ordinal":return G=w(G,a.currentOrdinalDefaultFormat()),Q=q,oe=G,ue=(J=a).currentOrdinal(),de=Object.assign({},c,oe),Oe=p({instance:Q,providedFormat:oe,state:J}),be=ue(Q._value),"".concat(Oe).concat(de.spaceSeparated?" ":"").concat(be);case"number":default:return p({instance:q,providedFormat:G,numbro:X})}var Q,oe,J,ue,de,Oe,be,$,k,g,m,b,E,O,F,x,K,Z,te,ie,se,Se}(S,C,P);return Y=(Y=R+Y)+W}function d(S,C,P){var R=C[0],W=Math.abs(S);if(P<=W){for(var Y=1;Y<C.length;++Y){var q=Math.pow(P,Y),G=Math.pow(P,Y+1);if(q<=W&&W<G){R=C[Y],S/=q;break}}R===C[0]&&(S/=Math.pow(P,C.length-1),R=C[C.length-1])}return{value:S,suffix:R}}function v(S){for(var C="",P=0;P<S;P++)C+="0";return C}function y(S,C){return S.toString().indexOf("e")!==-1?function(P,R){var W=P.toString(),Y=i(W.split("e"),2),q=Y[0],G=Y[1],X=i(q.split("."),2),Q=X[0],oe=X[1],J=oe===void 0?"":oe;if(0<+G)W=Q+J+v(G-J.length);else{var ue=".";ue=+Q<0?"-0".concat(ue):"0".concat(ue);var de=(v(-G-1)+Math.abs(Q)+J).substr(0,R);de.length<R&&(de+=v(R-de.length)),W=ue+de}return 0<+G&&0<R&&(W+=".".concat(v(R))),W}(S,C):(Math.round(+"".concat(S,"e+").concat(C))/Math.pow(10,C)).toFixed(C)}function p(S){var C=S.instance,P=S.providedFormat,R=S.state,W=R===void 0?a:R,Y=S.decimalSeparator,q=S.defaults,G=q===void 0?W.currentDefaults():q,X=C._value;if(X===0&&W.hasZeroFormat())return W.getZeroFormat();if(!isFinite(X))return X.toString();var Q,oe,J,ue,de,Oe,be,$,k=Object.assign({},c,G,P),g=k.totalLength,m=g?0:k.characteristic,b=k.optionalCharacteristic,E=k.forceAverage,O=!!g||!!E||k.average,F=g?-1:O&&P.mantissa===void 0?0:k.mantissa,x=!g&&(P.optionalMantissa===void 0?F===-1:k.optionalMantissa),K=k.trimMantissa,Z=k.thousandSeparated,te=k.spaceSeparated,ie=k.negative,se=k.forceSign,Se=k.exponential,we="";if(O){var U=function(_){var T=_.value,A=_.forceAverage,j=_.abbreviations,M=_.spaceSeparated,B=M!==void 0&&M,N=_.totalLength,D=N===void 0?0:N,V="",L=Math.abs(T),z=-1;if(L>=Math.pow(10,12)&&!A||A==="trillion"?(V=j.trillion,T/=Math.pow(10,12)):L<Math.pow(10,12)&&L>=Math.pow(10,9)&&!A||A==="billion"?(V=j.billion,T/=Math.pow(10,9)):L<Math.pow(10,9)&&L>=Math.pow(10,6)&&!A||A==="million"?(V=j.million,T/=Math.pow(10,6)):(L<Math.pow(10,6)&&L>=Math.pow(10,3)&&!A||A==="thousand")&&(V=j.thousand,T/=Math.pow(10,3)),V&&(V=(B?" ":"")+V),D){var le=T.toString().split(".")[0];z=Math.max(D-le.length,0)}return{value:T,abbreviation:V,mantissaPrecision:z}}({value:X,forceAverage:E,abbreviations:W.currentAbbreviations(),spaceSeparated:te,totalLength:g});X=U.value,we+=U.abbreviation,g&&(F=U.mantissaPrecision)}if(Se){var De=(oe=(Q={value:X,characteristicPrecision:m}).value,J=Q.characteristicPrecision,ue=J===void 0?0:J,de=i(oe.toExponential().split("e"),2),Oe=de[0],be=de[1],$=+Oe,ue&&1<ue&&($*=Math.pow(10,ue-1),be=0<=(be=+be-(ue-1))?"+".concat(be):be),{value:$,abbreviation:"e".concat(be)});X=De.value,we=De.abbreviation+we}var Fe,ke,Ae,Pe=function(_,T,A,j,M){if(j===-1)return _;var B=y(T,j),N=i(B.toString().split("."),2),D=N[0],V=N[1],L=V===void 0?"":V;if(L.match(/^0+$/)&&(A||M))return D;var z=L.match(/0+$/);return M&&z?"".concat(D,".").concat(L.toString().slice(0,z.index)):B.toString()}(X.toString(),X,x,F,K);return Pe=function(_,T,A,j,M){var B=j.currentDelimiters(),N=B.thousands;M=M||B.decimal;var D=B.thousandsSize||3,V=_.toString(),L=V.split(".")[0],z=V.split(".")[1];return A&&(T<0&&(L=L.slice(1)),function(le,me){for(var Re=[],Ne=0,Xe=le;0<Xe;Xe--)Ne===me&&(Re.unshift(Xe),Ne=0),Ne++;return Re}(L.length,D).forEach(function(le,me){L=L.slice(0,le+me)+N+L.slice(le+me)}),T<0&&(L="-".concat(L))),V=z?L+M+z:L}(Pe=function(_,T,A,j){var M=_,B=i(M.toString().split("."),2),N=B[0],D=B[1];if(N.match(/^-?0$/)&&A)return D?"".concat(N.replace("0",""),".").concat(D):N.replace("0","");if(N.length<j)for(var V=j-N.length,L=0;L<V;L++)M="0".concat(M);return M.toString()}(Pe,0,b,m),X,Z,W,Y),(O||Se)&&(Pe=Pe+we),(se||X<0)&&(Fe=Pe,Ae=ie,Pe=(ke=X)===0?Fe:+Fe==0?Fe.replace("-",""):0<ke?"+".concat(Fe):Ae==="sign"?Fe:"(".concat(Fe.replace("-",""),")")),Pe}function w(S,C){if(!S)return C;var P=Object.keys(S);return P.length===1&&P[0]==="output"?C:S}n.exports=function(S){return{format:function(){for(var C=arguments.length,P=new Array(C),R=0;R<C;R++)P[R]=arguments[R];return h.apply(void 0,P.concat([S]))},getByteUnit:function(){for(var C=arguments.length,P=new Array(C),R=0;R<C;R++)P[R]=arguments[R];return function(W){var Y=f.general;return d(W._value,Y.suffixes,Y.scale).suffix}.apply(void 0,P.concat([S]))},getBinaryByteUnit:function(){for(var C=arguments.length,P=new Array(C),R=0;R<C;R++)P[R]=arguments[R];return function(W){var Y=f.binary;return d(W._value,Y.suffixes,Y.scale).suffix}.apply(void 0,P.concat([S]))},getDecimalByteUnit:function(){for(var C=arguments.length,P=new Array(C),R=0;R<C;R++)P[R]=arguments[R];return function(W){var Y=f.decimal;return d(W._value,Y.suffixes,Y.scale).suffix}.apply(void 0,P.concat([S]))},formatOrDefault:w}}},{"./globalState":4,"./parsing":8,"./validating":10}],4:[function(r,n,o){var i=r("./en-US"),a=r("./validating"),l=r("./parsing"),s={},u=void 0,f={},c=null,h={};function d(y){u=y}function v(){return f[u]}s.languages=function(){return Object.assign({},f)},s.currentLanguage=function(){return u},s.currentCurrency=function(){return v().currency},s.currentAbbreviations=function(){return v().abbreviations},s.currentDelimiters=function(){return v().delimiters},s.currentOrdinal=function(){return v().ordinal},s.currentDefaults=function(){return Object.assign({},v().defaults,h)},s.currentOrdinalDefaultFormat=function(){return Object.assign({},s.currentDefaults(),v().ordinalFormat)},s.currentByteDefaultFormat=function(){return Object.assign({},s.currentDefaults(),v().byteFormat)},s.currentPercentageDefaultFormat=function(){return Object.assign({},s.currentDefaults(),v().percentageFormat)},s.currentCurrencyDefaultFormat=function(){return Object.assign({},s.currentDefaults(),v().currencyFormat)},s.currentTimeDefaultFormat=function(){return Object.assign({},s.currentDefaults(),v().timeFormat)},s.setDefaults=function(y){y=l.parseFormat(y),a.validateFormat(y)&&(h=y)},s.getZeroFormat=function(){return c},s.setZeroFormat=function(y){return c=typeof y=="string"?y:null},s.hasZeroFormat=function(){return c!==null},s.languageData=function(y){if(y){if(f[y])return f[y];throw new Error('Unknown tag "'.concat(y,'"'))}return v()},s.registerLanguage=function(y){var p=1<arguments.length&&arguments[1]!==void 0&&arguments[1];if(!a.validateLanguage(y))throw new Error("Invalid language data");f[y.languageTag]=y,p&&d(y.languageTag)},s.setLanguage=function(y){var p=1<arguments.length&&arguments[1]!==void 0?arguments[1]:i.languageTag;if(!f[y]){var w=y.split("-")[0],S=Object.keys(f).find(function(C){return C.split("-")[0]===w});return f[S]?void d(S):void d(p)}d(y)},s.registerLanguage(i),u=i.languageTag,n.exports=s},{"./en-US":2,"./parsing":8,"./validating":10}],5:[function(r,n,o){n.exports=function(i){return{loadLanguagesInNode:function(a){return l=i,void a.forEach(function(s){var u=void 0;try{u=r("../languages/".concat(s))}catch{console.error('Unable to load "'.concat(s,'". No matching language file found.'))}u&&l.registerLanguage(u)});var l}}}},{}],6:[function(r,n,o){var i=r("bignumber.js");function a(l,s,u){var f=new i(l._value),c=s;return u.isNumbro(s)&&(c=s._value),c=new i(c),l._value=f.minus(c).toNumber(),l}n.exports=function(l){return{add:function(s,u){return c=u,h=l,d=new i((f=s)._value),v=c,h.isNumbro(c)&&(v=c._value),v=new i(v),f._value=d.plus(v).toNumber(),f;var f,c,h,d,v},subtract:function(s,u){return a(s,u,l)},multiply:function(s,u){return c=u,h=l,d=new i((f=s)._value),v=c,h.isNumbro(c)&&(v=c._value),v=new i(v),f._value=d.times(v).toNumber(),f;var f,c,h,d,v},divide:function(s,u){return c=u,h=l,d=new i((f=s)._value),v=c,h.isNumbro(c)&&(v=c._value),v=new i(v),f._value=d.dividedBy(v).toNumber(),f;var f,c,h,d,v},set:function(s,u){return f=s,h=c=u,l.isNumbro(c)&&(h=c._value),f._value=h,f;var f,c,h},difference:function(s,u){return f=u,a(h=(c=l)(s._value),f,c),Math.abs(h._value);var f,c,h}}}},{"bignumber.js":1}],7:[function(r,n,o){function i(p,w){for(var S=0;S<w.length;S++){var C=w[S];C.enumerable=C.enumerable||!1,C.configurable=!0,"value"in C&&(C.writable=!0),Object.defineProperty(p,C.key,C)}}var a=r("./globalState"),l=r("./validating"),s=r("./loading")(y),u=r("./unformatting"),f=r("./formatting")(y),c=r("./manipulating")(y),h=r("./parsing"),d=function(){function p(C){(function(P,R){if(!(P instanceof R))throw new TypeError("Cannot call a class as a function")})(this,p),this._value=C}var w,S;return w=p,(S=[{key:"clone",value:function(){return y(this._value)}},{key:"format",value:function(){var C=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{};return f.format(this,C)}},{key:"formatCurrency",value:function(C){return typeof C=="string"&&(C=h.parseFormat(C)),(C=f.formatOrDefault(C,a.currentCurrencyDefaultFormat())).output="currency",f.format(this,C)}},{key:"formatTime",value:function(){var C=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{};return C.output="time",f.format(this,C)}},{key:"binaryByteUnits",value:function(){return f.getBinaryByteUnit(this)}},{key:"decimalByteUnits",value:function(){return f.getDecimalByteUnit(this)}},{key:"byteUnits",value:function(){return f.getByteUnit(this)}},{key:"difference",value:function(C){return c.difference(this,C)}},{key:"add",value:function(C){return c.add(this,C)}},{key:"subtract",value:function(C){return c.subtract(this,C)}},{key:"multiply",value:function(C){return c.multiply(this,C)}},{key:"divide",value:function(C){return c.divide(this,C)}},{key:"set",value:function(C){return c.set(this,v(C))}},{key:"value",value:function(){return this._value}},{key:"valueOf",value:function(){return this._value}}])&&i(w.prototype,S),p}();function v(p){var w=p;return y.isNumbro(p)?w=p._value:typeof p=="string"?w=y.unformat(p):isNaN(p)&&(w=NaN),w}function y(p){return new d(v(p))}y.version="2.1.2",y.isNumbro=function(p){return p instanceof d},y.language=a.currentLanguage,y.registerLanguage=a.registerLanguage,y.setLanguage=a.setLanguage,y.languages=a.languages,y.languageData=a.languageData,y.zeroFormat=a.setZeroFormat,y.defaultFormat=a.currentDefaults,y.setDefaults=a.setDefaults,y.defaultCurrencyFormat=a.currentCurrencyDefaultFormat,y.validate=l.validate,y.loadLanguagesInNode=s.loadLanguagesInNode,y.unformat=u.unformat,n.exports=y},{"./formatting":3,"./globalState":4,"./loading":5,"./manipulating":6,"./parsing":8,"./unformatting":9,"./validating":10}],8:[function(r,n,o){n.exports={parseFormat:function(i){var a,l,s,u,f,c,h,d,v,y,p,w,S,C,P,R,W,Y,q,G,X=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{};return typeof i!="string"?i:(l=X,i=(s=(a=i).match(/^{([^}]*)}/))?(l.prefix=s[1],a.slice(s[0].length)):a,f=X,function(Q,oe){if(Q.indexOf("$")===-1){if(Q.indexOf("%")===-1)return Q.indexOf("bd")!==-1?(oe.output="byte",oe.base="general"):Q.indexOf("b")!==-1?(oe.output="byte",oe.base="binary"):Q.indexOf("d")!==-1?(oe.output="byte",oe.base="decimal"):Q.indexOf(":")===-1?Q.indexOf("o")!==-1&&(oe.output="ordinal"):oe.output="time";oe.output="percent"}else oe.output="currency"}(i=(c=(u=i).match(/{([^}]*)}$/))?(f.postfix=c[1],u.slice(0,-c[0].length)):u,X),h=X,(d=i.match(/[1-9]+[0-9]*/))&&(h.totalLength=+d[0]),v=X,(y=i.split(".")[0].match(/0+/))&&(v.characteristic=y[0].length),function(Q,oe){if(Q.indexOf(".")!==-1){var J=Q.split(".")[0];oe.optionalCharacteristic=J.indexOf("0")===-1}}(i,X),p=X,i.indexOf("a")!==-1&&(p.average=!0),S=X,(w=i).indexOf("K")!==-1?S.forceAverage="thousand":w.indexOf("M")!==-1?S.forceAverage="million":w.indexOf("B")!==-1?S.forceAverage="billion":w.indexOf("T")!==-1&&(S.forceAverage="trillion"),function(Q,oe){var J=Q.split(".")[1];if(J){var ue=J.match(/0+/);ue&&(oe.mantissa=ue[0].length)}}(i,X),P=X,(C=i).match(/\[\.]/)?P.optionalMantissa=!0:C.match(/\./)&&(P.optionalMantissa=!1),R=X,i.indexOf(",")!==-1&&(R.thousandSeparated=!0),W=X,i.indexOf(" ")!==-1&&(W.spaceSeparated=!0),q=X,(Y=i).match(/^\+?\([^)]*\)$/)&&(q.negative="parenthesis"),Y.match(/^\+?-/)&&(q.negative="sign"),G=X,i.match(/^\+/)&&(G.forceSign=!0),X)}}},{}],9:[function(r,n,o){var i=[{key:"ZiB",factor:Math.pow(1024,7)},{key:"ZB",factor:Math.pow(1e3,7)},{key:"YiB",factor:Math.pow(1024,8)},{key:"YB",factor:Math.pow(1e3,8)},{key:"TiB",factor:Math.pow(1024,4)},{key:"TB",factor:Math.pow(1e3,4)},{key:"PiB",factor:Math.pow(1024,5)},{key:"PB",factor:Math.pow(1e3,5)},{key:"MiB",factor:Math.pow(1024,2)},{key:"MB",factor:Math.pow(1e3,2)},{key:"KiB",factor:Math.pow(1024,1)},{key:"KB",factor:Math.pow(1e3,1)},{key:"GiB",factor:Math.pow(1024,3)},{key:"GB",factor:Math.pow(1e3,3)},{key:"EiB",factor:Math.pow(1024,6)},{key:"EB",factor:Math.pow(1e3,6)},{key:"B",factor:1}];function a(s){return s.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&")}function l(s,u){var f=2<arguments.length&&arguments[2]!==void 0?arguments[2]:"",c=3<arguments.length?arguments[3]:void 0,h=4<arguments.length?arguments[4]:void 0,d=5<arguments.length?arguments[5]:void 0,v=6<arguments.length?arguments[6]:void 0;if(s!=="")return s===h?0:function y(p,w){var S=2<arguments.length&&arguments[2]!==void 0?arguments[2]:"",C=3<arguments.length?arguments[3]:void 0,P=4<arguments.length?arguments[4]:void 0,R=5<arguments.length?arguments[5]:void 0,W=6<arguments.length?arguments[6]:void 0;if(!isNaN(+p))return+p;var Y="",q=p.replace(/(^[^(]*)\((.*)\)([^)]*$)/,"$1$2$3");if(q!==p)return-1*y(q,w,S,C,P,R,W);for(var G=0;G<i.length;G++){var X=i[G];if((Y=p.replace(X.key,""))!==p)return y(Y,w,S,C,P,R,W)*X.factor}if((Y=p.replace("%",""))!==p)return y(Y,w,S,C,P,R,W)/100;var Q=parseFloat(p);if(!isNaN(Q)){var oe=C(Q);if(oe&&oe!=="."&&(Y=p.replace(new RegExp("".concat(a(oe),"$")),""))!==p)return y(Y,w,S,C,P,R,W);var J={};Object.keys(R).forEach(function(g){J[R[g]]=g});for(var ue=Object.keys(J).sort().reverse(),de=ue.length,Oe=0;Oe<de;Oe++){var be=ue[Oe],$=J[be];if((Y=p.replace(be,""))!==p){var k=void 0;switch($){case"thousand":k=Math.pow(10,3);break;case"million":k=Math.pow(10,6);break;case"billion":k=Math.pow(10,9);break;case"trillion":k=Math.pow(10,12)}return y(Y,w,S,C,P,R,W)*k}}}}(function(y,p){var w=2<arguments.length&&arguments[2]!==void 0?arguments[2]:"",S=y.replace(w,"");return S=(S=S.replace(new RegExp("([0-9])".concat(a(p.thousands),"([0-9])"),"g"),"$1$2")).replace(p.decimal,".")}(s,u,f),u,f,c,h,d,v)}n.exports={unformat:function(s,u){var f,c,h,d=r("./globalState"),v=d.currentDelimiters(),y=d.currentCurrency().symbol,p=d.currentOrdinal(),w=d.getZeroFormat(),S=d.currentAbbreviations(),C=void 0;if(typeof s=="string")C=function(P,R){if(!P.indexOf(":")||R.thousands===":")return!1;var W=P.split(":");if(W.length!==3)return!1;var Y=+W[0],q=+W[1],G=+W[2];return!isNaN(Y)&&!isNaN(q)&&!isNaN(G)}(s,v)?(f=s.split(":"),c=+f[0],h=+f[1],+f[2]+60*h+3600*c):l(s,v,y,p,w,S,u);else{if(typeof s!="number")return;C=s}if(C!==void 0)return C}}},{"./globalState":4}],10:[function(r,n,o){function i(v){return function(y){if(Array.isArray(y)){for(var p=0,w=new Array(y.length);p<y.length;p++)w[p]=y[p];return w}}(v)||function(y){if(Symbol.iterator in Object(y)||Object.prototype.toString.call(y)==="[object Arguments]")return Array.from(y)}(v)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function a(v){return(a=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(y){return typeof y}:function(y){return y&&typeof Symbol=="function"&&y.constructor===Symbol&&y!==Symbol.prototype?"symbol":typeof y})(v)}var l=r("./unformatting"),s=/^[a-z]{2,3}(-[a-zA-Z]{4})?(-([A-Z]{2}|[0-9]{3}))?$/,u={output:{type:"string",validValues:["currency","percent","byte","time","ordinal","number"]},base:{type:"string",validValues:["decimal","binary","general"],restriction:function(v,y){return y.output==="byte"},message:"`base` must be provided only when the output is `byte`",mandatory:function(v){return v.output==="byte"}},characteristic:{type:"number",restriction:function(v){return 0<=v},message:"value must be positive"},prefix:"string",postfix:"string",forceAverage:{type:"string",validValues:["trillion","billion","million","thousand"]},average:"boolean",currencyPosition:{type:"string",validValues:["prefix","infix","postfix"]},currencySymbol:"string",totalLength:{type:"number",restrictions:[{restriction:function(v){return 0<=v},message:"value must be positive"},{restriction:function(v,y){return!y.exponential},message:"`totalLength` is incompatible with `exponential`"}]},mantissa:{type:"number",restriction:function(v){return 0<=v},message:"value must be positive"},optionalMantissa:"boolean",trimMantissa:"boolean",optionalCharacteristic:"boolean",thousandSeparated:"boolean",spaceSeparated:"boolean",abbreviations:{type:"object",children:{thousand:"string",million:"string",billion:"string",trillion:"string"}},negative:{type:"string",validValues:["sign","parenthesis"]},forceSign:"boolean",exponential:{type:"boolean"},prefixSymbol:{type:"boolean",restriction:function(v,y){return y.output==="percent"},message:"`prefixSymbol` can be provided only when the output is `percent`"}},f={languageTag:{type:"string",mandatory:!0,restriction:function(v){return v.match(s)},message:"the language tag must follow the BCP 47 specification (see https://tools.ieft.org/html/bcp47)"},delimiters:{type:"object",children:{thousands:"string",decimal:"string",thousandsSize:"number"},mandatory:!0},abbreviations:{type:"object",children:{thousand:{type:"string",mandatory:!0},million:{type:"string",mandatory:!0},billion:{type:"string",mandatory:!0},trillion:{type:"string",mandatory:!0}},mandatory:!0},spaceSeparated:"boolean",ordinal:{type:"function",mandatory:!0},currency:{type:"object",children:{symbol:"string",position:"string",code:"string"},mandatory:!0},defaults:"format",ordinalFormat:"format",byteFormat:"format",percentageFormat:"format",currencyFormat:"format",timeDefaults:"format",formats:{type:"object",children:{fourDigits:{type:"format",mandatory:!0},fullWithTwoDecimals:{type:"format",mandatory:!0},fullWithTwoDecimalsNoCurrency:{type:"format",mandatory:!0},fullWithNoDecimals:{type:"format",mandatory:!0}}}};function c(v){return!!l.unformat(v)}function h(v,y,p){var w=3<arguments.length&&arguments[3]!==void 0&&arguments[3],S=Object.keys(v).map(function(C){if(!y[C])return console.error("".concat(p," Invalid key: ").concat(C)),!1;var P=v[C],R=y[C];if(typeof R=="string"&&(R={type:R}),R.type==="format"){if(!h(P,u,"[Validate ".concat(C,"]"),!0))return!1}else if(a(P)!==R.type)return console.error("".concat(p," ").concat(C,' type mismatched: "').concat(R.type,'" expected, "').concat(a(P),'" provided')),!1;if(R.restrictions&&R.restrictions.length)for(var W=R.restrictions.length,Y=0;Y<W;Y++){var q=R.restrictions[Y],G=q.restriction,X=q.message;if(!G(P,v))return console.error("".concat(p," ").concat(C," invalid value: ").concat(X)),!1}return R.restriction&&!R.restriction(P,v)?(console.error("".concat(p," ").concat(C," invalid value: ").concat(R.message)),!1):R.validValues&&R.validValues.indexOf(P)===-1?(console.error("".concat(p," ").concat(C," invalid value: must be among ").concat(JSON.stringify(R.validValues),', "').concat(P,'" provided')),!1):!(R.children&&!h(P,R.children,"[Validate ".concat(C,"]")))});return w||S.push.apply(S,i(Object.keys(y).map(function(C){var P=y[C];if(typeof P=="string"&&(P={type:P}),P.mandatory){var R=P.mandatory;if(typeof R=="function"&&(R=R(v)),R&&v[C]===void 0)return console.error("".concat(p,' Missing mandatory key "').concat(C,'"')),!1}return!0}))),S.reduce(function(C,P){return C&&P},!0)}function d(v){return h(v,u,"[Validate format]")}n.exports={validate:function(v,y){var p=c(v),w=d(y);return p&&w},validateFormat:d,validateInput:c,validateLanguage:function(v){return h(v,f,"[Validate language]")}}},{"./unformatting":9}]},{},[7])(7)})})(r2);var xOe=r2.exports;const Ni=hL(xOe);var DOe="numeric";function NT(e,t,r,n,o,i,a){var l=i;if(Cr(l)){var s=a.numericFormat,u=s&&s.culture||"-",f=s&&s.pattern,c=a.className||"",h=c.length?c.split(" "):[];if(typeof u<"u"&&!Ni.languages()[u]){var d=u.replace("-",""),v=Ni.allLanguages?Ni.allLanguages[u]:Ni[d];v&&Ni.registerLanguage(v)}Ni.setLanguage(u),l=Ni(l).format(f||"0"),h.indexOf("htLeft")<0&&h.indexOf("htCenter")<0&&h.indexOf("htRight")<0&&h.indexOf("htJustify")<0&&h.push("htRight"),h.indexOf("htNumeric")<0&&h.push("htNumeric"),a.className=h.join(" "),t.dir="ltr"}Ei(e,t,r,n,o,l,a)}NT.RENDERER_TYPE=DOe;var NOe="password";function HT(e,t,r,n,o,i,a){Ei.apply(this,[e,t,r,n,o,i,a]);var l=a.hashLength||t.innerHTML.length,s=a.hashSymbol||"*",u="";_e(l-1,function(){u+=s}),vf(t,u)}HT.RENDERER_TYPE=NOe;var HOe="time";function LT(e,t,r,n,o,i,a){Ei.apply(this,[e,t,r,n,o,i,a]),t.dir="ltr"}LT.RENDERER_TYPE=HOe;function LOe(){Zn(bf),Zn(hv),Zn(xT),Zn(MT),Zn(NT),Zn(HT),Zn(Ei),Zn(LT)}var jOe="autocomplete";function Tp(e,t){var r=e;if(r==null&&(r=""),this.allowEmpty&&r===""){t(!0);return}this.strict&&this.source?typeof this.source=="function"?this.source(r,WM(r,t)):WM(r,t)(this.source):t(!0)}Tp.VALIDATOR_TYPE=jOe;function WM(e,t){var r=e;return function(n){for(var o=!1,i=0,a=n.length;i<a;i++)if(r===n[i]){o=!0;break}t(o)}}var FOe=Object.is||function(t,r){return t===r?t!==0||1/t===1/r:t!=t&&r!=r},BOe=Ut,VOe=Ym,WOe=Mt,UOe=dn,zOe=Or,UM=FOe,zM=Ft,YOe=Wa,GOe=Gm;VOe("search",function(e,t,r){return[function(o){var i=zOe(this),a=UOe(o)?void 0:YOe(o,e);return a?BOe(a,o,i):new RegExp(o)[e](zM(i))},function(n){var o=WOe(this),i=zM(n),a=r(t,o,i);if(a.done)return a.value;var l=o.lastIndex;UM(l,0)||(o.lastIndex=0);var s=GOe(o,i);return UM(o.lastIndex,l)||(o.lastIndex=l),s===null?-1:s.index}]});function KOe(e){var t=new Date(e);return isNaN(new Date("".concat(e,"T00:00")).getDate())?t:new Date(t.getTime()+t.getTimezoneOffset()*6e4)}var qOe="date";function jT(e,t){var r=XB(XW,this.instance),n=e,o=!0;n==null&&(n="");var i=ee(n,this.dateFormat||r.defaultDateFormat,!0).isValid(),a=ee(new Date(n)).isValid()||i;if(this.allowEmpty&&n===""&&(a=!0,i=!0),a||(o=!1),!a&&i&&(o=!0),a&&!i)if(this.correctFormat===!0){var l=XOe(n,this.dateFormat),s=this.instance.toVisualRow(this.row),u=this.instance.toVisualColumn(this.col);this.instance.setDataAtCell(s,u,l,"dateValidator"),o=!0}else o=!1;t(o)}jT.VALIDATOR_TYPE=qOe;function XOe(e,t){var r=ee(KOe(e)),n=ee(e,t),o=e.search(/[A-z]/g)>-1,i;return r.isValid()&&r.format("x")===n.format("x")||!n.isValid()||o?i=r:i=n,i.format(t)}var ZOe="numeric";function FT(e,t){var r=e;r==null&&(r=""),this.allowEmpty&&r===""?t(!0):t(r===""?!1:Cr(e))}FT.VALIDATOR_TYPE=ZOe;var QOe=["YYYY-MM-DDTHH:mm:ss.SSSZ","X","x"],JOe="time";function BT(e,t){var r=this.timeFormat||"h:mm:ss a",n=!0,o=e;o===null&&(o=""),o=/^\d{3,}$/.test(o)?parseInt(o,10):o;var i=/^\d{1,2}$/.test(o);i&&(o+=":00");var a=ee(o,QOe,!0).isValid()?ee(o):ee(o,r),l=a.isValid(),s=ee(o,r,!0).isValid()&&!i;if(this.allowEmpty&&o===""&&(l=!0,s=!0),l||(n=!1),!l&&s&&(n=!0),l&&!s)if(this.correctFormat===!0){var u=a.format(r),f=this.instance.toVisualRow(this.row),c=this.instance.toVisualColumn(this.col);this.instance.setDataAtCell(f,c,u,"timeValidator"),n=!0}else n=!1;t(n)}BT.VALIDATOR_TYPE=JOe;function eRe(){rc(Tp),rc(jT),rc(FT),rc(BT)}var tRe="autocomplete",rRe={CELL_TYPE:tRe,editor:AT,renderer:bf,validator:Tp},nRe="checkbox",oRe={CELL_TYPE:nRe,editor:KW,renderer:xT},iRe="date",aRe={CELL_TYPE:iRe,editor:ZW,renderer:bf,validator:jT},lRe="dropdown",sRe={CELL_TYPE:lRe,editor:IT,renderer:bf,validator:Tp},uRe="handsontable",fRe={CELL_TYPE:uRe,editor:$T,renderer:bf},cRe="numeric",hRe={CELL_TYPE:cRe,editor:QW,renderer:NT,validator:FT,dataType:"number"},dRe="password",vRe={CELL_TYPE:dRe,editor:JW,renderer:HT,copyable:!1},yRe="time",gRe={CELL_TYPE:yRe,editor:e2,renderer:LT,validator:BT};function mRe(){Rn(rRe),Rn(oRe),Rn(aRe),Rn(sRe),Rn(fRe),Rn(hRe),Rn(vRe),Rn(WW),Rn(gRe)}var pRe=Fm,bRe=FB;pRe("WeakSet",function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}},bRe);function Hh(e){"@babel/helpers - typeof";return Hh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Hh(e)}function wRe(e,t){return ORe(e)||_Re(e,t)||CRe(e,t)||SRe()}function SRe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function CRe(e,t){if(e){if(typeof e=="string")return YM(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return YM(e,t)}}function YM(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _Re(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function ORe(e){if(Array.isArray(e))return e}function RRe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function GM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,TRe(n.key),n)}}function ERe(e,t,r){return t&&GM(e.prototype,t),r&&GM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function TRe(e){var t=kRe(e,"string");return Hh(t)==="symbol"?t:String(t)}function kRe(e,t){if(Hh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Hh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function PRe(e,t){$Re(e,t),t.add(e)}function $Re(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ARe(e,t,r){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return r}var KM=new Map([["plugin",nse],["cell-type",MW],["editor",qB],["renderer",sV],["validator",uV]]),IRe="base",Hi=new WeakMap,ww=[],bn=null,qM=new WeakSet,it=function(){function e(t){var r=this;RRe(this,e),PRe(this,qM),Lo(this,"hot",t,{writable:!1}),Hi.set(this,{hooks:{}}),bn=null,this.pluginName=null,this.pluginsInitializedCallbacks=[],this.isPluginsReady=!1,this.enabled=!1,this.initialized=!1,this.hot.addHook("afterPluginsInitialized",function(){return r.onAfterPluginsInitialized()}),this.hot.addHook("afterUpdateSettings",function(n){return r.onUpdateSettings(n)}),this.hot.addHook("beforeInit",function(){return r.init()})}return ERe(e,[{key:"init",value:function(){var r=this;this.pluginName=this.hot.getPluginName(this);var n=this.constructor.PLUGIN_DEPS,o=Array.isArray(n)?n:[];if(o.length>0){var i=[];if(o.forEach(function(u){var f=u.split(":"),c=wRe(f,2),h=c[0],d=c[1];if(!KM.has(h))throw new Error('Unknown plugin dependency type "'.concat(h,'" was found.'));KM.get(h)(d)||i.push(" - ".concat(d," (").concat(h,")"))}),i.length>0){var a=["The ".concat(this.pluginName,` plugin requires the following modules:
`),"".concat(i.join(`
`),`
`)].join("");ww.push(a)}}bn||(bn=lV()),bn.indexOf("UndoRedo")>=0&&bn.splice(bn.indexOf("UndoRedo"),1),bn.indexOf(this.pluginName)>=0&&bn.splice(bn.indexOf(this.pluginName),1),this.hot.addHookOnce("afterPluginsInitialized",function(){r.isEnabled&&r.isEnabled()&&r.enablePlugin()});var l=bn.length===0;if(l){if(ww.length>0){var s=["".concat(ww.join(`
`),`
`),"You have to import and register them manually."].join("");throw new Error(s)}this.hot.runHooks("afterPluginsInitialized")}this.initialized=!0}},{key:"enablePlugin",value:function(){this.enabled=!0}},{key:"disablePlugin",value:function(){this.eventManager&&this.eventManager.clear(),this.clearHooks(),this.enabled=!1}},{key:"addHook",value:function(r,n){Hi.get(this).hooks[r]=Hi.get(this).hooks[r]||[];var o=Hi.get(this).hooks[r];this.hot.addHook(r,n),o.push(n),Hi.get(this).hooks[r]=o}},{key:"removeHooks",value:function(r){var n=this;I(Hi.get(this).hooks[r]||[],function(o){n.hot.removeHook(r,o)})}},{key:"clearHooks",value:function(){var r=this,n=Hi.get(this).hooks;Ke(n,function(o,i){return r.removeHooks(i)}),n.length=0}},{key:"callOnPluginsReady",value:function(r){this.isPluginsReady?r():this.pluginsInitializedCallbacks.push(r)}},{key:"onAfterPluginsInitialized",value:function(){I(this.pluginsInitializedCallbacks,function(r){return r()}),this.pluginsInitializedCallbacks.length=0,this.isPluginsReady=!0}},{key:"onUpdateSettings",value:function(r){var n=ARe(this,qM,MRe).call(this,r);this.isEnabled&&(this.enabled&&!this.isEnabled()&&this.disablePlugin(),!this.enabled&&this.isEnabled()&&this.enablePlugin(),this.enabled&&this.isEnabled()&&n&&this.updatePlugin(r))}},{key:"updatePlugin",value:function(){}},{key:"destroy",value:function(){var r=this;this.eventManager&&this.eventManager.destroy(),this.clearHooks(),Ke(this,function(n,o){o!=="hot"&&(r[o]=null)}),delete this.t,delete this.hot}}],[{key:"PLUGIN_KEY",get:function(){return IRe}},{key:"SETTING_KEYS",get:function(){return[this.PLUGIN_KEY]}}]),e}();function MRe(e){if(!e)return!1;var t=this.constructor.SETTING_KEYS;if(typeof t=="boolean")return t;for(var r=0;r<t.length;r++)if(e[t[r]]!==void 0)return!0;return!1}function Lh(e){"@babel/helpers - typeof";return Lh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Lh(e)}function xRe(e,t){return LRe(e)||HRe(e,t)||NRe(e,t)||DRe()}function DRe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function NRe(e,t){if(e){if(typeof e=="string")return XM(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return XM(e,t)}}function XM(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function HRe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function LRe(e){if(Array.isArray(e))return e}function jRe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ZM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,BRe(n.key),n)}}function FRe(e,t,r){return t&&ZM(e.prototype,t),r&&ZM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function BRe(e){var t=VRe(e,"string");return Lh(t)==="symbol"?t:String(t)}function VRe(e,t){if(Lh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Lh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var WRe=function(){function e(t){jRe(this,e),this.hot=t,this.container=null,this.injected=!1,this.rows=[],this.columns=[],this.samples=null,this.settings={useHeaders:!0}}return FRe(e,[{key:"addRow",value:function(r,n){if(this.columns.length)throw new Error("Doesn't support multi-dimensional table");this.rows.length||(this.container=this.createContainer(this.hot.rootElement.className));var o={row:r};this.rows.push(o),this.samples=n,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.table.tr.appendChild(this.createRow(r)),this.container.container.appendChild(this.table.fragment),o.table=this.table.table}},{key:"addColumnHeadersRow",value:function(r){var n=this.hot.getColHeader(0);if(n!=null){var o={row:-1};this.rows.push(o),this.container=this.createContainer(this.hot.rootElement.className),this.samples=r,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.appendColumnHeadersRow(),this.container.container.appendChild(this.table.fragment),o.table=this.table.table}}},{key:"addColumn",value:function(r,n){if(this.rows.length)throw new Error("Doesn't support multi-dimensional table");this.columns.length||(this.container=this.createContainer(this.hot.rootElement.className));var o={col:r};this.columns.push(o),this.samples=n,this.table=this.createTable(this.hot.table.className),this.getSetting("useHeaders")&&this.hot.getColHeader(r)!==null&&this.hot.view.appendColHeader(r,this.table.th),this.table.tBody.appendChild(this.createCol(r)),this.container.container.appendChild(this.table.fragment),o.table=this.table.table}},{key:"getHeights",value:function(r){this.injected||this.injectTable(),I(this.rows,function(n){r(n.row,Tt(n.table)-1)})}},{key:"getWidths",value:function(r){this.injected||this.injectTable(),I(this.columns,function(n){var o=n.table.getBoundingClientRect(),i=o.width;r(n.col,Math.ceil(i))})}},{key:"setSettings",value:function(r){this.settings=r}},{key:"setSetting",value:function(r,n){this.settings||(this.settings={}),this.settings[r]=n}},{key:"getSettings",value:function(){return this.settings}},{key:"getSetting",value:function(r){return this.settings?this.settings[r]:null}},{key:"createColGroupsCol",value:function(){var r=this,n=this.hot.rootDocument.createDocumentFragment();return this.hot.hasRowHeaders()&&n.appendChild(this.createColElement(-1)),this.samples.forEach(function(o){I(o.strings,function(i){n.appendChild(r.createColElement(i.col))})}),n}},{key:"createRow",value:function(r){var n=this,o=this.hot.rootDocument,i=o.createDocumentFragment(),a=o.createElement("th");return this.hot.hasRowHeaders()&&(this.hot.view.appendRowHeader(r,a),i.appendChild(a)),this.samples.forEach(function(l){I(l.strings,function(s){var u=s.col,f=n.hot.getCellMeta(r,u);f.col=u,f.row=r;var c=n.hot.getCellRenderer(f),h=o.createElement("td");h.setAttribute("ghost-table",1),c(n.hot,h,r,u,n.hot.colToProp(u),s.value,f),i.appendChild(h)})}),i}},{key:"appendColumnHeadersRow",value:function(){var r=this,n=this.hot.rootDocument,o=n.createDocumentFragment(),i=[];if(this.hot.hasRowHeaders()){var a=n.createElement("th");i.push([-1,a]),o.appendChild(a)}this.samples.forEach(function(l){I(l.strings,function(s){var u=s.col,f=n.createElement("th");i.push([u,f]),o.appendChild(f)})}),this.table.tHead.appendChild(o),I(i,function(l){var s=xRe(l,2),u=s[0],f=s[1];r.hot.view.appendColHeader(u,f)})}},{key:"createCol",value:function(r){var n=this,o=this.hot.rootDocument,i=o.createDocumentFragment();return this.samples.forEach(function(a){I(a.strings,function(l){var s=l.row,u=n.hot.getCellMeta(s,r);u.col=r,u.row=s;var f=n.hot.getCellRenderer(u),c=o.createElement("td"),h=o.createElement("tr");c.setAttribute("ghost-table",1),f(n.hot,c,s,r,n.hot.colToProp(r),l.value,u),h.appendChild(c),i.appendChild(h)})}),i}},{key:"clean",value:function(){this.rows.length=0,this.rows[-1]=void 0,this.columns.length=0,this.samples&&this.samples.clear(),this.samples=null,this.removeTable()}},{key:"injectTable",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;this.injected||((r||this.hot.rootElement).appendChild(this.container.fragment),this.injected=!0)}},{key:"removeTable",value:function(){this.injected&&this.container.container.parentNode&&(this.container.container.parentNode.removeChild(this.container.container),this.container=null,this.injected=!1)}},{key:"createColElement",value:function(r){var n=this.hot.rootDocument.createElement("col");return n.style.width="".concat(this.hot.view._wt.wtTable.getStretchedColumnWidth(r),"px"),n}},{key:"createTable",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",n=this.hot.rootDocument,o=n.createDocumentFragment(),i=n.createElement("table"),a=n.createElement("thead"),l=n.createElement("tbody"),s=n.createElement("colgroup"),u=n.createElement("tr"),f=n.createElement("th");return this.isVertical()&&i.appendChild(s),this.isHorizontal()&&(u.appendChild(f),a.appendChild(u),i.style.tableLayout="auto",i.style.width="auto"),i.appendChild(a),this.isVertical()&&l.appendChild(u),i.appendChild(l),re(i,r),o.appendChild(i),{fragment:o,table:i,tHead:a,tBody:l,colGroup:s,tr:u,th:f}}},{key:"createContainer",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",n=this.hot.rootDocument,o=n.createDocumentFragment(),i=n.createElement("div"),a="htGhostTable htAutoSize ".concat(r.trim());return re(i,a),o.appendChild(i),{fragment:o,container:i}}},{key:"isVertical",value:function(){return!!(this.rows.length&&!this.columns.length)}},{key:"isHorizontal",value:function(){return!!(this.columns.length&&!this.rows.length)}}]),e}();const n2=WRe;function jh(e){"@babel/helpers - typeof";return jh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},jh(e)}function URe(e,t,r){return t=o2(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function zRe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function QM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,o2(n.key),n)}}function YRe(e,t,r){return t&&QM(e.prototype,t),r&&QM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function o2(e){var t=GRe(e,"string");return jh(t)==="symbol"?t:String(t)}function GRe(e,t){if(jh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(jh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var KRe=function(){function e(t){zRe(this,e),this.samples=null,this.dataFactory=t,this.customSampleCount=null,this.allowDuplicates=!1}return YRe(e,[{key:"getSampleCount",value:function(){return this.customSampleCount?this.customSampleCount:e.SAMPLE_COUNT}},{key:"setSampleCount",value:function(r){this.customSampleCount=r}},{key:"setAllowDuplicates",value:function(r){this.allowDuplicates=r}},{key:"generateRowSamples",value:function(r,n){return this.generateSamples("row",n,r)}},{key:"generateColumnSamples",value:function(r,n){return this.generateSamples("col",n,r)}},{key:"generateSamples",value:function(r,n,o){var i=this,a=new Map,l=typeof o=="number"?{from:o,to:o}:o,s=l.from,u=l.to;return _e(s,u,function(f){var c=i.generateSample(r,n,f);a.set(f,c)}),a}},{key:"generateSample",value:function(r,n,o){var i=this;if(r!=="row"&&r!=="col")throw new Error("Unsupported sample type");var a=new Map,l=r==="row"?"col":"row",s=[];return _e(n.from,n.to,function(u){var f=r==="row"?i.dataFactory(o,u):i.dataFactory(u,o),c=f.value,h=f.bundleSeed,d=typeof h=="string"&&h.length>0,v;d?v=h:Ge(c)?v="".concat(Object.keys(c).length):Array.isArray(c)?v="".concat(c.length):v="".concat(Ht(c).length),a.has(v)||a.set(v,{needed:i.getSampleCount(),strings:[]});var y=a.get(v);if(y.needed){var p=s.indexOf(c)>-1;(!p||i.allowDuplicates||d)&&(y.strings.push(URe({value:c},l,u)),s.push(c),y.needed-=1)}}),a}}],[{key:"SAMPLE_COUNT",get:function(){return 3}}]),e}();const i2=KRe;function Xs(e){"@babel/helpers - typeof";return Xs=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Xs(e)}function JM(e,t){return QRe(e)||ZRe(e,t)||XRe(e,t)||qRe()}function qRe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function XRe(e,t){if(e){if(typeof e=="string")return ex(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return ex(e,t)}}function ex(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function ZRe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function QRe(e){if(Array.isArray(e))return e}function JRe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function tx(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,tEe(n.key),n)}}function eEe(e,t,r){return t&&tx(e.prototype,t),r&&tx(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function tEe(e){var t=rEe(e,"string");return Xs(t)==="symbol"?t:String(t)}function rEe(e,t){if(Xs(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Xs(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Zi(){return typeof Reflect<"u"&&Reflect.get?Zi=Reflect.get.bind():Zi=function(t,r,n){var o=nEe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Zi.apply(this,arguments)}function nEe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=ao(e),e!==null););return e}function oEe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&I_(e,t)}function I_(e,t){return I_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},I_(e,t)}function iEe(e){var t=lEe();return function(){var n=ao(e),o;if(t){var i=ao(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return aEe(this,o)}}function aEe(e,t){if(t&&(Xs(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return a2(e)}function a2(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function lEe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function ao(e){return ao=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},ao(e)}ge.getSingleton().register("modifyAutoColumnSizeSeed");var jf="autoColumnSize",sEe=10,Sw=new WeakMap,uEe="autoColumnSize",fEe=function(e){oEe(r,e);var t=iEe(r);function r(n){var o;return JRe(this,r),o=t.call(this,n),Sw.set(a2(o),{cachedColumnHeaders:[]}),o.ghostTable=new n2(o.hot),o.samplesGenerator=new i2(function(i,a){var l=o.hot.getCellMeta(i,a),s="";l.spanned||(s=o.hot.getDataAtCell(i,a));var u="";return o.hot.hasHook("modifyAutoColumnSizeSeed")&&(u=o.hot.runHooks("modifyAutoColumnSizeSeed",u,l,s)),{value:s,bundleSeed:u}}),o.firstCalculation=!0,o.inProgress=!1,o.measuredColumns=0,o.columnWidthsMap=new Ri,o.hot.columnIndexMapper.registerMap(uEe,o.columnWidthsMap),o.addHook("beforeColumnResize",function(i,a,l){return o.onBeforeColumnResize(i,a,l)}),o}return eEe(r,[{key:"isEnabled",value:function(){return this.hot.getSettings()[jf]!==!1&&!this.hot.getSettings().colWidths}},{key:"enablePlugin",value:function(){var o=this;if(!this.enabled){var i=this.hot.getSettings()[jf];i&&i.useHeaders!==null&&i.useHeaders!==void 0&&this.ghostTable.setSetting("useHeaders",i.useHeaders),this.setSamplingOptions(),this.addHook("afterLoadData",function(){return o.onAfterLoadData.apply(o,arguments)}),this.addHook("beforeChangeRender",function(a){return o.onBeforeChange(a)}),this.addHook("afterFormulasValuesUpdate",function(a){return o.onAfterFormulasValuesUpdate(a)}),this.addHook("beforeViewRender",function(a){return o.onBeforeViewRender(a)}),this.addHook("modifyColWidth",function(a,l){return o.getColumnWidth(l,a)}),this.addHook("afterInit",function(){return o.onAfterInit()}),Zi(ao(r.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){var o=this.findColumnsWhereHeaderWasChanged();o.length&&(this.clearCache(o),this.calculateVisibleColumnsWidth()),Zi(ao(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){var o=this;Zi(ao(r.prototype),"disablePlugin",this).call(this),this.addHook("beforeColumnResize",function(i,a,l){return o.onBeforeColumnResize(i,a,l)})}},{key:"calculateVisibleColumnsWidth",value:function(){var o=this.hot.countRows();if(o){var i=this.hot.renderCall,a=this.getFirstVisibleColumn(),l=this.getLastVisibleColumn();a===-1||l===-1||this.calculateColumnsWidth({from:a,to:l},void 0,i)}}},{key:"calculateColumnsWidth",value:function(){var o=this,i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countRows()-1},l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,s=typeof i=="number"?{from:i,to:i}:i,u=typeof a=="number"?{from:a,to:a}:a;_e(s.from,s.to,function(f){var c=o.hot.toPhysicalColumn(f);if(c===null&&(c=f),l||o.columnWidthsMap.getValueAtIndex(c)===null&&!o.hot._getColWidthFromSettings(c)){var h=o.samplesGenerator.generateColumnSamples(f,u);I(h,function(d){var v=JM(d,2),y=v[0],p=v[1];return o.ghostTable.addColumn(y,p)})}}),this.ghostTable.columns.length&&(this.hot.batchExecution(function(){o.ghostTable.getWidths(function(f,c){var h=o.hot.toPhysicalColumn(f);o.columnWidthsMap.setValueAtIndex(h,c)})},!0),this.measuredColumns=s.to+1,this.ghostTable.clean())}},{key:"calculateAllColumnsWidth",value:function(){var o=this,i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},a=0,l=this.hot.countCols()-1,s=null;this.inProgress=!0;var u=function c(){if(!o.hot){Cg(s),o.inProgress=!1;return}o.calculateColumnsWidth({from:a,to:Math.min(a+r.CALCULATION_STEP,l)},i),a=a+r.CALCULATION_STEP+1,a<l?s=uE(c):(Cg(s),o.inProgress=!1,o.hot.view.adjustElementsSize())},f=this.getSyncCalculationLimit();this.firstCalculation&&f>=0&&(this.calculateColumnsWidth({from:0,to:f},i),this.firstCalculation=!1,a=f+1),a<l?u():this.inProgress=!1}},{key:"setSamplingOptions",value:function(){var o=this.hot.getSettings()[jf],i=o&&It(o,"samplingRatio")?o.samplingRatio:void 0,a=o&&It(o,"allowSampleDuplicates")?o.allowSampleDuplicates:void 0;i&&!isNaN(i)&&this.samplesGenerator.setSampleCount(parseInt(i,10)),a&&this.samplesGenerator.setAllowDuplicates(a)}},{key:"recalculateAllColumnsWidth",value:function(){this.hot.view&&this.hot.view._wt.wtTable.isVisible()&&(this.clearCache(),this.calculateAllColumnsWidth())}},{key:"getSyncCalculationLimit",value:function(){var o=this.hot.getSettings()[jf],i=r.SYNC_CALCULATION_LIMIT,a=this.hot.countCols()-1;return Ge(o)&&(i=o.syncLimit,$B(i)?i=eV(a,i):i>>=0),Math.min(i,a)}},{key:"getColumnWidth",value:function(o){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:void 0,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,l=i;return l===void 0&&(l=this.columnWidthsMap.getValueAtIndex(this.hot.toPhysicalColumn(o)),a&&typeof l=="number"&&(l=Math.max(l,BE.DEFAULT_WIDTH))),l}},{key:"getFirstVisibleColumn",value:function(){var o=this.hot.view._wt;if(o.wtViewport.columnsVisibleCalculator){var i=o.wtTable.getFirstVisibleColumn();if(i!==-1)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(i)}if(o.wtViewport.columnsRenderCalculator){var a=o.wtTable.getFirstRenderedColumn();if(a!==-1)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(a)}return-1}},{key:"getLastVisibleColumn",value:function(){var o=this.hot.view._wt;if(o.wtViewport.columnsVisibleCalculator){var i=o.wtTable.getLastVisibleColumn();if(i!==-1)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(i)}if(o.wtViewport.columnsRenderCalculator){var a=o.wtTable.getLastRenderedColumn();if(a!==-1)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(a)}return-1}},{key:"findColumnsWhereHeaderWasChanged",value:function(){var o=this.hot.getColHeader(),i=Sw.get(this),a=i.cachedColumnHeaders,l=nr(o,function(s,u,f){var c=a.length;return(c-1<f||a[f]!==u)&&s.push(f),c-1<f?a.push(u):a[f]=u,s},[]);return l}},{key:"clearCache",value:function(){var o=this,i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];i.length?this.hot.batchExecution(function(){I(i,function(a){o.columnWidthsMap.setValueAtIndex(a,null)})},!0):this.columnWidthsMap.clear()}},{key:"isNeedRecalculate",value:function(){return!!Yr(this.columnWidthsMap.getValues().slice(0,this.measuredColumns),function(o){return o===null}).length}},{key:"onBeforeViewRender",value:function(){this.calculateVisibleColumnsWidth(),this.isNeedRecalculate()&&!this.inProgress&&this.calculateAllColumnsWidth()}},{key:"onAfterLoadData",value:function(){var o=this;this.hot.view?this.recalculateAllColumnsWidth():setTimeout(function(){o.hot&&o.recalculateAllColumnsWidth()},0)}},{key:"onBeforeChange",value:function(o){var i=this,a=Ye(o,function(l){var s=JM(l,2),u=s[1];return i.hot.toPhysicalColumn(i.hot.propToCol(u))});this.clearCache(Array.from(new Set(a)))}},{key:"onBeforeColumnResize",value:function(o,i,a){var l=o;return a&&(this.calculateColumnsWidth(i,void 0,!0),l=this.getColumnWidth(i,void 0,!1)),l}},{key:"onAfterInit",value:function(){Sw.get(this).cachedColumnHeaders=this.hot.getColHeader()}},{key:"onAfterFormulasValuesUpdate",value:function(o){var i=Yr(o,function(l){var s;return ye((s=l.address)===null||s===void 0?void 0:s.col)}),a=Ye(i,function(l){return l.address.col});this.clearCache(Array.from(new Set(a)))}},{key:"destroy",value:function(){this.ghostTable.clean(),Zi(ao(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return jf}},{key:"PLUGIN_PRIORITY",get:function(){return sEe}},{key:"SETTING_KEYS",get:function(){return!0}},{key:"CALCULATION_STEP",get:function(){return 50}},{key:"SYNC_CALCULATION_LIMIT",get:function(){return 50}}]),r}(it),Qi={horizontal:"horizontal",vertical:"vertical"};function cEe(e,t,r){var n,o,i;return t[0]===e[0]&&t[1]<e[1]?(i="left",n=r(t[0],t[1]),o=r(t[2],e[1]-1)):t[2]===e[2]&&t[0]===e[0]&&t[3]>e[3]?(i="right",n=r(t[0],e[3]+1),o=r(t[2],t[3])):t[0]<e[0]&&t[1]===e[1]?(i="up",n=r(t[0],t[1]),o=r(e[0]-1,t[3])):t[2]>e[2]&&t[1]===e[1]&&(i="down",n=r(e[2]+1,t[1]),o=r(t[2],t[3])),n&&n.normalize(),o&&o.normalize(),{directionOfDrag:i,startOfDragCoords:n,endOfDragCoords:o}}function hEe(e){var t={};return e===!0?(t.directions=Object.keys(Qi),t.autoInsertRow=!0):Ge(e)?(ye(e.autoInsertRow)?e.direction===Qi.horizontal?t.autoInsertRow=!1:t.autoInsertRow=e.autoInsertRow:t.autoInsertRow=!1,ye(e.direction)?t.directions=[e.direction]:t.directions=Object.keys(Qi)):typeof e=="string"?(t.directions=[e],t.autoInsertRow=!0):(t.directions=[],t.autoInsertRow=!1),t}function Zs(e){"@babel/helpers - typeof";return Zs=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Zs(e)}function dEe(e){return gEe(e)||yEe(e)||l2(e)||vEe()}function vEe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function yEe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function gEe(e){if(Array.isArray(e))return M_(e)}function mEe(e,t){return wEe(e)||bEe(e,t)||l2(e,t)||pEe()}function pEe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function l2(e,t){if(e){if(typeof e=="string")return M_(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return M_(e,t)}}function M_(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function bEe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function wEe(e){if(Array.isArray(e))return e}function SEe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function rx(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_Ee(n.key),n)}}function CEe(e,t,r){return t&&rx(e.prototype,t),r&&rx(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _Ee(e){var t=OEe(e,"string");return Zs(t)==="symbol"?t:String(t)}function OEe(e,t){if(Zs(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Zs(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Ji(){return typeof Reflect<"u"&&Reflect.get?Ji=Reflect.get.bind():Ji=function(t,r,n){var o=REe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Ji.apply(this,arguments)}function REe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=lo(e),e!==null););return e}function EEe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&x_(e,t)}function x_(e,t){return x_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},x_(e,t)}function TEe(e){var t=PEe();return function(){var n=lo(e),o;if(t){var i=lo(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return kEe(this,o)}}function kEe(e,t){if(t&&(Zs(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return s2(e)}function s2(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function PEe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function lo(e){return lo=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},lo(e)}ge.getSingleton().register("modifyAutofillRange");ge.getSingleton().register("beforeAutofill");ge.getSingleton().register("afterAutofill");var nx="autofill",$Ee=20,AEe=["fillHandle"],IEe="insert_row_below",MEe=200,xEe=function(e){EEe(r,e);var t=TEe(r);function r(n){var o;return SEe(this,r),o=t.call(this,n),o.eventManager=new Pt(s2(o)),o.addingStarted=!1,o.mouseDownOnCellCorner=!1,o.mouseDragOutside=!1,o.handleDraggedCells=0,o.directions=[],o.autoInsertRow=!1,o}return CEe(r,[{key:"isEnabled",value:function(){return this.hot.getSettings().fillHandle}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.mapSettings(),this.registerEvents(),this.addHook("afterOnCellCornerMouseDown",function(i){return o.onAfterCellCornerMouseDown(i)}),this.addHook("afterOnCellCornerDblClick",function(i){return o.onCellCornerDblClick(i)}),this.addHook("beforeOnCellMouseOver",function(i,a){return o.onBeforeCellMouseOver(a)}),Ji(lo(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),Ji(lo(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.clearMappedSettings(),Ji(lo(r.prototype),"disablePlugin",this).call(this)}},{key:"getSelectionData",value:function(){var o=this,i=this.hot.getSelectedRangeLast(),a=i.getTopStartCorner(),l=a.row,s=a.col,u=i.getBottomEndCorner(),f=u.row,c=u.col,h=this.hot.runHooks("modifyCopyableRange",[{startRow:l,startCol:s,endRow:f,endCol:c}]),d=[],v=[],y=[];return I(h,function(p){for(var w=p.startRow;w<=p.endRow;w+=1)d.indexOf(w)===-1&&d.push(w);for(var S=p.startCol;S<=p.endCol;S+=1)v.indexOf(S)===-1&&v.push(S)}),I(d,function(p){var w=[];I(v,function(S){w.push(o.hot.getCopyableData(p,S))}),y.push(w)}),y}},{key:"fillIn",value:function(){var o=this;if(this.hot.selection.highlight.getFill().isEmpty())return!1;var i=this.hot.selection.highlight.getFill().getVisualCorners(),a=mEe(i,4),l=a[0],s=a[1],u=a[2],f=a[3],c=this.hot.getSelectedRangeLast(),h=c.getTopStartCorner(),d=c.getBottomEndCorner();this.resetSelectionOfDraggedArea();var v=[h.row,h.col,d.row,d.col],y=this.hot.runHooks("modifyAutofillRange",[Math.min(h.row,l),Math.min(h.col,s),Math.max(d.row,u),Math.max(d.col,f)],v),p=cEe(v,y,function(be,$){return o.hot._createCellCoords(be,$)}),w=p.directionOfDrag,S=p.startOfDragCoords,C=p.endOfDragCoords;if(S&&S.row>-1&&S.col>-1){var P=this.getSelectionData(),R=c.clone(),W=this.hot._createCellRange(S,S,C),Y=this.hot.runHooks("beforeAutofill",P,R,W,w);if(Y===!1)return this.hot.selection.highlight.getFill().clear(),this.hot.render(),!1;var q=Y,G=Y;if(["up","left"].indexOf(w)>-1&&!(G.length===1&&G[0].length===0))if(q=[],w==="up")for(var X=C.row-S.row+1,Q=X%G.length,oe=0;oe<X;oe++)q.push(G[(oe+(G.length-Q))%G.length]);else for(var J=C.col-S.col+1,ue=J%G[0].length,de=0;de<G.length;de++){q.push([]);for(var Oe=0;Oe<J;Oe++)q[de].push(G[de][(Oe+(G[de].length-ue))%G[de].length])}this.hot.populateFromArray(S.row,S.col,q,C.row,C.col,"".concat(this.pluginName,".fill"),null),this.setSelection(y),this.hot.runHooks("afterAutofill",q,R,W,w),this.hot.render()}else this.hot._refreshBorders();return!0}},{key:"reduceSelectionAreaIfNeeded",value:function(o){return o.row<0&&(o.row=0),o.col<0&&(o.col=0),o}},{key:"getCoordsOfDragAndDropBorders",value:function(o){var i=this.hot.getSelectedRangeLast(),a=i.getBottomEndCorner(),l=o;if(this.directions.includes(Qi.vertical)&&this.directions.includes(Qi.horizontal)){var s=i.getTopStartCorner();(a.col<=o.col||s.col>=o.col)&&(l=this.hot._createCellCoords(a.row,o.col)),(a.row<o.row||s.row>o.row)&&(l=this.hot._createCellCoords(o.row,a.col))}else if(this.directions.includes(Qi.vertical))l=this.hot._createCellCoords(o.row,a.col);else if(this.directions.includes(Qi.horizontal))l=this.hot._createCellCoords(a.row,o.col);else return;return this.reduceSelectionAreaIfNeeded(l)}},{key:"showBorder",value:function(o){var i=this.getCoordsOfDragAndDropBorders(o);i&&this.redrawBorders(i)}},{key:"addRow",value:function(){var o=this;this.hot._registerTimeout(function(){o.hot.alter(IEe,void 0,1,"".concat(o.pluginName,".fill")),o.addingStarted=!1},MEe)}},{key:"addNewRowIfNeeded",value:function(){if(!this.hot.selection.highlight.getFill().isEmpty()&&this.addingStarted===!1&&this.autoInsertRow){var o=this.hot.getSelectedLast(),i=this.hot.selection.highlight.getFill().getVisualCorners(),a=this.hot.countRows();o[2]<a-1&&i[2]===a-1&&(this.addingStarted=!0,this.addRow())}}},{key:"getIndexOfLastAdjacentFilledInRow",value:function(o){for(var i=this.hot.getData(),a=this.hot.countRows(),l,s=o[2]+1;s<a;s++){for(var u=o[1];u<=o[3];u++){var f=i[s][u];if(f)return-1}var c=i[s][o[1]-1],h=i[s][o[3]+1];(c||h)&&(l=s)}return l}},{key:"addSelectionFromStartAreaToSpecificRowIndex",value:function(o,i){this.hot.selection.highlight.getFill().clear().add(this.hot._createCellCoords(o[0],o[1])).add(this.hot._createCellCoords(i,o[3])).commit()}},{key:"setSelection",value:function(o){var i;(i=this.hot).selectCell.apply(i,dEe(Ye(o,function(a){return Math.max(a,0)})).concat([!1,!1]))}},{key:"selectAdjacent",value:function(){var o=this.hot.getSelectedLast(),i=this.getIndexOfLastAdjacentFilledInRow(o);return i===-1||i===void 0?!1:(this.addSelectionFromStartAreaToSpecificRowIndex(o,i),!0)}},{key:"resetSelectionOfDraggedArea",value:function(){this.handleDraggedCells=0,this.hot.selection.highlight.getFill().clear()}},{key:"redrawBorders",value:function(o){this.hot.selection.highlight.getFill().clear().add(this.hot.getSelectedRangeLast().from).add(this.hot.getSelectedRangeLast().to).add(o).commit(),this.hot.view.render()}},{key:"getIfMouseWasDraggedOutside",value:function(o){var i=this.hot.rootDocument.documentElement,a=Vt(this.hot.table).top-(this.hot.rootWindow.pageYOffset||i.scrollTop)+Tt(this.hot.table),l=Vt(this.hot.table).left-(this.hot.rootWindow.pageXOffset||i.scrollLeft)+ut(this.hot.table);return o.clientY>a&&o.clientX<=l}},{key:"registerEvents",value:function(){var o=this,i=this.hot.rootDocument.documentElement;this.eventManager.addEventListener(i,"mouseup",function(){return o.onMouseUp()}),this.eventManager.addEventListener(i,"mousemove",function(a){return o.onMouseMove(a)})}},{key:"onCellCornerDblClick",value:function(){var o=this.selectAdjacent();o&&this.fillIn()}},{key:"onAfterCellCornerMouseDown",value:function(){this.handleDraggedCells=1,this.mouseDownOnCellCorner=!0}},{key:"onBeforeCellMouseOver",value:function(o){this.mouseDownOnCellCorner&&!this.hot.view.isMouseDown()&&this.handleDraggedCells&&(this.handleDraggedCells+=1,this.showBorder(o),this.addNewRowIfNeeded())}},{key:"onMouseUp",value:function(){this.handleDraggedCells&&(this.handleDraggedCells>1&&this.fillIn(),this.handleDraggedCells=0,this.mouseDownOnCellCorner=!1)}},{key:"onMouseMove",value:function(o){var i=this.getIfMouseWasDraggedOutside(o);this.addingStarted===!1&&this.handleDraggedCells>0&&i?(this.mouseDragOutside=!0,this.addingStarted=!0):this.mouseDragOutside=!1,this.mouseDragOutside&&this.autoInsertRow&&this.addRow()}},{key:"clearMappedSettings",value:function(){this.directions.length=0,this.autoInsertRow=!1}},{key:"mapSettings",value:function(){var o=hEe(this.hot.getSettings().fillHandle);this.directions=o.directions,this.autoInsertRow=o.autoInsertRow}},{key:"destroy",value:function(){Ji(lo(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return nx}},{key:"PLUGIN_PRIORITY",get:function(){return $Ee}},{key:"SETTING_KEYS",get:function(){return[nx].concat(AEe)}}]),r}(it);function Qs(e){"@babel/helpers - typeof";return Qs=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Qs(e)}function DEe(e,t){return jEe(e)||LEe(e,t)||HEe(e,t)||NEe()}function NEe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function HEe(e,t){if(e){if(typeof e=="string")return ox(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return ox(e,t)}}function ox(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function LEe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function jEe(e){if(Array.isArray(e))return e}function FEe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ix(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,VEe(n.key),n)}}function BEe(e,t,r){return t&&ix(e.prototype,t),r&&ix(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function VEe(e){var t=WEe(e,"string");return Qs(t)==="symbol"?t:String(t)}function WEe(e,t){if(Qs(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Qs(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Ul(){return typeof Reflect<"u"&&Reflect.get?Ul=Reflect.get.bind():Ul=function(t,r,n){var o=UEe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Ul.apply(this,arguments)}function UEe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=fi(e),e!==null););return e}function zEe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&D_(e,t)}function D_(e,t){return D_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},D_(e,t)}function YEe(e){var t=qEe();return function(){var n=fi(e),o;if(t){var i=fi(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return GEe(this,o)}}function GEe(e,t){if(t&&(Qs(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return KEe(e)}function KEe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function qEe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function fi(e){return fi=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},fi(e)}var Jv="autoRowSize",XEe=40,ZEe="autoRowSize",QEe=function(e){zEe(r,e);var t=YEe(r);function r(n){var o;return FEe(this,r),o=t.call(this,n),o.rowHeightsMap=void 0,o.headerHeight=null,o.ghostTable=new n2(o.hot),o.samplesGenerator=new i2(function(i,a){var l;return i>=0?l=o.hot.getDataAtCell(i,a):i===-1&&(l=o.hot.getColHeader(a)),{value:l}}),o.firstCalculation=!0,o.inProgress=!1,o.measuredRows=0,o.rowHeightsMap=new Ri,o.hot.rowIndexMapper.registerMap(ZEe,o.rowHeightsMap),o.addHook("beforeRowResize",function(i,a,l){return o.onBeforeRowResize(i,a,l)}),o}return BEe(r,[{key:"isEnabled",value:function(){var o=this.hot.getSettings()[Jv];return o===!0||Ge(o)}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.setSamplingOptions(),this.addHook("afterLoadData",function(){return o.onAfterLoadData.apply(o,arguments)}),this.addHook("beforeChangeRender",function(i){return o.onBeforeChange(i)}),this.addHook("beforeColumnResize",function(){return o.recalculateAllRowsHeight()}),this.addHook("beforeViewRender",function(i){return o.onBeforeViewRender(i)}),this.addHook("modifyRowHeight",function(i,a){return o.getRowHeight(a,i)}),this.addHook("modifyColumnHeaderHeight",function(){return o.getColumnHeaderHeight()}),Ul(fi(r.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){var o=this;this.headerHeight=null,Ul(fi(r.prototype),"disablePlugin",this).call(this),this.addHook("beforeRowResize",function(i,a,l){return o.onBeforeRowResize(i,a,l)})}},{key:"calculateRowsHeight",value:function(){var o=this,i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countCols()-1},l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,s=typeof i=="number"?{from:i,to:i}:i,u=typeof a=="number"?{from:a,to:a}:a;if(this.hot.getColHeader(0)!==null){var f=this.samplesGenerator.generateRowSamples(-1,u);this.ghostTable.addColumnHeadersRow(f.get(-1))}_e(s.from,s.to,function(c){if(l||o.rowHeightsMap.getValueAtIndex(c)===null){var h=o.samplesGenerator.generateRowSamples(c,u);I(h,function(d){var v=DEe(d,2),y=v[0],p=v[1];return o.ghostTable.addRow(y,p)})}}),this.ghostTable.rows.length&&(this.hot.batchExecution(function(){o.ghostTable.getHeights(function(c,h){c<0?o.headerHeight=h:o.rowHeightsMap.setValueAtIndex(o.hot.toPhysicalRow(c),h)})},!0),this.measuredRows=s.to+1,this.ghostTable.clean())}},{key:"calculateAllRowsHeight",value:function(){var o=this,i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},a=0,l=this.hot.countRows()-1,s=null;this.inProgress=!0;var u=function c(){if(!o.hot){Cg(s),o.inProgress=!1;return}o.calculateRowsHeight({from:a,to:Math.min(a+r.CALCULATION_STEP,l)},i),a=a+r.CALCULATION_STEP+1,a<l?s=uE(c):(Cg(s),o.inProgress=!1,o.hot.view.adjustElementsSize(!0),o.hot.view._wt.wtOverlays.inlineStartOverlay.needFullRender&&o.hot.view._wt.wtOverlays.inlineStartOverlay.clone.draw())},f=this.getSyncCalculationLimit();this.firstCalculation&&f>=0&&(this.calculateRowsHeight({from:0,to:f},i),this.firstCalculation=!1,a=f+1),a<l?u():(this.inProgress=!1,this.hot.view.adjustElementsSize(!1))}},{key:"setSamplingOptions",value:function(){var o=this.hot.getSettings()[Jv],i=o&&It(o,"samplingRatio")?o.samplingRatio:void 0,a=o&&It(o,"allowSampleDuplicates")?o.allowSampleDuplicates:void 0;i&&!isNaN(i)&&this.samplesGenerator.setSampleCount(parseInt(i,10)),a&&this.samplesGenerator.setAllowDuplicates(a)}},{key:"recalculateAllRowsHeight",value:function(){Pc(this.hot.view._wt.wtTable.TABLE)&&(this.clearCache(),this.calculateAllRowsHeight())}},{key:"getSyncCalculationLimit",value:function(){var o=this.hot.getSettings()[Jv],i=r.SYNC_CALCULATION_LIMIT,a=this.hot.countRows()-1;return Ge(o)&&(i=o.syncLimit,$B(i)?i=eV(a,i):i>>=0),Math.min(i,a)}},{key:"getRowHeight",value:function(o){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:void 0,a=o<0?this.headerHeight:this.rowHeightsMap.getValueAtIndex(this.hot.toPhysicalRow(o)),l=i;return a!==null&&a>(i||0)&&(l=a),l}},{key:"getColumnHeaderHeight",value:function(){return this.headerHeight}},{key:"getFirstVisibleRow",value:function(){var o=this.hot.view._wt;return o.wtViewport.rowsVisibleCalculator?o.wtTable.getFirstVisibleRow():o.wtViewport.rowsRenderCalculator?o.wtTable.getFirstRenderedRow():-1}},{key:"getLastVisibleRow",value:function(){var o=this.hot.view._wt;return o.wtViewport.rowsVisibleCalculator?o.wtTable.getLastVisibleRow():o.wtViewport.rowsRenderCalculator?o.wtTable.getLastRenderedRow():-1}},{key:"clearCache",value:function(){this.headerHeight=null,this.rowHeightsMap.init()}},{key:"clearCacheByRange",value:function(o){var i=this,a=typeof o=="number"?{from:o,to:o}:o,l=a.from,s=a.to;this.hot.batchExecution(function(){_e(Math.min(l,s),Math.max(l,s),function(u){i.rowHeightsMap.setValueAtIndex(u,null)})},!0)}},{key:"isNeedRecalculate",value:function(){return!!Yr(this.rowHeightsMap.getValues().slice(0,this.measuredRows),function(o){return o===null}).length}},{key:"onBeforeViewRender",value:function(){var o=this.hot.renderCall,i=this.hot.getSettings().fixedRowsBottom,a=this.getFirstVisibleRow(),l=this.getLastVisibleRow();if(!(a===-1||l===-1)){if(this.calculateRowsHeight({from:a,to:l},void 0,o),i){var s=this.hot.countRows()-1;this.calculateRowsHeight({from:s-i,to:s})}this.isNeedRecalculate()&&!this.inProgress&&this.calculateAllRowsHeight()}}},{key:"onBeforeRowMove",value:function(o,i){this.clearCacheByRange({from:o,to:i}),this.calculateAllRowsHeight()}},{key:"onBeforeRowResize",value:function(o,i,a){var l=o;return a&&(this.calculateRowsHeight(i,void 0,!0),l=this.getRowHeight(i)),l}},{key:"onAfterLoadData",value:function(){var o=this;this.hot.view?this.recalculateAllRowsHeight():setTimeout(function(){o.hot&&o.recalculateAllRowsHeight()},0)}},{key:"onBeforeChange",value:function(o){var i=null;o.length===1?i=o[0][0]:o.length>1&&(i={from:o[0][0],to:o[o.length-1][0]}),i!==null&&this.clearCacheByRange(i)}},{key:"destroy",value:function(){this.ghostTable.clean(),Ul(fi(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return Jv}},{key:"PLUGIN_PRIORITY",get:function(){return XEe}},{key:"SETTING_KEYS",get:function(){return!0}},{key:"CALCULATION_STEP",get:function(){return 50}},{key:"SYNC_CALCULATION_LIMIT",get:function(){return 500}}]),r}(it);function Js(e){"@babel/helpers - typeof";return Js=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Js(e)}function JEe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ax(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,t0e(n.key),n)}}function e0e(e,t,r){return t&&ax(e.prototype,t),r&&ax(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function t0e(e){var t=r0e(e,"string");return Js(t)==="symbol"?t:String(t)}function r0e(e,t){if(Js(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Js(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function gc(){return typeof Reflect<"u"&&Reflect.get?gc=Reflect.get.bind():gc=function(t,r,n){var o=n0e(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},gc.apply(this,arguments)}function n0e(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=La(e),e!==null););return e}function o0e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&N_(e,t)}function N_(e,t){return N_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},N_(e,t)}function i0e(e){var t=s0e();return function(){var n=La(e),o;if(t){var i=La(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return a0e(this,o)}}function a0e(e,t){if(t&&(Js(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return l0e(e)}function l0e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function s0e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function La(e){return La=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},La(e)}var u2=uW("physicallyIndexed"),u0e=u2.getListWithInsertedItems,f0e=u2.getListWithRemovedItems,c0e=function(e){o0e(r,e);var t=i0e(r);function r(){return JEe(this,r),t.call(this,function(n){return n})}return e0e(r,[{key:"insert",value:function(o,i){var a=o0(this.indexedValues,i);this.indexedValues=u0e(a,o,i,this.initValueOrFn),gc(La(r.prototype),"insert",this).call(this,o,i)}},{key:"remove",value:function(o){var i=f0e(this.indexedValues,o);this.indexedValues=n0(i,o),gc(La(r.prototype),"remove",this).call(this,o)}}]),r}(Xa);const h0e=c0e;function eu(e){"@babel/helpers - typeof";return eu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},eu(e)}function d0e(e){return m0e(e)||g0e(e)||y0e(e)||v0e()}function v0e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function y0e(e,t){if(e){if(typeof e=="string")return H_(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return H_(e,t)}}function g0e(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function m0e(e){if(Array.isArray(e))return H_(e)}function H_(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function p0e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function lx(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,w0e(n.key),n)}}function b0e(e,t,r){return t&&lx(e.prototype,t),r&&lx(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function w0e(e){var t=S0e(e,"string");return eu(t)==="symbol"?t:String(t)}function S0e(e,t){if(eu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(eu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function mc(){return typeof Reflect<"u"&&Reflect.get?mc=Reflect.get.bind():mc=function(t,r,n){var o=C0e(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},mc.apply(this,arguments)}function C0e(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=ja(e),e!==null););return e}function _0e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&L_(e,t)}function L_(e,t){return L_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},L_(e,t)}function O0e(e){var t=T0e();return function(){var n=ja(e),o;if(t){var i=ja(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return R0e(this,o)}}function R0e(e,t){if(t&&(eu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return E0e(e)}function E0e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function T0e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function ja(e){return ja=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},ja(e)}var f2=uW("physicallyIndexed"),k0e=f2.getListWithInsertedItems,P0e=f2.getListWithRemovedItems,$0e=function(e){_0e(r,e);var t=O0e(r);function r(){return p0e(this,r),t.call(this,function(n){return n})}return b0e(r,[{key:"insert",value:function(o,i){var a=this;this.indexedValues=k0e(this.indexedValues,o,i,function(l,s){return a.getNextValue(s)}),mc(ja(r.prototype),"insert",this).call(this,o,i)}},{key:"remove",value:function(o){this.indexedValues=P0e(this.indexedValues,o),mc(ja(r.prototype),"remove",this).call(this,o)}},{key:"getNextValue",value:function(o){return Math.max.apply(Math,d0e(this.getValues()))+1+o}}]),r}(Xa);const A0e=$0e;function tu(e){"@babel/helpers - typeof";return tu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},tu(e)}function I0e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function sx(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,x0e(n.key),n)}}function M0e(e,t,r){return t&&sx(e.prototype,t),r&&sx(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function x0e(e){var t=D0e(e,"string");return tu(t)==="symbol"?t:String(t)}function D0e(e,t){if(tu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(tu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function zl(){return typeof Reflect<"u"&&Reflect.get?zl=Reflect.get.bind():zl=function(t,r,n){var o=N0e(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},zl.apply(this,arguments)}function N0e(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=ci(e),e!==null););return e}function H0e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&j_(e,t)}function j_(e,t){return j_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},j_(e,t)}function L0e(e){var t=B0e();return function(){var n=ci(e),o;if(t){var i=ci(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return j0e(this,o)}}function j0e(e,t){if(t&&(tu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return F0e(e)}function F0e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function B0e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function ci(e){return ci=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},ci(e)}var Cw="bindRowsWithHeaders",V0e=210,W0e="loose",U0e=new Map([["loose",h0e],["strict",A0e]]),z0e=function(e){H0e(r,e);var t=L0e(r);function r(n){var o;return I0e(this,r),o=t.call(this,n),o.headerIndexes=null,o}return M0e(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[Cw]}},{key:"enablePlugin",value:function(){var o=this;if(!this.enabled){var i=this.hot.getSettings()[Cw];typeof i!="string"&&(i=W0e);var a=U0e.get(i);this.headerIndexes=this.hot.rowIndexMapper.registerMap("bindRowsWithHeaders",new a),this.addHook("modifyRowHeader",function(l){return o.onModifyRowHeader(l)}),zl(ci(r.prototype),"enablePlugin",this).call(this)}}},{key:"disablePlugin",value:function(){this.hot.rowIndexMapper.unregisterMap("bindRowsWithHeaders"),zl(ci(r.prototype),"disablePlugin",this).call(this)}},{key:"onModifyRowHeader",value:function(o){return this.headerIndexes.getValueAtIndex(this.hot.toPhysicalRow(o))}},{key:"destroy",value:function(){zl(ci(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return Cw}},{key:"PLUGIN_PRIORITY",get:function(){return V0e}}]),r}(it);function ru(e){"@babel/helpers - typeof";return ru=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ru(e)}function ux(e){return q0e(e)||K0e(e)||G0e(e)||Y0e()}function Y0e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function G0e(e,t){if(e){if(typeof e=="string")return F_(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return F_(e,t)}}function K0e(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function q0e(e){if(Array.isArray(e))return F_(e)}function F_(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function X0e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function fx(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,c2(n.key),n)}}function Z0e(e,t,r){return t&&fx(e.prototype,t),r&&fx(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function ea(){return typeof Reflect<"u"&&Reflect.get?ea=Reflect.get.bind():ea=function(t,r,n){var o=Q0e(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},ea.apply(this,arguments)}function Q0e(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=so(e),e!==null););return e}function J0e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&B_(e,t)}function B_(e,t){return B_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},B_(e,t)}function eTe(e){var t=rTe();return function(){var n=so(e),o;if(t){var i=so(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return tTe(this,o)}}function tTe(e,t){if(t&&(ru(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Ml(e)}function Ml(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function rTe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function so(e){return so=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},so(e)}function nTe(e,t,r){oTe(e,t),t.set(e,r)}function oTe(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _w(e,t,r){return t=c2(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function c2(e){var t=iTe(e,"string");return ru(t)==="symbol"?t:String(t)}function iTe(e,t){if(ru(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ru(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function cx(e,t){var r=h2(e,t,"get");return aTe(e,r)}function aTe(e,t){return t.get?t.get.call(e):t.value}function Ow(e,t,r){var n=h2(e,t,"set");return lTe(e,n,r),r}function h2(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function lTe(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}var Rw="collapsibleColumns",sTe=290,uTe=["nestedHeaders"],cl="collapsibleIndicator",hx=new Map([["collapse",{hideColumn:!0,beforeHook:"beforeColumnCollapse",afterHook:"afterColumnCollapse"}],["expand",{hideColumn:!1,beforeHook:"beforeColumnExpand",afterHook:"afterColumnExpand"}]]),hl=new WeakMap,fTe=function(e){J0e(r,e);var t=eTe(r);function r(){var n;X0e(this,r);for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return n=t.call.apply(t,[this].concat(i)),_w(Ml(n),"nestedHeadersPlugin",null),_w(Ml(n),"eventManager",new Pt(Ml(n))),_w(Ml(n),"headerStateManager",null),nTe(Ml(n),hl,{writable:!0,value:null}),n}return Z0e(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[Rw]}},{key:"enablePlugin",value:function(){var o=this;if(!this.enabled){var i=this.hot.getSettings(),a=i.nestedHeaders;a||yt("You need to configure the Nested Headers plugin in order to use collapsible headers."),Ow(this,hl,this.hot.columnIndexMapper.createAndRegisterIndexMap(this.pluginName,"hiding")),this.nestedHeadersPlugin=this.hot.getPlugin("nestedHeaders"),this.headerStateManager=this.nestedHeadersPlugin.getStateManager(),this.addHook("init",function(){return o.onInit()}),this.addHook("afterLoadData",function(){return o.onAfterLoadData.apply(o,arguments)}),this.addHook("afterGetColHeader",function(){return o.onAfterGetColHeader.apply(o,arguments)}),this.addHook("beforeOnCellMouseDown",function(l,s,u){return o.onBeforeOnCellMouseDown(l,s,u)}),ea(so(r.prototype),"enablePlugin",this).call(this),this.updatePlugin()}}},{key:"updatePlugin",value:function(){if(this.hot.view){if(!this.nestedHeadersPlugin.detectedOverlappedHeaders){var o=this.hot.getSettings(),i=o.collapsibleColumns;typeof i=="boolean"?this.headerStateManager.mapState(function(a){return{collapsible:a.origColspan>1}}):Array.isArray(i)&&(this.headerStateManager.mapState(function(){return{collapsible:!1}}),this.headerStateManager.mergeStateWith(i))}ea(so(r.prototype),"updatePlugin",this).call(this)}}},{key:"disablePlugin",value:function(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),Ow(this,hl,null),this.nestedHeadersPlugin=null,this.clearButtons(),ea(so(r.prototype),"disablePlugin",this).call(this)}},{key:"clearButtons",value:function(){if(this.hot.view){var o=this.hot.view._wt.getSetting("columnHeaders").length,i=this.hot.view._wt.wtTable.THEAD,a=this.hot.view._wt.wtOverlays.topOverlay.clone.wtTable.THEAD,l=this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay?this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null,s=function(f){f&&f.parentNode.removeChild(f)};_e(0,o-1,function(u){var f=i.childNodes[u],c=a.childNodes[u],h=l?l.childNodes[u]:null;_e(0,f.childNodes.length-1,function(d){var v=f.childNodes[d].querySelector(".".concat(cl));s(v),c&&c.childNodes[d]&&(v=c.childNodes[d].querySelector(".".concat(cl)),s(v)),l&&h&&h.childNodes[d]&&(v=h.childNodes[d].querySelector(".".concat(cl)),s(v))})})}}},{key:"expandSection",value:function(o){this.toggleCollapsibleSection([o],"expand")}},{key:"collapseSection",value:function(o){this.toggleCollapsibleSection([o],"collapse")}},{key:"toggleAllCollapsibleSections",value:function(o){var i=this,a=this.headerStateManager.mapNodes(function(l){var s=l.collapsible,u=l.origColspan,f=l.headerLevel,c=l.columnIndex,h=l.isCollapsed;if(s===!0&&u>1&&(h&&o==="expand"||!h&&o==="collapse"))return{row:i.headerStateManager.levelToRowCoords(f),col:c}});this.toggleCollapsibleSection(a,o)}},{key:"collapseAll",value:function(){this.toggleAllCollapsibleSections("collapse")}},{key:"expandAll",value:function(){this.toggleAllCollapsibleSections("expand")}},{key:"toggleCollapsibleSection",value:function(o,i){var a=this;if(!hx.has(i))throw new Error("Unsupported action is passed (".concat(i,")."));if(Array.isArray(o)){var l=Yr(o,function(p){var w=p.row;return w<0}),s=l.length>0;I(l,function(p){var w,S=p.row,C=p.col,P=(w=a.headerStateManager.getHeaderSettings(S,C))!==null&&w!==void 0?w:{},R=P.collapsible,W=P.isCollapsed;if(!R||W&&i==="collapse"||!W&&i==="expand")return s=!1,!1});var u=[],f=[];s&&I(l,function(p){var w=p.row,S=p.col,C=a.headerStateManager.triggerNodeModification(i,w,S),P=C.colspanCompensation,R=C.affectedColumns,W=C.rollbackModification;P>0&&(f.push.apply(f,ux(R)),u.push(W))});var c=this.getCollapsedColumns(),h=[];i==="collapse"?h=AF([].concat(ux(c),f)):i==="expand"&&(h=Yr(c,function(p){return!f.includes(p)}));var d=hx.get(i),v=this.hot.runHooks(d.beforeHook,c,h,s);if(v===!1){I(u,function(p){p()});return}this.hot.batchExecution(function(){I(f,function(p){cx(a,hl).setValueAtIndex(a.hot.toPhysicalColumn(p),d.hideColumn)})},!0);var y=this.getCollapsedColumns().length!==c.length;this.hot.runHooks(d.afterHook,c,h,s,y),this.hot.render(),this.hot.view.adjustElementsSize(!0)}}},{key:"getCollapsedColumns",value:function(){return cx(this,hl).getHiddenIndexes()}},{key:"onAfterGetColHeader",value:function(o,i,a){var l,s=(l=this.headerStateManager.getHeaderSettings(a,o))!==null&&l!==void 0?l:{},u=s.collapsible,f=s.origColspan,c=s.isCollapsed,h=u&&f>1&&o>=this.hot.getSettings().fixedColumnsStart,d=i.querySelector(".".concat(cl));if(h)d||(d=this.hot.rootDocument.createElement("div"),re(d,cl),i.querySelector("div:first-child").appendChild(d)),He(d,["collapsed","expanded"]),c?(re(d,"collapsed"),ka(d,"+")):(re(d,"expanded"),ka(d,"-"));else{var v;(v=d)===null||v===void 0||v.remove()}}},{key:"onBeforeOnCellMouseDown",value:function(o,i){xe(o.target,cl)&&(xe(o.target,"expanded")?(this.eventManager.fireEvent(o.target,"mouseup"),this.toggleCollapsibleSection([i],"collapse")):xe(o.target,"collapsed")&&(this.eventManager.fireEvent(o.target,"mouseup"),this.toggleCollapsibleSection([i],"expand")),Dn(o))}},{key:"onInit",value:function(){this.updatePlugin()}},{key:"onAfterLoadData",value:function(o,i){i||this.updatePlugin()}},{key:"destroy",value:function(){Ow(this,hl,null),ea(so(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return Rw}},{key:"PLUGIN_PRIORITY",get:function(){return sTe}},{key:"PLUGIN_DEPS",get:function(){return["plugin:NestedHeaders"]}},{key:"SETTING_KEYS",get:function(){return[Rw].concat(uTe)}}]),r}(it);function Fh(e){"@babel/helpers - typeof";return Fh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Fh(e)}function dx(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function cTe(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?dx(Object(r),!0).forEach(function(n){hTe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):dx(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function hTe(e,t,r){return t=d2(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function vx(e,t){return gTe(e)||yTe(e,t)||vTe(e,t)||dTe()}function dTe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function vTe(e,t){if(e){if(typeof e=="string")return yx(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return yx(e,t)}}function yx(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function yTe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function gTe(e){if(Array.isArray(e))return e}function mTe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function gx(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,d2(n.key),n)}}function pTe(e,t,r){return t&&gx(e.prototype,t),r&&gx(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function d2(e){var t=bTe(e,"string");return Fh(t)==="symbol"?t:String(t)}function bTe(e,t){if(Fh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Fh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var wTe=["sortEmptyCells","indicator","headerAction","compareFunctionFactory"],STe=!1,CTe=!0,_Te=!0,OTe=function(){function e(t,r){mTe(this,e),this.hot=t,this.sortingStates=new pp,this.sortEmptyCells=STe,this.indicator=CTe,this.headerAction=_Te,this.compareFunctionFactory=void 0,this.mapName=r,this.hot.columnIndexMapper.registerMap(r,this.sortingStates)}return pTe(e,[{key:"updateAllColumnsProperties",value:function(r){var n=this;Ge(r)&&Ke(r,function(o,i){wTe.includes(i)&&(n[i]=o)})}},{key:"getAllColumnsProperties",value:function(){var r={sortEmptyCells:this.sortEmptyCells,indicator:this.indicator,headerAction:this.headerAction};return typeof this.compareFunctionFactory=="function"&&(r.compareFunctionFactory=this.compareFunctionFactory),r}},{key:"getSortOrderOfColumn",value:function(r){var n;return(n=this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(r)))===null||n===void 0?void 0:n.sortOrder}},{key:"getIndexOfColumnInSortQueue",value:function(r){return r=this.hot.toPhysicalColumn(r),this.sortingStates.getEntries().findIndex(function(n){var o=vx(n,1),i=o[0];return i===r})}},{key:"getNumberOfSortedColumns",value:function(){return this.sortingStates.getLength()}},{key:"isListOfSortedColumnsEmpty",value:function(){return this.getNumberOfSortedColumns()===0}},{key:"isColumnSorted",value:function(r){return Ge(this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(r)))}},{key:"getSortStates",value:function(){var r=this;if(this.sortingStates===null)return[];var n=this.sortingStates.getEntries();return n.map(function(o){var i=vx(o,2),a=i[0],l=i[1];return cTe({column:r.hot.toVisualColumn(a)},l)})}},{key:"getColumnSortState",value:function(r){var n=this.getSortOrderOfColumn(r);if(ye(n))return{column:r,sortOrder:n}}},{key:"setSortStates",value:function(r){this.sortingStates.clear();for(var n=0;n<r.length;n+=1)this.sortingStates.setValueAtIndex(this.hot.toPhysicalColumn(r[n].column),{sortOrder:r[n].sortOrder})}},{key:"destroy",value:function(){this.hot.columnIndexMapper.unregisterMap(this.mapName),this.sortingStates=null}}]),e}(),mm="asc",pm="desc",RTe="colHeader";function ETe(e){if(Ge(e)===!1)return!1;var t=e.column,r=e.sortOrder;return Number.isInteger(t)&&[mm,pm].includes(r)}function TTe(e){if(e.some(function(r){return ETe(r)===!1}))return!1;var t=e.map(function(r){var n=r.column;return n});return new Set(t).size===t.length}function mx(e){if(e!==pm)return e===mm?pm:mm}function px(e){var t=e.querySelector(".".concat(RTe));return t}function bx(e,t){if(e<0||!t.parentNode)return!1;var r=t.parentNode.parentNode.childNodes,n=Array.from(r).indexOf(t.parentNode)-r.length;return n===-1}function V_(e,t,r){return e===-1&&t>=0&&$a(r)===!1}var kTe="ascending",PTe="descending",v2="indicatorDisabled",y2="columnSorting",g2="sortAction",m2=new Map([[mm,kTe],[pm,PTe]]);function $Te(e,t,r,n){var o=[y2];if(n&&o.push(g2),r===!1)return o.push(v2),o;var i=e.getSortOrderOfColumn(t);return ye(i)&&o.push(m2.get(i)),o}function ATe(){return Array.from(m2.values()).concat(g2,v2,y2)}function p2(e,t,r){var n=t.locale;return function(o,i){var a=r.sortEmptyCells;return typeof o=="string"&&(o=o.toLocaleLowerCase(n)),typeof i=="string"&&(i=i.toLocaleLowerCase(n)),o===i?In:Yt(o)?Yt(i)?In:a&&e==="asc"?Rt:Et:Yt(i)?a&&e==="asc"?Et:Rt:isNaN(o)&&!isNaN(i)?e==="asc"?Et:Rt:!isNaN(o)&&isNaN(i)||(isNaN(o)||isNaN(i)||(o=parseFloat(o),i=parseFloat(i)),o<i)?e==="asc"?Rt:Et:o>i?e==="asc"?Et:Rt:In}}var b2="default";function ITe(e,t,r){return function(n,o){var i=parseFloat(n),a=parseFloat(o),l=r.sortEmptyCells;if(i===a||isNaN(i)&&isNaN(a))return In;if(l){if(Yt(n))return e==="asc"?Rt:Et;if(Yt(o))return e==="asc"?Et:Rt}return isNaN(i)?Et:isNaN(a)?Rt:i<a?e==="asc"?Rt:Et:i>a?e==="asc"?Et:Rt:In}}var MTe="numeric";function xTe(e,t,r){var n=t.checkedTemplate,o=t.uncheckedTemplate,i=r.sortEmptyCells;return function(a,l){var s=Yt(a),u=Yt(l),f=s?o:a,c=u?o:l,h=f===o||f===n,d=c===o||c===n;if(i===!1){if(s&&u===!1)return Et;if(s===!1&&u)return Rt}return h===!1&&d?e==="asc"?Rt:Et:h&&d===!1?e==="asc"?Et:Rt:h===!1&&d===!1?p2(e,t,r)(a,l):f===o&&c===n?e==="asc"?Rt:Et:f===n&&c===o?e==="asc"?Et:Rt:In}}var DTe="checkbox";function NTe(e,t,r){return function(n,o){var i=r.sortEmptyCells;if(n===o)return In;if(Yt(n))return Yt(o)?In:i&&e==="asc"?Rt:Et;if(Yt(o))return i&&e==="asc"?Et:Rt;var a=t.dateFormat,l=ee(n,a),s=ee(o,a);return l.isValid()?s.isValid()?s.isAfter(l)?e==="asc"?Rt:Et:s.isBefore(l)?e==="asc"?Et:Rt:In:Rt:Et}}var HTe="date",VT=Qr("sorting.compareFunctionFactory"),kp=VT.register,wx=VT.getItem,LTe=VT.hasItem,w2=Qr("sorting.mainSortComparator"),S2=w2.register,jTe=w2.getItem;function C2(e){return LTe(e)?wx(e):wx(b2)}kp(MTe,ITe);kp(DTe,xTe);kp(HTe,NTe);kp(b2,p2);var In=0,Rt=-1,Et=1;function FTe(e,t){for(var r=jTe(t),n=arguments.length,o=new Array(n>2?n-2:0),i=2;i<n;i++)o[i-2]=arguments[i];e.sort(r.apply(void 0,o))}function Sx(e){return UTe(e)||WTe(e)||VTe(e)||BTe()}function BTe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function VTe(e,t){if(e){if(typeof e=="string")return Cx(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Cx(e,t)}}function Cx(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function WTe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function UTe(e){if(Array.isArray(e))return e}function zTe(e,t){return function(r,n){var o=Sx(r),i=o.slice(1),a=Sx(n),l=a.slice(1);return function(u){var f=e[u],c=t[u],h=i[u],d=l[u],v=c.columnSorting,y=v.compareFunctionFactory?v.compareFunctionFactory:C2(c.type),p=y(f,c,v)(h,d);return p}(0)}}function nu(e){"@babel/helpers - typeof";return nu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},nu(e)}var YTe=["column"],GTe=["column"];function dl(e){return ZTe(e)||XTe(e)||qTe(e)||KTe()}function KTe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function qTe(e,t){if(e){if(typeof e=="string")return W_(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return W_(e,t)}}function XTe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function ZTe(e){if(Array.isArray(e))return W_(e)}function W_(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _x(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function Ox(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?_x(Object(r),!0).forEach(function(n){QTe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):_x(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function QTe(e,t,r){return t=_2(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Rx(e,t){if(e==null)return{};var r=JTe(e,t),n,o;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)n=i[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function JTe(e,t){if(e==null)return{};var r={},n=Object.keys(e),o,i;for(i=0;i<n.length;i++)o=n[i],!(t.indexOf(o)>=0)&&(r[o]=e[o]);return r}function eke(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ex(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_2(n.key),n)}}function tke(e,t,r){return t&&Ex(e.prototype,t),r&&Ex(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _2(e){var t=rke(e,"string");return nu(t)==="symbol"?t:String(t)}function rke(e,t){if(nu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(nu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ta(){return typeof Reflect<"u"&&Reflect.get?ta=Reflect.get.bind():ta=function(t,r,n){var o=nke(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},ta.apply(this,arguments)}function nke(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=uo(e),e!==null););return e}function oke(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&U_(e,t)}function U_(e,t){return U_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},U_(e,t)}function ike(e){var t=ske();return function(){var n=uo(e),o;if(t){var i=uo(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return ake(this,o)}}function ake(e,t){if(t&&(nu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return lke(e)}function lke(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ske(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function uo(e){return uo=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},uo(e)}var z_="columnSorting",uke=50,Tx="append",fke="replace";S2(z_,zTe);ge.getSingleton().register("beforeColumnSort");ge.getSingleton().register("afterColumnSort");var O2=function(e){oke(r,e);var t=ike(r);function r(n){var o;return eke(this,r),o=t.call(this,n),o.columnStatesManager=null,o.columnMetaCache=null,o.pluginKey=z_,o.indexesSequenceCache=null,o}return tke(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[this.pluginKey]}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.columnStatesManager=new OTe(this.hot,"".concat(this.pluginKey,".sortingStates")),this.columnMetaCache=new Ri(function(i){var a=o.hot.toVisualColumn(i);return a===null&&(a=i),o.getMergedPluginSettings(a)}),this.hot.columnIndexMapper.registerMap("".concat(this.pluginKey,".columnMeta"),this.columnMetaCache),this.addHook("afterGetColHeader",function(i,a){return o.onAfterGetColHeader(i,a)}),this.addHook("beforeOnCellMouseDown",function(){return o.onBeforeOnCellMouseDown.apply(o,arguments)}),this.addHook("afterOnCellMouseDown",function(i,a){return o.onAfterOnCellMouseDown(i,a)}),this.addHook("afterInit",function(){return o.loadOrSortBySettings()}),this.addHook("afterLoadData",function(){return o.onAfterLoadData.apply(o,arguments)}),this.hot.view&&this.loadOrSortBySettings(),ta(uo(r.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){var o=this,i=function(l,s){var u=px(s);bx(l,s)===!1||u===null||o.updateHeaderClasses(u)};this.hot.addHook("afterGetColHeader",i),this.hot.addHookOnce("afterViewRender",function(){o.hot.removeHook("afterGetColHeader",i)}),this.hot.batchExecution(function(){o.indexesSequenceCache!==null&&(o.hot.rowIndexMapper.setIndexesSequence(o.indexesSequenceCache.getValues()),o.hot.rowIndexMapper.unregisterMap(o.pluginKey))},!0),this.hot.columnIndexMapper.unregisterMap("".concat(this.pluginKey,".columnMeta")),this.columnStatesManager.destroy(),this.columnMetaCache=null,this.columnStatesManager=null,ta(uo(r.prototype),"disablePlugin",this).call(this)}},{key:"sort",value:function(o){var i=this.getSortConfig(),a=this.getNormalizedSortConfigs(o),l=this.areValidSortConfigs(a),s=this.hot.runHooks("beforeColumnSort",i,a,l);s!==!1&&(i.length===0&&this.indexesSequenceCache===null&&(this.indexesSequenceCache=this.hot.rowIndexMapper.registerMap(this.pluginKey,new fW),this.indexesSequenceCache.setValues(this.hot.rowIndexMapper.getIndexesSequence())),l&&(this.columnStatesManager.setSortStates(a),this.sortByPresetSortStates(a),this.saveAllSortSettings(a)),this.hot.runHooks("afterColumnSort",i,l?a:i,l),l&&(this.hot.render(),this.hot.forceFullRender=!1,this.hot.view.render()))}},{key:"clearSort",value:function(){this.sort([])}},{key:"isSorted",value:function(){return this.enabled&&!this.columnStatesManager.isListOfSortedColumnsEmpty()}},{key:"getSortConfig",value:function(o){return ye(o)?this.columnStatesManager.getColumnSortState(o):this.columnStatesManager.getSortStates()}},{key:"setSortConfig",value:function(o){var i=this.getNormalizedSortConfigs(o);this.areValidSortConfigs(i)&&this.columnStatesManager.setSortStates(i)}},{key:"getNormalizedSortConfigs",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Array.isArray(o)?o.slice(0,1):[o]}},{key:"areValidSortConfigs",value:function(o){var i=this.hot.countCols();return TTe(o)&&o.every(function(a){var l=a.column;return l<=i&&l>=0})}},{key:"saveAllSortSettings",value:function(o){var i=this,a=this.columnStatesManager.getAllColumnsProperties(),l=function(u){var f=u.column,c=Rx(u,YTe);return Ox({column:i.hot.toPhysicalColumn(f)},c)};a.initialConfig=Ye(o,l),this.hot.runHooks("persistentStateSave","columnSorting",a)}},{key:"getAllSavedSortSettings",value:function(){var o=this,i={};this.hot.runHooks("persistentStateLoad","columnSorting",i);var a=i.value,l=function(u){var f=u.column,c=Rx(u,GTe);return Ox({column:o.hot.toVisualColumn(f)},c)};return ye(a)&&Array.isArray(a.initialConfig)&&(a.initialConfig=Ye(a.initialConfig,l)),a}},{key:"getColumnNextConfig",value:function(o){var i=this.columnStatesManager.getSortOrderOfColumn(o);if(ye(i)){var a=mx(i);return ye(a)?{column:o,sortOrder:a}:void 0}var l=this.hot.countCols();if(Number.isInteger(o)&&o>=0&&o<l)return{column:o,sortOrder:mx()}}},{key:"getNextSortConfig",value:function(o){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Tx,a=this.columnStatesManager.getIndexOfColumnInSortQueue(o),l=a!==-1,s=this.getSortConfig(),u=this.getColumnNextConfig(o);if(l){if(gt(u))return[].concat(dl(s.slice(0,a)),dl(s.slice(a+1)));if(i===Tx)return[].concat(dl(s.slice(0,a)),dl(s.slice(a+1)),[u]);if(i===fke)return[].concat(dl(s.slice(0,a)),[u],dl(s.slice(a+1)))}return ye(u)?s.concat(u):s}},{key:"getPluginColumnConfig",value:function(o){if(Ge(o)){var i=o[this.pluginKey];if(Ge(i))return i}return{}}},{key:"getMergedPluginSettings",value:function(o){var i=this.hot.getSettings()[this.pluginKey],a=this.columnStatesManager.getAllColumnsProperties(),l=this.hot.getCellMeta(0,o),s=Object.getPrototypeOf(l);return Array.isArray(s.columns)?Object.assign(a,i,this.getPluginColumnConfig(s.columns[o])):vt(s.columns)?Object.assign(a,i,this.getPluginColumnConfig(s.columns(o))):Object.assign(a,i)}},{key:"getFirstCellSettings",value:function(o){var i=this.hot.getCellMeta(0,o),a=Object.create(i);return a[this.pluginKey]=this.columnMetaCache.getValueAtIndex(this.hot.toPhysicalColumn(o)),a}},{key:"getNumberOfRowsToSort",value:function(o){var i=this.hot.getSettings();return i.maxRows<=o?i.maxRows:o-i.minSpareRows}},{key:"sortByPresetSortStates",value:function(o){var i=this;if(o.length===0){this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues());return}for(var a=[],l=this.hot.countRows(),s=function(p){return Ye(o,function(w){return i.hot.getDataAtCell(p,w.column)})},u=0;u<this.getNumberOfRowsToSort(l);u+=1)a.push([this.hot.toPhysicalRow(u)].concat(s(u)));var f=Ye(a,function(y){return y[0]});FTe(a,this.pluginKey,Ye(o,function(y){return y.sortOrder}),Ye(o,function(y){return i.getFirstCellSettings(y.column)}));for(var c=a.length;c<l;c+=1)a.push([c].concat(s(c)));var h=Ye(a,function(y){return y[0]}),d=new Map(Ye(f,function(y,p){return[y,h[p]]})),v=Ye(this.hot.rowIndexMapper.getIndexesSequence(),function(y){return d.has(y)?d.get(y):y});this.hot.rowIndexMapper.setIndexesSequence(v)}},{key:"loadOrSortBySettings",value:function(){var o=this.getAllSavedSortSettings();if(Ge(o))this.sortBySettings(o);else{var i=this.hot.getSettings()[this.pluginKey];this.sortBySettings(i)}}},{key:"sortBySettings",value:function(o){if(Ge(o)){this.columnStatesManager.updateAllColumnsProperties(o);var i=o.initialConfig;(Array.isArray(i)||Ge(i))&&this.sort(i)}else this.hot.render()}},{key:"onAfterGetColHeader",value:function(o,i){var a=px(i);if(!(bx(o,i)===!1||a===null)){var l=this.getFirstCellSettings(o)[this.pluginKey],s=l.indicator,u=l.headerAction;this.updateHeaderClasses(a,this.columnStatesManager,o,s,u)}}},{key:"updateHeaderClasses",value:function(o){if(He(o,ATe()),this.enabled!==!1){for(var i=arguments.length,a=new Array(i>1?i-1:0),l=1;l<i;l++)a[l-1]=arguments[l];re(o,$Te.apply(void 0,a))}}},{key:"onUpdateSettings",value:function(o){ta(uo(r.prototype),"onUpdateSettings",this).call(this),this.columnMetaCache!==null&&this.columnMetaCache.init(this.hot.columnIndexMapper.getNumberOfIndexes()),ye(o[this.pluginKey])&&this.sortBySettings(o[this.pluginKey])}},{key:"onAfterLoadData",value:function(o){o===!0&&this.hot.view&&this.loadOrSortBySettings()}},{key:"wasClickableHeaderClicked",value:function(o,i){var a=this.getFirstCellSettings(i)[this.pluginKey],l=a.headerAction;return l&&o.target.nodeName==="SPAN"}},{key:"onBeforeOnCellMouseDown",value:function(o,i,a,l){V_(i.row,i.col,o)!==!1&&this.wasClickableHeaderClicked(o,i.col)&&this.hot.getShortcutManager().isCtrlPressed()&&(l.column=!0)}},{key:"onAfterOnCellMouseDown",value:function(o,i){V_(i.row,i.col,o)!==!1&&this.wasClickableHeaderClicked(o,i.col)&&(this.hot.getShortcutManager().isCtrlPressed()&&(this.hot.deselectCell(),this.hot.selectColumns(i.col)),this.sort(this.getColumnNextConfig(i.col)))}},{key:"destroy",value:function(){var o;(o=this.columnStatesManager)===null||o===void 0||o.destroy(),ta(uo(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return z_}},{key:"PLUGIN_PRIORITY",get:function(){return uke}}]),r}(it),cke=$e,WT=Ve,hke=_i,dke=Oj,vke=dE,kx=Le,yke=RangeError,R2=String,E2=Math.floor,Y_=WT(vke),Px=WT("".slice),Ff=WT(1 .toFixed),Hl=function(e,t,r){return t===0?r:t%2===1?Hl(e,t-1,r*e):Hl(e*e,t/2,r)},gke=function(e){for(var t=0,r=e;r>=4096;)t+=12,r/=4096;for(;r>=2;)t+=1,r/=2;return t},vl=function(e,t,r){for(var n=-1,o=r;++n<6;)o+=t*e[n],e[n]=o%1e7,o=E2(o/1e7)},Ew=function(e,t){for(var r=6,n=0;--r>=0;)n+=e[r],e[r]=E2(n/t),n=n%t*1e7},$x=function(e){for(var t=6,r="";--t>=0;)if(r!==""||t===0||e[t]!==0){var n=R2(e[t]);r=r===""?n:r+Y_("0",7-n.length)+n}return r},mke=kx(function(){return Ff(8e-5,3)!=="0.000"||Ff(.9,0)!=="1"||Ff(1.255,2)!=="1.25"||Ff(0xde0b6b3a7640080,0)!=="1000000000000000128"})||!kx(function(){Ff({})});cke({target:"Number",proto:!0,forced:mke},{toFixed:function(t){var r=dke(this),n=hke(t),o=[0,0,0,0,0,0],i="",a="0",l,s,u,f;if(n<0||n>20)throw yke("Incorrect fraction digits");if(r!=r)return"NaN";if(r<=-1e21||r>=1e21)return R2(r);if(r<0&&(i="-",r=-r),r>1e-21)if(l=gke(r*Hl(2,69,1))-69,s=l<0?r*Hl(2,-l,1):r/Hl(2,l,1),s*=4503599627370496,l=52-l,l>0){for(vl(o,0,s),u=n;u>=7;)vl(o,1e7,0),u-=7;for(vl(o,Hl(10,u,1),0),u=l-1;u>=23;)Ew(o,1<<23),u-=23;Ew(o,1<<u),vl(o,1,1),Ew(o,2),a=$x(o)}else vl(o,0,s),vl(o,1<<-l,0),a=$x(o)+Y_("0",n);return n>0?(f=a.length,a=i+(f<=n?"0."+Y_("0",n-f)+a:Px(a,0,f-n)+"."+Px(a,f-n))):a=i+a,a}});function Bh(e){"@babel/helpers - typeof";return Bh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Bh(e)}function pke(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ax(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,wke(n.key),n)}}function bke(e,t,r){return t&&Ax(e.prototype,t),r&&Ax(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function wke(e){var t=Ske(e,"string");return Bh(t)==="symbol"?t:String(t)}function Ske(e,t){if(Bh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Bh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Cke=function(){function e(t,r){pke(this,e),this.plugin=t,this.hot=this.plugin.hot,this.endpoints=[],this.settings=r,this.settingsType="array",this.currentEndpoint=null,this.cellsToSetCache=[]}return bke(e,[{key:"getEndpoint",value:function(r){return this.settingsType==="function"?this.fillMissingEndpointData(this.settings)[r]:this.endpoints[r]}},{key:"getAllEndpoints",value:function(){return this.settingsType==="function"?this.fillMissingEndpointData(this.settings):this.endpoints}},{key:"fillMissingEndpointData",value:function(r){return this.parseSettings(r.call(this))}},{key:"parseSettings",value:function(r){var n=this,o=[],i=r;if(!i&&typeof this.settings=="function"){this.settingsType="function";return}return i||(i=this.settings),I(i,function(a){var l={};n.assignSetting(a,l,"ranges",[[0,n.hot.countRows()-1]]),n.assignSetting(a,l,"reversedRowCoords",!1),n.assignSetting(a,l,"destinationRow",new Error(`
        You must provide a destination row for the Column Summary plugin in order to work properly!
      `)),n.assignSetting(a,l,"destinationColumn",new Error(`
        You must provide a destination column for the Column Summary plugin in order to work properly!
      `)),n.assignSetting(a,l,"sourceColumn",a.destinationColumn),n.assignSetting(a,l,"type","sum"),n.assignSetting(a,l,"forceNumeric",!1),n.assignSetting(a,l,"suppressDataTypeErrors",!0),n.assignSetting(a,l,"suppressDataTypeErrors",!0),n.assignSetting(a,l,"customFunction",null),n.assignSetting(a,l,"readOnly",!0),n.assignSetting(a,l,"roundFloat",!1),o.push(l)}),o}},{key:"assignSetting",value:function(r,n,o,i){if(o==="ranges"&&r[o]===void 0){n[o]=i;return}else if(o==="ranges"&&r[o].length===0)return;if(r[o]===void 0){if(i instanceof Error)throw i;n[o]=i}else o==="destinationRow"&&n.reversedRowCoords?n[o]=this.hot.countRows()-r[o]-1:n[o]=r[o]}},{key:"resetSetupBeforeStructureAlteration",value:function(r,n,o){if(this.settingsType==="function"){var i=r.indexOf("row")>-1?"row":"col",a=this.getAllEndpoints();I(a,function(l){i==="row"&&l.destinationRow>=n&&(r==="insert_row"?l.alterRowOffset=o:r==="remove_row"&&(l.alterRowOffset=-1*o)),i==="col"&&l.destinationColumn>=n&&(r==="insert_col"?l.alterColumnOffset=o:r==="remove_col"&&(l.alterColumnOffset=-1*o))}),this.resetAllEndpoints(a,!1)}}},{key:"resetSetupAfterStructureAlteration",value:function(r,n,o,i,a){var l=this,s=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;if(this.settingsType==="function"){var u=function y(){return l.hot.removeHook("beforeViewRender",y),l.refreshAllEndpoints()};this.hot.addHookOnce("beforeViewRender",u);return}var f=r.indexOf("row")>-1?"row":"col",c=r.indexOf("remove")>-1?-1:1,h=this.getAllEndpoints(),d=r.indexOf("move_row")===0,v=n;I(h,function(y){f==="row"&&y.destinationRow>=v&&(y.alterRowOffset=c*o),f==="col"&&y.destinationColumn>=v&&(y.alterColumnOffset=c*o)}),this.resetAllEndpoints(h,!d),d?I(h,function(y){l.extendEndpointRanges(y,v,i[0],i.length),l.recreatePhysicalRanges(y),l.clearOffsetInformation(y)}):I(h,function(y){l.shiftEndpointCoordinates(y,v)}),s&&this.refreshAllEndpoints()}},{key:"clearOffsetInformation",value:function(r){r.alterRowOffset=void 0,r.alterColumnOffset=void 0}},{key:"extendEndpointRanges",value:function(r,n,o,i){I(r.ranges,function(a){a[1]&&(n>=a[0]&&n<=a[1]?o>a[1]?a[1]+=i:o<a[0]&&(a[0]-=i):o>=a[0]&&o<=a[1]&&(a[1]-=i,n<=a[0]&&(a[0]+=1,a[1]+=1)))})}},{key:"recreatePhysicalRanges",value:function(r){var n=this,o=r.ranges,i=[],a=[];I(o,function(l){var s=[];if(l[1])for(var u=l[0];u<=l[1];u++)s.push(n.hot.toPhysicalRow(u));else s.push(n.hot.toPhysicalRow(l[0]));a.push(s)}),I(a,function(l){var s=[];I(l,function(u,f){f===0?s.push(u):l[f]!==l[f-1]+1&&(s.push(l[f-1]),i.push(s),s=[],s.push(u)),f===l.length-1&&(s.push(u),i.push(s))})}),r.ranges=i}},{key:"shiftEndpointCoordinates",value:function(r,n){r.alterRowOffset&&r.alterRowOffset!==0?(r.destinationRow+=r.alterRowOffset||0,I(r.ranges,function(o){I(o,function(i,a){i>=n&&(o[a]+=r.alterRowOffset||0)})})):r.alterColumnOffset&&r.alterColumnOffset!==0&&(r.destinationColumn+=r.alterColumnOffset||0,r.sourceColumn+=r.alterColumnOffset||0)}},{key:"resetAllEndpoints",value:function(){var r=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getAllEndpoints(),o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,i=n.some(function(a){var l=a.alterRowOffset||0,s=a.alterColumnOffset||0;return a.destinationRow+l>=r.hot.countRows()||a.destinationColumn+s>=r.hot.countCols()});i||(this.cellsToSetCache=[],I(n,function(a){r.resetEndpointValue(a,o)}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[])}},{key:"refreshAllEndpoints",value:function(){var r=this;this.cellsToSetCache=[],I(this.getAllEndpoints(),function(n){r.currentEndpoint=n,r.plugin.calculate(n),r.setEndpointValue(n,"init")}),this.currentEndpoint=null,this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}},{key:"refreshChangedEndpoints",value:function(r){var n=this,o=[];this.cellsToSetCache=[],I(r,function(i,a,l){"".concat(i[2]||"")!=="".concat(i[3])&&I(n.getAllEndpoints(),function(s,u){n.hot.propToCol(l[a][1])===s.sourceColumn&&o.indexOf(u)===-1&&o.push(u)})}),I(o,function(i){n.refreshEndpoint(n.getEndpoint(i))}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}},{key:"refreshEndpoint",value:function(r){this.currentEndpoint=r,this.plugin.calculate(r),this.setEndpointValue(r),this.currentEndpoint=null}},{key:"resetEndpointValue",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,o=r.alterRowOffset||0,i=r.alterColumnOffset||0;this.cellsToSetCache.push([this.hot.toVisualRow(r.destinationRow+(n?o:0)),this.hot.toVisualColumn(r.destinationColumn+(n?i:0)),""])}},{key:"setEndpointValue",value:function(r,n){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=this.hot.toVisualRow(r.destinationRow);if(r.destinationRow>=this.hot.countRows()||r.destinationColumn>=this.hot.countCols()){this.throwOutOfBoundsWarning();return}var a=this.hot.toVisualRow(r.destinationRow);if(a!==null){var l=this.hot.getCellMeta(a,r.destinationColumn);(n==="init"||l.readOnly!==r.readOnly)&&(l.readOnly=r.readOnly,l.className="columnSummaryResult")}r.roundFloat&&!isNaN(r.result)&&(r.result=r.result.toFixed(r.roundFloat)),o?this.hot.setDataAtCell(i,r.destinationColumn,r.result,"ColumnSummary.set"):this.cellsToSetCache.push([i,r.destinationColumn,r.result]),r.alterRowOffset=void 0,r.alterColumnOffset=void 0}},{key:"throwOutOfBoundsWarning",value:function(){yt("One of the Column Summary plugins' destination points you provided is beyond the table boundaries!")}}]),e}();const _ke=Cke;function Tw(e){return e==null||isNaN(e)}function ou(e){"@babel/helpers - typeof";return ou=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ou(e)}var Ix;function Oke(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function Rke(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Mx(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Tke(n.key),n)}}function Eke(e,t,r){return t&&Mx(e.prototype,t),r&&Mx(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Tke(e){var t=kke(e,"string");return ou(t)==="symbol"?t:String(t)}function kke(e,t){if(ou(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ou(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ng(){return typeof Reflect<"u"&&Reflect.get?ng=Reflect.get.bind():ng=function(t,r,n){var o=Pke(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},ng.apply(this,arguments)}function Pke(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=iu(e),e!==null););return e}function $ke(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&G_(e,t)}function G_(e,t){return G_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},G_(e,t)}function Ake(e){var t=xke();return function(){var n=iu(e),o;if(t){var i=iu(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Ike(this,o)}}function Ike(e,t){if(t&&(ou(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Mke(e)}function Mke(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function xke(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function iu(e){return iu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},iu(e)}var kw="columnSummary",Dke=220,Nke=function(e){$ke(r,e);var t=Ake(r);function r(n){var o;return Rke(this,r),o=t.call(this,n),o.endpoints=null,o}return Eke(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[kw]}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.settings=this.hot.getSettings()[kw],this.endpoints=new _ke(this,this.settings),this.addHook("afterInit",function(){return o.onAfterInit.apply(o,arguments)}),this.addHook("afterChange",function(){return o.onAfterChange.apply(o,arguments)}),this.addHook("beforeCreateRow",function(i,a,l){return o.endpoints.resetSetupBeforeStructureAlteration("insert_row",i,a,null,l)}),this.addHook("beforeCreateCol",function(i,a,l){return o.endpoints.resetSetupBeforeStructureAlteration("insert_col",i,a,null,l)}),this.addHook("beforeRemoveRow",function(){for(var i,a=arguments.length,l=new Array(a),s=0;s<a;s++)l[s]=arguments[s];return(i=o.endpoints).resetSetupBeforeStructureAlteration.apply(i,["remove_row"].concat(l))}),this.addHook("beforeRemoveCol",function(){for(var i,a=arguments.length,l=new Array(a),s=0;s<a;s++)l[s]=arguments[s];return(i=o.endpoints).resetSetupBeforeStructureAlteration.apply(i,["remove_col"].concat(l))}),this.addHook("afterCreateRow",function(i,a,l){return o.endpoints.resetSetupAfterStructureAlteration("insert_row",i,a,null,l)}),this.addHook("afterCreateCol",function(i,a,l){return o.endpoints.resetSetupAfterStructureAlteration("insert_col",i,a,null,l)}),this.addHook("afterRemoveRow",function(){for(var i,a=arguments.length,l=new Array(a),s=0;s<a;s++)l[s]=arguments[s];return(i=o.endpoints).resetSetupAfterStructureAlteration.apply(i,["remove_row"].concat(l))}),this.addHook("afterRemoveCol",function(){for(var i,a=arguments.length,l=new Array(a),s=0;s<a;s++)l[s]=arguments[s];return(i=o.endpoints).resetSetupAfterStructureAlteration.apply(i,["remove_col"].concat(l))}),this.addHook("afterRowMove",function(){return o.onAfterRowMove.apply(o,arguments)}),ng(iu(r.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.endpoints=null,this.settings=null,this.currentEndpoint=null}},{key:"calculate",value:function(o){switch(o.type.toLowerCase()){case"sum":o.result=this.calculateSum(o);break;case"min":o.result=this.calculateMinMax(o,o.type);break;case"max":o.result=this.calculateMinMax(o,o.type);break;case"count":o.result=this.countEntries(o);break;case"average":o.result=this.calculateAverage(o);break;case"custom":o.result=o.customFunction.call(this,o);break}}},{key:"calculateSum",value:function(o){var i=this,a=0;return Ke(o.ranges,function(l){a+=i.getPartialSum(l,o.sourceColumn)}),a}},{key:"getPartialSum",value:function(o,i){var a=0,l=o[1]||o[0],s=null,u=0;do{if(s=this.getCellValue(l,i),s=Tw(s)?null:s,s!==null){var f=("".concat(s).split(".")[1]||[]).length||1;f>u&&(u=f)}a+=s||0,l-=1}while(l>=o[0]);return Math.round(a*Math.pow(10,u))/Math.pow(10,u)}},{key:"calculateMinMax",value:function(o,i){var a=this,l=null;return Ke(o.ranges,function(s){var u=a.getPartialMinMax(s,o.sourceColumn,i);if(l===null&&u!==null&&(l=u),u!==null)switch(i){case"min":l=Math.min(l,u);break;case"max":l=Math.max(l,u);break}}),l===null?"Not enough data":l}},{key:"getPartialMinMax",value:function(o,i,a){var l=null,s=o[1]||o[0],u;do{if(u=this.getCellValue(s,i),u=Tw(u)?null:u,l===null)l=u;else if(u!==null)switch(a){case"min":l=Math.min(l,u);break;case"max":l=Math.max(l,u);break}s-=1}while(s>=o[0]);return l}},{key:"countEmpty",value:function(o,i){var a,l=0,s=o[1]||o[0];do a=this.getCellValue(s,i),a=Tw(a)?null:a,a===null&&(l+=1),s-=1;while(s>=o[0]);return l}},{key:"countEntries",value:function(o){var i=this,a=0,l=o.ranges;return Ke(l,function(s){var u=s[1]===void 0?1:s[1]-s[0]+1,f=i.countEmpty(s,o.sourceColumn);a+=u,a-=f}),a}},{key:"calculateAverage",value:function(o){var i=this.calculateSum(o),a=this.countEntries(o);return i/a}},{key:"getCellValue",value:function(o,i){var a=this.hot.toVisualRow(o),l=this.hot.toVisualColumn(i),s=this.hot.getSourceDataAtCell(o,i),u="";if(a!==null&&l!==null&&(u=this.hot.getCellMeta(a,l).className||""),u.indexOf("columnSummaryResult")>-1)return null;if(this.endpoints.currentEndpoint.forceNumeric&&(typeof s=="string"&&(s=s.replace(/,/,".")),s=parseFloat(s)),isNaN(s)&&!this.endpoints.currentEndpoint.suppressDataTypeErrors)throw new Error(ft(Ix||(Ix=Oke(["ColumnSummary plugin: cell at (",", ",`) is not in a 
          numeric format. Cannot do the calculation.`],["ColumnSummary plugin: cell at (",", ",`) is not in a\\x20
          numeric format. Cannot do the calculation.`])),o,i));return s}},{key:"onAfterInit",value:function(){this.endpoints.endpoints=this.endpoints.parseSettings(),this.endpoints.refreshAllEndpoints(!0)}},{key:"onAfterChange",value:function(o,i){o&&i!=="ColumnSummary.reset"&&i!=="ColumnSummary.set"&&i!=="loadData"&&this.endpoints.refreshChangedEndpoints(o)}},{key:"onAfterRowMove",value:function(o,i){this.endpoints.resetSetupBeforeStructureAlteration("move_row",o[0],o.length,o,this.pluginName),this.endpoints.resetSetupAfterStructureAlteration("move_row",i,o.length,o,this.pluginName)}}],[{key:"PLUGIN_KEY",get:function(){return kw}},{key:"PLUGIN_PRIORITY",get:function(){return Dke}}]),r}(it);function Vh(e){"@babel/helpers - typeof";return Vh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Vh(e)}function Hke(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function xx(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,jke(n.key),n)}}function Lke(e,t,r){return t&&xx(e.prototype,t),r&&xx(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function jke(e){var t=Fke(e,"string");return Vh(t)==="symbol"?t:String(t)}function Fke(e,t){if(Vh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Vh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Bke=function(){function e(t,r){Hke(this,e),this.rootDocument=t,this.isRtl=r,this.container=null,this.editor=this.createEditor(),this.editorStyle=this.editor.style,this.hidden=!0,this.hide()}return Lke(e,[{key:"setPosition",value:function(r,n){this.editorStyle.left="".concat(r,"px"),this.editorStyle.top="".concat(n,"px")}},{key:"setSize",value:function(r,n){if(r&&n){var o=this.getInputElement();o.style.width="".concat(r,"px"),o.style.height="".concat(n,"px")}}},{key:"getSize",value:function(){return{width:ut(this.getInputElement()),height:Tt(this.getInputElement())}}},{key:"resetSize",value:function(){var r=this.getInputElement();r.style.width="",r.style.height=""}},{key:"setReadOnlyState",value:function(r){var n=this.getInputElement();n.readOnly=r}},{key:"show",value:function(){this.editorStyle.display="block",this.hidden=!1}},{key:"hide",value:function(){this.hidden||(this.editorStyle.display="none"),this.hidden=!0}},{key:"isVisible",value:function(){return this.editorStyle.display==="block"}},{key:"setValue",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",n=r||"";this.getInputElement().value=n}},{key:"getValue",value:function(){return this.getInputElement().value}},{key:"isFocused",value:function(){return this.rootDocument.activeElement===this.getInputElement()}},{key:"focus",value:function(){this.getInputElement().focus()}},{key:"createEditor",value:function(){var r=this.rootDocument.createElement("div"),n=this.rootDocument.createElement("textarea");return r.style.display="none",this.container=this.rootDocument.createElement("div"),this.container.setAttribute("dir",this.isRtl?"rtl":"ltr"),re(this.container,e.CLASS_EDITOR_CONTAINER),this.rootDocument.body.appendChild(this.container),re(r,e.CLASS_EDITOR),re(n,e.CLASS_INPUT),r.appendChild(n),this.container.appendChild(r),r}},{key:"getInputElement",value:function(){return this.editor.querySelector(".".concat(e.CLASS_INPUT))}},{key:"destroy",value:function(){var r=this.container?this.container.parentNode:null;this.editor.parentNode.removeChild(this.editor),this.editor=null,this.editorStyle=null,r&&r.removeChild(this.container)}}],[{key:"CLASS_EDITOR_CONTAINER",get:function(){return"htCommentsContainer"}},{key:"CLASS_EDITOR",get:function(){return"htComments"}},{key:"CLASS_INPUT",get:function(){return"htCommentTextArea"}},{key:"CLASS_CELL",get:function(){return"htCommentCell"}}]),e}();const Vke=Bke;var ze="---------";function Wke(){return{name:ze}}function Uke(e){return Ye(e,function(t){return{start:t.getTopStartCorner(),end:t.getBottomEndCorner()}})}function ey(e){return xe(e,"htSeparator")}function zke(e){return xe(e,"htSubmenu")}function ty(e){return xe(e,"htDisabled")}function ry(e){return xe(e,"htSelectionDisabled")}function Qa(e){var t=e.getSelected();return!t||t[0]<0?null:t}function Yke(e,t){if(e.indexOf(t)!==-1)return e;var r=e.replace("htTop","").replace("htMiddle","").replace("htBottom","").replace("  ","");return"".concat(r," ").concat(t)}function Gke(e,t){if(e.indexOf(t)!==-1)return e;var r=e.replace("htLeft","").replace("htCenter","").replace("htRight","").replace("htJustify","").replace("  ","");return"".concat(r," ").concat(t)}function Li(e,t){var r={};return I(e,function(n){n.forAll(function(o,i){o>=0&&i>=0&&(r[o]||(r[o]=[]),r[o][i]=t(o,i))})}),r}function Jo(e,t,r,n,o){I(e,function(i){i.forAll(function(a,l){a>=0&&l>=0&&Kke(a,l,t,r,n,o)})})}function Kke(e,t,r,n,o,i){var a=o(e,t),l=n;a.className&&(r==="vertical"?l=Yke(a.className,n):l=Gke(a.className,n)),i(e,t,"className",l)}function kn(e,t){var r=!1;return Array.isArray(e)&&I(e,function(n){return n.forAll(function(o,i){if(o>=0&&i>=0&&t(o,i))return r=!0,!1}),r}),r}function eo(e){return'<span class="selected">'.concat(String.fromCharCode(10003),"</span>").concat(e)}function qke(e,t){return!e.hidden||!(typeof e.hidden=="function"&&e.hidden.call(t))}function T2(e,t){for(var r=e.slice(0),n=0;n<r.length&&r[n].name===t;)r.shift();return r}function Xke(e,t){var r=e.slice(0);return r.reverse(),r=T2(r,t),r.reverse(),r}function Zke(e){var t=[];return I(e,function(r,n){n>0?t[t.length-1].name!==r.name&&t.push(r):t.push(r)}),t}function Qke(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:ze,r=e.slice(0);return r=T2(r,t),r=Xke(r,t),r=Zke(r),r}function Wh(e){"@babel/helpers - typeof";return Wh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Wh(e)}function Jke(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Dx(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,tPe(n.key),n)}}function ePe(e,t,r){return t&&Dx(e.prototype,t),r&&Dx(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function tPe(e){var t=rPe(e,"string");return Wh(t)==="symbol"?t:String(t)}function rPe(e,t){if(Wh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Wh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var nPe=250,oPe=250,k2=function(){function e(t){Jke(this,e),this.wasLastActionShow=!0,this.showDebounced=null,this.hidingTimer=null,this.updateDelay(t)}return ePe(e,[{key:"hide",value:function(){var r=this;this.wasLastActionShow=!1,this.hidingTimer=setTimeout(function(){r.wasLastActionShow===!1&&r.runLocalHooks("hide")},oPe)}},{key:"show",value:function(r){this.wasLastActionShow=!0,this.showDebounced(r)}},{key:"cancelHiding",value:function(){this.wasLastActionShow=!0,clearTimeout(this.hidingTimer),this.hidingTimer=null}},{key:"updateDelay",value:function(){var r=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:nPe;this.showDebounced=DB(function(o){r.wasLastActionShow&&r.runLocalHooks("show",o.from.row,o.from.col)},n)}},{key:"destroy",value:function(){this.clearLocalHooks()}}]),e}();dt(k2,Er);const iPe=k2;function au(e){"@babel/helpers - typeof";return au=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},au(e)}function Pw(e,t,r){return t=P2(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function aPe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Nx(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,P2(n.key),n)}}function lPe(e,t,r){return t&&Nx(e.prototype,t),r&&Nx(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function P2(e){var t=sPe(e,"string");return au(t)==="symbol"?t:String(t)}function sPe(e,t){if(au(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(au(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ra(){return typeof Reflect<"u"&&Reflect.get?ra=Reflect.get.bind():ra=function(t,r,n){var o=uPe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},ra.apply(this,arguments)}function uPe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=fo(e),e!==null););return e}function fPe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&K_(e,t)}function K_(e,t){return K_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},K_(e,t)}function cPe(e){var t=dPe();return function(){var n=fo(e),o;if(t){var i=fo(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return hPe(this,o)}}function hPe(e,t){if(t&&(au(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return $2(e)}function $2(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function dPe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function fo(e){return fo=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},fo(e)}var $w="comments",vPe=60,ny=new WeakMap,wn="comment",yl="value",Hx="style",oy="readOnly",yPe=function(e){fPe(r,e);var t=cPe(r);function r(n){var o;return aPe(this,r),o=t.call(this,n),o.editor=null,o.displaySwitch=null,o.eventManager=null,o.range={},o.preventEditorAutoSwitch=!1,ny.set($2(o),{tempEditorDimensions:{},cellBelowCursor:null}),o}return lPe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[$w]}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.editor||(this.editor=new Vke(this.hot.rootDocument,this.hot.isRtl())),this.eventManager||(this.eventManager=new Pt(this)),this.displaySwitch||(this.displaySwitch=new iPe(this.getDisplayDelaySetting())),this.addHook("afterContextMenuDefaultOptions",function(i){return o.addToContextMenu(i)}),this.addHook("afterRenderer",function(i,a,l,s,u,f){return o.onAfterRenderer(i,f)}),this.addHook("afterScrollHorizontally",function(){return o.hide()}),this.addHook("afterScrollVertically",function(){return o.hide()}),this.addHook("afterBeginEditing",function(){return o.hide()}),this.displaySwitch.addLocalHook("hide",function(){return o.hide()}),this.displaySwitch.addLocalHook("show",function(i,a){return o.showAtCell(i,a)}),this.registerListeners(),ra(fo(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),ra(fo(r.prototype),"updatePlugin",this).call(this),this.displaySwitch.updateDelay(this.getDisplayDelaySetting())}},{key:"disablePlugin",value:function(){ra(fo(r.prototype),"disablePlugin",this).call(this)}},{key:"registerListeners",value:function(){var o=this,i=this.hot.rootDocument;this.eventManager.addEventListener(i,"mouseover",function(a){return o.onMouseOver(a)}),this.eventManager.addEventListener(i,"mousedown",function(a){return o.onMouseDown(a)}),this.eventManager.addEventListener(i,"mouseup",function(){return o.onMouseUp()}),this.eventManager.addEventListener(this.editor.getInputElement(),"blur",function(){return o.onEditorBlur()}),this.eventManager.addEventListener(this.editor.getInputElement(),"mousedown",function(a){return o.onEditorMouseDown(a)}),this.eventManager.addEventListener(this.editor.getInputElement(),"mouseup",function(a){return o.onEditorMouseUp(a)})}},{key:"setRange",value:function(o){this.range=o}},{key:"clearRange",value:function(){this.range={}}},{key:"targetIsCellWithComment",value:function(o){var i=Ra(o.target,"TD","TBODY");return!!(i&&xe(i,"htCommentCell")&&Ra(i,[this.hot.rootElement]))}},{key:"targetIsCommentTextArea",value:function(o){return this.editor.getInputElement()===o.target}},{key:"setComment",value:function(o){if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');var i=this.editor.getValue(),a="";o!=null?a=o:i!=null&&(a=i);var l=this.range.from.row,s=this.range.from.col;this.updateCommentMeta(l,s,Pw({},yl,a)),this.hot.render()}},{key:"setCommentAtCell",value:function(o,i,a){this.setRange({from:this.hot._createCellCoords(o,i)}),this.setComment(a)}},{key:"removeComment",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');this.hot.setCellMeta(this.range.from.row,this.range.from.col,wn),o&&this.hot.render(),this.hide()}},{key:"removeCommentAtCell",value:function(o,i){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;this.setRange({from:this.hot._createCellCoords(o,i)}),this.removeComment(a)}},{key:"getComment",value:function(){var o=this.range.from.row,i=this.range.from.col;return this.getCommentMeta(o,i,yl)}},{key:"getCommentAtCell",value:function(o,i){return this.getCommentMeta(o,i,yl)}},{key:"show",value:function(){if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');var o=this.range.from,i=o.row,a=o.col;if(i<0||i>this.hot.countSourceRows()-1||a<0||a>this.hot.countSourceCols()-1)return!1;var l=this.hot.getCellMeta(this.range.from.row,this.range.from.col);return this.editor.setValue(l[wn]?l[wn][yl]:""),this.editor.show(),this.refreshEditor(!0),!0}},{key:"showAtCell",value:function(o,i){return this.setRange({from:this.hot._createCellCoords(o,i)}),this.show()}},{key:"hide",value:function(){this.editor.hide()}},{key:"refreshEditor",value:function(){var o,i,a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(!(!a&&(!this.range.from||!this.editor.isVisible()))){var l=this.hot,s=l.rowIndexMapper,u=l.columnIndexMapper,f=this.range.from,c=f.row,h=f.col,d=s.getRenderableFromVisualIndex(c),v=u.getRenderableFromVisualIndex(h),y=d===null;this.editor.setPosition(0,0),d===null&&(d=s.getRenderableFromVisualIndex(s.getNearestNotHiddenIndex(c,-1))),v===null&&(v=u.getRenderableFromVisualIndex(u.getNearestNotHiddenIndex(h,-1)));var p=d===null,w=v===null;d=(o=d)!==null&&o!==void 0?o:0,v=(i=v)!==null&&i!==void 0?i:0;var S=this.hot,C=S.rootWindow,P=S.view._wt,R=P.wtTable,W=P.getCell({row:d,col:v},!0),Y=this.getCommentMeta(c,h,Hx);Y?this.editor.setSize(Y.width,Y.height):this.editor.resetSize();var q=w?0:R.getStretchedColumnWidth(v),G=y&&!p?Tt(W):0,X=W.getBoundingClientRect(),Q=X.left,oe=X.top,J=X.width,ue=X.height,de=this.editor.getSize(),Oe=de.width,be=de.height,$=this.hot.rootWindow,k=$.innerWidth,g=$.innerHeight,m=this.hot.rootDocument.documentElement,b=Q+C.scrollX+q,E=oe+C.scrollY+G;this.hot.isRtl()&&(b-=Oe+q),this.hot.isLtr()&&Q+J+Oe>k?b=Q+C.scrollX-Oe-1:this.hot.isRtl()&&b<-(m.scrollWidth-m.clientWidth)&&(b=Q+C.scrollX+q+1),oe+be>g&&(E-=be-ue+1),this.editor.setPosition(b,E),this.editor.setReadOnlyState(this.getCommentMeta(c,h,oy))}}},{key:"checkSelectionCommentsConsistency",value:function(){var o=this.hot.getSelectedRangeLast();if(!o)return!1;var i=!1,a=o.getTopStartCorner();return this.getCommentMeta(a.row,a.col,yl)&&(i=!0),i}},{key:"updateCommentMeta",value:function(o,i,a){var l=this.hot.getCellMeta(o,i)[wn],s;l?(s=dr(l),ep(s,a)):s=a,this.hot.setCellMeta(o,i,wn,s)}},{key:"getCommentMeta",value:function(o,i,a){var l=this.hot.getCellMeta(o,i);if(l[wn])return l[wn][a]}},{key:"onMouseDown",value:function(o){if(!(!this.hot.view||!this.hot.view._wt)&&!this.preventEditorAutoSwitch&&!this.targetIsCommentTextArea(o)){var i=Ra(o.target,"TD","TBODY"),a=null;i&&(a=this.hot.getCoords(i)),(!i||this.range.from&&a&&(this.range.from.row!==a.row||this.range.from.col!==a.col))&&this.hide()}}},{key:"onMouseOver",value:function(o){var i=ny.get(this),a=this.hot.rootDocument;if(!(this.preventEditorAutoSwitch||this.editor.isFocused()||xe(o.target,"wtBorder")||i.cellBelowCursor===o.target||!this.editor))if(i.cellBelowCursor=a.elementFromPoint(o.clientX,o.clientY),this.targetIsCellWithComment(o)){var l=this.hot._createCellRange(this.hot.getCoords(o.target));this.displaySwitch.show(l)}else Ea(o.target,a)&&!this.targetIsCommentTextArea(o)&&this.displaySwitch.hide()}},{key:"onMouseUp",value:function(){this.preventEditorAutoSwitch=!1}},{key:"onAfterRenderer",value:function(o,i){i[wn]&&i[wn][yl]&&re(o,i.commentedCellClassName)}},{key:"onEditorBlur",value:function(){this.setComment()}},{key:"onEditorMouseDown",value:function(o){var i=ny.get(this);i.tempEditorDimensions={width:ut(o.target),height:Tt(o.target)}}},{key:"onEditorMouseUp",value:function(o){var i=ny.get(this),a=ut(o.target),l=Tt(o.target);(a!==i.tempEditorDimensions.width+1||l!==i.tempEditorDimensions.height+2)&&this.updateCommentMeta(this.range.from.row,this.range.from.col,Pw({},Hx,{width:a,height:l}))}},{key:"onContextMenuAddComment",value:function(){var o=this.hot.getSelectedRangeLast();this.preventEditorAutoSwitch=!0,this.displaySwitch.cancelHiding(),this.setRange({from:o.highlight}),this.show(),this.hot.deselectCell(),this.editor.focus()}},{key:"onContextMenuRemoveComment",value:function(){var o=this,i=this.hot.getSelectedRangeLast();this.preventEditorAutoSwitch=!0,i.forAll(function(a,l){a>=0&&l>=0&&o.removeCommentAtCell(a,l,!1)}),this.hot.render()}},{key:"onContextMenuMakeReadOnly",value:function(){var o=this,i=this.hot.getSelectedRangeLast();this.preventEditorAutoSwitch=!0,i.forAll(function(a,l){if(a>=0&&l>=0){var s=!!o.getCommentMeta(a,l,oy);o.updateCommentMeta(a,l,Pw({},oy,!s))}})}},{key:"addToContextMenu",value:function(o){var i=this,a=function(){return i.hot.rowIndexMapper.getRenderableIndexesLength()>0&&i.hot.columnIndexMapper.getRenderableIndexesLength()>0};o.items.push({name:"---------"},{key:"commentsAddEdit",name:function(){return i.checkSelectionCommentsConsistency()?i.hot.getTranslatedPhrase(T0):i.hot.getTranslatedPhrase(E0)},callback:function(){return i.onContextMenuAddComment()},disabled:function(){return a()?!(i.hot.getSelectedLast()&&!i.hot.selection.isSelectedByCorner()):!0}},{key:"commentsRemove",name:function(){return this.getTranslatedPhrase(k0)},callback:function(){return i.onContextMenuRemoveComment()},disabled:function(){return a()?!(i.hot.getSelectedLast()&&!i.hot.selection.isSelectedByCorner()):!0}},{key:"commentsReadOnly",name:function(){var s=this,u=this.getTranslatedPhrase(P0),f=kn(this.getSelectedRangeLast(),function(c,h){var d=s.getCellMeta(c,h)[wn];if(d&&(d=d[oy]),d)return!0});return f&&(u=eo(u)),u},callback:function(){return i.onContextMenuMakeReadOnly()},disabled:function(){return a()?!(i.hot.getSelectedLast()&&!i.hot.selection.isSelectedByCorner())||!i.checkSelectionCommentsConsistency():!0}})}},{key:"getDisplayDelaySetting",value:function(){var o=this.hot.getSettings()[$w];if(Ge(o))return o.displayDelay}},{key:"destroy",value:function(){this.editor&&this.editor.destroy(),this.displaySwitch&&this.displaySwitch.destroy(),ra(fo(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return $w}},{key:"PLUGIN_PRIORITY",get:function(){return vPe}}]),r}(it);function Uh(e){"@babel/helpers - typeof";return Uh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Uh(e)}function gPe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Lx(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,pPe(n.key),n)}}function mPe(e,t,r){return t&&Lx(e.prototype,t),r&&Lx(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function pPe(e){var t=bPe(e,"string");return Uh(t)==="symbol"?t:String(t)}function bPe(e,t){if(Uh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Uh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var wPe=function(){function e(t){gPe(this,e),this.hot=t,this.commands={},this.commonCallback=null}return mPe(e,[{key:"registerCommand",value:function(r,n){this.commands[r]=n}},{key:"setCommonCallback",value:function(r){this.commonCallback=r}},{key:"execute",value:function(r){for(var n=this,o=arguments.length,i=new Array(o>1?o-1:0),a=1;a<o;a++)i[a-1]=arguments[a];var l=r.split(":"),s=l[0],u=l.length===2?l[1]:null,f=this.commands[s];if(!f)throw new Error("Menu command '".concat(s,"' not exists."));if(u&&f.submenu&&(f=SPe(u,f.submenu.items)),f.disabled!==!0&&!(typeof f.disabled=="function"&&f.disabled.call(this.hot)===!0)&&!It(f,"submenu")){var c=[];typeof f.callback=="function"&&c.push(f.callback),typeof this.commonCallback=="function"&&c.push(this.commonCallback),i.unshift(l.join(":")),I(c,function(h){return h.apply(n.hot,i)})}}}]),e}();function SPe(e,t){var r;return I(t,function(n){var o=n.key?n.key.split(":"):null;if(Array.isArray(o)&&o[1]===e)return r=n,!1}),r}const A2=wPe;var Wr="alignment";function CPe(){return{key:Wr,name:function(){return this.getTranslatedPhrase($0)},disabled:function(){return this.countRows()===0||this.countCols()===0?!0:!(this.getSelectedRange()&&!this.selection.isSelectedByCorner())},submenu:{items:[{key:"".concat(Wr,":left"),name:function(){var t=this,r=this.getTranslatedPhrase(A0),n=kn(this.getSelectedRange(),function(o,i){var a=t.getCellMeta(o,i).className;if(a&&a.indexOf("htLeft")!==-1)return!0});return n&&(r=eo(r)),r},callback:function(){var t=this,r=this.getSelectedRange(),n=Li(r,function(a,l){return t.getCellMeta(a,l).className}),o="horizontal",i="htLeft";this.runHooks("beforeCellAlignment",n,r,o,i),Jo(r,o,i,function(a,l){return t.getCellMeta(a,l)},function(a,l,s,u){return t.setCellMeta(a,l,s,u)}),this.render()},disabled:!1},{key:"".concat(Wr,":center"),name:function(){var t=this,r=this.getTranslatedPhrase(I0),n=kn(this.getSelectedRange(),function(o,i){var a=t.getCellMeta(o,i).className;if(a&&a.indexOf("htCenter")!==-1)return!0});return n&&(r=eo(r)),r},callback:function(){var t=this,r=this.getSelectedRange(),n=Li(r,function(a,l){return t.getCellMeta(a,l).className}),o="horizontal",i="htCenter";this.runHooks("beforeCellAlignment",n,r,o,i),Jo(r,o,i,function(a,l){return t.getCellMeta(a,l)},function(a,l,s,u){return t.setCellMeta(a,l,s,u)}),this.render()},disabled:!1},{key:"".concat(Wr,":right"),name:function(){var t=this,r=this.getTranslatedPhrase(M0),n=kn(this.getSelectedRange(),function(o,i){var a=t.getCellMeta(o,i).className;if(a&&a.indexOf("htRight")!==-1)return!0});return n&&(r=eo(r)),r},callback:function(){var t=this,r=this.getSelectedRange(),n=Li(r,function(a,l){return t.getCellMeta(a,l).className}),o="horizontal",i="htRight";this.runHooks("beforeCellAlignment",n,r,o,i),Jo(r,o,i,function(a,l){return t.getCellMeta(a,l)},function(a,l,s,u){return t.setCellMeta(a,l,s,u)}),this.render()},disabled:!1},{key:"".concat(Wr,":justify"),name:function(){var t=this,r=this.getTranslatedPhrase(x0),n=kn(this.getSelectedRange(),function(o,i){var a=t.getCellMeta(o,i).className;if(a&&a.indexOf("htJustify")!==-1)return!0});return n&&(r=eo(r)),r},callback:function(){var t=this,r=this.getSelectedRange(),n=Li(r,function(a,l){return t.getCellMeta(a,l).className}),o="horizontal",i="htJustify";this.runHooks("beforeCellAlignment",n,r,o,i),Jo(r,o,i,function(a,l){return t.getCellMeta(a,l)},function(a,l,s,u){return t.setCellMeta(a,l,s,u)}),this.render()},disabled:!1},{name:ze},{key:"".concat(Wr,":top"),name:function(){var t=this,r=this.getTranslatedPhrase(D0),n=kn(this.getSelectedRange(),function(o,i){var a=t.getCellMeta(o,i).className;if(a&&a.indexOf("htTop")!==-1)return!0});return n&&(r=eo(r)),r},callback:function(){var t=this,r=this.getSelectedRange(),n=Li(r,function(a,l){return t.getCellMeta(a,l).className}),o="vertical",i="htTop";this.runHooks("beforeCellAlignment",n,r,o,i),Jo(r,o,i,function(a,l){return t.getCellMeta(a,l)},function(a,l,s,u){return t.setCellMeta(a,l,s,u)}),this.render()},disabled:!1},{key:"".concat(Wr,":middle"),name:function(){var t=this,r=this.getTranslatedPhrase(N0),n=kn(this.getSelectedRange(),function(o,i){var a=t.getCellMeta(o,i).className;if(a&&a.indexOf("htMiddle")!==-1)return!0});return n&&(r=eo(r)),r},callback:function(){var t=this,r=this.getSelectedRange(),n=Li(r,function(a,l){return t.getCellMeta(a,l).className}),o="vertical",i="htMiddle";this.runHooks("beforeCellAlignment",n,r,o,i),Jo(r,o,i,function(a,l){return t.getCellMeta(a,l)},function(a,l,s,u){return t.setCellMeta(a,l,s,u)}),this.render()},disabled:!1},{key:"".concat(Wr,":bottom"),name:function(){var t=this,r=this.getTranslatedPhrase(H0),n=kn(this.getSelectedRange(),function(o,i){var a=t.getCellMeta(o,i).className;if(a&&a.indexOf("htBottom")!==-1)return!0});return n&&(r=eo(r)),r},callback:function(){var t=this,r=this.getSelectedRange(),n=Li(r,function(a,l){return t.getCellMeta(a,l).className}),o="vertical",i="htBottom";this.runHooks("beforeCellAlignment",n,r,o,i),Jo(r,o,i,function(a,l){return t.getCellMeta(a,l)},function(a,l,s,u){return t.setCellMeta(a,l,s,u)}),this.render()},disabled:!1}]}}}var Pp="clear_column";function _Pe(){return{key:Pp,name:function(){return this.getTranslatedPhrase(g0)},callback:function(t,r){var n=r[0].start.col,o=r[0].end.col;this.countRows()&&this.populateFromArray(0,n,[[null]],Math.max(r[0].start.row,r[0].end.row),o,"ContextMenu.clearColumn")},disabled:function(){var t=Qa(this);return t?!this.selection.isSelectedByColumnHeader():!0}}}var dv="col_left";function OPe(){return{key:dv,name:function(){return this.getTranslatedPhrase(u0)},callback:function(){var t=this.getSelectedRangeLast().getTopLeftCorner(),r=this.isRtl()?"insert_col_end":"insert_col_start";this.alter(r,t.col,1,"ContextMenu.columnLeft")},disabled:function(){if(!this.isColumnModificationAllowed())return!0;var t=Qa(this);if(!t)return!0;if(this.selection.isSelectedByCorner()){var r=this.countCols();return r===0}return this.selection.isSelectedByRowHeader()||this.countCols()>=this.getSettings().maxCols},hidden:function(){return!this.getSettings().allowInsertColumn}}}var vv="col_right";function RPe(){return{key:vv,name:function(){return this.getTranslatedPhrase(f0)},callback:function(){var t=this.getSelectedRangeLast().getTopRightCorner(),r=this.isRtl()?"insert_col_start":"insert_col_end";this.alter(r,t.col,1,"ContextMenu.columnRight")},disabled:function(){if(!this.isColumnModificationAllowed())return!0;var t=Qa(this);return t?this.selection.isSelectedByCorner()?!1:this.selection.isSelectedByRowHeader()||this.countCols()>=this.getSettings().maxCols:!0},hidden:function(){return!this.getSettings().allowInsertColumn}}}var yv="make_read_only";function EPe(){return{key:yv,name:function(){var t=this,r=this.getTranslatedPhrase(y0),n=kn(this.getSelectedRange(),function(o,i){return t.getCellMeta(o,i).readOnly});return n&&(r=eo(r)),r},callback:function(){var t=this,r=this.getSelectedRange(),n=kn(r,function(o,i){return t.getCellMeta(o,i).readOnly});I(r,function(o){o.forAll(function(i,a){i>=0&&a>=0&&t.setCellMeta(i,a,"readOnly",!n)})}),this.render()},disabled:function(){return!!(this.selection.isSelectedByCorner()||this.countRows()===0||this.countCols()===0||!this.getSelectedRange()||this.getSelectedRange().length===0)}}}var $p="redo";function TPe(){return{key:$p,name:function(){return this.getTranslatedPhrase(v0)},callback:function(){this.redo()},hidden:function(){var t=this.getPlugin("undoRedo");return!t||!t.isEnabled()},disabled:function(){return!this.getPlugin("undoRedo").isRedoAvailable()}}}function kPe(e,t){return IPe(e)||APe(e,t)||$Pe(e,t)||PPe()}function PPe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function $Pe(e,t){if(e){if(typeof e=="string")return jx(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return jx(e,t)}}function jx(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function APe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function IPe(e){if(Array.isArray(e))return e}var gv="remove_col";function MPe(){return{key:gv,name:function(){var t=this.getSelected(),r=0;if(t)if(t.length>1)r=1;else{var n=kPe(t[0],4),o=n[1],i=n[3];o-i!==0&&(r=1)}return this.getTranslatedPhrase(h0,r)},callback:function(){this.alter("remove_col",zbe(this.getSelected()),null,"ContextMenu.removeColumn")},disabled:function(){if(!this.isColumnModificationAllowed())return!0;var t=Qa(this);if(!t)return!0;var r=this.countCols();return this.selection.isSelectedByCorner()?r===0:this.selection.isSelectedByRowHeader()||r===0},hidden:function(){return!this.getSettings().allowRemoveColumn}}}function xPe(e,t){return LPe(e)||HPe(e,t)||NPe(e,t)||DPe()}function DPe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function NPe(e,t){if(e){if(typeof e=="string")return Fx(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Fx(e,t)}}function Fx(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function HPe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function LPe(e){if(Array.isArray(e))return e}var Ap="remove_row";function jPe(){return{key:Ap,name:function(){var t=this.getSelected(),r=0;if(t)if(t.length>1)r=1;else{var n=xPe(t[0],3),o=n[0],i=n[2];o-i!==0&&(r=1)}return this.getTranslatedPhrase(c0,r)},callback:function(){this.alter("remove_row",Ybe(this.getSelected()),1,"ContextMenu.removeRow")},disabled:function(){var t=Qa(this);if(!t)return!0;var r=this.countRows();return this.selection.isSelectedByCorner()?r===0:this.selection.isSelectedByColumnHeader()||r===0},hidden:function(){return!this.getSettings().allowRemoveRow}}}var Ip="row_above";function FPe(){return{key:Ip,name:function(){return this.getTranslatedPhrase(l0)},callback:function(){var t=this.getSelectedRangeLast().getTopLeftCorner();this.alter("insert_row_above",t.row,1,"ContextMenu.rowAbove")},disabled:function(){var t=Qa(this);if(!t)return!0;if(this.selection.isSelectedByCorner()){var r=this.countRows();return r===0}return this.selection.isSelectedByColumnHeader()||this.countRows()>=this.getSettings().maxRows},hidden:function(){return!this.getSettings().allowInsertRow}}}var Mp="row_below";function BPe(){return{key:Mp,name:function(){return this.getTranslatedPhrase(s0)},callback:function(){var t=this.getSelectedRangeLast().getBottomRightCorner();this.alter("insert_row_below",t.row,1,"ContextMenu.rowBelow")},disabled:function(){var t=Qa(this);return t?this.selection.isSelectedByCorner()?!1:this.selection.isSelectedByColumnHeader()||this.countRows()>=this.getSettings().maxRows:!0},hidden:function(){return!this.getSettings().allowInsertRow}}}var zh="no_items";function VPe(){return{key:zh,name:function(){return this.getTranslatedPhrase(a0)},disabled:!0,isCommand:!1}}var xp="undo";function WPe(){return{key:xp,name:function(){return this.getTranslatedPhrase(d0)},callback:function(){this.undo()},hidden:function(){var t=this.getPlugin("undoRedo");return!t||!t.isEnabled()},disabled:function(){return!this.getPlugin("undoRedo").isUndoAvailable()}}}function Yh(e){"@babel/helpers - typeof";return Yh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Yh(e)}var sr;function Tr(e,t,r){return t=UPe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function UPe(e){var t=zPe(e,"string");return Yh(t)==="symbol"?t:String(t)}function zPe(e,t){if(Yh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Yh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var YPe=[Ip,Mp,dv,vv,Pp,Ap,gv,xp,$p,yv,Wr,ze,zh],GPe=(sr={},Tr(sr,ze,Wke),Tr(sr,zh,VPe),Tr(sr,Ip,FPe),Tr(sr,Mp,BPe),Tr(sr,dv,OPe),Tr(sr,vv,RPe),Tr(sr,Pp,_Pe),Tr(sr,Ap,jPe),Tr(sr,gv,MPe),Tr(sr,xp,WPe),Tr(sr,$p,TPe),Tr(sr,yv,EPe),Tr(sr,Wr,CPe),sr);function I2(){var e={};return Ke(GPe,function(t,r){e[r]=t()}),e}function Gh(e){"@babel/helpers - typeof";return Gh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Gh(e)}function KPe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Bx(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,XPe(n.key),n)}}function qPe(e,t,r){return t&&Bx(e.prototype,t),r&&Bx(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function XPe(e){var t=ZPe(e,"string");return Gh(t)==="symbol"?t:String(t)}function ZPe(e,t){if(Gh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Gh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var QPe=function(){function e(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;KPe(this,e),this.hot=t,this.predefinedItems=I2(),this.defaultOrderPattern=r}return qPe(e,[{key:"setPredefinedItems",value:function(r){var n=this,o={};this.defaultOrderPattern.length=0,Ke(r,function(i,a){var l="";i.name===ze?(o[ze]=i,l=ze):isNaN(parseInt(a,10))?(i.key=i.key===void 0?a:i.key,o[a]=i,l=i.key):(o[i.key]=i,l=i.key),n.defaultOrderPattern.push(l)}),this.predefinedItems=o}},{key:"getItems",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return JPe(r,this.defaultOrderPattern,this.predefinedItems)}}]),e}();function JPe(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},n=[],o=e;return o&&o.items?o=o.items:Array.isArray(o)||(o=t),Ge(o)?Ke(o,function(i,a){var l=r[typeof i=="string"?i:a];l||(l=i),Ge(i)?Wt(l,i):typeof l=="string"&&(l={name:l}),l.key===void 0&&(l.key=a),n.push(l)}):I(o,function(i,a){var l=r[i];!l&&YPe.indexOf(i)>=0||(l||(l={name:i,key:"".concat(a)}),Ge(i)&&Wt(l,i),l.key===void 0&&(l.key=a),n.push(l))}),n}const M2=QPe;function Kh(e){"@babel/helpers - typeof";return Kh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Kh(e)}function e$e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Vx(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,r$e(n.key),n)}}function t$e(e,t,r){return t&&Vx(e.prototype,t),r&&Vx(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function r$e(e){var t=n$e(e,"string");return Kh(t)==="symbol"?t:String(t)}function n$e(e,t){if(Kh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Kh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var o$e=function(){function e(t,r){e$e(this,e);var n=$c(r),o=rs(r),i,a,l,s,u,f;this.rootWindow=r,this.type=this.getSourceType(t),this.type==="literal"?(i=parseInt(t.top,10),l=parseInt(t.left,10),u=t.height||0,f=t.width||0,a=i,s=l,i+=n,l+=o):this.type==="event"&&(i=parseInt(t.pageY,10),l=parseInt(t.pageX,10),u=t.target.clientHeight,f=t.target.clientWidth,a=i-n,s=l-o),this.top=i,this.topRelative=a,this.left=l,this.leftRelative=s,this.scrollTop=n,this.scrollLeft=o,this.cellHeight=u,this.cellWidth=f}return t$e(e,[{key:"getSourceType",value:function(r){var n="literal";return r instanceof Event&&(n="event"),n}},{key:"fitsAbove",value:function(r){return this.topRelative>=r.offsetHeight}},{key:"fitsBelow",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.innerHeight;return this.topRelative+r.offsetHeight<=n}},{key:"fitsOnRight",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.innerWidth;return this.leftRelative+this.cellWidth+r.offsetWidth<=n}},{key:"fitsOnLeft",value:function(r){return this.leftRelative>=r.offsetWidth}}]),e}();const i$e=o$e;function qh(e){"@babel/helpers - typeof";return qh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},qh(e)}function Wx(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function Ux(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Wx(Object(r),!0).forEach(function(n){a$e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Wx(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function a$e(e,t,r){return t=x2(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function l$e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function zx(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,x2(n.key),n)}}function s$e(e,t,r){return t&&zx(e.prototype,t),r&&zx(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function x2(e){var t=u$e(e,"string");return qh(t)==="symbol"?t:String(t)}function u$e(e,t){if(qh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(qh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Yx=215,D2="menu",f$e=D2,N2=function(){function e(t,r){l$e(this,e),this.hot=t,this.options=r||{parent:null,name:null,className:"",keepInViewport:!0,standalone:!1,minWidth:Yx,container:this.hot.rootDocument.documentElement},this.eventManager=new Pt(this),this.container=this.createContainer(this.options.name),this.hotMenu=null,this.hotSubMenus={},this.parentMenu=this.options.parent||null,this.menuItems=null,this.origOutsideClickDeselects=null,this.keyEvent=!1,this.offset={above:0,below:0,left:0,right:0},this._afterScrollCallback=null,this.registerEvents()}return s$e(e,[{key:"registerEvents",value:function(){for(var r=this,n=this.hot.rootWindow;n;)this.eventManager.addEventListener(n.document,"mousedown",function(o){return r.onDocumentMouseDown(o)}),this.eventManager.addEventListener(n.document,"contextmenu",function(o){return r.onDocumentContextMenu(o)}),n=Ag(n)}},{key:"setMenuItems",value:function(r){this.menuItems=r}},{key:"getSelectedItem",value:function(){return this.hasSelectedItem()?this.hotMenu.getSourceDataAtRow(this.hotMenu.getSelectedLast()[0]):null}},{key:"hasSelectedItem",value:function(){return Array.isArray(this.hotMenu.getSelectedLast())}},{key:"setOffset",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;this.offset[r]=n}},{key:"isSubMenu",value:function(){return this.parentMenu!==null}},{key:"open",value:function(){var r=this;this.runLocalHooks("beforeOpen"),this.container.removeAttribute("style"),this.container.style.display="block";var n=DB(function(d){return r.openSubMenu(d)},300),o=this.options.minWidth||Yx,i=!1,a=Yr(this.menuItems,function(d){return d.key===zh&&(i=!0),qke(d,r.hot)});if(a.length<1&&!i)a.push(I2()[zh]);else if(a.length===0)return;a=Qke(a,ze);var l=!1,s={data:a,colHeaders:!1,autoColumnSize:!0,autoWrapRow:!1,modifyColWidth:function(v){return ye(v)&&v<o?o:v},autoRowSize:!1,readOnly:!0,editor:!1,copyPaste:!1,maxCols:1,columns:[{data:"name",renderer:function(v,y,p,w,S,C){return r.menuItemRenderer(v,y,p,w,S,C)}}],renderAllRows:!0,fragmentSelection:!1,outsideClickDeselects:!1,disableVisualSelection:"area",layoutDirection:this.hot.isRtl()?"rtl":"ltr",afterOnCellMouseOver:function(v,y){r.isAllSubMenusClosed()?n(y.row):r.openSubMenu(y.row)},rowHeights:function(v){return a[v].name===ze?1:23},afterOnCellContextMenu:function(v){v.preventDefault(),U$()&&l&&r.hasSelectedItem()&&r.close(!0)},beforeOnCellMouseUp:function(v){r.hasSelectedItem()&&(l=!r.isCommandPassive(r.getSelectedItem()),r.executeCommand(v))},afterOnCellMouseUp:function(v){(!U$()||!$a(v))&&l&&r.hasSelectedItem()&&(An()||xF()?setTimeout(function(){return r.close(!0)},325):r.close(!0))},afterUnlisten:function(){!r.hasSelectedItem()&&r.isOpened()&&r.hotMenu.listen()}};this.origOutsideClickDeselects=this.hot.getSettings().outsideClickDeselects,this.hot.getSettings().outsideClickDeselects=!1,this.hotMenu=new PT(this.container,s),this.hotMenu.addHook("afterInit",function(){return r.onAfterInit()}),this.hotMenu.addHook("afterSelection",function(){return r.onAfterSelection.apply(r,arguments)}),this.hotMenu.init(),this.hotMenu.listen();var u=this.hotMenu.getShortcutManager(),f=u.addContext(f$e),c={group:D2},h=Ux(Ux({},c),{},{runOnlyIf:function(v){return xg(v.target)===!1||r.container.contains(v.target)===!1}});u.setActiveContextName("menu"),f.addShortcuts([{keys:[["Escape"]],callback:function(){r.keyEvent=!0,r.close(),r.keyEvent=!1}},{keys:[["ArrowDown"]],callback:function(){var v=r.hotMenu.getSelectedLast();r.keyEvent=!0,v?r.selectNextCell(v[0],v[1]):r.selectFirstCell(),r.keyEvent=!1}},{keys:[["ArrowUp"]],callback:function(){var v=r.hotMenu.getSelectedLast();r.keyEvent=!0,v?r.selectPrevCell(v[0],v[1]):r.selectLastCell(),r.keyEvent=!1}},{keys:[["ArrowRight"]],callback:function(){var v=r.hotMenu.getSelectedLast();if(r.keyEvent=!0,v){var y=r.openSubMenu(v[0]);y&&y.selectFirstCell()}r.keyEvent=!1}},{keys:[["ArrowLeft"]],callback:function(){var v=r.hotMenu.getSelectedLast();r.keyEvent=!0,v&&r.isSubMenu()&&(r.close(),r.parentMenu&&r.parentMenu.hotMenu.listen()),r.keyEvent=!1}},{keys:[["Enter"]],callback:function(v){var y=r.hotMenu.getSelectedLast();r.keyEvent=!0,r.hotMenu.getSourceDataAtRow(y[0]).submenu||(r.executeCommand(v),r.close(!0)),r.keyEvent=!1}},{keys:[["PageUp"]],callback:function(){var v=r.hotMenu.getSelectedLast();r.keyEvent=!0,v?r.hotMenu.selection.transformStart(-r.hotMenu.countVisibleRows(),0):r.selectFirstCell(),r.keyEvent=!1}},{keys:[["PageDown"]],callback:function(){var v=r.hotMenu.getSelectedLast();r.keyEvent=!0,v?r.hotMenu.selection.transformStart(r.hotMenu.countVisibleRows(),0):r.selectLastCell(),r.keyEvent=!1}}],h),this.blockMainTableCallbacks(),this.runLocalHooks("afterOpen")}},{key:"close",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.isOpened()&&(r&&this.parentMenu?this.parentMenu.close():(this.closeAllSubMenus(),this.container.style.display="none",this.releaseMainTableCallbacks(),this.hotMenu.destroy(),this.hotMenu=null,this.hot.getSettings().outsideClickDeselects=this.origOutsideClickDeselects,this.runLocalHooks("afterClose"),this.parentMenu&&this.parentMenu.hotMenu.listen()))}},{key:"openSubMenu",value:function(r){if(!this.hotMenu)return!1;var n=this.hotMenu.getCell(r,0);if(this.closeAllSubMenus(),!n||!zke(n))return!1;var o=this.hotMenu.getSourceDataAtRow(r),i=new e(this.hot,{parent:this,name:o.name,className:this.options.className,keepInViewport:!0,container:this.options.container});return i.setMenuItems(o.submenu.items),i.open(),i.setPosition(n.getBoundingClientRect()),this.hotSubMenus[o.key]=i,i}},{key:"closeSubMenu",value:function(r){var n=this.hotMenu.getSourceDataAtRow(r),o=this.hotSubMenus[n.key];o&&(o.destroy(),delete this.hotSubMenus[n.key])}},{key:"closeAllSubMenus",value:function(){var r=this;I(this.hotMenu.getData(),function(n,o){return r.closeSubMenu(o)})}},{key:"isAllSubMenusClosed",value:function(){return Object.keys(this.hotSubMenus).length===0}},{key:"destroy",value:function(){var r=this.container.parentNode;this.clearLocalHooks(),this.close(),this.parentMenu=null,this.eventManager.destroy(),r&&r.removeChild(this.container)}},{key:"isOpened",value:function(){return this.hotMenu!==null}},{key:"executeCommand",value:function(r){if(!(!this.isOpened()||!this.hasSelectedItem())){var n=this.getSelectedItem();if(this.runLocalHooks("select",n,r),!this.isCommandPassive(n)){var o=this.hot.getSelectedRange(),i=o?Uke(o):[];this.runLocalHooks("executeCommand",n.key,i,r),this.isSubMenu()&&this.parentMenu.runLocalHooks("executeCommand",n.key,i,r)}}}},{key:"isCommandPassive",value:function(r){var n=r.isCommand,o=r.name,i=r.disabled,a=r.submenu,l=i===!0||typeof i=="function"&&i.call(this.hot)===!0;return n===!1||o===ze||l===!0||a}},{key:"setPosition",value:function(r){var n=new i$e(r,this.container.ownerDocument.defaultView);this.options.keepInViewport?(n.fitsBelow(this.container)?this.setPositionBelowCursor(n):n.fitsAbove(this.container)?this.setPositionAboveCursor(n):this.setPositionBelowCursor(n),this.hot.isLtr()?this.setHorizontalPositionForLtr(n):this.setHorizontalPositionForRtl(n)):(this.setPositionBelowCursor(n),this.setPositionOnRightOfCursor(n))}},{key:"setHorizontalPositionForRtl",value:function(r){r.fitsOnLeft(this.container)?this.setPositionOnLeftOfCursor(r):this.setPositionOnRightOfCursor(r)}},{key:"setHorizontalPositionForLtr",value:function(r){r.fitsOnRight(this.container)?this.setPositionOnRightOfCursor(r):this.setPositionOnLeftOfCursor(r)}},{key:"setPositionAboveCursor",value:function(r){var n=this.offset.above+r.top-this.container.offsetHeight;this.isSubMenu()&&(n=r.top+r.cellHeight-this.container.offsetHeight+3),this.container.style.top="".concat(n,"px")}},{key:"setPositionBelowCursor",value:function(r){var n=this.offset.below+r.top+1;this.isSubMenu()&&(n=r.top-1),this.container.style.top="".concat(n,"px")}},{key:"setPositionOnRightOfCursor",value:function(r){var n=r.left;if(this.isSubMenu()){var o=this.parentMenu.container.getBoundingClientRect(),i=o.right;n+=r.cellWidth+i-(r.left+r.cellWidth)}else n+=this.offset.right;this.container.style.left="".concat(n,"px")}},{key:"setPositionOnLeftOfCursor",value:function(r){var n=this.offset.left+r.left-this.container.offsetWidth;if(this.isSubMenu()){var o=this.parentMenu.container.getBoundingClientRect(),i=o.left;n-=r.left-i}this.container.style.left="".concat(n,"px")}},{key:"selectFirstCell",value:function(){var r=this.hotMenu.getCell(0,0);ey(r)||ty(r)||ry(r)?this.selectNextCell(0,0):this.hotMenu.selectCell(0,0)}},{key:"selectLastCell",value:function(){var r=this.hotMenu.countRows()-1,n=this.hotMenu.getCell(r,0);ey(n)||ty(n)||ry(n)?this.selectPrevCell(r,0):(this.hotMenu.selectCell(r,0,void 0,void 0,!1),this.hotMenu.scrollViewportTo(r,0,!0,!1))}},{key:"selectNextCell",value:function(r,n){var o=r+1,i=o<this.hotMenu.countRows()?this.hotMenu.getCell(o,n):null;i&&(ey(i)||ty(i)||ry(i)?this.selectNextCell(o,n):this.hotMenu.selectCell(o,n))}},{key:"selectPrevCell",value:function(r,n){var o=r-1,i=o>=0?this.hotMenu.getCell(o,n):null;i&&(ey(i)||ty(i)||ry(i)?this.selectPrevCell(o,n):this.hotMenu.selectCell(o,n))}},{key:"menuItemRenderer",value:function(r,n,o,i,a,l){var s=this,u=r.getSourceDataAtRow(o),f=this.hot.rootDocument.createElement("div"),c=function(w){return It(w,"submenu")},h=function(w){return new RegExp(ze,"i").test(w.name)},d=function(w){return w.disabled===!0||typeof w.disabled=="function"&&w.disabled.call(s.hot)===!0},v=function(w){return w.disableSelection},y=l;typeof y=="function"&&(y=y.call(this.hot)),xn(n),re(f,"htItemWrapper"),n.appendChild(f),h(u)?re(n,"htSeparator"):typeof u.renderer=="function"?(re(n,"htCustomMenuRenderer"),n.appendChild(u.renderer(r,f,o,i,a,y))):vf(f,y),d(u)?(re(n,"htDisabled"),this.eventManager.addEventListener(n,"mouseenter",function(){return r.deselectCell()})):v(u)?(re(n,"htSelectionDisabled"),this.eventManager.addEventListener(n,"mouseenter",function(){return r.deselectCell()})):c(u)?(re(n,"htSubmenu"),v(u)?this.eventManager.addEventListener(n,"mouseenter",function(){return r.deselectCell()}):this.eventManager.addEventListener(n,"mouseenter",function(){return r.selectCell(o,i,void 0,void 0,!1,!1)})):(He(n,["htSubmenu","htDisabled"]),v(u)?this.eventManager.addEventListener(n,"mouseenter",function(){return r.deselectCell()}):this.eventManager.addEventListener(n,"mouseenter",function(){return r.selectCell(o,i,void 0,void 0,!1,!1)}))}},{key:"createContainer",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,n=this.options.container.ownerDocument,o=r,i;return o&&(vt(o)&&(o=o.call(this.hot),o===null||gt(o)?o="":o=o.toString()),o=o.replace(/[^A-z0-9]/g,"_"),o="".concat(this.options.className,"Sub_").concat(o),i=n.querySelector(".".concat(this.options.className,".").concat(o))),i||(i=n.createElement("div"),re(i,"htMenu ".concat(this.options.className)),o&&re(i,o),this.options.container.appendChild(i)),i}},{key:"blockMainTableCallbacks",value:function(){this._afterScrollCallback=function(){},this.hot.addHook("afterScrollVertically",this._afterScrollCallback),this.hot.addHook("afterScrollHorizontally",this._afterScrollCallback)}},{key:"releaseMainTableCallbacks",value:function(){this._afterScrollCallback&&(this.hot.removeHook("afterScrollVertically",this._afterScrollCallback),this.hot.removeHook("afterScrollHorizontally",this._afterScrollCallback),this._afterScrollCallback=null)}},{key:"onAfterInit",value:function(){var r=this.hotMenu.view._wt.wtTable,n=this.hotMenu.getSettings().data,o=r.hider.style,i=r.holder.style,a=parseInt(o.width,10),l=nr(n,function(s,u){return s+(u.name===ze?1:26)},0);i.width="".concat(a+3,"px"),i.height="".concat(l+3,"px"),o.height=i.height}},{key:"onAfterSelection",value:function(r,n,o,i,a){this.keyEvent===!1&&(a.value=!0)}},{key:"onDocumentMouseDown",value:function(r){this.isOpened()&&(this.options.standalone&&this.hotMenu&&!Ea(r.target,this.hotMenu.rootElement)?this.close(!0):(this.isAllSubMenusClosed()||this.isSubMenu())&&!Ea(r.target,".htMenu")&&this.close(!0))}},{key:"onDocumentContextMenu",value:function(r){this.isOpened()&&xe(r.target,"htCore")&&Ea(r.target,this.hotMenu.rootElement)&&r.preventDefault()}}]),e}();dt(N2,Er);const UT=N2;function lu(e){"@babel/helpers - typeof";return lu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},lu(e)}function c$e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Gx(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,d$e(n.key),n)}}function h$e(e,t,r){return t&&Gx(e.prototype,t),r&&Gx(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function d$e(e){var t=v$e(e,"string");return lu(t)==="symbol"?t:String(t)}function v$e(e,t){if(lu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(lu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function na(){return typeof Reflect<"u"&&Reflect.get?na=Reflect.get.bind():na=function(t,r,n){var o=y$e(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},na.apply(this,arguments)}function y$e(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=co(e),e!==null););return e}function g$e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&q_(e,t)}function q_(e,t){return q_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},q_(e,t)}function m$e(e){var t=b$e();return function(){var n=co(e),o;if(t){var i=co(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return p$e(this,o)}}function p$e(e,t){if(t&&(lu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return H2(e)}function H2(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function b$e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function co(e){return co=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},co(e)}var iy="contextMenu",w$e=70;ge.getSingleton().register("afterContextMenuDefaultOptions");ge.getSingleton().register("beforeContextMenuShow");ge.getSingleton().register("afterContextMenuShow");ge.getSingleton().register("afterContextMenuHide");ge.getSingleton().register("afterContextMenuExecute");var L2=function(e){g$e(r,e);var t=m$e(r);function r(n){var o;return c$e(this,r),o=t.call(this,n),o.eventManager=new Pt(H2(o)),o.commandExecutor=new A2(o.hot),o.itemsFactory=null,o.menu=null,o}return h$e(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[iy]}},{key:"enablePlugin",value:function(){var o=this;if(!this.enabled){var i=this.hot.getSettings()[iy];typeof i.callback=="function"&&this.commandExecutor.setCommonCallback(i.callback),this.menu=new UT(this.hot,{className:"htContextMenu",keepInViewport:!0,container:i.uiContainer||this.hot.rootDocument.body}),this.menu.addLocalHook("beforeOpen",function(){return o.onMenuBeforeOpen()}),this.menu.addLocalHook("afterOpen",function(){return o.onMenuAfterOpen()}),this.menu.addLocalHook("afterClose",function(){return o.onMenuAfterClose()}),this.menu.addLocalHook("executeCommand",function(){for(var a,l=arguments.length,s=new Array(l),u=0;u<l;u++)s[u]=arguments[u];return(a=o.executeCommand).call.apply(a,[o].concat(s))}),this.addHook("afterOnCellContextMenu",function(a){return o.onAfterOnCellContextMenu(a)}),na(co(r.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),na(co(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.close(),this.menu&&(this.menu.destroy(),this.menu=null),na(co(r.prototype),"disablePlugin",this).call(this)}},{key:"open",value:function(o){if(this.menu&&(this.prepareMenuItems(),this.menu.open(),!!this.menu.isOpened())){var i=0,a=0;if(this.hot.rootDocument!==this.menu.container.ownerDocument){var l=this.hot.rootWindow.frameElement,s=l.getBoundingClientRect(),u=s.top,f=s.left;i=u-$c(o.view),a=f-rs(o.view)}else i=-1*$c(this.menu.hotMenu.rootWindow),a=-1*rs(this.menu.hotMenu.rootWindow);this.menu.setPosition({top:parseInt(o.pageY,10)+i,left:parseInt(o.pageX,10)+a})}}},{key:"close",value:function(){this.menu&&(this.menu.close(),this.itemsFactory=null)}},{key:"executeCommand",value:function(o){var i;this.itemsFactory===null&&this.prepareMenuItems();for(var a=arguments.length,l=new Array(a>1?a-1:0),s=1;s<a;s++)l[s-1]=arguments[s];(i=this.commandExecutor).execute.apply(i,[o].concat(l))}},{key:"prepareMenuItems",value:function(){var o=this;this.itemsFactory=new M2(this.hot,r.DEFAULT_ITEMS);var i=this.hot.getSettings()[iy],a={items:this.itemsFactory.getItems(i)};this.hot.runHooks("afterContextMenuDefaultOptions",a),this.itemsFactory.setPredefinedItems(a.items);var l=this.itemsFactory.getItems(i);this.hot.runHooks("beforeContextMenuSetItems",l),this.menu.setMenuItems(l),I(l,function(s){return o.commandExecutor.registerCommand(s.key,s)})}},{key:"onAfterOnCellContextMenu",value:function(o){var i=this.hot.getSettings(),a=i.rowHeaders,l=i.colHeaders;function s(f){return f.nodeName==="TD"||f.parentNode.nodeName==="TD"}var u=o.target;this.close(),!xe(u,"handsontableInput")&&(o.preventDefault(),o.stopPropagation(),!(!(a||l)&&!s(u)&&!(xe(u,"current")&&xe(u,"wtBorder")))&&this.open(o))}},{key:"onMenuBeforeOpen",value:function(){this.hot.runHooks("beforeContextMenuShow",this)}},{key:"onMenuAfterOpen",value:function(){this.hot.runHooks("afterContextMenuShow",this)}},{key:"onMenuAfterClose",value:function(){this.hot.listen(),this.hot.runHooks("afterContextMenuHide",this)}},{key:"destroy",value:function(){this.close(),this.menu&&this.menu.destroy(),na(co(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return iy}},{key:"PLUGIN_PRIORITY",get:function(){return w$e}},{key:"PLUGIN_DEPS",get:function(){return["plugin:AutoColumnSize"]}},{key:"DEFAULT_ITEMS",get:function(){return[Ip,Mp,ze,dv,vv,ze,Ap,gv,ze,xp,$p,ze,yv,ze,Wr]}}]),r}(it);L2.SEPARATOR={name:ze};function S$e(e){return{key:"copy",name:function(){return this.getTranslatedPhrase(m0)},callback:function(){e.copyCellsOnly()},disabled:function(){if(this.countRows()===0||this.countCols()===0)return!0;var r=this.getSelected();return!r||r.length>1},hidden:!1}}function C$e(e){return{key:"copy_column_headers_only",name:function(){var r=this.getSelectedRangeLast(),n=r?Math.min(r.getWidth()-1,1):0;return this.getTranslatedPhrase(w0,n)},callback:function(){e.copyColumnHeadersOnly()},disabled:function(){if(!this.hasColHeaders())return!0;var r=this.getSelected();return!r||r.length>1},hidden:!1}}function _$e(e){return{key:"copy_with_column_group_headers",name:function(){var r=this.getSelectedRangeLast(),n=r?Math.min(r.getWidth()-1,1):0;return this.getTranslatedPhrase(b0,n)},callback:function(){e.copyWithAllColumnHeaders()},disabled:function(){if(!this.hasColHeaders()||!this.getSettings().nestedHeaders)return!0;var r=this.getSelected();return!r||r.length>1},hidden:!1}}function O$e(e){return{key:"copy_with_column_headers",name:function(){var r=this.getSelectedRangeLast(),n=r?Math.min(r.getWidth()-1,1):0;return this.getTranslatedPhrase(p0,n)},callback:function(){e.copyWithColumnHeaders()},disabled:function(){if(!this.hasColHeaders())return!0;var r=this.getSelected();return!r||r.length>1},hidden:!1}}function R$e(e){return{key:"cut",name:function(){return this.getTranslatedPhrase(S0)},callback:function(){e.cut()},disabled:function(){if(this.countRows()===0||this.countCols()===0)return!0;var r=this.getSelected();return!r||r.length>1},hidden:!1}}function Xh(e){"@babel/helpers - typeof";return Xh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Xh(e)}function E$e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Kx(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,k$e(n.key),n)}}function T$e(e,t,r){return t&&Kx(e.prototype,t),r&&Kx(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function k$e(e){var t=P$e(e,"string");return Xh(t)==="symbol"?t:String(t)}function P$e(e,t){if(Xh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Xh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var $$e=function(){function e(){E$e(this,e),this.data={}}return T$e(e,[{key:"setData",value:function(r,n){this.data[r]=n}},{key:"getData",value:function(r){return this.data[r]||void 0}}]),e}();function Zh(e){"@babel/helpers - typeof";return Zh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Zh(e)}function qx(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,I$e(n.key),n)}}function A$e(e,t,r){return t&&qx(e.prototype,t),r&&qx(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function I$e(e){var t=M$e(e,"string");return Zh(t)==="symbol"?t:String(t)}function M$e(e,t){if(Zh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Zh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function x$e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var D$e=A$e(function e(){x$e(this,e),this.clipboardData=new $$e});function Qh(e){"@babel/helpers - typeof";return Qh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Qh(e)}function N$e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Xx(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,L$e(n.key),n)}}function H$e(e,t,r){return t&&Xx(e.prototype,t),r&&Xx(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function L$e(e){var t=j$e(e,"string");return Qh(t)==="symbol"?t:String(t)}function j$e(e,t){if(Qh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Qh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var zT=function(){function e(t){N$e(this,e),this.rootDocument=t.defaultView?t:t.ownerDocument,this.mainElement=null,this.eventManager=new Pt(this),this.listenersCount=new WeakSet,this.container=t}return H$e(e,[{key:"useSecondaryElement",value:function(){var r=V$e(this.container);this.listenersCount.has(r)||(this.listenersCount.add(r),Zx(this.eventManager,r,this)),this.mainElement=r}},{key:"setFocusableElement",value:function(r){this.listenersCount.has(r)||(this.listenersCount.add(r),Zx(this.eventManager,r,this)),this.mainElement=r}},{key:"getFocusableElement",value:function(){return this.mainElement}},{key:"focus",value:function(){this.mainElement.value=" ",An()||Sie(this.mainElement)}}]),e}();dt(zT,Er);var bm=new WeakMap;function F$e(e){var t=new zT(e),r=bm.get(e);return r=isNaN(r)?0:r,bm.set(e,r+1),t}function B$e(e){e.eventManager.clear()}var Aw=function(t,r){return function(n){return r.runLocalHooks(t,n)}};function Zx(e,t,r){e.addEventListener(t,"copy",Aw("copy",r)),e.addEventListener(t,"cut",Aw("cut",r)),e.addEventListener(t,"paste",Aw("paste",r))}var wm=new WeakMap;function V$e(e){var t=wm.get(e);if(t)return t.parentElement||e.appendChild(t),t;var r=e.defaultView?e:e.ownerDocument,n=r.createElement("textarea");return wm.set(e,n),n.setAttribute("data-hot-input",""),n.className="HandsontableCopyPaste",n.tabIndex=-1,n.autocomplete="off",n.wrap="hard",n.value=" ",e.appendChild(n),n}function Qx(e){if(e instanceof zT){var t=bm.get(e.container);if(t=isNaN(t)?0:t,t>0&&(t-=1),B$e(e),t<=0){t=0;var r=wm.get(e.container);r&&r.parentNode&&(r.parentNode.removeChild(r),wm.delete(e.container)),e.mainElement=null}bm.set(e.container,t)}}function Jh(e){"@babel/helpers - typeof";return Jh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Jh(e)}function W$e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Jx(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,z$e(n.key),n)}}function U$e(e,t,r){return t&&Jx(e.prototype,t),r&&Jx(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function z$e(e){var t=Y$e(e,"string");return Jh(t)==="symbol"?t:String(t)}function Y$e(e,t){if(Jh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Jh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function eD(e,t){j2(e,t),t.add(e)}function gl(e,t,r){j2(e,t),t.set(e,r)}function j2(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ay(e,t,r){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return r}function cr(e,t){var r=F2(e,t,"get");return G$e(e,r)}function G$e(e,t){return t.get?t.get.call(e):t.value}function ml(e,t,r){var n=F2(e,t,"set");return K$e(e,n,r),r}function F2(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function K$e(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}var Yo=new WeakMap,Iw=new WeakMap,Bf=new WeakMap,X_=new WeakMap,Z_=new WeakMap,Vf=new WeakMap,ly=new WeakSet,tD=new WeakSet,q$e=function(){function e(t){var r=t.countRows,n=t.countColumns,o=t.rowsLimit,i=t.columnsLimit,a=t.countColumnHeaders;W$e(this,e),eD(this,tD),eD(this,ly),gl(this,Yo,{writable:!0,value:void 0}),gl(this,Iw,{writable:!0,value:void 0}),gl(this,Bf,{writable:!0,value:void 0}),gl(this,X_,{writable:!0,value:void 0}),gl(this,Z_,{writable:!0,value:void 0}),gl(this,Vf,{writable:!0,value:void 0}),ml(this,Iw,r),ml(this,Bf,n),ml(this,X_,o),ml(this,Z_,i),ml(this,Vf,a)}return U$e(e,[{key:"setSelectedRange",value:function(r){ml(this,Yo,r)}},{key:"getCellsRange",value:function(){if(cr(this,Iw).call(this)===0||cr(this,Bf).call(this)===0)return null;var r=cr(this,Yo).getTopStartCorner(),n=r.row,o=r.col,i=cr(this,Yo).getBottomEndCorner(),a=i.row,l=i.col,s=ay(this,tD,X$e).call(this,n,a),u=ay(this,ly,Mw).call(this,o,l),f=a!==s||l!==u;return{isRangeTrimmed:f,startRow:n,startCol:o,endRow:s,endCol:u}}},{key:"getMostBottomColumnHeadersRange",value:function(){if(cr(this,Bf).call(this)===0||cr(this,Vf).call(this)===0)return null;var r=cr(this,Yo).getTopStartCorner(),n=r.col,o=cr(this,Yo).getBottomEndCorner(),i=o.col,a=ay(this,ly,Mw).call(this,n,i),l=i!==a;return{isRangeTrimmed:l,startRow:-1,startCol:n,endRow:-1,endCol:a}}},{key:"getAllColumnHeadersRange",value:function(){if(cr(this,Bf).call(this)===0||cr(this,Vf).call(this)===0)return null;var r=cr(this,Yo).getTopStartCorner(),n=r.col,o=cr(this,Yo).getBottomEndCorner(),i=o.col,a=ay(this,ly,Mw).call(this,n,i),l=i!==a;return{isRangeTrimmed:l,startRow:-cr(this,Vf).call(this),startCol:n,endRow:-1,endCol:a}}}]),e}();function Mw(e,t){return Math.min(t,Math.max(e+cr(this,Z_).call(this)-1,e))}function X$e(e,t){return Math.min(t,Math.max(e+cr(this,X_).call(this)-1,e))}function B2(e){var t=[],r=[];return I(e,function(n){var o=Math.min(n.startRow,n.endRow),i=Math.max(n.startRow,n.endRow);_e(o,i,function(s){t.indexOf(s)===-1&&t.push(s)});var a=Math.min(n.startCol,n.endCol),l=Math.max(n.startCol,n.endCol);_e(a,l,function(s){r.indexOf(s)===-1&&r.push(s)})}),{rows:t,columns:r}}function Z$e(e,t){return tAe(e)||eAe(e,t)||J$e(e,t)||Q$e()}function Q$e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function J$e(e,t){if(e){if(typeof e=="string")return rD(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return rD(e,t)}}function rD(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function eAe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function tAe(e){if(Array.isArray(e))return e}function Fa(e){"@babel/helpers - typeof";return Fa=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Fa(e)}function rAe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function nD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,W2(n.key),n)}}function nAe(e,t,r){return t&&nD(e.prototype,t),r&&nD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function oa(){return typeof Reflect<"u"&&Reflect.get?oa=Reflect.get.bind():oa=function(t,r,n){var o=oAe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},oa.apply(this,arguments)}function oAe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=ho(e),e!==null););return e}function iAe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Q_(e,t)}function Q_(e,t){return Q_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},Q_(e,t)}function aAe(e){var t=sAe();return function(){var n=ho(e),o;if(t){var i=ho(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return lAe(this,o)}}function lAe(e,t){if(t&&(Fa(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return fr(e)}function fr(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function sAe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function ho(e){return ho=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},ho(e)}function uAe(e,t){V2(e,t),t.add(e)}function ji(e,t,r){V2(e,t),t.set(e,r)}function V2(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function pl(e,t,r){return t=W2(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function W2(e){var t=fAe(e,"string");return Fa(t)==="symbol"?t:String(t)}function fAe(e,t){if(Fa(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Fa(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function cAe(e,t,r){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return r}function kr(e,t){var r=U2(e,t,"get");return hAe(e,r)}function hAe(e,t){return t.get?t.get.call(e):t.value}function zn(e,t,r){var n=U2(e,t,"set");return dAe(e,n,r),r}function U2(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function dAe(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}ge.getSingleton().register("afterCopyLimit");ge.getSingleton().register("modifyCopyableRange");ge.getSingleton().register("beforeCut");ge.getSingleton().register("afterCut");ge.getSingleton().register("beforePaste");ge.getSingleton().register("afterPaste");ge.getSingleton().register("beforeCopy");ge.getSingleton().register("afterCopy");var sy="copyPaste",vAe=80,yAe=["fragmentSelection"],oD=['<meta name="generator" content="Handsontable"/>','<style type="text/css">td{white-space:normal}br{mso-data-placement:same-cell}</style>'].join(""),xw=new WeakMap,Dw=new WeakMap,Nw=new WeakMap,bl=new WeakMap,uy=new WeakMap,fy=new WeakMap,wl=new WeakMap,iD=new WeakSet,gAe=function(e){iAe(r,e);var t=aAe(r);function r(){var n;rAe(this,r);for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return n=t.call.apply(t,[this].concat(i)),uAe(fr(n),iD),pl(fr(n),"columnsLimit",1/0),pl(fr(n),"rowsLimit",1/0),pl(fr(n),"pasteMode","overwrite"),pl(fr(n),"uiContainer",n.hot.rootDocument.body),ji(fr(n),xw,{writable:!0,value:!1}),ji(fr(n),Dw,{writable:!0,value:!1}),ji(fr(n),Nw,{writable:!0,value:!1}),ji(fr(n),bl,{writable:!0,value:"cells-only"}),ji(fr(n),uy,{writable:!0,value:!1}),ji(fr(n),fy,{writable:!0,value:!1}),ji(fr(n),wl,{writable:!0,value:new q$e({countRows:function(){return n.hot.countRows()},countColumns:function(){return n.hot.countCols()},rowsLimit:function(){return n.rowsLimit},columnsLimit:function(){return n.columnsLimit},countColumnHeaders:function(){return n.hot.view.getColumnHeadersCount()}})}),pl(fr(n),"copyableRanges",[]),pl(fr(n),"focusableElement",void 0),n}return nAe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[sy]}},{key:"enablePlugin",value:function(){var o=this;if(!this.enabled){var i=this.hot.getSettings(),a=i[sy];if(Fa(a)==="object"){var l,s;this.pasteMode=(l=a.pasteMode)!==null&&l!==void 0?l:this.pasteMode,this.rowsLimit=isNaN(a.rowsLimit)?this.rowsLimit:a.rowsLimit,this.columnsLimit=isNaN(a.columnsLimit)?this.columnsLimit:a.columnsLimit,zn(this,xw,!!a.copyColumnHeaders),zn(this,Dw,!!a.copyColumnGroupHeaders),zn(this,Nw,!!a.copyColumnHeadersOnly),this.uiContainer=(s=a.uiContainer)!==null&&s!==void 0?s:this.uiContainer}this.addHook("afterContextMenuDefaultOptions",function(u){return o.onAfterContextMenuDefaultOptions(u)}),this.addHook("afterOnCellMouseUp",function(){return o.onAfterOnCellMouseUp()}),this.addHook("afterSelectionEnd",function(){return o.onAfterSelectionEnd()}),this.addHook("beforeKeyDown",function(){return o.onBeforeKeyDown()}),this.focusableElement=F$e(this.uiContainer),this.focusableElement.addLocalHook("copy",function(u){return o.onCopy(u)}).addLocalHook("cut",function(u){return o.onCut(u)}).addLocalHook("paste",function(u){return o.onPaste(u)}),oa(ho(r.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),this.getOrCreateFocusableElement(),oa(ho(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.focusableElement&&Qx(this.focusableElement),oa(ho(r.prototype),"disablePlugin",this).call(this)}},{key:"copy",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"cells-only";zn(this,bl,o),zn(this,uy,!0),this.getOrCreateFocusableElement(),this.focusableElement.focus(),this.hot.rootDocument.execCommand("copy")}},{key:"copyCellsOnly",value:function(){this.copy("cells-only")}},{key:"copyColumnHeadersOnly",value:function(){this.copy("column-headers-only")}},{key:"copyWithAllColumnHeaders",value:function(){this.copy("with-column-group-headers")}},{key:"copyWithColumnHeaders",value:function(){this.copy("with-column-headers")}},{key:"cut",value:function(){zn(this,fy,!0),this.getOrCreateFocusableElement(),this.focusableElement.focus(),this.hot.rootDocument.execCommand("cut")}},{key:"getRangedCopyableData",value:function(o){return vc(this.getRangedData(o))}},{key:"getRangedData",value:function(o){var i=this,a=[],l=B2(o),s=l.rows,u=l.columns;return I(s,function(f){var c=[];I(u,function(h){f<0?c.push(i.hot.getColHeader(h,f)):c.push(i.hot.getCopyableData(f,h))}),a.push(c)}),a}},{key:"paste",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:o;if(!(!o&&!i)){var a=new D$e;o&&a.clipboardData.setData("text/plain",o),i&&a.clipboardData.setData("text/html",i),this.getOrCreateFocusableElement(),this.onPaste(a)}}},{key:"setCopyableText",value:function(){var o=this.hot.getSelectedRangeLast();if(o){kr(this,wl).setSelectedRange(o);var i=new Map([["headers",null],["cells",null]]);kr(this,bl)==="column-headers-only"?i.set("headers",kr(this,wl).getMostBottomColumnHeadersRange()):(kr(this,bl)==="with-column-headers"?i.set("headers",kr(this,wl).getMostBottomColumnHeadersRange()):kr(this,bl)==="with-column-group-headers"&&i.set("headers",kr(this,wl).getAllColumnHeadersRange()),i.set("cells",kr(this,wl).getCellsRange())),this.copyableRanges=Array.from(i.values()).filter(function(c){return c!==null}).map(function(c){var h=c.startRow,d=c.startCol,v=c.endRow,y=c.endCol;return{startRow:h,startCol:d,endRow:v,endCol:y}}),this.copyableRanges=this.hot.runHooks("modifyCopyableRange",this.copyableRanges);var a=i.get("cells");if(a!==null&&a.isRangeTrimmed){var l=a.startRow,s=a.startCol,u=a.endRow,f=a.endCol;this.hot.runHooks("afterCopyLimit",u-l+1,f-s+1,this.rowsLimit,this.columnsLimit)}}}},{key:"getOrCreateFocusableElement",value:function(){var o,i=(o=this.hot.getActiveEditor())===null||o===void 0?void 0:o.TEXTAREA;i?this.focusableElement.setFocusableElement(i):this.focusableElement.useSecondaryElement()}},{key:"isEditorOpened",value:function(){var o;return(o=this.hot.getActiveEditor())===null||o===void 0?void 0:o.isOpened()}},{key:"populateValues",value:function(o){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.hot.getSelectedRangeLast();if(o.length){for(var a=o.length,l=o[0].length,s=[],u=i.getTopStartCorner(),f=u.row,c=u.col,h=i.getBottomEndCorner(),d=h.row,v=h.col,y=f,p=c,w=f,S=c;s.length<a||y<=d;){var C=this.hot.getCellMeta(y,c),P=C.skipRowOnPaste,R=C.visualRow;if(y=R+1,P!==!0){w=R,p=c;for(var W=[],Y=s.length%a;W.length<l||p<=v;){var q=this.hot.getCellMeta(f,p),G=q.skipColumnOnPaste,X=q.visualCol;if(p=X+1,G!==!0){S=X;var Q=W.length%l;W.push(o[Y][Q])}}s.push(W)}}return this.hot.populateFromArray(f,c,s,void 0,void 0,"CopyPaste.paste",this.pasteMode),[f,c,w,S]}}},{key:"onCopy",value:function(o){if(!(!this.hot.isListening()&&!kr(this,uy)||this.isEditorOpened())){this.setCopyableText(),zn(this,uy,!1);var i=this.getRangedData(this.copyableRanges),a=cAe(this,iD,mAe).call(this,this.copyableRanges),l=!!this.hot.runHooks("beforeCopy",i,this.copyableRanges,a);if(l){var s=vc(i);if(o&&o.clipboardData){var u=FA(i,this.hot.rootDocument);o.clipboardData.setData("text/plain",s),o.clipboardData.setData("text/html",[oD,u].join(""))}else typeof ClipboardEvent>"u"&&this.hot.rootWindow.clipboardData.setData("Text",s);this.hot.runHooks("afterCopy",i,this.copyableRanges,a)}zn(this,bl,"cells-only"),o.preventDefault()}}},{key:"onCut",value:function(o){if(!(!this.hot.isListening()&&!kr(this,fy)||this.isEditorOpened())){this.setCopyableText(),zn(this,fy,!1);var i=this.getRangedData(this.copyableRanges),a=!!this.hot.runHooks("beforeCut",i,this.copyableRanges);if(a){var l=vc(i);if(o&&o.clipboardData){var s=FA(i,this.hot.rootDocument);o.clipboardData.setData("text/plain",l),o.clipboardData.setData("text/html",[oD,s].join(""))}else typeof ClipboardEvent>"u"&&this.hot.rootWindow.clipboardData.setData("Text",l);this.hot.emptySelectedCells("CopyPaste.cut"),this.hot.runHooks("afterCut",i,this.copyableRanges)}o.preventDefault()}}},{key:"onPaste",value:function(o){if(!(!this.hot.isListening()||this.isEditorOpened())){o&&o.preventDefault&&o.preventDefault();var i;if(o&&typeof o.clipboardData<"u"){var a=xE(o.clipboardData.getData("text/html"),{ADD_TAGS:["meta"],ADD_ATTR:["content"],FORCE_BODY:!0});if(a&&/(<table)|(<TABLE)/g.test(a)){var l=cle(a,this.hot.rootDocument);i=l.data}else i=o.clipboardData.getData("text/plain")}else typeof ClipboardEvent>"u"&&typeof this.hot.rootWindow.clipboardData<"u"&&(i=this.hot.rootWindow.clipboardData.getData("Text"));if(typeof i=="string"&&(i=dwe(i)),!(i&&i.length===0)&&this.hot.runHooks("beforePaste",i,this.copyableRanges)!==!1){var s=this.populateValues(i),u=Z$e(s,4),f=u[0],c=u[1],h=u[2],d=u[3];this.hot.selectCell(f,c,Math.min(this.hot.countRows()-1,h),Math.min(this.hot.countCols()-1,d)),this.hot.runHooks("afterPaste",i,this.copyableRanges)}}}},{key:"onAfterContextMenuDefaultOptions",value:function(o){o.items.push({name:"---------"},S$e(this)),kr(this,xw)&&o.items.push(O$e(this)),kr(this,Dw)&&o.items.push(_$e(this)),kr(this,Nw)&&o.items.push(C$e(this)),o.items.push(R$e(this))}},{key:"onAfterOnCellMouseUp",value:function(){!this.hot.isListening()||this.isEditorOpened()||this.hot.getSettings().fragmentSelection||(this.getOrCreateFocusableElement(),this.focusableElement.focus())}},{key:"onAfterSelectionEnd",value:function(){this.isEditorOpened()||(this.getOrCreateFocusableElement(),!(this.hot.getSettings().fragmentSelection&&this.focusableElement.getFocusableElement()!==this.hot.rootDocument.activeElement&&mie())&&(this.setCopyableText(),this.focusableElement.focus()))}},{key:"onBeforeKeyDown",value:function(){if(!(!this.hot.isListening()||this.isEditorOpened())){var o=this.hot.rootDocument.activeElement,i=this.hot.getActiveEditor();!i||o!==this.focusableElement.getFocusableElement()&&o!==i.select||(this.getOrCreateFocusableElement(),this.focusableElement.focus())}}},{key:"destroy",value:function(){this.focusableElement&&(Qx(this.focusableElement),this.focusableElement=null),oa(ho(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return sy}},{key:"SETTING_KEYS",get:function(){return[sy].concat(yAe)}},{key:"PLUGIN_PRIORITY",get:function(){return vAe}}]),r}(it);function mAe(e){for(var t=B2(e),r=t.rows,n=0,o=0;o<r.length&&!(r[o]>=0);o++)n+=1;return{columnHeadersCount:n}}function z2(e,t){return"border_row".concat(e,"col").concat(t)}function nc(){return{width:1,color:"#000"}}function vo(){return{hide:!0}}function pAe(){return{width:1,color:"#000",cornerVisible:!1}}function Hw(e){if(ye(e.start)||ye(e.left)){var t;e.start=(t=e.start)!==null&&t!==void 0?t:e.left}if(ye(e.end)||ye(e.right)){var r;e.end=(r=e.end)!==null&&r!==void 0?r:e.right}return delete e.left,delete e.right,e}function Wf(e){return ye(e.start)&&(e.left=e.start),ye(e.end)&&(e.right=e.end),e}function Lw(e,t){return{id:z2(e,t),border:pAe(),row:e,col:t,top:vo(),bottom:vo(),start:vo(),end:vo()}}function bAe(e,t){return It(t,"border")&&t.border&&(e.border=t.border),It(t,"top")&&ye(t.top)&&(t.top?(Ge(t.top)||(t.top=nc()),e.top=t.top):(t.top=vo(),e.top=t.top)),It(t,"bottom")&&ye(t.bottom)&&(t.bottom?(Ge(t.bottom)||(t.bottom=nc()),e.bottom=t.bottom):(t.bottom=vo(),e.bottom=t.bottom)),It(t,"start")&&ye(t.start)&&(t.start?(Ge(t.start)||(t.start=nc()),e.start=t.start):(t.start=vo(),e.start=t.start)),It(t,"end")&&ye(t.end)&&(t.end?(Ge(t.end)||(t.end=nc()),e.end=t.end):(t.end=vo(),e.end=t.end)),e}function Do(e,t){var r=!1;return I(e.getSelectedRange(),function(n){n.forAll(function(o,i){if(!(o<0||i<0)){var a=e.getCellMeta(o,i).borders;if(a)if(t){if(!It(a[t],"hide")||a[t].hide===!1)return r=!0,!1}else return r=!0,!1}})}),r}function Dp(e){return'<span class="selected">'.concat(String.fromCharCode(10003),"</span>").concat(e)}function wAe(e){return e.some(function(t){return ye(t.left)||ye(t.right)})}function SAe(e){return e.some(function(t){return ye(t.start)||ye(t.end)})}var CAe=new Map([["left","start"],["right","end"]]);function _Ae(e){var t;return(t=CAe.get(e))!==null&&t!==void 0?t:e}function OAe(e){return{key:"borders:bottom",name:function(){var r=this.getTranslatedPhrase(B0),n=Do(this,"bottom");return n&&(r=Dp(r)),r},callback:function(r,n){var o=Do(this,"bottom");e.prepareBorder(n,"bottom",o)}}}function RAe(e){var t=e.hot.isRtl()?"end":"start";return{key:"borders:left",name:function(){var n=this.getTranslatedPhrase(V0),o=Do(this,t);return o&&(n=Dp(n)),n},callback:function(n,o){var i=Do(this,t);e.prepareBorder(o,t,i)}}}function EAe(e){return{key:"borders:no_borders",name:function(){return this.getTranslatedPhrase(W0)},callback:function(r,n){e.prepareBorder(n,"noBorders")},disabled:function(){return!Do(this)}}}function TAe(e){var t=e.hot.isRtl()?"start":"end";return{key:"borders:right",name:function(){var n=this.getTranslatedPhrase(F0),o=Do(this,t);return o&&(n=Dp(n)),n},callback:function(n,o){var i=Do(this,t);e.prepareBorder(o,t,i)}}}function kAe(e){return{key:"borders:top",name:function(){var r=this.getTranslatedPhrase(j0),n=Do(this,"top");return n&&(r=Dp(r)),r},callback:function(r,n){var o=Do(this,"top");e.prepareBorder(n,"top",o)}}}function su(e){"@babel/helpers - typeof";return su=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},su(e)}function aD(e,t){return IAe(e)||AAe(e,t)||$Ae(e,t)||PAe()}function PAe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function $Ae(e,t){if(e){if(typeof e=="string")return lD(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return lD(e,t)}}function lD(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function AAe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function IAe(e){if(Array.isArray(e))return e}function MAe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function sD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,G2(n.key),n)}}function xAe(e,t,r){return t&&sD(e.prototype,t),r&&sD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function ia(){return typeof Reflect<"u"&&Reflect.get?ia=Reflect.get.bind():ia=function(t,r,n){var o=DAe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},ia.apply(this,arguments)}function DAe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=yo(e),e!==null););return e}function NAe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&J_(e,t)}function J_(e,t){return J_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},J_(e,t)}function HAe(e){var t=jAe();return function(){var n=yo(e),o;if(t){var i=yo(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return LAe(this,o)}}function LAe(e,t){if(t&&(su(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Y2(e)}function Y2(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function jAe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function yo(e){return yo=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},yo(e)}function FAe(e,t,r){return t=G2(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function G2(e){var t=BAe(e,"string");return su(t)==="symbol"?t:String(t)}function BAe(e,t){if(su(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(su(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var cy="customBorders",VAe=90,WAe=function(e){NAe(r,e);var t=HAe(r);function r(){var n;MAe(this,r);for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return n=t.call.apply(t,[this].concat(i)),FAe(Y2(n),"savedBorders",[]),n}return xAe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[cy]}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.addHook("afterContextMenuDefaultOptions",function(i){return o.onAfterContextMenuDefaultOptions(i)}),this.addHook("init",function(){return o.onAfterInit()}),ia(yo(r.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.hideBorders(),ia(yo(r.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),this.changeBorderSettings(),ia(yo(r.prototype),"updatePlugin",this).call(this)}},{key:"setBorders",value:function(o,i){var a=this,l=["top","bottom","start","end"],s=null;i&&(this.checkSettingsCohesion([i]),l=Object.keys(i),s=Hw(i));var u=Is(o),f=Th(u);I(o,function(c){for(var h=f(c),d=aD(h,4),v=d[0],y=d[1],p=d[2],w=d[3],S=function(R){for(var W=function(G){I(l,function(X){a.prepareBorderFromCustomAdded(R,G,s,_Ae(X))})},Y=y;Y<=w;Y+=1)W(Y)},C=v;C<=p;C+=1)S(C)}),this.hot.view.render()}},{key:"getBorders",value:function(o){var i=this;if(!Array.isArray(o))return this.savedBorders;var a=Is(o),l=Th(a),s=[];return I(o,function(u){for(var f=l(u),c=aD(f,4),h=c[0],d=c[1],v=c[2],y=c[3],p=function(C){for(var P=function(Y){I(i.savedBorders,function(q){q.row===C&&q.col===Y&&s.push(Wf(q))})},R=d;R<=y;R+=1)P(R)},w=h;w<=v;w+=1)p(w)}),s}},{key:"clearBorders",value:function(o){var i=this;o?this.setBorders(o):(I(this.savedBorders,function(a){i.clearBordersFromSelectionSettings(a.id),i.clearNullCellRange(),i.hot.removeCellMeta(a.row,a.col,"borders")}),this.savedBorders.length=0)}},{key:"insertBorderIntoSettings",value:function(o,i){var a=this.checkSavedBorders(o);a||this.savedBorders.push(o);var l=this.hot._createCellRange(this.hot._createCellCoords(o.row,o.col)),s=this.checkCustomSelections(o,l,i);s||this.hot.selection.highlight.addCustomSelection({border:o,visualCellRange:l})}},{key:"prepareBorderFromCustomAdded",value:function(o,i,a,l){var s=this.hot.countRows(),u=this.hot.countCols();if(!(o>=s||i>=u)){var f=Lw(o,i);a&&(f=bAe(f,a),I(this.hot.selection.highlight.customSelections,function(c){if(f.id===c.settings.id)return Object.assign(c.settings,a),f.id=c.settings.id,f.top=c.settings.top,f.bottom=c.settings.bottom,f.start=c.settings.start,f.end=c.settings.end,!1})),this.hot.setCellMeta(o,i,"borders",Wf(f)),this.insertBorderIntoSettings(f,l)}}},{key:"prepareBorderFromCustomAddedRange",value:function(o,i){var a=this,l=Math.min(o.to.row,this.hot.countRows()-1),s=Math.min(o.to.col,this.hot.countCols()-1);_e(o.from.row,l,function(u){_e(o.from.col,s,function(f){var c=Lw(u,f),h=0;u===o.from.row&&It(i,"top")&&(h+=1,c.top=i.top),u===o.to.row&&It(i,"bottom")&&(h+=1,c.bottom=i.bottom),f===o.from.col&&It(i,"start")&&(h+=1,c.start=i.start),f===o.to.col&&It(i,"end")&&(h+=1,c.end=i.end),h>0&&(a.hot.setCellMeta(u,f,"borders",Wf(c)),a.insertBorderIntoSettings(c))})})}},{key:"removeAllBorders",value:function(o,i){var a=z2(o,i);this.spliceBorder(a),this.clearBordersFromSelectionSettings(a),this.clearNullCellRange(),this.hot.removeCellMeta(o,i,"borders")}},{key:"setBorder",value:function(o,i,a,l){var s=this.hot.getCellMeta(o,i).borders;if(!s||s.border===void 0?s=Lw(o,i):s=Hw(s),l){s[a]=vo();var u=this.countHide(s);if(u===4)this.removeAllBorders(o,i);else{var f=this.checkCustomSelectionsFromContextMenu(s,a,l);f||this.insertBorderIntoSettings(s),this.hot.setCellMeta(o,i,"borders",Wf(s))}}else{s[a]=nc();var c=this.checkCustomSelectionsFromContextMenu(s,a,l);c||this.insertBorderIntoSettings(s),this.hot.setCellMeta(o,i,"borders",Wf(s))}}},{key:"prepareBorder",value:function(o,i,a){var l=this;I(o,function(s){var u=s.start,f=s.end;if(u.row===f.row&&u.col===f.col)i==="noBorders"?l.removeAllBorders(u.row,u.col):l.setBorder(u.row,u.col,i,a);else switch(i){case"noBorders":_e(u.col,f.col,function(c){_e(u.row,f.row,function(h){l.removeAllBorders(h,c)})});break;case"top":_e(u.col,f.col,function(c){l.setBorder(u.row,c,i,a)});break;case"bottom":_e(u.col,f.col,function(c){l.setBorder(f.row,c,i,a)});break;case"start":_e(u.row,f.row,function(c){l.setBorder(c,u.col,i,a)});break;case"end":_e(u.row,f.row,function(c){l.setBorder(c,f.col,i,a)});break}})}},{key:"createCustomBorders",value:function(o){var i=this;I(o,function(a){var l=Hw(a);a.range?i.prepareBorderFromCustomAddedRange(a.range,l):i.prepareBorderFromCustomAdded(a.row,a.col,l)})}},{key:"countHide",value:function(o){var i=o.top,a=o.bottom,l=o.start,s=o.end,u=[i,a,l,s];return nr(u,function(f,c){var h=f;return c&&c.hide&&(h+=1),h},0)}},{key:"clearBordersFromSelectionSettings",value:function(o){var i=Ye(this.hot.selection.highlight.customSelections,function(a){return a.settings.id}).indexOf(o);i>-1&&this.hot.selection.highlight.customSelections[i].clear()}},{key:"clearNullCellRange",value:function(){var o=this;I(this.hot.selection.highlight.customSelections,function(i,a){if(i.cellRange===null)return o.hot.selection.highlight.customSelections[a].destroy(),o.hot.selection.highlight.customSelections.splice(a,1),!1})}},{key:"hideBorders",value:function(){var o=this;I(this.savedBorders,function(i){o.clearBordersFromSelectionSettings(i.id),o.clearNullCellRange()})}},{key:"spliceBorder",value:function(o){var i=Ye(this.savedBorders,function(a){return a.id}).indexOf(o);i>-1&&this.savedBorders.splice(i,1)}},{key:"checkSavedBorders",value:function(o){var i=this,a=!1,l=this.countHide(o);return l===4?(this.spliceBorder(o.id),a=!0):I(this.savedBorders,function(s,u){if(o.id===s.id)return i.savedBorders[u]=o,a=!0,!1}),a}},{key:"checkCustomSelectionsFromContextMenu",value:function(o,i,a){var l=!1;return I(this.hot.selection.highlight.customSelections,function(s){if(o.id===s.settings.id)return Ke(s.instanceBorders,function(u){u.toggleHiddenClass(i,a)}),l=!0,!1}),l}},{key:"checkCustomSelections",value:function(o,i,a){var l=this.countHide(o),s=!1;return l===4?(this.removeAllBorders(o.row,o.col),s=!0):I(this.hot.selection.highlight.customSelections,function(u){if(o.id===u.settings.id)return u.visualCellRange=i,u.commit(),a&&Ke(u.instanceBorders,function(f){f.changeBorderStyle(a,o)}),s=!0,!1}),s}},{key:"changeBorderSettings",value:function(){var o=this.hot.getSettings()[cy];if(Array.isArray(o)){var i=dr(o);this.checkSettingsCohesion(i),i.length||(this.savedBorders=i),this.createCustomBorders(i)}else o!==void 0&&this.createCustomBorders(this.savedBorders)}},{key:"checkSettingsCohesion",value:function(o){var i=wAe(o),a=SAe(o);if(i&&a)throw new Error('The "left"/"right" and "start"/"end" options should not be used together. Please use only the option "start"/"end".');if(this.hot.isRtl()&&i)throw new Error('The "left"/"right" properties are not supported for RTL. Please use option "start"/"end".')}},{key:"onAfterContextMenuDefaultOptions",value:function(o){this.hot.getSettings()[cy]&&o.items.push({name:"---------"},{key:"borders",name:function(){return this.getTranslatedPhrase(L0)},disabled:function(){return this.selection.isSelectedByCorner()},submenu:{items:[kAe(this),TAe(this),OAe(this),RAe(this),EAe(this)]}})}},{key:"onAfterInit",value:function(){this.changeBorderSettings()}},{key:"destroy",value:function(){ia(yo(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return cy}},{key:"PLUGIN_PRIORITY",get:function(){return VAe}}]),r}(it);function uu(e){"@babel/helpers - typeof";return uu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},uu(e)}function UAe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function uD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,YAe(n.key),n)}}function zAe(e,t,r){return t&&uD(e.prototype,t),r&&uD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function YAe(e){var t=GAe(e,"string");return uu(t)==="symbol"?t:String(t)}function GAe(e,t){if(uu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(uu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function aa(){return typeof Reflect<"u"&&Reflect.get?aa=Reflect.get.bind():aa=function(t,r,n){var o=KAe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},aa.apply(this,arguments)}function KAe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=go(e),e!==null););return e}function qAe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&eO(e,t)}function eO(e,t){return eO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},eO(e,t)}function XAe(e){var t=QAe();return function(){var n=go(e),o;if(t){var i=go(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return ZAe(this,o)}}function ZAe(e,t){if(t&&(uu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return K2(e)}function K2(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function QAe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function go(e){return go=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},go(e)}var fD="dragToScroll",JAe=100,e1e=function(e){qAe(r,e);var t=XAe(r);function r(n){var o;return UAe(this,r),o=t.call(this,n),o.eventManager=new Pt(K2(o)),o.boundaries=null,o.callback=null,o.listening=!1,o}return zAe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[fD]}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.addHook("afterOnCellMouseDown",function(i){return o.setupListening(i)}),this.addHook("afterOnCellCornerMouseDown",function(i){return o.setupListening(i)}),this.registerEvents(),aa(go(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),aa(go(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.unregisterEvents(),aa(go(r.prototype),"disablePlugin",this).call(this)}},{key:"setBoundaries",value:function(o){this.boundaries=o}},{key:"setCallback",value:function(o){this.callback=o}},{key:"check",value:function(o,i){var a=0,l=0;i<this.boundaries.top?l=i-this.boundaries.top:i>this.boundaries.bottom&&(l=i-this.boundaries.bottom),o<this.boundaries.left?a=o-this.boundaries.left:o>this.boundaries.right&&(a=o-this.boundaries.right),this.callback(a,l)}},{key:"listen",value:function(){this.listening=!0}},{key:"unlisten",value:function(){this.listening=!1}},{key:"isListening",value:function(){return this.listening}},{key:"registerEvents",value:function(){for(var o=this,i=this.hot.rootWindow,a=i;a;)this.eventManager.addEventListener(a.document,"contextmenu",function(){return o.unlisten()}),this.eventManager.addEventListener(a.document,"mouseup",function(){return o.unlisten()}),this.eventManager.addEventListener(a.document,"mousemove",function(l){return o.onMouseMove(l)}),a=Ag(a)}},{key:"unregisterEvents",value:function(){this.eventManager.clear()}},{key:"setupListening",value:function(o){if(!$a(o)){var i=this.hot.view._wt.wtTable.holder;i!==this.hot.rootWindow&&(this.setBoundaries(i.getBoundingClientRect()),this.setCallback(function(a,l){a<0?i.scrollLeft-=50:a>0&&(i.scrollLeft+=50),l<0?i.scrollTop-=20:l>0&&(i.scrollTop+=20)}),this.listen())}}},{key:"onMouseMove",value:function(o){this.isListening()&&this.check(o.clientX,o.clientY)}},{key:"destroy",value:function(){aa(go(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return fD}},{key:"PLUGIN_PRIORITY",get:function(){return JAe}}]),r}(it);function fu(e){"@babel/helpers - typeof";return fu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},fu(e)}function t1e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function cD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n1e(n.key),n)}}function r1e(e,t,r){return t&&cD(e.prototype,t),r&&cD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function n1e(e){var t=o1e(e,"string");return fu(t)==="symbol"?t:String(t)}function o1e(e,t){if(fu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(fu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function la(){return typeof Reflect<"u"&&Reflect.get?la=Reflect.get.bind():la=function(t,r,n){var o=i1e(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},la.apply(this,arguments)}function i1e(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=mo(e),e!==null););return e}function a1e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&tO(e,t)}function tO(e,t){return tO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},tO(e,t)}function l1e(e){var t=u1e();return function(){var n=mo(e),o;if(t){var i=mo(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return s1e(this,o)}}function s1e(e,t){if(t&&(fu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return q2(e)}function q2(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function u1e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function mo(e){return mo=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},mo(e)}ge.getSingleton().register("afterDropdownMenuDefaultOptions");ge.getSingleton().register("beforeDropdownMenuShow");ge.getSingleton().register("afterDropdownMenuShow");ge.getSingleton().register("afterDropdownMenuHide");ge.getSingleton().register("afterDropdownMenuExecute");var jw="dropdownMenu",f1e=230,Fw="changeType",X2=function(e){a1e(r,e);var t=l1e(r);function r(n){var o;return t1e(this,r),o=t.call(this,n),o.eventManager=new Pt(q2(o)),o.commandExecutor=new A2(o.hot),o.itemsFactory=null,o.menu=null,o.hot.addHook("afterGetColHeader",function(i,a){return o.onAfterGetColHeader(i,a)}),o}return r1e(r,[{key:"isEnabled",value:function(){return this.hot.getSettings()[jw]}},{key:"enablePlugin",value:function(){var o=this;if(!this.enabled){this.itemsFactory=new M2(this.hot,r.DEFAULT_ITEMS);var i=this.hot.getSettings()[jw],a={items:this.itemsFactory.getItems(i)};this.registerEvents(),typeof i.callback=="function"&&this.commandExecutor.setCommonCallback(i.callback),la(mo(r.prototype),"enablePlugin",this).call(this),this.callOnPluginsReady(function(){o.hot.runHooks("afterDropdownMenuDefaultOptions",a),o.itemsFactory.setPredefinedItems(a.items);var l=o.itemsFactory.getItems(i);o.menu&&o.menu.destroy(),o.menu=new UT(o.hot,{className:"htDropdownMenu",keepInViewport:!0,container:i.uiContainer||o.hot.rootDocument.body}),o.hot.runHooks("beforeDropdownMenuSetItems",l),o.menu.setMenuItems(l),o.menu.addLocalHook("beforeOpen",function(){return o.onMenuBeforeOpen()}),o.menu.addLocalHook("afterOpen",function(){return o.onMenuAfterOpen()}),o.menu.addLocalHook("afterClose",function(){return o.onMenuAfterClose()}),o.menu.addLocalHook("executeCommand",function(){for(var s,u=arguments.length,f=new Array(u),c=0;c<u;c++)f[c]=arguments[c];return(s=o.executeCommand).call.apply(s,[o].concat(f))}),I(l,function(s){return o.commandExecutor.registerCommand(s.key,s)})})}}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),la(mo(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.close(),this.menu&&this.menu.destroy(),la(mo(r.prototype),"disablePlugin",this).call(this)}},{key:"registerEvents",value:function(){var o=this;this.eventManager.addEventListener(this.hot.rootElement,"click",function(i){return o.onTableClick(i)})}},{key:"open",value:function(o){this.menu&&(this.menu.open(),o.width&&this.menu.setOffset("left",o.width),this.menu.setPosition(o))}},{key:"close",value:function(){this.menu&&this.menu.close()}},{key:"executeCommand",value:function(o){for(var i,a=arguments.length,l=new Array(a>1?a-1:0),s=1;s<a;s++)l[s-1]=arguments[s];(i=this.commandExecutor).execute.apply(i,[o].concat(l))}},{key:"setListening",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.menu.isOpened()&&(o?this.menu.hotMenu.listen():this.menu.hotMenu.unlisten())}},{key:"onTableClick",value:function(o){if(o.stopPropagation(),xe(o.target,Fw)&&!this.menu.isOpened()){var i=0,a=0;if(this.hot.rootDocument!==this.menu.container.ownerDocument){var l=this.hot.rootWindow.frameElement,s=l.getBoundingClientRect(),u=s.top,f=s.left;i=u,a=f}var c=o.target.getBoundingClientRect();this.open({left:c.left+a,top:c.top+o.target.offsetHeight+3+i,width:c.width,height:c.height})}}},{key:"onAfterGetColHeader",value:function(o,i){var a=i.parentNode;if(a){var l=a.parentNode.childNodes,s=Array.prototype.indexOf.call(l,a);if(!(o<0||s!==l.length-1)){var u=i.querySelector(".".concat(Fw));if(!(this.enabled&&u)){if(!this.enabled){u&&u.parentNode.removeChild(u);return}var f=this.hot.rootDocument.createElement("button");f.className=Fw,f.type="button",f.onclick=function(){return!1},i.firstChild.insertBefore(f,i.firstChild.firstChild)}}}}},{key:"onMenuBeforeOpen",value:function(){this.hot.runHooks("beforeDropdownMenuShow",this)}},{key:"onMenuAfterOpen",value:function(){this.hot.runHooks("afterDropdownMenuShow",this)}},{key:"onMenuAfterClose",value:function(){this.hot.listen(),this.hot.runHooks("afterDropdownMenuHide",this)}},{key:"destroy",value:function(){this.close(),this.menu&&this.menu.destroy(),la(mo(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return jw}},{key:"PLUGIN_PRIORITY",get:function(){return f1e}},{key:"PLUGIN_DEPS",get:function(){return["plugin:AutoColumnSize"]}},{key:"DEFAULT_ITEMS",get:function(){return[dv,vv,ze,gv,ze,Pp,ze,yv,ze,Wr]}}]),r}(it);X2.SEPARATOR={name:ze};function ed(e){"@babel/helpers - typeof";return ed=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ed(e)}function c1e(e,t){return y1e(e)||v1e(e,t)||d1e(e,t)||h1e()}function h1e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function d1e(e,t){if(e){if(typeof e=="string")return hD(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return hD(e,t)}}function hD(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function v1e(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function y1e(e){if(Array.isArray(e))return e}function g1e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function dD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,p1e(n.key),n)}}function m1e(e,t,r){return t&&dD(e.prototype,t),r&&dD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function p1e(e){var t=b1e(e,"string");return ed(t)==="symbol"?t:String(t)}function b1e(e,t){if(ed(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ed(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var w1e=function(){function e(t){g1e(this,e),this.hot=t,this.options={}}return m1e(e,[{key:"setOptions",value:function(r){this.options=r}},{key:"getData",value:function(){var r=this,n=this._getDataRange(),o=n.startRow,i=n.startCol,a=n.endRow,l=n.endCol,s=this.options,u=[];return _e(o,a,function(f){var c=[];!s.exportHiddenRows&&r._isHiddenRow(f)||(_e(i,l,function(h){!s.exportHiddenColumns&&r._isHiddenColumn(h)||c.push(r.hot.getDataAtCell(f,h))}),u.push(c))}),u}},{key:"getRowHeaders",value:function(){var r=this,n=[];if(this.options.rowHeaders){var o=this._getDataRange(),i=o.startRow,a=o.endRow,l=this.hot.getRowHeader();_e(i,a,function(s){!r.options.exportHiddenRows&&r._isHiddenRow(s)||n.push(l[s])})}return n}},{key:"getColumnHeaders",value:function(){var r=this,n=[];if(this.options.columnHeaders){var o=this._getDataRange(),i=o.startCol,a=o.endCol,l=this.hot.getColHeader();_e(i,a,function(s){!r.options.exportHiddenColumns&&r._isHiddenColumn(s)||n.push(l[s])})}return n}},{key:"_getDataRange",value:function(){var r=this.hot.countCols()-1,n=this.hot.countRows()-1,o=c1e(this.options.range,4),i=o[0],a=i===void 0?0:i,l=o[1],s=l===void 0?0:l,u=o[2],f=u===void 0?n:u,c=o[3],h=c===void 0?r:c;return a=Math.max(a,0),s=Math.max(s,0),f=Math.min(f,n),h=Math.min(h,r),{startRow:a,startCol:s,endRow:f,endCol:h}}},{key:"_isHiddenRow",value:function(r){return this.hot.rowIndexMapper.isHidden(this.hot.toPhysicalRow(r))}},{key:"_isHiddenColumn",value:function(r){return this.hot.columnIndexMapper.isHidden(this.hot.toPhysicalColumn(r))}}]),e}();const S1e=w1e;function td(e){"@babel/helpers - typeof";return td=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},td(e)}function C1e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function vD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,O1e(n.key),n)}}function _1e(e,t,r){return t&&vD(e.prototype,t),r&&vD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function O1e(e){var t=R1e(e,"string");return td(t)==="symbol"?t:String(t)}function R1e(e,t){if(td(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(td(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var E1e=function(){function e(t,r){C1e(this,e),this.dataProvider=t,this.options=this._mergeOptions(r),this.dataProvider.setOptions(this.options)}return _1e(e,[{key:"_mergeOptions",value:function(r){var n=_r(this.constructor.DEFAULT_OPTIONS),o=new Date;return n=Wt(_r(e.DEFAULT_OPTIONS),n),n=Wt(n,r),n.filename=AB(n.filename,{YYYY:o.getFullYear(),MM:"".concat(o.getMonth()+1).padStart(2,"0"),DD:"".concat(o.getDate()).padStart(2,"0")}),n}}],[{key:"DEFAULT_OPTIONS",get:function(){return{mimeType:"text/plain",fileExtension:"txt",filename:"Handsontable [YYYY]-[MM]-[DD]",encoding:"utf-8",bom:!1,columnHeaders:!1,rowHeaders:!1,exportHiddenColumns:!1,exportHiddenRows:!1,range:[]}}}]),e}();const T1e=E1e;function cu(e){"@babel/helpers - typeof";return cu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},cu(e)}function k1e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function yD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,$1e(n.key),n)}}function P1e(e,t,r){return t&&yD(e.prototype,t),r&&yD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function $1e(e){var t=A1e(e,"string");return cu(t)==="symbol"?t:String(t)}function A1e(e,t){if(cu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(cu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function I1e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&rO(e,t)}function rO(e,t){return rO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},rO(e,t)}function M1e(e){var t=N1e();return function(){var n=Sm(e),o;if(t){var i=Sm(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return x1e(this,o)}}function x1e(e,t){if(t&&(cu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return D1e(e)}function D1e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function N1e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Sm(e){return Sm=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Sm(e)}var H1e=String.fromCharCode(13),L1e=String.fromCharCode(34),j1e=String.fromCharCode(10),F1e=function(e){I1e(r,e);var t=M1e(r);function r(){return k1e(this,r),t.apply(this,arguments)}return P1e(r,[{key:"export",value:function(){var o=this,i=this.options,a=this.dataProvider.getData(),l=this.dataProvider.getColumnHeaders(),s=l.length>0,u=this.dataProvider.getRowHeaders(),f=u.length>0,c=i.bom?String.fromCharCode(65279):"";return s&&(l=Ye(l,function(h){return o._escapeCell(h,!0)}),f&&(c+=i.columnDelimiter),c+=l.join(i.columnDelimiter),c+=i.rowDelimiter),I(a,function(h,d){d>0&&(c+=i.rowDelimiter),f&&(c+=o._escapeCell(u[d])+i.columnDelimiter),c+=h.map(function(v){return o._escapeCell(v)}).join(i.columnDelimiter)}),c}},{key:"_escapeCell",value:function(o){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,a=Ht(o);return a!==""&&(i||a.indexOf(H1e)>=0||a.indexOf(L1e)>=0||a.indexOf(j1e)>=0||a.indexOf(this.options.columnDelimiter)>=0)&&(a=a.replace(new RegExp('"',"g"),'""'),a='"'.concat(a,'"')),a}}],[{key:"DEFAULT_OPTIONS",get:function(){return{mimeType:"text/csv",fileExtension:"csv",bom:!0,columnDelimiter:",",rowDelimiter:`\r
`}}}]),r}(T1e);const B1e=F1e;function rd(e){"@babel/helpers - typeof";return rd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},rd(e)}function V1e(e,t,r){return t=W1e(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function W1e(e){var t=U1e(e,"string");return rd(t)==="symbol"?t:String(t)}function U1e(e,t){if(rd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(rd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var z1e="csv",nO=V1e({},z1e,B1e);function Y1e(e,t,r){return typeof nO[e]=="function"?new nO[e](t,r):null}function hu(e){"@babel/helpers - typeof";return hu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},hu(e)}function G1e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function gD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,q1e(n.key),n)}}function K1e(e,t,r){return t&&gD(e.prototype,t),r&&gD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function q1e(e){var t=X1e(e,"string");return hu(t)==="symbol"?t:String(t)}function X1e(e,t){if(hu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(hu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Z1e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&oO(e,t)}function oO(e,t){return oO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},oO(e,t)}function Q1e(e){var t=tIe();return function(){var n=Cm(e),o;if(t){var i=Cm(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return J1e(this,o)}}function J1e(e,t){if(t&&(hu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return eIe(e)}function eIe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function tIe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Cm(e){return Cm=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Cm(e)}var rIe="exportFile",nIe=240,oIe=function(e){Z1e(r,e);var t=Q1e(r);function r(){return G1e(this,r),t.apply(this,arguments)}return K1e(r,[{key:"isEnabled",value:function(){return!0}},{key:"exportAsString",value:function(o){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._createTypeFormatter(o,i).export()}},{key:"exportAsBlob",value:function(o){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._createBlob(this._createTypeFormatter(o,i))}},{key:"downloadFile",value:function(o){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},a=this.hot,l=a.rootDocument,s=a.rootWindow,u=this._createTypeFormatter(o,i),f=this._createBlob(u),c=s.URL||s.webkitURL,h=l.createElement("a"),d="".concat(u.options.filename,".").concat(u.options.fileExtension);if(h.download!==void 0){var v=c.createObjectURL(f);h.style.display="none",h.setAttribute("href",v),h.setAttribute("download",d),l.body.appendChild(h),h.dispatchEvent(new MouseEvent("click")),l.body.removeChild(h),setTimeout(function(){c.revokeObjectURL(v)},100)}else navigator.msSaveOrOpenBlob&&navigator.msSaveOrOpenBlob(f,d)}},{key:"_createTypeFormatter",value:function(o){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!nO[o])throw new Error('Export format type "'.concat(o,'" is not supported.'));return Y1e(o,new S1e(this.hot),i)}},{key:"_createBlob",value:function(o){var i=null;return typeof Blob<"u"&&(i=new Blob([o.export()],{type:"".concat(o.options.mimeType,";charset=").concat(o.options.encoding)})),i}}],[{key:"PLUGIN_KEY",get:function(){return rIe}},{key:"PLUGIN_PRIORITY",get:function(){return nIe}}]),r}(it);function nd(e){"@babel/helpers - typeof";return nd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},nd(e)}function iIe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function mD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,lIe(n.key),n)}}function aIe(e,t,r){return t&&mD(e.prototype,t),r&&mD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function lIe(e){var t=sIe(e,"string");return nd(t)==="symbol"?t:String(t)}function sIe(e,t){if(nd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(nd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Z2=function(){function e(t,r){var n=r.id,o=r.stateless,i=o===void 0?!0:o;iIe(this,e),this.hot=t,this.id=n,this.elements=[],this.hidden=!1,this.stateId="Filters.component.".concat(this.id),this.state=i?null:this.hot.columnIndexMapper.registerMap(this.stateId,new pp)}return aIe(e,[{key:"reset",value:function(){I(this.elements,function(r){return r.reset()})}},{key:"hide",value:function(){this.hidden=!0}},{key:"show",value:function(){this.hidden=!1}},{key:"isHidden",value:function(){return this.hot===null||this.hidden}},{key:"restoreState",value:function(r){this.state&&this.setState(this.state.getValueAtIndex(r))}},{key:"setState",value:function(){throw new Error("The state setting logic is not implemented")}},{key:"saveState",value:function(r){this.state&&this.state.setValueAtIndex(r,this.getState())}},{key:"getState",value:function(){throw new Error("The state gathering logic is not implemented")}},{key:"destroy",value:function(){this.hot.columnIndexMapper.unregisterMap(this.stateId),this.clearLocalHooks(),I(this.elements,function(r){return r.destroy()}),this.state=null,this.elements=null,this.hot=null}}]),e}();dt(Z2,Er);const Np=Z2;var od={};function wi(e,t){if(!od[e])throw Error('Filter condition "'.concat(e,'" does not exist.'));var r=od[e],n=r.condition,o=r.descriptor,i=t;return o.inputValuesDecorator&&(i=o.inputValuesDecorator(i)),function(a){return n.apply(a.meta.instance,[].concat([a],[i]))}}function sa(e){if(!od[e])throw Error('Filter condition "'.concat(e,'" does not exist.'));return od[e].descriptor}function Bt(e,t,r){r.key=e,od[e]={condition:t,descriptor:r}}var qt="none";function uIe(){return!0}Bt(qt,uIe,{name:bp,inputsCount:0,showOperators:!1});var pc="empty";function fIe(e){return Yt(e.value)}Bt(pc,fIe,{name:X0,inputsCount:0,showOperators:!0});var og="not_empty";function cIe(e,t){return!wi(pc,t)(e)}Bt(og,cIe,{name:Z0,inputsCount:0,showOperators:!0});function hIe(e,t){return gIe(e)||yIe(e,t)||vIe(e,t)||dIe()}function dIe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function vIe(e,t){if(e){if(typeof e=="string")return pD(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return pD(e,t)}}function pD(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function yIe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function gIe(e){if(Array.isArray(e))return e}var bc="eq";function mIe(e,t){var r=hIe(t,1),n=r[0];return Ht(e.value).toLocaleLowerCase(e.meta.locale)===Ht(n)}Bt(bc,mIe,{name:Q0,inputsCount:1,showOperators:!0});var ig="neq";function pIe(e,t){return!wi(bc,t)(e)}Bt(ig,pIe,{name:J0,inputsCount:1,showOperators:!0});function bIe(e,t){return _Ie(e)||CIe(e,t)||SIe(e,t)||wIe()}function wIe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function SIe(e,t){if(e){if(typeof e=="string")return bD(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return bD(e,t)}}function bD(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function CIe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function _Ie(e){if(Array.isArray(e))return e}var Q2="gt";function OIe(e,t){var r=bIe(t,1),n=r[0],o=n;return e.meta.type==="numeric"&&(o=parseFloat(o,10)),e.value>o}Bt(Q2,OIe,{name:oT,inputsCount:1,showOperators:!0});function RIe(e,t){return PIe(e)||kIe(e,t)||TIe(e,t)||EIe()}function EIe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function TIe(e,t){if(e){if(typeof e=="string")return wD(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return wD(e,t)}}function wD(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function kIe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function PIe(e){if(Array.isArray(e))return e}var J2="gte";function $Ie(e,t){var r=RIe(t,1),n=r[0],o=n;return e.meta.type==="numeric"&&(o=parseFloat(o,10)),e.value>=o}Bt(J2,$Ie,{name:iT,inputsCount:1,showOperators:!0});function AIe(e,t){return DIe(e)||xIe(e,t)||MIe(e,t)||IIe()}function IIe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function MIe(e,t){if(e){if(typeof e=="string")return SD(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return SD(e,t)}}function SD(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function xIe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function DIe(e){if(Array.isArray(e))return e}var eU="lt";function NIe(e,t){var r=AIe(t,1),n=r[0],o=n;return e.meta.type==="numeric"&&(o=parseFloat(o,10)),e.value<o}Bt(eU,NIe,{name:aT,inputsCount:1,showOperators:!0});function HIe(e,t){return BIe(e)||FIe(e,t)||jIe(e,t)||LIe()}function LIe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function jIe(e,t){if(e){if(typeof e=="string")return CD(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return CD(e,t)}}function CD(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function FIe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function BIe(e){if(Array.isArray(e))return e}var tU="lte";function VIe(e,t){var r=HIe(t,1),n=r[0],o=n;return e.meta.type==="numeric"&&(o=parseFloat(o,10)),e.value<=o}Bt(tU,VIe,{name:lT,inputsCount:1,showOperators:!0});function WIe(e,t){return GIe(e)||YIe(e,t)||zIe(e,t)||UIe()}function UIe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function zIe(e,t){if(e){if(typeof e=="string")return _D(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return _D(e,t)}}function _D(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function YIe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function GIe(e){if(Array.isArray(e))return e}var YT="date_after";function KIe(e,t){var r=WIe(t,1),n=r[0],o=ee(e.value,e.meta.dateFormat),i=ee(n,e.meta.dateFormat);return!o.isValid()||!i.isValid()?!1:o.diff(i)>=0}Bt(YT,KIe,{name:fT,inputsCount:1,showOperators:!0});function qIe(e,t){return JIe(e)||QIe(e,t)||ZIe(e,t)||XIe()}function XIe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ZIe(e,t){if(e){if(typeof e=="string")return OD(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return OD(e,t)}}function OD(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function QIe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function JIe(e){if(Array.isArray(e))return e}var GT="date_before";function eMe(e,t){var r=qIe(t,1),n=r[0],o=ee(e.value,e.meta.dateFormat),i=ee(n,e.meta.dateFormat);return!o.isValid()||!i.isValid()?!1:o.diff(i)<=0}Bt(GT,eMe,{name:cT,inputsCount:1,showOperators:!0});function tMe(e,t){return iMe(e)||oMe(e,t)||nMe(e,t)||rMe()}function rMe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function nMe(e,t){if(e){if(typeof e=="string")return RD(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return RD(e,t)}}function RD(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function oMe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function iMe(e){if(Array.isArray(e))return e}var _m="between";function aMe(e,t){var r=tMe(t,2),n=r[0],o=r[1],i=n,a=o;if(e.meta.type==="numeric"){var l=parseFloat(i,10),s=parseFloat(a,10);i=Math.min(l,s),a=Math.max(l,s)}else if(e.meta.type==="date"){var u=wi(GT,[a]),f=wi(YT,[i]);return u(e)&&f(e)}return e.value>=i&&e.value<=a}Bt(_m,aMe,{name:sT,inputsCount:2,showOperators:!0});var rU="not_between";function lMe(e,t){return!wi(_m,t)(e)}Bt(rU,lMe,{name:uT,inputsCount:2,showOperators:!0});function sMe(e,t){return hMe(e)||cMe(e,t)||fMe(e,t)||uMe()}function uMe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function fMe(e,t){if(e){if(typeof e=="string")return ED(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return ED(e,t)}}function ED(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function cMe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function hMe(e){if(Array.isArray(e))return e}var nU="begins_with";function dMe(e,t){var r=sMe(t,1),n=r[0];return Ht(e.value).toLocaleLowerCase(e.meta.locale).startsWith(Ht(n))}Bt(nU,dMe,{name:eT,inputsCount:1,showOperators:!0});var vMe=$e,oU=Ud,yMe=Hn.f,gMe=Ua,TD=Ft,mMe=aE,pMe=Or,bMe=lE,kD=oU("".endsWith),wMe=oU("".slice),SMe=Math.min,iU=bMe("endsWith"),CMe=!iU&&!!function(){var e=yMe(String.prototype,"endsWith");return e&&!e.writable}();vMe({target:"String",proto:!0,forced:!CMe&&!iU},{endsWith:function(t){var r=TD(pMe(this));mMe(t);var n=arguments.length>1?arguments[1]:void 0,o=r.length,i=n===void 0?o:SMe(gMe(n),o),a=TD(t);return kD?kD(r,a,i):wMe(r,i-a.length,i)===a}});function _Me(e,t){return TMe(e)||EMe(e,t)||RMe(e,t)||OMe()}function OMe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function RMe(e,t){if(e){if(typeof e=="string")return PD(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return PD(e,t)}}function PD(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function EMe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function TMe(e){if(Array.isArray(e))return e}var aU="ends_with";function kMe(e,t){var r=_Me(t,1),n=r[0];return Ht(e.value).toLocaleLowerCase(e.meta.locale).endsWith(Ht(n))}Bt(aU,kMe,{name:tT,inputsCount:1,showOperators:!0});function PMe(e,t){return MMe(e)||IMe(e,t)||AMe(e,t)||$Me()}function $Me(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function AMe(e,t){if(e){if(typeof e=="string")return $D(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return $D(e,t)}}function $D(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function IMe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function MMe(e){if(Array.isArray(e))return e}var KT="contains";function xMe(e,t){var r=PMe(t,1),n=r[0];return Ht(e.value).toLocaleLowerCase(e.meta.locale).indexOf(Ht(n))>=0}Bt(KT,xMe,{name:rT,inputsCount:1,showOperators:!0});var lU="not_contains";function DMe(e,t){return!wi(KT,t)(e)}Bt(lU,DMe,{name:nT,inputsCount:1,showOperators:!0});var sU="date_tomorrow";function NMe(e){var t=ee(e.value,e.meta.dateFormat);return t.isValid()?t.isSame(ee().subtract(-1,"days").startOf("day"),"d"):!1}Bt(sU,NMe,{name:dT,inputsCount:0});var uU="date_today";function HMe(e){var t=ee(e.value,e.meta.dateFormat);return t.isValid()?t.isSame(ee().startOf("day"),"d"):!1}Bt(uU,HMe,{name:hT,inputsCount:0});var fU="date_yesterday";function LMe(e){var t=ee(e.value,e.meta.dateFormat);return t.isValid()?t.isSame(ee().subtract(1,"days").startOf("day"),"d"):!1}Bt(fU,LMe,{name:vT,inputsCount:0});aJ();function jMe(e,t){var r=e;return r===""&&(r="(".concat(t,")")),r}var iO=new Set([1]).has(1),FMe=iO&&typeof Array.from=="function";function mv(e){var t=e;return iO&&(t=new Set(t)),function(r){var n;return iO?n=t.has(r):n=!!~t.indexOf(r),n}}function cU(e){return e??""}function aO(e){var t=e;return FMe?t=Array.from(new Set(t)):t=AF(t),t=t.sort(function(r,n){return typeof r=="number"&&typeof n=="number"?r-n:r===n?0:r>n?1:-1}),t}function AD(e,t,r,n){var o=[],i=e===t,a;return i||(a=mv(t)),I(e,function(l){var s=!1;(i||a(l))&&(s=!0);var u={checked:s,value:l,visualValue:jMe(l,r)};n&&n(u),o.push(u)}),o}function hU(e,t){return UMe(e)||WMe(e,t)||VMe(e,t)||BMe()}function BMe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function VMe(e,t){if(e){if(typeof e=="string")return ID(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return ID(e,t)}}function ID(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function WMe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function UMe(e){if(Array.isArray(e))return e}var ua="by_value";function zMe(e,t){var r=hU(t,1),n=r[0];return n(e.value)}Bt(ua,zMe,{name:"By value",inputsCount:0,inputValuesDecorator:function(t){var r=hU(t,1),n=r[0];return[mv(n)]},showOperators:!1});var id={};function YMe(e){if(!id[e])throw Error('Operation with id "'.concat(e,'" does not exist.'));var t=id[e].func;return function(r,n){return t(r,n)}}function GMe(e){return id[e].name}function qT(e,t,r){id[e]={name:t,func:r}}var hi="conjunction",KMe=mT;function qMe(e,t){return e.every(function(r){return r.func(t)})}qT(hi,KMe,qMe);var Om="disjunction",XMe=wp;function ZMe(e,t){return e.some(function(r){return r.func(t)})}qT(Om,XMe,ZMe);var XT="disjunctionWithExtraCondition",QMe=wp;function JMe(e,t){if(e.length<3)throw Error("Operation doesn't work on less then three conditions.");return e.slice(0,e.length-1).some(function(r){return r.func(t)})&&e[e.length-1].func(t)}qT(XT,QMe,JMe);function ad(e){"@babel/helpers - typeof";return ad=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ad(e)}var Uf;function Bw(e,t,r){return t=exe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function exe(e){var t=txe(e,"string");return ad(t)==="symbol"?t:String(t)}function txe(e,t){if(ad(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ad(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var rxe="numeric",dU="text",nxe="date",MD=(Uf={},Bw(Uf,rxe,[qt,ze,pc,og,ze,bc,ig,ze,Q2,J2,eU,tU,_m,rU]),Bw(Uf,dU,[qt,ze,pc,og,ze,bc,ig,ze,nU,aU,ze,KT,lU]),Bw(Uf,nxe,[qt,ze,pc,og,ze,bc,ig,ze,GT,YT,_m,ze,sU,uU,fU]),Uf);function oxe(e){var t=[],r=e;return MD[r]||(r=dU),I(MD[r],function(n){var o;n===ze?o={name:ze}:o=_r(sa(n)),t.push(o)}),t}function ld(e){"@babel/helpers - typeof";return ld=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ld(e)}function ixe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function xD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,lxe(n.key),n)}}function axe(e,t,r){return t&&xD(e.prototype,t),r&&xD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function lxe(e){var t=sxe(e,"string");return ld(t)==="symbol"?t:String(t)}function sxe(e,t){if(ld(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ld(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Vw="built",Ww="building",DD=["click","input","keydown","keypress","keyup","focus","blur","change"],vU=function(){function e(t,r){ixe(this,e),this.hot=t,this.eventManager=new Pt(this),this.options=Wt(e.DEFAULTS,r),this._element=this.hot.rootDocument.createElement(this.options.wrapIt?"div":this.options.tagName),this.buildState=null}return axe(e,[{key:"setValue",value:function(r){this.options.value=r,this.update()}},{key:"getValue",value:function(){return this.options.value}},{key:"element",get:function(){return this.buildState===Ww?this._element:this.buildState===Vw?(this.update(),this._element):(this.buildState=Ww,this.build(),this.buildState=Vw,this._element)}},{key:"isBuilt",value:function(){return this.buildState===Vw}},{key:"translateIfPossible",value:function(r){return typeof r=="string"&&r.startsWith(gr)?this.hot.getTranslatedPhrase(r):r}},{key:"build",value:function(){var r=this,n=function(a,l){r.eventManager.addEventListener(a,l,function(s){return r.runLocalHooks(l,s,r)})};if(this.buildState||(this.buildState=Ww),this.options.className&&re(this._element,this.options.className),this.options.children.length)I(this.options.children,function(i){return r._element.appendChild(i.element)});else if(this.options.wrapIt){var o=this.hot.rootDocument.createElement(this.options.tagName);Ke(this.options,function(i,a){o[a]!==void 0&&a!=="className"&&a!=="tagName"&&a!=="children"&&(o[a]=r.translateIfPossible(i))}),this._element.appendChild(o),I(DD,function(i){return n(o,i)})}else I(DD,function(i){return n(r._element,i)})}},{key:"update",value:function(){}},{key:"reset",value:function(){this.options.value="",this.update()}},{key:"show",value:function(){this.element.style.display=""}},{key:"hide",value:function(){this.element.style.display="none"}},{key:"focus",value:function(){}},{key:"destroy",value:function(){this.eventManager.destroy(),this.eventManager=null,this.hot=null,this._element.parentNode&&this._element.parentNode.removeChild(this._element),this._element=null}}],[{key:"DEFAULTS",get:function(){return _r({className:"",value:"",tagName:"div",children:[],wrapIt:!0})}}]),e}();dt(vU,Er);const di=vU;function du(e){"@babel/helpers - typeof";return du=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},du(e)}function uxe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ND(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,cxe(n.key),n)}}function fxe(e,t,r){return t&&ND(e.prototype,t),r&&ND(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function cxe(e){var t=hxe(e,"string");return du(t)==="symbol"?t:String(t)}function hxe(e,t){if(du(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(du(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ag(){return typeof Reflect<"u"&&Reflect.get?ag=Reflect.get.bind():ag=function(t,r,n){var o=dxe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},ag.apply(this,arguments)}function dxe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=vu(e),e!==null););return e}function vxe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&lO(e,t)}function lO(e,t){return lO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},lO(e,t)}function yxe(e){var t=mxe();return function(){var n=vu(e),o;if(t){var i=vu(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return gxe(this,o)}}function gxe(e,t){if(t&&(du(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return yU(e)}function yU(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function mxe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function vu(e){return vu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},vu(e)}var hy=new WeakMap,pxe=function(e){vxe(r,e);var t=yxe(r);function r(n,o){var i;return uxe(this,r),i=t.call(this,n,Wt(r.DEFAULTS,o)),hy.set(yU(i),{}),i.registerHooks(),i}return fxe(r,[{key:"registerHooks",value:function(){var o=this;this.addLocalHook("click",function(){return o.onClick()}),this.addLocalHook("keyup",function(i){return o.onKeyup(i)})}},{key:"build",value:function(){ag(vu(r.prototype),"build",this).call(this);var o=hy.get(this),i=this.hot.rootDocument.createElement("div");o.input=this._element.firstChild,re(this._element,"htUIInput"),re(i,"htUIInputIcon"),this._element.appendChild(i),this.update()}},{key:"update",value:function(){if(this.isBuilt()){var o=hy.get(this).input;o.type=this.options.type,o.placeholder=this.translateIfPossible(this.options.placeholder),o.value=this.translateIfPossible(this.options.value)}}},{key:"focus",value:function(){this.isBuilt()&&hy.get(this).input.focus()}},{key:"onClick",value:function(){}},{key:"onKeyup",value:function(o){this.options.value=o.target.value}}],[{key:"DEFAULTS",get:function(){return _r({placeholder:"",type:"text",tagName:"input"})}}]),r}(di);const Yl=pxe;function yu(e){"@babel/helpers - typeof";return yu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},yu(e)}function bxe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function HD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Sxe(n.key),n)}}function wxe(e,t,r){return t&&HD(e.prototype,t),r&&HD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Sxe(e){var t=Cxe(e,"string");return yu(t)==="symbol"?t:String(t)}function Cxe(e,t){if(yu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(yu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Gl(){return typeof Reflect<"u"&&Reflect.get?Gl=Reflect.get.bind():Gl=function(t,r,n){var o=_xe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Gl.apply(this,arguments)}function _xe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=vi(e),e!==null););return e}function Oxe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&sO(e,t)}function sO(e,t){return sO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},sO(e,t)}function Rxe(e){var t=Txe();return function(){var n=vi(e),o;if(t){var i=vi(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Exe(this,o)}}function Exe(e,t){if(t&&(yu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return gU(e)}function gU(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Txe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function vi(e){return vi=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},vi(e)}var dy=new WeakMap,kxe=function(e){Oxe(r,e);var t=Rxe(r);function r(n,o){var i;return bxe(this,r),i=t.call(this,n,Wt(r.DEFAULTS,o)),dy.set(gU(i),{}),i.menu=null,i.items=[],i.registerHooks(),i}return wxe(r,[{key:"registerHooks",value:function(){var o=this;this.addLocalHook("click",function(){return o.onClick()})}},{key:"setItems",value:function(o){this.items=this.translateNames(o),this.menu&&this.menu.setMenuItems(this.items)}},{key:"translateNames",value:function(o){var i=this;return I(o,function(a){a.name=i.translateIfPossible(a.name)}),o}},{key:"build",value:function(){var o=this;Gl(vi(r.prototype),"build",this).call(this),this.menu=new UT(this.hot,{className:"htSelectUI htFiltersConditionsMenu",keepInViewport:!1,standalone:!0,container:this.options.menuContainer}),this.menu.setMenuItems(this.items);var i=new di(this.hot,{className:"htUISelectCaption"}),a=new di(this.hot,{className:"htUISelectDropdown"}),l=dy.get(this);l.caption=i,l.captionElement=i.element,l.dropdown=a,I([i,a],function(s){return o._element.appendChild(s.element)}),this.menu.addLocalHook("select",function(s){return o.onMenuSelect(s)}),this.menu.addLocalHook("afterClose",function(){return o.onMenuClosed()}),this.update()}},{key:"update",value:function(){if(this.isBuilt()){var o;this.options.value?o=this.options.value.name:o=this.menu.hot.getTranslatedPhrase(bp),dy.get(this).captionElement.textContent=o,Gl(vi(r.prototype),"update",this).call(this)}}},{key:"openOptions",value:function(){var o=this.element.getBoundingClientRect();this.menu&&(this.menu.open(),this.menu.setPosition({left:this.hot.isLtr()?o.left-5:o.left-31,top:o.top-1,width:o.width,height:o.height}))}},{key:"closeOptions",value:function(){this.menu&&this.menu.close()}},{key:"onMenuSelect",value:function(o){o.name!==ze&&(this.options.value=o,this.update(),this.runLocalHooks("select",this.options.value))}},{key:"onMenuClosed",value:function(){this.runLocalHooks("afterClose")}},{key:"onClick",value:function(){this.openOptions()}},{key:"destroy",value:function(){this.menu&&(this.menu.destroy(),this.menu=null);var o=dy.get(this),i=o.caption,a=o.dropdown;i&&i.destroy(),a&&a.destroy(),Gl(vi(r.prototype),"destroy",this).call(this)}}],[{key:"DEFAULTS",get:function(){return _r({className:"htUISelect",wrapIt:!1})}}]),r}(di);const LD=kxe;function gu(e){"@babel/helpers - typeof";return gu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},gu(e)}function Pxe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function jD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Axe(n.key),n)}}function $xe(e,t,r){return t&&jD(e.prototype,t),r&&jD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Axe(e){var t=Ixe(e,"string");return gu(t)==="symbol"?t:String(t)}function Ixe(e,t){if(gu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(gu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function lg(){return typeof Reflect<"u"&&Reflect.get?lg=Reflect.get.bind():lg=function(t,r,n){var o=Mxe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},lg.apply(this,arguments)}function Mxe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=mu(e),e!==null););return e}function xxe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&uO(e,t)}function uO(e,t){return uO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},uO(e,t)}function Dxe(e){var t=Lxe();return function(){var n=mu(e),o;if(t){var i=mu(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Nxe(this,o)}}function Nxe(e,t){if(t&&(gu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Hxe(e)}function Hxe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Lxe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function mu(e){return mu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},mu(e)}var jxe=function(e){xxe(r,e);var t=Dxe(r);function r(n,o){var i;return Pxe(this,r),i=t.call(this,n,{id:o.id,stateless:!1}),i.name=o.name,i.addSeparator=o.addSeparator,i.elements.push(new LD(i.hot,{menuContainer:o.menuContainer})),i.elements.push(new Yl(i.hot,{placeholder:_T})),i.elements.push(new Yl(i.hot,{placeholder:OT})),i.registerHooks(),i}return $xe(r,[{key:"registerHooks",value:function(){var o=this;this.getSelectElement().addLocalHook("select",function(i){return o.onConditionSelect(i)}),this.getSelectElement().addLocalHook("afterClose",function(){return o.onSelectUIClosed()}),I(this.getInputElements(),function(i){i.addLocalHook("keydown",function(a){return o.onInputKeyDown(a)})})}},{key:"setState",value:function(o){var i=this;if(this.reset(),!!o){var a=_r(o.command);a.name.startsWith($t)&&(a.name=this.hot.getTranslatedPhrase(a.name)),this.getSelectElement().setValue(a),I(o.args,function(l,s){if(s>a.inputsCount-1)return!1;var u=i.getInputElement(s);u.setValue(l),u[a.inputsCount>s?"show":"hide"](),s||setTimeout(function(){return u.focus()},10)})}}},{key:"getState",value:function(){var o=this.getSelectElement().getValue()||sa(qt),i=[];return I(this.getInputElements(),function(a,l){o.inputsCount>l&&i.push(a.getValue())}),{command:o,args:i}}},{key:"updateState",value:function(o,i){var a=sa(o?o.name:qt);this.state.setValueAtIndex(i,{command:a,args:o?o.args:[]}),o||I(this.getInputElements(),function(l){return l.setValue(null)})}},{key:"getSelectElement",value:function(){return this.elements.filter(function(o){return o instanceof LD})[0]}},{key:"getInputElement",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.getInputElements()[o]}},{key:"getInputElements",value:function(){return this.elements.filter(function(o){return o instanceof Yl})}},{key:"getMenuItemDescriptor",value:function(){var o=this;return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:function(){return o.isHidden()},renderer:function(a,l,s,u,f,c){re(l.parentNode,"htFiltersMenuCondition"),o.addSeparator&&re(l.parentNode,"border");var h=o.hot.rootDocument.createElement("div");return re(h,"htFiltersMenuLabel"),h.textContent=c,l.appendChild(h),l.parentNode.hasAttribute("ghost-table")||I(o.elements,function(d){return l.appendChild(d.element)}),l}}}},{key:"reset",value:function(){var o=this.hot.getPlugin("filters").getSelectedColumn(),i=[sa(qt)];if(o!==null){var a=o.visualIndex;i=oxe(this.hot.getDataType(0,a,this.hot.countRows(),a))}I(this.getInputElements(),function(l){return l.hide()}),this.getSelectElement().setItems(i),lg(mu(r.prototype),"reset",this).call(this),this.getSelectElement().setValue(i[0])}},{key:"onConditionSelect",value:function(o){I(this.getInputElements(),function(i,a){i[o.inputsCount>a?"show":"hide"](),a===0&&setTimeout(function(){return i.focus()},10)}),this.runLocalHooks("change",o)}},{key:"onSelectUIClosed",value:function(){this.runLocalHooks("afterClose")}},{key:"onInputKeyDown",value:function(o){Ic(o.keyCode,"ENTER")?(this.runLocalHooks("accept"),Dn(o)):Ic(o.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),Dn(o))}}]),r}(Np);const Uw=jxe;function pu(e){"@babel/helpers - typeof";return pu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},pu(e)}function Fxe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function FD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Vxe(n.key),n)}}function Bxe(e,t,r){return t&&FD(e.prototype,t),r&&FD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Vxe(e){var t=Wxe(e,"string");return pu(t)==="symbol"?t:String(t)}function Wxe(e,t){if(pu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(pu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function sg(){return typeof Reflect<"u"&&Reflect.get?sg=Reflect.get.bind():sg=function(t,r,n){var o=Uxe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},sg.apply(this,arguments)}function Uxe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=bu(e),e!==null););return e}function zxe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&fO(e,t)}function fO(e,t){return fO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},fO(e,t)}function Yxe(e){var t=Kxe();return function(){var n=bu(e),o;if(t){var i=bu(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Gxe(this,o)}}function Gxe(e,t){if(t&&(pu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return mU(e)}function mU(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Kxe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function bu(e){return bu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},bu(e)}var vy=new WeakMap,qxe=function(e){zxe(r,e);var t=Yxe(r);function r(n,o){var i;return Fxe(this,r),i=t.call(this,n,Wt(r.DEFAULTS,o)),vy.set(mU(i),{}),i}return Bxe(r,[{key:"build",value:function(){sg(bu(r.prototype),"build",this).call(this);var o=vy.get(this);o.input=this._element.firstChild;var i=this.hot.rootDocument.createElement("label");i.textContent=this.translateIfPossible(this.options.label.textContent),i.htmlFor=this.translateIfPossible(this.options.label.htmlFor),o.label=i,this._element.appendChild(i),this.update()}},{key:"update",value:function(){if(this.isBuilt()){var o=vy.get(this);o.input.checked=this.options.checked,o.label.textContent=this.translateIfPossible(this.options.label.textContent)}}},{key:"isChecked",value:function(){return this.options.checked}},{key:"setChecked",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.options.checked=o,this.update()}},{key:"focus",value:function(){this.isBuilt()&&vy.get(this).input.focus()}}],[{key:"DEFAULTS",get:function(){return _r({type:"radio",tagName:"input",className:"htUIRadio",label:{}})}}]),r}(di);const BD=qxe;function wu(e){"@babel/helpers - typeof";return wu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},wu(e)}var VD;function Xxe(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function Zxe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function WD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Jxe(n.key),n)}}function Qxe(e,t,r){return t&&WD(e.prototype,t),r&&WD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Jxe(e){var t=eDe(e,"string");return wu(t)==="symbol"?t:String(t)}function eDe(e,t){if(wu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(wu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function tDe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&cO(e,t)}function cO(e,t){return cO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},cO(e,t)}function rDe(e){var t=iDe();return function(){var n=Rm(e),o;if(t){var i=Rm(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return nDe(this,o)}}function nDe(e,t){if(t&&(wu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return oDe(e)}function oDe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function iDe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Rm(e){return Rm=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Rm(e)}var UD=0,aDe=function(e){tDe(r,e);var t=rDe(r);function r(n,o){var i;return Zxe(this,r),i=t.call(this,n,{id:o.id,stateless:!1}),i.name=o.name,i.buildOperatorsElement(),i}return Qxe(r,[{key:"getMenuItemDescriptor",value:function(){var o=this;return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:function(){return o.isHidden()},renderer:function(a,l){return re(l.parentNode,"htFiltersMenuOperators"),l.parentNode.hasAttribute("ghost-table")||I(o.elements,function(s){return l.appendChild(s.element)}),l}}}},{key:"buildOperatorsElement",value:function(){var o=this,i=[hi,Om];I(i,function(a){var l=new BD(o.hot,{name:"operator",label:{htmlFor:a,textContent:GMe(a)},value:a,checked:a===i[UD],id:a});l.addLocalHook("change",function(s){return o.onRadioInputChange(s)}),o.elements.push(l)})}},{key:"setChecked",value:function(o){if(this.elements.length<o)throw Error(ft(VD||(VD=Xxe(["Radio button with index "," doesn't exist."])),o));I(this.elements,function(i,a){i.setChecked(a===o)})}},{key:"getActiveOperationId",value:function(){var o=this.elements.find(function(i){return i instanceof BD&&i.isChecked()});return o?o.getValue():hi}},{key:"getState",value:function(){return this.getActiveOperationId()}},{key:"setState",value:function(o){this.reset(),o&&this.getActiveOperationId()!==o&&I(this.elements,function(i){i.setChecked(i.getValue()===o)})}},{key:"updateState",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:hi,i=arguments.length>1?arguments[1]:void 0,a=o;a===XT&&(a=Om),this.state.setValueAtIndex(i,a)}},{key:"reset",value:function(){this.setChecked(UD)}},{key:"onRadioInputChange",value:function(o){this.setState(o.target.value)}}]),r}(Np);const lDe=aDe;var sDe=Ve,uDe=Or,zD=Ft,fDe=/"/g,cDe=sDe("".replace),hDe=function(e,t,r,n){var o=zD(uDe(e)),i="<"+t;return r!==""&&(i+=" "+r+'="'+cDe(zD(n),fDe,"&quot;")+'"'),i+">"+o+"</"+t+">"},dDe=Le,vDe=function(e){return dDe(function(){var t=""[e]('"');return t!==t.toLowerCase()||t.split('"').length>3})},yDe=$e,gDe=hDe,mDe=vDe;yDe({target:"String",proto:!0,forced:mDe("link")},{link:function(t){return gDe(this,"a","href",t)}});function Su(e){"@babel/helpers - typeof";return Su=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Su(e)}function pDe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function YD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,wDe(n.key),n)}}function bDe(e,t,r){return t&&YD(e.prototype,t),r&&YD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function wDe(e){var t=SDe(e,"string");return Su(t)==="symbol"?t:String(t)}function SDe(e,t){if(Su(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Su(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ug(){return typeof Reflect<"u"&&Reflect.get?ug=Reflect.get.bind():ug=function(t,r,n){var o=CDe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},ug.apply(this,arguments)}function CDe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Cu(e),e!==null););return e}function _De(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&hO(e,t)}function hO(e,t){return hO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},hO(e,t)}function ODe(e){var t=EDe();return function(){var n=Cu(e),o;if(t){var i=Cu(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return RDe(this,o)}}function RDe(e,t){if(t&&(Su(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return pU(e)}function pU(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function EDe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Cu(e){return Cu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Cu(e)}var zw=new WeakMap,TDe=function(e){_De(r,e);var t=ODe(r);function r(n,o){var i;return pDe(this,r),i=t.call(this,n,Wt(r.DEFAULTS,o)),zw.set(pU(i),{}),i}return bDe(r,[{key:"build",value:function(){ug(Cu(r.prototype),"build",this).call(this);var o=zw.get(this);o.link=this._element.firstChild}},{key:"update",value:function(){this.isBuilt()&&(zw.get(this).link.textContent=this.translateIfPossible(this.options.textContent))}}],[{key:"DEFAULTS",get:function(){return _r({href:"#",tagName:"a"})}}]),r}(di);const GD=TDe;function _u(e){"@babel/helpers - typeof";return _u=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_u(e)}function KD(e){return ADe(e)||$De(e)||PDe(e)||kDe()}function kDe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function PDe(e,t){if(e){if(typeof e=="string")return dO(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return dO(e,t)}}function $De(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function ADe(e){if(Array.isArray(e))return dO(e)}function dO(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function IDe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function qD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,xDe(n.key),n)}}function MDe(e,t,r){return t&&qD(e.prototype,t),r&&qD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function xDe(e){var t=DDe(e,"string");return _u(t)==="symbol"?t:String(t)}function DDe(e,t){if(_u(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_u(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Kl(){return typeof Reflect<"u"&&Reflect.get?Kl=Reflect.get.bind():Kl=function(t,r,n){var o=NDe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Kl.apply(this,arguments)}function NDe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=yi(e),e!==null););return e}function HDe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&vO(e,t)}function vO(e,t){return vO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},vO(e,t)}function LDe(e){var t=FDe();return function(){var n=yi(e),o;if(t){var i=yi(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return jDe(this,o)}}function jDe(e,t){if(t&&(_u(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return bU(e)}function bU(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function FDe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function yi(e){return yi=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},yi(e)}var BDe=new WeakMap,VDe="multipleSelect.itemBox",WDe=function(e){HDe(r,e);var t=LDe(r);function r(n,o){var i;return IDe(this,r),i=t.call(this,n,Wt(r.DEFAULTS,o)),BDe.set(bU(i),{}),i.searchInput=new Yl(i.hot,{placeholder:CT,className:"htUIMultipleSelectSearch"}),i.selectAllUI=new GD(i.hot,{textContent:pT,className:"htUISelectAll"}),i.clearAllUI=new GD(i.hot,{textContent:bT,className:"htUIClearAll"}),i.items=[],i.itemsBox=null,i.registerHooks(),i}return MDe(r,[{key:"registerHooks",value:function(){var o=this;this.searchInput.addLocalHook("keydown",function(i){return o.onInputKeyDown(i)}),this.searchInput.addLocalHook("input",function(i){return o.onInput(i)}),this.selectAllUI.addLocalHook("click",function(i){return o.onSelectAllClick(i)}),this.clearAllUI.addLocalHook("click",function(i){return o.onClearAllClick(i)})}},{key:"setItems",value:function(o){this.items=o,this.itemsBox&&this.itemsBox.loadData(this.items)}},{key:"setLocale",value:function(o){this.locale=o}},{key:"getLocale",value:function(){return this.locale}},{key:"getItems",value:function(){return KD(this.items)}},{key:"getValue",value:function(){return zDe(this.items)}},{key:"isSelectedAllValues",value:function(){return this.items.length===this.getValue().length}},{key:"build",value:function(){var o=this;Kl(yi(r.prototype),"build",this).call(this);var i=this.hot.rootDocument,a=i.createElement("div"),l=new di(this.hot,{className:"htUISelectionControls",children:[this.selectAllUI,this.clearAllUI]});this._element.appendChild(this.searchInput.element),this._element.appendChild(l.element),this._element.appendChild(a);var s=function(f){if(o._element){o.itemsBox&&o.itemsBox.destroy(),re(f,"htUIMultipleSelectHot"),o.itemsBox=new o.hot.constructor(f,{data:o.items,columns:[{data:"checked",type:"checkbox",label:{property:"visualValue",position:"after"}}],beforeRenderer:function(v,y,p,w,S,C){v.title=C.instance.getDataAtRowProp(y,C.label.property)},maxCols:1,autoWrapCol:!0,height:110,colWidths:function(){return o.itemsBox.container.scrollWidth-Zt(i)},copyPaste:!1,disableVisualSelection:"area",fillHandle:!1,fragmentSelection:"cell",tabMoves:{row:1,col:0},layoutDirection:o.hot.isRtl()?"rtl":"ltr"}),o.itemsBox.init();var c=o.itemsBox.getShortcutManager(),h=c.getContext("grid");h.addShortcut({keys:[["Escape"]],callback:function(v){o.runLocalHooks("keydown",v,o)},group:VDe})}};s(a),setTimeout(function(){return s(a)},100)}},{key:"reset",value:function(){this.searchInput.reset(),this.selectAllUI.reset(),this.clearAllUI.reset()}},{key:"update",value:function(){this.isBuilt()&&(this.itemsBox.loadData(UDe(this.items,this.options.value)),Kl(yi(r.prototype),"update",this).call(this))}},{key:"destroy",value:function(){this.itemsBox&&this.itemsBox.destroy(),this.searchInput.destroy(),this.clearAllUI.destroy(),this.selectAllUI.destroy(),this.searchInput=null,this.clearAllUI=null,this.selectAllUI=null,this.itemsBox=null,this.items=null,Kl(yi(r.prototype),"destroy",this).call(this)}},{key:"onInput",value:function(o){var i=this,a=o.target.value.toLocaleLowerCase(this.getLocale()),l;a===""?l=KD(this.items):l=Yr(this.items,function(s){return"".concat(s.value).toLocaleLowerCase(i.getLocale()).indexOf(a)>=0}),this.itemsBox.loadData(l)}},{key:"onInputKeyDown",value:function(o){this.runLocalHooks("keydown",o,this);var i=NB(Ic,o.keyCode);i("ARROW_DOWN|TAB")&&!this.itemsBox.isListening()&&(Dn(o),this.itemsBox.listen(),this.itemsBox.selectCell(0,0))}},{key:"onSelectAllClick",value:function(o){var i=[];o.preventDefault(),I(this.itemsBox.getSourceData(),function(a,l){a.checked=!0,i.push(iI(a,l)[0])}),this.itemsBox.setSourceDataAtCell(i)}},{key:"onClearAllClick",value:function(o){var i=[];o.preventDefault(),I(this.itemsBox.getSourceData(),function(a,l){a.checked=!1,i.push(iI(a,l)[0])}),this.itemsBox.setSourceDataAtCell(i)}}],[{key:"DEFAULTS",get:function(){return _r({className:"htUIMultipleSelect",value:[]})}}]),r}(di);const XD=WDe;function UDe(e,t){var r=mv(t);return Ye(e,function(n){return n.checked=r(n.value),n})}function zDe(e){var t=[];return I(e,function(r){r.checked&&t.push(r.value)}),t}function Ou(e){"@babel/helpers - typeof";return Ou=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ou(e)}function YDe(e,t){return XDe(e)||qDe(e,t)||KDe(e,t)||GDe()}function GDe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function KDe(e,t){if(e){if(typeof e=="string")return ZD(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return ZD(e,t)}}function ZD(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function qDe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function XDe(e){if(Array.isArray(e))return e}function ZDe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function QD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,JDe(n.key),n)}}function QDe(e,t,r){return t&&QD(e.prototype,t),r&&QD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function JDe(e){var t=eNe(e,"string");return Ou(t)==="symbol"?t:String(t)}function eNe(e,t){if(Ou(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ou(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function fg(){return typeof Reflect<"u"&&Reflect.get?fg=Reflect.get.bind():fg=function(t,r,n){var o=tNe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},fg.apply(this,arguments)}function tNe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Ru(e),e!==null););return e}function rNe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&yO(e,t)}function yO(e,t){return yO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},yO(e,t)}function nNe(e){var t=aNe();return function(){var n=Ru(e),o;if(t){var i=Ru(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return oNe(this,o)}}function oNe(e,t){if(t&&(Ou(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return iNe(e)}function iNe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function aNe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ru(e){return Ru=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Ru(e)}var lNe=function(e){rNe(r,e);var t=nNe(r);function r(n,o){var i;return ZDe(this,r),i=t.call(this,n,{id:o.id,stateless:!1}),i.name=o.name,i.elements.push(new XD(i.hot)),i.registerHooks(),i}return QDe(r,[{key:"registerHooks",value:function(){var o=this;this.getMultipleSelectElement().addLocalHook("keydown",function(i){return o.onInputKeyDown(i)})}},{key:"setState",value:function(o){if(this.reset(),o&&o.command.key===ua){var i=this.getMultipleSelectElement();i.setItems(o.itemsSnapshot),i.setValue(o.args[0]),i.setLocale(o.locale)}}},{key:"getState",value:function(){var o=this.getMultipleSelectElement(),i=o.getItems();return{command:{key:o.isSelectedAllValues()||!i.length?qt:ua},args:[o.getValue()],itemsSnapshot:i}}},{key:"updateState",value:function(o){var i=this,a=function(s,u,f,c,h){var d=Yr(u,function(W){return W.name===ua}),v=YDe(d,1),y=v[0],p={},w=i.hot.getTranslatedPhrase(cm);if(y){var S=aO(Ye(c(s,h),function(W){return W.value}));f&&(y.args[0]=f);var C=[],P=AD(S,y.args[0],w,function(W){W.checked&&C.push(W.value)}),R=o.editedConditionStack.column;p.locale=i.hot.getCellMeta(0,R).locale,p.args=[C],p.command=sa(ua),p.itemsSnapshot=P}else p.args=[],p.command=sa(qt);i.state.setValueAtIndex(s,p)};a(o.editedConditionStack.column,o.editedConditionStack.conditions,o.conditionArgsChange,o.filteredRowsFactory),o.dependentConditionStacks.length&&a(o.dependentConditionStacks[0].column,o.dependentConditionStacks[0].conditions,o.conditionArgsChange,o.filteredRowsFactory,o.editedConditionStack)}},{key:"getMultipleSelectElement",value:function(){return this.elements.filter(function(o){return o instanceof XD})[0]}},{key:"getMenuItemDescriptor",value:function(){var o=this;return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:function(){return o.isHidden()},renderer:function(a,l,s,u,f,c){re(l.parentNode,"htFiltersMenuValue");var h=o.hot.rootDocument.createElement("div");return re(h,"htFiltersMenuLabel"),h.textContent=c,l.appendChild(h),l.parentNode.hasAttribute("ghost-table")||I(o.elements,function(d){return l.appendChild(d.element)}),l}}}},{key:"reset",value:function(){var o=this.hot.getTranslatedPhrase(cm),i=aO(this._getColumnVisibleValues()),a=AD(i,i,o);this.getMultipleSelectElement().setItems(a),fg(Ru(r.prototype),"reset",this).call(this),this.getMultipleSelectElement().setValue(i);var l=this.hot.getPlugin("filters").getSelectedColumn();l!==null&&this.getMultipleSelectElement().setLocale(this.hot.getCellMeta(0,l.visualIndex).locale)}},{key:"onInputKeyDown",value:function(o){Ic(o.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),Dn(o))}},{key:"_getColumnVisibleValues",value:function(){var o=this.hot.getPlugin("filters").getSelectedColumn();return o===null?[]:Ye(this.hot.getDataAtCol(o.visualIndex),function(i){return cU(i)})}}]),r}(Np);const sNe=lNe;function Eu(e){"@babel/helpers - typeof";return Eu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Eu(e)}function uNe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function JD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,cNe(n.key),n)}}function fNe(e,t,r){return t&&JD(e.prototype,t),r&&JD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function cNe(e){var t=hNe(e,"string");return Eu(t)==="symbol"?t:String(t)}function hNe(e,t){if(Eu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Eu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function dNe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&gO(e,t)}function gO(e,t){return gO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},gO(e,t)}function vNe(e){var t=mNe();return function(){var n=Em(e),o;if(t){var i=Em(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return yNe(this,o)}}function yNe(e,t){if(t&&(Eu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return gNe(e)}function gNe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function mNe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Em(e){return Em=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Em(e)}var pNe=function(e){dNe(r,e);var t=vNe(r);function r(n,o){var i;return uNe(this,r),i=t.call(this,n,{id:o.id,stateless:!0}),i.name=o.name,i.elements.push(new Yl(i.hot,{type:"button",value:wT,className:"htUIButton htUIButtonOK",identifier:r.BUTTON_OK})),i.elements.push(new Yl(i.hot,{type:"button",value:ST,className:"htUIButton htUIButtonCancel",identifier:r.BUTTON_CANCEL})),i.registerHooks(),i}return fNe(r,[{key:"registerHooks",value:function(){var o=this;I(this.elements,function(i){i.addLocalHook("click",function(a,l){return o.onButtonClick(a,l)})})}},{key:"getMenuItemDescriptor",value:function(){var o=this;return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:function(){return o.isHidden()},renderer:function(a,l){return re(l.parentNode,"htFiltersMenuActionBar"),l.parentNode.hasAttribute("ghost-table")||I(o.elements,function(s){return l.appendChild(s.element)}),l}}}},{key:"accept",value:function(){this.runLocalHooks("accept")}},{key:"cancel",value:function(){this.runLocalHooks("cancel")}},{key:"onButtonClick",value:function(o,i){i.options.identifier===r.BUTTON_OK?this.accept():this.cancel()}}],[{key:"BUTTON_OK",get:function(){return"ok"}},{key:"BUTTON_CANCEL",get:function(){return"cancel"}}]),r}(Np);const bNe=pNe;function sd(e){"@babel/helpers - typeof";return sd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},sd(e)}var eN,tN;function rN(e,t){return _Ne(e)||CNe(e,t)||SNe(e,t)||wNe()}function wNe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function SNe(e,t){if(e){if(typeof e=="string")return nN(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return nN(e,t)}}function nN(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function CNe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function _Ne(e){if(Array.isArray(e))return e}function oN(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function ONe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function iN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,ENe(n.key),n)}}function RNe(e,t,r){return t&&iN(e.prototype,t),r&&iN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function ENe(e){var t=TNe(e,"string");return sd(t)==="symbol"?t:String(t)}function TNe(e,t){if(sd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(sd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var aN="ConditionCollection.filteringStates",wU=function(){function e(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;ONe(this,e),this.hot=t,this.isMapRegistrable=r,this.filteringStates=new pp,this.isMapRegistrable===!0?this.hot.columnIndexMapper.registerMap(aN,this.filteringStates):this.filteringStates.init(this.hot.columnIndexMapper.getNumberOfIndexes())}return RNe(e,[{key:"isEmpty",value:function(){return this.getFilteredColumns().length===0}},{key:"isMatch",value:function(r,n){var o,i=this.filteringStates.getValueAtIndex(n),a=(o=i==null?void 0:i.conditions)!==null&&o!==void 0?o:[],l=i==null?void 0:i.operation;return this.isMatchInConditions(a,r,l)}},{key:"isMatchInConditions",value:function(r,n){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:hi;return r.length?YMe(o)(r,n):!0}},{key:"addCondition",value:function(r,n){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:hi,i=arguments.length>3?arguments[3]:void 0,a=this.hot.getCellMeta(0,r).locale,l=Ye(n.args,function(c){return typeof c=="string"?c.toLocaleLowerCase(a):c}),s=n.name||n.command.key;this.runLocalHooks("beforeAdd",r);var u=this.getOperation(r);if(u){if(u!==o)throw Error(ft(eN||(eN=oN(["The column of index "," has been already applied with a `","` \n        filter operation. Use `removeConditions` to clear the current conditions and then add new ones. \n        Mind that you cannot mix different types of operations (for instance, if you use `conjunction`, \n        use it consequently for a particular column)."],["The column of index "," has been already applied with a \\`","\\`\\x20\n        filter operation. Use \\`removeConditions\\` to clear the current conditions and then add new ones.\\x20\n        Mind that you cannot mix different types of operations (for instance, if you use \\`conjunction\\`,\\x20\n        use it consequently for a particular column)."])),r,u))}else if(gt(id[o]))throw new Error(ft(tN||(tN=oN(["Unexpected operation named `","`. Possible ones are \n        `disjunction` and `conjunction`."],["Unexpected operation named \\`","\\`. Possible ones are\\x20\n        \\`disjunction\\` and \\`conjunction\\`."])),o));var f=this.getConditions(r);f.length===0?this.filteringStates.setValueAtIndex(r,{operation:o,conditions:[{name:s,args:l,func:wi(s,l)}]},i):f.push({name:s,args:l,func:wi(s,l)}),this.runLocalHooks("afterAdd",r)}},{key:"getConditions",value:function(r){var n,o;return(n=(o=this.filteringStates.getValueAtIndex(r))===null||o===void 0?void 0:o.conditions)!==null&&n!==void 0?n:[]}},{key:"getOperation",value:function(r){var n;return(n=this.filteringStates.getValueAtIndex(r))===null||n===void 0?void 0:n.operation}},{key:"getFilteredColumns",value:function(){return this.filteringStates.getEntries().map(function(r){var n=rN(r,1),o=n[0];return o})}},{key:"getColumnStackPosition",value:function(r){return this.getFilteredColumns().indexOf(r)}},{key:"exportAllConditions",value:function(){return nr(this.filteringStates.getEntries(),function(r,n){var o=rN(n,2),i=o[0],a=o[1],l=a.operation,s=a.conditions;return r.push({column:i,operation:l,conditions:Ye(s,function(u){var f=u.name,c=u.args;return{name:f,args:c}})}),r},[])}},{key:"importAllConditions",value:function(r){var n=this;this.clean(),I(r,function(o){I(o.conditions,function(i){return n.addCondition(o.column,i)})})}},{key:"removeConditions",value:function(r){this.runLocalHooks("beforeRemove",r),this.filteringStates.clearValue(r),this.runLocalHooks("afterRemove",r)}},{key:"clean",value:function(){this.runLocalHooks("beforeClean"),this.filteringStates.clear(),this.runLocalHooks("afterClean")}},{key:"hasConditions",value:function(r,n){var o=this.getConditions(r);return n?o.some(function(i){return i.name===n}):o.length>0}},{key:"destroy",value:function(){this.isMapRegistrable&&this.hot.columnIndexMapper.unregisterMap(aN),this.filteringStates=null,this.clearLocalHooks()}}]),e}();dt(wU,Er);const SU=wU;function ud(e){"@babel/helpers - typeof";return ud=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ud(e)}function kNe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function lN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,$Ne(n.key),n)}}function PNe(e,t,r){return t&&lN(e.prototype,t),r&&lN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function $Ne(e){var t=ANe(e,"string");return ud(t)==="symbol"?t:String(t)}function ANe(e,t){if(ud(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ud(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var INe=function(){function e(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:function(){return[]};kNe(this,e),this.conditionCollection=t,this.columnDataFactory=r}return PNe(e,[{key:"filter",value:function(){var r=this,n=[];return I(this.conditionCollection.getFilteredColumns(),function(o,i){var a=r.columnDataFactory(o);i&&(a=r._getIntersectData(a,n)),n=r.filterByColumn(o,a)}),n}},{key:"filterByColumn",value:function(r){var n=this,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],i=[];return I(o,function(a){a!==void 0&&n.conditionCollection.isMatch(a,r)&&i.push(a)}),i}},{key:"_getIntersectData",value:function(r,n){var o=[];return I(n,function(i){var a=i.meta.visualRow;r[a]!==void 0&&(o[a]=r[a])}),o}}]),e}();const CU=INe;function fd(e){"@babel/helpers - typeof";return fd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},fd(e)}function MNe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function sN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,DNe(n.key),n)}}function xNe(e,t,r){return t&&sN(e.prototype,t),r&&sN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function DNe(e){var t=NNe(e,"string");return fd(t)==="symbol"?t:String(t)}function NNe(e,t){if(fd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(fd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var _U=function(){function e(t,r){var n=this,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:function(){return[]};MNe(this,e),this.hot=t,this.conditionCollection=r,this.columnDataFactory=o,this.changes=[],this.grouping=!1,this.latestEditedColumnPosition=-1,this.latestOrderStack=[],this.conditionCollection.addLocalHook("beforeRemove",function(i){return n._onConditionBeforeModify(i)}),this.conditionCollection.addLocalHook("afterRemove",function(i){return n.updateStatesAtColumn(i)}),this.conditionCollection.addLocalHook("afterAdd",function(i){return n.updateStatesAtColumn(i)}),this.conditionCollection.addLocalHook("beforeClean",function(){return n._onConditionBeforeClean()}),this.conditionCollection.addLocalHook("afterClean",function(){return n._onConditionAfterClean()})}return xNe(e,[{key:"groupChanges",value:function(){this.grouping=!0}},{key:"flush",value:function(){var r=this;this.grouping=!1,I(this.changes,function(n){r.updateStatesAtColumn(n)}),this.changes.length=0}},{key:"_onConditionBeforeModify",value:function(r){this.latestEditedColumnPosition=this.conditionCollection.getColumnStackPosition(r)}},{key:"updateStatesAtColumn",value:function(r,n){var o=this;if(this.grouping){this.changes.indexOf(r)===-1&&this.changes.push(r);return}var i=this.conditionCollection.exportAllConditions(),a=this.conditionCollection.getColumnStackPosition(r);a===-1&&(a=this.latestEditedColumnPosition);var l=i.slice(0,a),s=i.slice(a);s.length&&s[0].column===r&&s.shift();var u=_ie(function(c,h){var d=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[],v=new SU(o.hot,!1),y=[].concat(c,d);v.importAllConditions(y);var p=o.columnDataFactory(h),w;v.isEmpty()?w=p:w=new CU(v,function(C){return o.columnDataFactory(C)}).filter(),w=Ye(w,function(C){return C.meta.visualRow});var S=mv(w);return v.destroy(),Yr(p,function(C){return S(C.meta.visualRow)})})(l),f=[].concat(this.conditionCollection.getConditions(r));this.runLocalHooks("update",{editedConditionStack:{column:r,conditions:f},dependentConditionStacks:s,filteredRowsFactory:u,conditionArgsChange:n})}},{key:"_onConditionBeforeClean",value:function(){this.latestOrderStack=this.conditionCollection.getFilteredColumns()}},{key:"_onConditionAfterClean",value:function(){var r=this;I(this.latestOrderStack,function(n){r.updateStatesAtColumn(n)})}},{key:"destroy",value:function(){var r=this;this.clearLocalHooks(),Ke(this,function(n,o){r[o]=null})}}]),e}();dt(_U,Er);const HNe=_U;function Tu(e){"@babel/helpers - typeof";return Tu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Tu(e)}var uN;function LNe(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function jNe(e,t){return WNe(e)||VNe(e,t)||BNe(e,t)||FNe()}function FNe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function BNe(e,t){if(e){if(typeof e=="string")return fN(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return fN(e,t)}}function fN(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function VNe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function WNe(e){if(Array.isArray(e))return e}function UNe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function cN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,YNe(n.key),n)}}function zNe(e,t,r){return t&&cN(e.prototype,t),r&&cN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function YNe(e){var t=GNe(e,"string");return Tu(t)==="symbol"?t:String(t)}function GNe(e,t){if(Tu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Tu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ql(){return typeof Reflect<"u"&&Reflect.get?ql=Reflect.get.bind():ql=function(t,r,n){var o=KNe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},ql.apply(this,arguments)}function KNe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=gi(e),e!==null););return e}function qNe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&mO(e,t)}function mO(e,t){return mO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},mO(e,t)}function XNe(e){var t=QNe();return function(){var n=gi(e),o;if(t){var i=gi(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return ZNe(this,o)}}function ZNe(e,t){if(t&&(Tu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return OU(e)}function OU(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function QNe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function gi(e){return gi=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},gi(e)}var hN="filters",JNe=250,eHe=function(e){qNe(r,e);var t=XNe(r);function r(n){var o;return UNe(this,r),o=t.call(this,n),o.eventManager=new Pt(OU(o)),o.dropdownMenuPlugin=null,o.conditionCollection=null,o.conditionUpdateObserver=null,o.components=new Map([["filter_by_condition",null],["filter_operators",null],["filter_by_condition2",null],["filter_by_value",null],["filter_action_bar",null]]),o.filtersRowsMap=null,o.hot.addHook("afterGetColHeader",function(i,a){return o.onAfterGetColHeader(i,a)}),o}return zNe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[hN]}},{key:"enablePlugin",value:function(){var o=this;if(!this.enabled){this.filtersRowsMap=this.hot.rowIndexMapper.registerMap(this.pluginName,new uv),this.dropdownMenuPlugin=this.hot.getPlugin("dropdownMenu");var i=this.hot.getSettings().dropdownMenu,a=i&&i.uiContainer||this.hot.rootDocument.body,l=function(d){return d.addLocalHook("accept",function(){return o.onActionBarSubmit("accept")}),d.addLocalHook("cancel",function(){return o.onActionBarSubmit("cancel")}),d.addLocalHook("change",function(v){return o.onComponentChange(d,v)}),d},s=function(){return"".concat(o.hot.getTranslatedPhrase(yT),":")},u=function(){return"".concat(o.hot.getTranslatedPhrase(gT),":")};if(!this.components.get("filter_by_condition")){var f=new Uw(this.hot,{id:"filter_by_condition",name:s,addSeparator:!1,menuContainer:a});f.addLocalHook("afterClose",function(){return o.onSelectUIClosed()}),this.components.set("filter_by_condition",l(f))}if(this.components.get("filter_operators")||this.components.set("filter_operators",new lDe(this.hot,{id:"filter_operators",name:"Operators"})),!this.components.get("filter_by_condition2")){var c=new Uw(this.hot,{id:"filter_by_condition2",name:"",addSeparator:!0,menuContainer:a});c.addLocalHook("afterClose",function(){return o.onSelectUIClosed()}),this.components.set("filter_by_condition2",l(c))}this.components.get("filter_by_value")||this.components.set("filter_by_value",l(new sNe(this.hot,{id:"filter_by_value",name:u}))),this.components.get("filter_action_bar")||this.components.set("filter_action_bar",l(new bNe(this.hot,{id:"filter_action_bar",name:"Action bar"}))),this.conditionCollection||(this.conditionCollection=new SU(this.hot)),this.conditionUpdateObserver||(this.conditionUpdateObserver=new HNe(this.hot,this.conditionCollection,function(h){return o.getDataMapAtColumn(h)}),this.conditionUpdateObserver.addLocalHook("update",function(h){return o.updateComponents(h)})),this.components.forEach(function(h){return h.show()}),this.addHook("beforeDropdownMenuSetItems",function(h){return o.onBeforeDropdownMenuSetItems(h)}),this.addHook("afterDropdownMenuDefaultOptions",function(h){return o.onAfterDropdownMenuDefaultOptions(h)}),this.addHook("afterDropdownMenuShow",function(){return o.onAfterDropdownMenuShow()}),this.addHook("afterDropdownMenuHide",function(){return o.onAfterDropdownMenuHide()}),this.addHook("afterChange",function(h){return o.onAfterChange(h)}),this.hot.getSettings().dropdownMenu&&this.dropdownMenuPlugin&&(this.dropdownMenuPlugin.disablePlugin(),this.dropdownMenuPlugin.enablePlugin()),ql(gi(r.prototype),"enablePlugin",this).call(this)}}},{key:"disablePlugin",value:function(){var o=this;if(this.enabled){var i;(i=this.dropdownMenuPlugin)!==null&&i!==void 0&&i.enabled&&this.dropdownMenuPlugin.menu.clearLocalHooks(),this.components.forEach(function(a,l){a.destroy(),o.components.set(l,null)}),this.conditionCollection.destroy(),this.conditionCollection=null,this.hot.rowIndexMapper.unregisterMap(this.pluginName)}ql(gi(r.prototype),"disablePlugin",this).call(this)}},{key:"addCondition",value:function(o,i,a){var l=arguments.length>3&&arguments[3]!==void 0?arguments[3]:hi,s=this.hot.toPhysicalColumn(o);this.conditionCollection.addCondition(s,{command:{key:i},args:a},l)}},{key:"removeConditions",value:function(o){var i=this.hot.toPhysicalColumn(o);this.conditionCollection.removeConditions(i)}},{key:"clearConditions",value:function(o){if(o===void 0)this.conditionCollection.clean();else{var i=this.hot.toPhysicalColumn(o);this.conditionCollection.removeConditions(i)}}},{key:"filter",value:function(){var o=this,i=this._createDataFilter(),a=!this.conditionCollection.isEmpty(),l=[],s=this.conditionCollection.exportAllConditions(),u=this.hot.runHooks("beforeFilter",s);if(u!==!1)if(a){var f=[];this.hot.batchExecution(function(){o.filtersRowsMap.clear(),l=Ye(i.filter(),function(h){return h.meta.visualRow});var c=mv(l);_e(o.hot.countSourceRows()-1,function(h){c(h)||f.push(h)}),I(f,function(h){o.filtersRowsMap.setValueAtIndex(h,!0)})},!0),l.length||this.hot.deselectCell()}else this.filtersRowsMap.clear();this.hot.runHooks("afterFilter",s),this.hot.view.adjustElementsSize(!0),this.hot.render(),this.clearColumnSelection()}},{key:"getSelectedColumn",value:function(){var o,i=(o=this.hot.getSelectedRangeLast())===null||o===void 0?void 0:o.highlight;return i?{visualIndex:i.col,physicalIndex:this.hot.toPhysicalColumn(i.col)}:null}},{key:"clearColumnSelection",value:function(){var o=this.getSelectedColumn();o!==null&&this.hot.selectCell(0,o.visualIndex)}},{key:"getDataMapAtColumn",value:function(o){var i=this,a=this.hot.toVisualColumn(o),l=[];return I(this.hot.getSourceDataAtCol(a),function(s,u){var f,c=i.hot.getCellMeta(u,a),h=c.row,d=c.col,v=c.visualCol,y=c.visualRow,p=c.type,w=c.instance,S=c.dateFormat,C=c.locale,P=(f=i.hot.getDataAtCell(i.hot.toVisualRow(u),a))!==null&&f!==void 0?f:s;l.push({meta:{row:h,col:d,visualCol:v,visualRow:y,type:p,instance:w,dateFormat:S,locale:C},value:cU(P)})}),l}},{key:"onAfterChange",value:function(o){var i=this;o&&I(o,function(a){var l=jNe(a,2),s=l[1],u=i.hot.propToCol(s);i.conditionCollection.hasConditions(u)&&i.updateValueComponentCondition(u)})}},{key:"updateValueComponentCondition",value:function(o){var i=this.hot.getDataAtCol(o),a=aO(i);this.conditionUpdateObserver.updateStatesAtColumn(o,a)}},{key:"restoreComponents",value:function(o){var i,a=(i=this.getSelectedColumn())===null||i===void 0?void 0:i.physicalIndex;o.forEach(function(l){l.isHidden()||l.restoreState(a)}),this.updateDependentComponentsVisibility()}},{key:"onAfterDropdownMenuShow",value:function(){this.restoreComponents(Array.from(this.components.values()))}},{key:"onAfterDropdownMenuHide",value:function(){this.components.get("filter_by_condition").getSelectElement().closeOptions(),this.components.get("filter_by_condition2").getSelectElement().closeOptions()}},{key:"onBeforeDropdownMenuSetItems",value:function(){var o=this;this.dropdownMenuPlugin&&this.dropdownMenuPlugin.menu.addLocalHook("afterOpen",function(){o.dropdownMenuPlugin.menu.hotMenu.updateSettings({hiddenRows:!0})})}},{key:"onAfterDropdownMenuDefaultOptions",value:function(o){o.items.push({name:ze}),this.components.forEach(function(i){o.items.push(i.getMenuItemDescriptor())})}},{key:"getOperationBasedOnArguments",value:function(o,i,a,l){var s=o;return s===Om&&i.command.key!==qt&&a.command.key!==qt&&l.command.key!==qt?s=XT:l.command.key!==qt&&(i.command.key===qt||a.command.key===qt)&&(s=hi),s}},{key:"onActionBarSubmit",value:function(o){var i;if(o==="accept"){var a=this.getSelectedColumn();if(a===null){var l;(l=this.dropdownMenuPlugin)===null||l===void 0||l.close();return}var s=a.physicalIndex,u=this.components.get("filter_by_condition").getState(),f=this.components.get("filter_by_condition2").getState(),c=this.components.get("filter_by_value").getState(),h=this.getOperationBasedOnArguments(this.components.get("filter_operators").getActiveOperationId(),u,f,c);this.conditionUpdateObserver.groupChanges();var d=this.conditionCollection.getColumnStackPosition(s);d===-1&&(d=void 0),this.conditionCollection.removeConditions(s),u.command.key!==qt&&(this.conditionCollection.addCondition(s,u,h,d),f.command.key!==qt&&this.conditionCollection.addCondition(s,f,h,d)),c.command.key!==qt&&this.conditionCollection.addCondition(s,c,h,d),this.conditionUpdateObserver.flush(),this.components.forEach(function(v){return v.saveState(s)}),this.filtersRowsMap.clear(),this.filter()}(i=this.dropdownMenuPlugin)===null||i===void 0||i.close()}},{key:"onComponentChange",value:function(o,i){this.updateDependentComponentsVisibility(),o.constructor===Uw&&!i.inputsCount&&this.setListeningDropdownMenu()}},{key:"onSelectUIClosed",value:function(){this.setListeningDropdownMenu()}},{key:"setListeningDropdownMenu",value:function(){this.dropdownMenuPlugin&&this.dropdownMenuPlugin.setListening()}},{key:"updateDependentComponentsVisibility",value:function(){var o=this.components.get("filter_by_condition"),i=o.getState(),a=i.command,l=[this.components.get("filter_by_condition2"),this.components.get("filter_operators")];a.showOperators?this.showComponents.apply(this,l):this.hideComponents.apply(this,l)}},{key:"onAfterGetColHeader",value:function(o,i){var a=this.hot.toPhysicalColumn(o);this.enabled&&this.conditionCollection.hasConditions(a)?re(i,"htFiltersActive"):He(i,"htFiltersActive")}},{key:"_createDataFilter",value:function(){var o=this,i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.conditionCollection;return new CU(i,function(a){return o.getDataMapAtColumn(a)})}},{key:"updateComponents",value:function(o){var i;if((i=this.dropdownMenuPlugin)!==null&&i!==void 0&&i.enabled){var a=o.editedConditionStack,l=a.conditions,s=a.column,u=l.filter(function(h){return h.name===ua}),f=l.filter(function(h){return h.name!==ua});if(u.length>=2||f.length>=3)yt(ft(uN||(uN=LNe([`The filter conditions have been applied properly, but couldnât be displayed visually. 
        The overall amount of conditions exceed the capability of the dropdown menu. 
        For more details see the documentation.`],[`The filter conditions have been applied properly, but couldnât be displayed visually.\\x20
        The overall amount of conditions exceed the capability of the dropdown menu.\\x20
        For more details see the documentation.`]))));else{var c=this.conditionCollection.getOperation(s);this.components.get("filter_by_condition").updateState(f[0],s),this.components.get("filter_by_condition2").updateState(f[1],s),this.components.get("filter_operators").updateState(c,s),this.components.get("filter_by_value").updateState(o)}}}},{key:"getIndexesOfComponents",value:function(){var o=[];if(!this.dropdownMenuPlugin)return o;for(var i=this.dropdownMenuPlugin.menu,a=arguments.length,l=new Array(a),s=0;s<a;s++)l[s]=arguments[s];return I(l,function(u){I(i.menuItems,function(f,c){f.key===u.getMenuItemDescriptor().key&&o.push(c)})}),o}},{key:"changeComponentsVisibility",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(this.dropdownMenuPlugin){for(var i=this.dropdownMenuPlugin.menu,a=i.hotMenu,l=a.getPlugin("hiddenRows"),s=arguments.length,u=new Array(s>1?s-1:0),f=1;f<s;f++)u[f-1]=arguments[f];var c=this.getIndexesOfComponents.apply(this,u);o?l.showRows(c):l.hideRows(c),a.render()}}},{key:"hideComponents",value:function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];this.changeComponentsVisibility.apply(this,[!1].concat(i))}},{key:"showComponents",value:function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];this.changeComponentsVisibility.apply(this,[!0].concat(i))}},{key:"destroy",value:function(){var o=this;this.enabled&&(this.components.forEach(function(i,a){i!==null&&(i.destroy(),o.components.set(a,null))}),this.conditionCollection.destroy(),this.conditionUpdateObserver.destroy(),this.hot.rowIndexMapper.unregisterMap(this.pluginName)),ql(gi(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return hN}},{key:"PLUGIN_PRIORITY",get:function(){return JNe}},{key:"PLUGIN_DEPS",get:function(){return["plugin:DropdownMenu","plugin:HiddenRows","cell-type:checkbox"]}}]),r}(it);function cd(e){"@babel/helpers - typeof";return cd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},cd(e)}function dN(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function wc(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?dN(Object(r),!0).forEach(function(n){tHe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):dN(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function tHe(e,t,r){return t=rHe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function rHe(e){var t=nHe(e,"string");return cd(t)==="symbol"?t:String(t)}function nHe(e,t){if(cd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(cd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var RU="internal-use-in-handsontable",pO={licenseKey:RU,useArrayArithmetic:!0,useColumnIndex:!1,useStats:!1,evaluateNullToZero:!0,precisionEpsilon:1e-13,precisionRounding:14,smartRounding:!0,leapYear1900:!1,nullDate:{year:1899,month:12,day:30},nullYear:30,dateFormats:["DD/MM/YYYY","DD/MM/YY"],timeFormats:["hh:mm","hh:mm:ss.sss"],matchWholeCell:!0,useRegularExpressions:!1,useWildcards:!0,functionArgSeparator:",",thousandSeparator:"",decimalSeparator:".",language:"enGB"};function EU(e){var t,r;return{maxColumns:e.maxColumns,maxRows:e.maxRows,language:(t=e[er])===null||t===void 0||(r=t.language)===null||r===void 0?void 0:r.langCode}}function TU(e){return Object.keys(e).reduce(function(t,r){return r!=="hyperformula"&&(t[r]=e[r]),t},{})}function oHe(e){var t,r=e[er],n=TU(r!=null&&(t=r.engine)!==null&&t!==void 0&&t.hyperformula?r.engine:{}),o=EU(e);return wc(wc(wc({},pO),n),o)}function iHe(e){var t,r=e[er],n=TU(r!=null&&(t=r.engine)!==null&&t!==void 0&&t.hyperformula?r.engine:{}),o=EU(e);return wc(wc({},n),o)}function aHe(e,t){return Object.keys(t).some(function(r){return t[r]!==void 0&&t[r]!==e[r]})}var vN;function lHe(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function bO(e){"@babel/helpers - typeof";return bO=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},bO(e)}function Hp(){var e="engine_relationship",t=Qr(er);return t.hasItem(e)||t.register(e,new Map),t.getItem(e)}function ZT(){var e="shared_engine_usage",t=Qr(er);return t.hasItem(e)||t.register(e,new Map),t.getItem(e)}function sHe(e){var t=e.getSettings(),r=t[er],n=r==null?void 0:r.engine;if(r===!0||gt(n))return null;if(typeof n.hyperformula=="function"||typeof n=="function"){var o;return uHe((o=n.hyperformula)!==null&&o!==void 0?o:n,t,e)}else if(bO(n)==="object"&&gt(n.hyperformula)){var i=Hp(),a=ZT().get(n);return i.has(n)||i.set(n,[]),i.get(n).push(e),a&&a.push(e.guid),n.getConfig().licenseKey||n.updateConfig({licenseKey:RU}),(n.getConfig().leapYear1900!==pO.leapYear1900||cE(n.getConfig().nullDate,pO.nullDate)===!1)&&yt(ft(vN||(vN=lHe(["If you use HyperFormula with Handsontable, keep the default `leapYear1900` and `nullDate` \n      settings. Otherwise, HyperFormula's dates may not sync correctly with Handsontable's dates."],["If you use HyperFormula with Handsontable, keep the default \\`leapYear1900\\` and \\`nullDate\\` \n      settings. Otherwise, HyperFormula's dates may not sync correctly with Handsontable's dates."])))),n}return null}function uHe(e,t,r){var n=t[er],o=oHe(t),i=Hp(),a=ZT();fHe(e,n.functions),cHe(e,n.language);var l=e.buildEmpty(o);return i.set(l,[r]),a.set(l,[r.guid]),hHe(l,n.namedExpressions),l.on("sheetAdded",function(){l.rebuildAndRecalculate()}),l.on("sheetRemoved",function(){l.rebuildAndRecalculate()}),l}function yN(e){var t,r=Hp(),n=r.size===0?[]:Array.from((t=r.get(e))!==null&&t!==void 0?t:[]);return new Map(n.map(function(o){return[o.getPlugin("formulas").sheetId,o]}))}function gN(e,t){if(e){var r=Hp(),n=r.get(e),o=ZT(),i=o.get(e);n&&n.includes(t)&&(n.splice(n.indexOf(t),1),n.length===0&&r.delete(e)),i&&i.includes(t.guid)&&(i.splice(i.indexOf(t.guid),1),i.length===0&&(o.delete(e),e.destroy()))}}function fHe(e,t){t&&t.forEach(function(r){var n=r.name,o=r.plugin,i=r.translations;try{e.registerFunction(n,o,i)}catch(a){yt(a.message)}})}function cHe(e,t){if(t){var r=t.langCode;try{e.registerLanguage(r,t)}catch(n){yt(n.message)}}}function hHe(e,t){t&&(e.suspendEvaluation(),t.forEach(function(r){var n=r.name,o=r.expression,i=r.scope,a=r.options;try{e.addNamedExpression(n,o,i,a)}catch(l){yt(l.message)}}),e.resumeEvaluation())}function dHe(e,t){return(gt(t)||!e.doesSheetExist(t))&&(t=e.addSheet(t)),t}var kU="DD/MM/YYYY";function PU(e){return typeof e=="string"&&e.charAt(0)==="'"&&e.charAt(1)==="="}function vHe(e){return PU(e)?e.substr(1):e}function yHe(e){return typeof e=="string"&&e.startsWith("=")}function Yw(e,t){return typeof e=="string"&&t==="date"}function mN(e,t){return ee(e,t,!0).isValid()}function pN(e,t){return ee(e,t,!0).format(kU)}function gHe(e,t){return ee(e,kU,!0).format(t)}function bN(e,t){var r=-1,n=new Date(Date.UTC(0,0,e+r));return ee(n).format(t)}function hd(e){"@babel/helpers - typeof";return hd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},hd(e)}function mHe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function wN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,bHe(n.key),n)}}function pHe(e,t,r){return t&&wN(e.prototype,t),r&&wN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function bHe(e){var t=wHe(e,"string");return hd(t)==="symbol"?t:String(t)}function wHe(e,t){if(hd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(hd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Fi(e,t,r){SHe(e,t),t.set(e,r)}function SHe(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function bt(e,t){var r=$U(e,t,"get");return CHe(e,r)}function CHe(e,t){return t.get?t.get.call(e):t.value}function Go(e,t,r){var n=$U(e,t,"set");return _He(e,n,r),r}function $U(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function _He(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}var zf=new WeakMap,Ko=new WeakMap,Pr=new WeakMap,yy=new WeakMap,Gw=new WeakMap,Kw=new WeakMap,gy=new WeakMap,OHe=function(){function e(t,r,n){mHe(this,e),Fi(this,zf,{writable:!0,value:void 0}),Fi(this,Ko,{writable:!0,value:void 0}),Fi(this,Pr,{writable:!0,value:void 0}),Fi(this,yy,{writable:!0,value:[]}),Fi(this,Gw,{writable:!0,value:[]}),Fi(this,Kw,{writable:!0,value:void 0}),Fi(this,gy,{writable:!0,value:[]}),Go(this,zf,t),Go(this,Ko,r),Go(this,Pr,n)}return pHe(e,[{key:"setRemovedHfIndexes",value:function(r){var n=this;return Go(this,gy,r.map(function(o){var i=bt(n,Ko).getVisualFromPhysicalIndex(o);return n.getHfIndexFromVisualIndex(i)})),bt(this,gy)}},{key:"getRemovedHfIndexes",value:function(){return bt(this,gy)}},{key:"getHfIndexFromVisualIndex",value:function(r){var n=bt(this,Ko).getIndexesSequence(),o=bt(this,Ko).getNotTrimmedIndexes();return n.indexOf(o[r])}},{key:"syncMoves",value:function(r){var n=this,o=1,i="move".concat(un(bt(this,zf)),"s");bt(this,Pr).getEngine().batch(function(){r.forEach(function(a){var l=a.from!==a.to,s=a.from+1!==a.to;l&&s&&bt(n,Pr).getEngine()[i](bt(n,Pr).getSheetId(),a.from,o,a.to)})})}},{key:"storeMovesInformation",value:function(r,n,o){var i=this;o!==!1&&(Go(this,Gw,r.map(function(a){return i.getHfIndexFromVisualIndex(a)})),Go(this,Kw,this.getHfIndexFromVisualIndex(n)))}},{key:"getMoveLine",value:function(r,n){var o=bt(this,Ko).getNumberOfIndexes(),i=Array.from(Array(o).keys()).filter(function(l){return r.includes(l)===!1});if(n===0){var a;return(a=i[n])!==null&&a!==void 0?a:0}return i[n-1]+1}},{key:"getInitiallyCalculatedMoves",value:function(r,n){var o=this.getMoveLine(r,n),i=[];return r.forEach(function(a){var l={from:a,to:o};i.forEach(function(s){var u=s.from>s.to,f=s.to<=l.from,c=s.from>l.from;c&&f&&u&&(l.from+=1)}),l.from>=o&&(o+=1),i.push(l)}),i}},{key:"adjustedCalculatedMoves",value:function(r){return r.forEach(function(n,o){var i=r.slice(o+1);i.forEach(function(a){var l=a.from<a.to;a.from>n.from&&l&&(a.from-=1)})}),r}},{key:"calculateAndSyncMoves",value:function(r,n){var o=this;if(!bt(this,Pr).isPerformingUndoRedo()&&!(r===!1||n===!1)){var i=this.adjustedCalculatedMoves(this.getInitiallyCalculatedMoves(bt(this,Gw),bt(this,Kw)));bt(this,Pr).getSheetId()===null?bt(this,Pr).getPostponeAction(function(){return o.syncMoves(i)}):this.syncMoves(i)}}},{key:"getIndexesChangeSyncMethod",value:function(){var r=this,n="set".concat(un(bt(this,zf)),"Order");return function(o){if(!bt(r,Pr).isPerformingUndoRedo()){var i=bt(r,Ko).getIndexesSequence();if(o==="update"){var a=bt(r,yy).map(function(c){return i.indexOf(c)}),l=bt(r,Pr).getEngine().getSheetDimensions(bt(r,Pr).getSheetId()),s;bt(r,zf)==="row"?s=l.height:s=l.width;for(var u=a.length,f=u;f<s;f+=1)a.push(f);bt(r,Pr).getEngine()[n](bt(r,Pr).getSheetId(),a)}Go(r,yy,i)}}}},{key:"init",value:function(){Go(this,yy,bt(this,Ko).getIndexesSequence())}}]),e}();const SN=OHe;function dd(e){"@babel/helpers - typeof";return dd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},dd(e)}function RHe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function CN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,THe(n.key),n)}}function EHe(e,t,r){return t&&CN(e.prototype,t),r&&CN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function THe(e){var t=kHe(e,"string");return dd(t)==="symbol"?t:String(t)}function kHe(e,t){if(dd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(dd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Bi(e,t,r){PHe(e,t),t.set(e,r)}function PHe(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Yn(e,t){var r=AU(e,t,"get");return $He(e,r)}function $He(e,t){return t.get?t.get.call(e):t.value}function Vi(e,t,r){var n=AU(e,t,"set");return AHe(e,n,r),r}function AU(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function AHe(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}var my=new WeakMap,py=new WeakMap,qw=new WeakMap,Xw=new WeakMap,Zw=new WeakMap,Qw=new WeakMap,Jw=new WeakMap,IHe=function(){function e(t,r,n){RHe(this,e),Bi(this,my,{writable:!0,value:void 0}),Bi(this,py,{writable:!0,value:void 0}),Bi(this,qw,{writable:!0,value:void 0}),Bi(this,Xw,{writable:!0,value:!1}),Bi(this,Zw,{writable:!0,value:!1}),Bi(this,Qw,{writable:!0,value:null}),Bi(this,Jw,{writable:!0,value:null}),Vi(this,my,new SN("row",t,this)),Vi(this,py,new SN("column",r,this)),Vi(this,qw,n)}return EHe(e,[{key:"getForAxis",value:function(r){return r==="row"?Yn(this,my):Yn(this,py)}},{key:"setPerformUndo",value:function(r){Vi(this,Xw,r)}},{key:"setPerformRedo",value:function(r){Vi(this,Zw,r)}},{key:"isPerformingUndoRedo",value:function(){return Yn(this,Xw)||Yn(this,Zw)}},{key:"getSheetId",value:function(){return Yn(this,Jw)}},{key:"getEngine",value:function(){return Yn(this,Qw)}},{key:"getPostponeAction",value:function(){return Yn(this,qw)}},{key:"setupSyncEndpoint",value:function(r,n){Vi(this,Qw,r),Vi(this,Jw,n),Yn(this,my).init(),Yn(this,py).init()}}]),e}();const MHe=IHe;function xHe(e){return HHe(e)||NHe(e)||IU(e)||DHe()}function DHe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function NHe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function HHe(e){if(Array.isArray(e))return wO(e)}function Si(e){"@babel/helpers - typeof";return Si=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Si(e)}function Sl(e,t){return FHe(e)||jHe(e,t)||IU(e,t)||LHe()}function LHe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function IU(e,t){if(e){if(typeof e=="string")return wO(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return wO(e,t)}}function wO(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function jHe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function FHe(e){if(Array.isArray(e))return e}function BHe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _N(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,MU(n.key),n)}}function VHe(e,t,r){return t&&_N(e.prototype,t),r&&_N(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function fa(){return typeof Reflect<"u"&&Reflect.get?fa=Reflect.get.bind():fa=function(t,r,n){var o=WHe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},fa.apply(this,arguments)}function WHe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=po(e),e!==null););return e}function UHe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&SO(e,t)}function SO(e,t){return SO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},SO(e,t)}function zHe(e){var t=GHe();return function(){var n=po(e),o;if(t){var i=po(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return YHe(this,o)}}function YHe(e,t){if(t&&(Si(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return En(e)}function En(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function GHe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function po(e){return po=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},po(e)}function Cl(e,t,r){return t=MU(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function MU(e){var t=KHe(e,"string");return Si(t)==="symbol"?t:String(t)}function KHe(e,t){if(Si(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Si(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function eS(e,t,r){qHe(e,t),t.set(e,r)}function qHe(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function qo(e,t,r){var n=xU(e,t,"set");return XHe(e,n,r),r}function XHe(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}function _l(e,t){var r=xU(e,t,"get");return ZHe(e,r)}function xU(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function ZHe(e,t){return t.get?t.get.call(e):t.value}var er="formulas",QHe=["maxRows","maxColumns","language"],JHe=260;ge.getSingleton().register("afterNamedExpressionAdded");ge.getSingleton().register("afterNamedExpressionRemoved");ge.getSingleton().register("afterSheetAdded");ge.getSingleton().register("afterSheetRemoved");ge.getSingleton().register("afterSheetRenamed");ge.getSingleton().register("afterFormulasValuesUpdate");var Ol=function(t){return t==="UndoRedo.undo"||t==="UndoRedo.redo"||t==="auto"},Gn=new WeakMap,tS=new WeakMap,Yf=new WeakMap,eLe=function(e){UHe(r,e);var t=zHe(r);function r(){var n;BHe(this,r);for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return n=t.call.apply(t,[this].concat(i)),eS(En(n),Gn,{writable:!0,value:!1}),eS(En(n),tS,{writable:!0,value:!1}),eS(En(n),Yf,{writable:!0,value:[["valuesUpdated",function(){var l;return(l=n).onEngineValuesUpdated.apply(l,arguments)}],["namedExpressionAdded",function(){var l;return(l=n).onEngineNamedExpressionsAdded.apply(l,arguments)}],["namedExpressionRemoved",function(){var l;return(l=n).onEngineNamedExpressionsRemoved.apply(l,arguments)}],["sheetAdded",function(){var l;return(l=n).onEngineSheetAdded.apply(l,arguments)}],["sheetRenamed",function(){var l;return(l=n).onEngineSheetRenamed.apply(l,arguments)}],["sheetRemoved",function(){var l;return(l=n).onEngineSheetRemoved.apply(l,arguments)}]]}),Cl(En(n),"staticRegister",Qr("formulas")),Cl(En(n),"engine",null),Cl(En(n),"sheetName",null),Cl(En(n),"indexSyncer",null),Cl(En(n),"rowAxisSyncer",null),Cl(En(n),"columnAxisSyncer",null),n}return VHe(r,[{key:"sheetId",get:function(){return this.sheetName===null?null:this.engine.getSheetId(this.sheetName)}},{key:"isEnabled",value:function(){return!!this.hot.getSettings()[er]}},{key:"enablePlugin",value:function(){var o,i=this;if(!this.enabled){if(this.engine=(o=sHe(this.hot))!==null&&o!==void 0?o:this.engine,!this.engine){yt("Missing the required `engine` key in the Formulas settings. Please fill it with either an engine class or an engine instance.");return}if(this.sheetName!==null&&!this.engine.doesSheetExist(this.sheetName)){var a=this.addSheet(this.sheetName,this.hot.getSourceDataArray());a!==!1&&(this.sheetName=a)}this.addHook("beforeLoadData",function(){return i.onBeforeLoadData.apply(i,arguments)}),this.addHook("afterLoadData",function(){return i.onAfterLoadData.apply(i,arguments)}),this.addHook("beforeUpdateData",function(){return i.onBeforeLoadData.apply(i,arguments)}),this.addHook("afterUpdateData",function(){return i.onAfterLoadData.apply(i,arguments)}),this.addHook("modifyData",function(){return i.onModifyData.apply(i,arguments)}),this.addHook("modifySourceData",function(){return i.onModifySourceData.apply(i,arguments)}),this.addHook("beforeValidate",function(){return i.onBeforeValidate.apply(i,arguments)}),this.addHook("afterSetSourceDataAtCell",function(){return i.onAfterSetSourceDataAtCell.apply(i,arguments)}),this.addHook("afterSetDataAtCell",function(){return i.onAfterSetDataAtCell.apply(i,arguments)}),this.addHook("afterSetDataAtRowProp",function(){return i.onAfterSetDataAtCell.apply(i,arguments)}),this.addHook("beforeCreateRow",function(){return i.onBeforeCreateRow.apply(i,arguments)}),this.addHook("beforeCreateCol",function(){return i.onBeforeCreateCol.apply(i,arguments)}),this.addHook("afterCreateRow",function(){return i.onAfterCreateRow.apply(i,arguments)}),this.addHook("afterCreateCol",function(){return i.onAfterCreateCol.apply(i,arguments)}),this.addHook("beforeRemoveRow",function(){return i.onBeforeRemoveRow.apply(i,arguments)}),this.addHook("beforeRemoveCol",function(){return i.onBeforeRemoveCol.apply(i,arguments)}),this.addHook("afterRemoveRow",function(){return i.onAfterRemoveRow.apply(i,arguments)}),this.addHook("afterRemoveCol",function(){return i.onAfterRemoveCol.apply(i,arguments)}),this.indexSyncer=new MHe(this.hot.rowIndexMapper,this.hot.columnIndexMapper,function(l){i.hot.addHookOnce("init",function(){l()})}),this.rowAxisSyncer=this.indexSyncer.getForAxis("row"),this.columnAxisSyncer=this.indexSyncer.getForAxis("column"),this.hot.addHook("afterRowSequenceChange",this.rowAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("afterColumnSequenceChange",this.columnAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("beforeRowMove",function(l,s,u,f){i.rowAxisSyncer.storeMovesInformation(l,s,f)}),this.hot.addHook("beforeColumnMove",function(l,s,u,f){i.columnAxisSyncer.storeMovesInformation(l,s,f)}),this.hot.addHook("afterRowMove",function(l,s,u,f,c){i.rowAxisSyncer.calculateAndSyncMoves(f,c)}),this.hot.addHook("afterColumnMove",function(l,s,u,f,c){i.columnAxisSyncer.calculateAndSyncMoves(f,c)}),this.hot.addHook("beforeColumnFreeze",function(l,s){i.columnAxisSyncer.storeMovesInformation([l],i.hot.getSettings().fixedColumnsStart,s)}),this.hot.addHook("afterColumnFreeze",function(l,s){i.columnAxisSyncer.calculateAndSyncMoves(s,s)}),this.hot.addHook("beforeColumnUnfreeze",function(l,s){i.columnAxisSyncer.storeMovesInformation([l],i.hot.getSettings().fixedColumnsStart-1,s)}),this.hot.addHook("afterColumnUnfreeze",function(l,s){i.columnAxisSyncer.calculateAndSyncMoves(s,s)}),this.addHook("afterCellMetaReset",function(){return i.onAfterCellMetaReset.apply(i,arguments)}),this.addHook("beforeUndo",function(){i.indexSyncer.setPerformUndo(!0),i.engine.undo()}),this.addHook("beforeRedo",function(){i.indexSyncer.setPerformRedo(!0),i.engine.redo()}),this.addHook("afterUndo",function(){i.indexSyncer.setPerformUndo(!1)}),this.addHook("afterUndo",function(){i.indexSyncer.setPerformRedo(!1)}),this.addHook("afterDetachChild",function(){return i.onAfterDetachChild.apply(i,arguments)}),this.addHook("beforeAutofill",function(){return i.onBeforeAutofill.apply(i,arguments)}),_l(this,Yf).forEach(function(l){var s=Sl(l,2),u=s[0],f=s[1];return i.engine.on(u,f)}),fa(po(r.prototype),"enablePlugin",this).call(this)}}},{key:"disablePlugin",value:function(){var o=this;_l(this,Yf).forEach(function(i){var a=Sl(i,2),l=a[0],s=a[1];return o.engine.off(l,s)}),gN(this.engine,this.hot),this.engine=null,fa(po(r.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(o){var i=iHe(this.hot.getSettings());aHe(this.engine.getConfig(),i)&&this.engine.updateConfig(i);var a=this.hot.getSettings()[er];if(ye(a)&&ye(a.sheetName)&&a.sheetName!==this.sheetName&&this.switchSheet(a.sheetName),!o.data&&this.sheetName===null){var l=this.hot.getSettings()[er].sheetName;l&&this.engine.doesSheetExist(l)?this.switchSheet(this.sheetName):this.sheetName=this.addSheet(l??void 0,this.hot.getSourceDataArray())}fa(po(r.prototype),"updatePlugin",this).call(this,o)}},{key:"destroy",value:function(){var o=this;_l(this,Yf).forEach(function(i){var a,l=Sl(i,2),s=l[0],u=l[1];return(a=o.engine)===null||a===void 0?void 0:a.off(s,u)}),qo(this,Yf,null),gN(this.engine,this.hot),this.engine=null,fa(po(r.prototype),"destroy",this).call(this)}},{key:"addSheet",value:function(o,i){if(ye(i)&&!bye(i))return yt("The provided data should be an array of arrays."),!1;if(o!=null&&this.engine.doesSheetExist(o))return yt("Sheet with the provided name already exists."),!1;try{var a=this.engine.addSheet(o??void 0);return i&&this.engine.setSheetContent(this.engine.getSheetId(a),i),a}catch(l){return yt(l.message),!1}}},{key:"switchSheet",value:function(o){if(!this.engine.doesSheetExist(o)){LE("The sheet named `".concat(o,"` does not exist, switch aborted."));return}this.sheetName=o;var i=this.engine.getSheetSerialized(this.sheetId);i.length>0&&this.hot.loadData(i,"".concat(un(er),".switchSheet"))}},{key:"getCellType",value:function(o,i){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.sheetId,l=this.hot.toPhysicalRow(o),s=this.hot.toPhysicalColumn(i);return l!==null&&s!==null?this.engine.getCellType({sheet:a,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(o),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(i)}):"EMPTY"}},{key:"isFormulaCellType",value:function(o,i){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.sheetId;return this.engine.doesCellHaveFormula({sheet:a,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(o),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(i)})}},{key:"renderDependentSheets",value:function(o){var i=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,l=new Set;o.forEach(function(s){var u,f=s==null||(u=s.address)===null||u===void 0?void 0:u.sheet;f!==void 0&&(l.has(f)||l.add(f))}),yN(this.engine).forEach(function(s,u){if((a||u!==i.sheetId)&&l.has(u)){var f;s.render(),(f=s.view)===null||f===void 0||f.adjustElementsSize()}})}},{key:"validateDependentCells",value:function(o){var i=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],l=function(f){var c,h=(c=f==null?void 0:f.address)!==null&&c!==void 0?c:{},d=h.row,v=h.col,y=h.sheet;return ye(y)?"".concat(y,":").concat(d,"x").concat(v):""},s=new Set(a.map(function(u){return l(u)}));o.forEach(function(u){var f,c,h=(f=u.address)!==null&&f!==void 0?f:{},d=h.row,v=h.col;if(!(ye(d)===!1||ye(v)===!1||d>=i.hot.countRows()||v>=i.hot.countCols())){var y=u==null||(c=u.address)===null||c===void 0?void 0:c.sheet,p=l(u);if(y!==void 0&&!s.has(p)){var w=yN(i.engine).get(y);if(!w)return;w.validateCell(w.getDataAtCell(d,v),w.getCellMeta(d,v),function(){})}}})}},{key:"syncChangeWithEngine",value:function(o,i,a){var l={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(o),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(i),sheet:this.sheetId};if(!this.engine.isItPossibleToSetCellContents(l)){yt("Not possible to set cell data at ".concat(JSON.stringify(l)));return}var s=this.hot.getCellMeta(o,i);return Yw(a,s.type)&&(mN(a,s.dateFormat)?a=pN(a,s.dateFormat):yHe(a)===!1&&(a="'".concat(a))),this.engine.setCellContents(l,a)}},{key:"onBeforeValidate",value:function(o,i,a){var l=this.hot.propToCol(a);if(this.isFormulaCellType(i,l)){var s={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(i),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(l),sheet:this.sheetId},u=this.hot.getCellMeta(i,l),f=this.engine.getCellValue(s);return u.type==="date"&&Cr(f)&&(f=bN(f,u.dateFormat)),Si(f)==="object"&&f!==null?f.value:f}return o}},{key:"onBeforeAutofill",value:function(o,i,a){var l=i.getTopStartCorner(),s=l.row,u=l.col,f=i.getBottomEndCorner(),c=f.row,h=f.col,d=a.getTopStartCorner(),v=d.row,y=d.col,p=a.getBottomEndCorner(),w=p.row,S=p.col,C={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(s),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(u),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(c),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(h),sheet:this.sheetId}},P={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(v),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(y),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(w),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(S),sheet:this.sheetId}};if(this.engine.isItPossibleToSetCellContents(P)===!1)return!1;for(var R=this.engine.getFillRangeData(C,P),W=C.start,Y=W.row,q=W.col,G=C.end,X=G.row,Q=G.col,oe=X-Y+1,J=Q-q+1,ue=0;ue<R.length;ue+=1)for(var de=0;de<R[ue].length;de+=1){var Oe=R[ue][de],be=ue%oe,$=de%J,k=this.hot.getCellMeta(be,$);Yw(Oe,k.type)&&(Oe.startsWith("'")?R[ue][de]=Oe.slice(1):this.isFormulaCellType(be,$,this.sheetId)===!1&&(R[ue][de]=gHe(Oe,k.dateFormat)))}return R}},{key:"onBeforeLoadData",value:function(o,i){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"";a.includes(un(er))||qo(this,tS,gt(this.hot.getSettings().data))}},{key:"onAfterCellMetaReset",value:function(){var o=this,i=this.hot.getSourceDataArray(),a=!1;i.forEach(function(l,s){l.forEach(function(u,f){var c=o.hot.getCellMeta(s,f),h=c.dateFormat;Yw(u,c.type)&&(a=!0,mN(u,h)?i[s][f]=pN(u,h):o.isFormulaCellType(s,f)===!1&&(i[s][f]="'".concat(u)))})}),a===!0&&(qo(this,Gn,!0),this.engine.setSheetContent(this.sheetId,i),qo(this,Gn,!1))}},{key:"onAfterLoadData",value:function(o,i){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"";if(!a.includes(un(er)))if(this.sheetName=dHe(this.engine,this.hot.getSettings()[er].sheetName),_l(this,tS))this.switchSheet(this.sheetName);else{var l=this.hot.getSourceDataArray();if(this.engine.isItPossibleToReplaceSheetContent(this.sheetId,l)){qo(this,Gn,!0);var s=this.engine.setSheetContent(this.sheetId,l);this.indexSyncer.setupSyncEndpoint(this.engine,this.sheetId),this.renderDependentSheets(s),qo(this,Gn,!1)}}}},{key:"onModifyData",value:function(o,i,a,l){if(!(l!=="get"||_l(this,Gn)||this.sheetName===null||!this.engine.doesSheetExist(this.sheetName))){var s=this.hot.toVisualRow(o);if(!(s===null||i===null)){var u=this.isFormulaCellType(s,i);if(!u){var f=this.getCellType(s,i);if(f!=="ARRAY"){PU(a.value)&&(a.value=vHe(a.value));return}}var c={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(s),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(i),sheet:this.sheetId},h=this.engine.getCellValue(c),d=this.hot.getCellMeta(s,i);d.type==="date"&&Cr(h)&&(h=bN(h,d.dateFormat));var v=Si(h)==="object"&&h!==null?h.value:h;a.value=v}}}},{key:"onModifySourceData",value:function(o,i,a,l){if(!(l!=="get"||_l(this,Gn)||this.sheetName===null||!this.engine.doesSheetExist(this.sheetName))){var s=this.hot.toVisualRow(o),u=this.hot.propToCol(i);if(!(s===null||u===null)){var f=this.isFormulaCellType(s,u);if(!f){var c=this.getCellType(s,u);if(c!=="ARRAY")return}var h=this.engine.getSheetDimensions(this.engine.getSheetId(this.sheetName));if(!(h.width===0&&h.height===0)){var d={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(s),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(u),sheet:this.sheetId};a.value=this.engine.getCellSerialized(d)}}}}},{key:"onAfterSetDataAtCell",value:function(o,i){var a=this;if(!Ol(i)){var l=[],s=[],u=this.engine.batch(function(){o.forEach(function(f){var c=Sl(f,4),h=c[0],d=c[1],v=c[3],y=a.hot.propToCol(d),p=a.hot.toPhysicalRow(h),w=a.hot.toPhysicalColumn(y),S={row:a.rowAxisSyncer.getHfIndexFromVisualIndex(h),col:a.columnAxisSyncer.getHfIndexFromVisualIndex(y),sheet:a.sheetId};p!==null&&w!==null?a.syncChangeWithEngine(h,y,v):l.push([h,y,v]),s.push({address:S})})});l.length&&this.hot.addHookOnce("afterChange",function(){var f=a.engine.batch(function(){l.forEach(function(c){var h=Sl(c,3),d=h[0],v=h[1],y=h[2];a.syncChangeWithEngine(d,v,y)})});a.renderDependentSheets(f,!0)}),this.renderDependentSheets(u),this.validateDependentCells(u,s)}}},{key:"onAfterSetSourceDataAtCell",value:function(o,i){var a=this;if(!Ol(i)){var l=[],s=[];o.forEach(function(u){var f=Sl(u,4),c=f[0],h=f[1],d=f[3],v=a.hot.propToCol(h);if(Cr(v)){var y={row:a.rowAxisSyncer.getHfIndexFromVisualIndex(c),col:a.columnAxisSyncer.getHfIndexFromVisualIndex(v),sheet:a.sheetId};if(!a.engine.isItPossibleToSetCellContents(y)){yt("Not possible to set source cell data at ".concat(JSON.stringify(y)));return}s.push({address:y}),l.push.apply(l,xHe(a.engine.setCellContents(y,d)))}}),this.renderDependentSheets(l),this.validateDependentCells(l,s)}}},{key:"onBeforeCreateRow",value:function(o,i){var a=this.rowAxisSyncer.getHfIndexFromVisualIndex(o);if(o>=this.hot.countRows()&&(a=o),this.sheetId===null||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddRows(this.sheetId,[a,i]))return!1}},{key:"onBeforeCreateCol",value:function(o,i){var a=this.columnAxisSyncer.getHfIndexFromVisualIndex(o);if(o>=this.hot.countCols()&&(a=o),this.sheetId===null||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddColumns(this.sheetId,[a,i]))return!1}},{key:"onBeforeRemoveRow",value:function(o,i,a){var l=this,s=this.rowAxisSyncer.setRemovedHfIndexes(a),u=s.every(function(f){return l.engine.isItPossibleToRemoveRows(l.sheetId,[f,1])});return u===!1?!1:void 0}},{key:"onBeforeRemoveCol",value:function(o,i,a){var l=this,s=this.columnAxisSyncer.setRemovedHfIndexes(a),u=s.every(function(f){return l.engine.isItPossibleToRemoveColumns(l.sheetId,[f,1])});return u===!1?!1:void 0}},{key:"onAfterCreateRow",value:function(o,i,a){if(!Ol(a)){var l=this.engine.addRows(this.sheetId,[this.rowAxisSyncer.getHfIndexFromVisualIndex(o),i]);this.renderDependentSheets(l)}}},{key:"onAfterCreateCol",value:function(o,i,a){if(!Ol(a)){var l=this.engine.addColumns(this.sheetId,[this.columnAxisSyncer.getHfIndexFromVisualIndex(o),i]);this.renderDependentSheets(l)}}},{key:"onAfterRemoveRow",value:function(o,i,a,l){var s=this;if(!Ol(l)){var u=this.rowAxisSyncer.getRemovedHfIndexes().sort().reverse(),f=this.engine.batch(function(){u.forEach(function(c){s.engine.removeRows(s.sheetId,[c,1])})});this.renderDependentSheets(f)}}},{key:"onAfterRemoveCol",value:function(o,i,a,l){var s=this;if(!Ol(l)){var u=this.columnAxisSyncer.getRemovedHfIndexes().sort().reverse(),f=this.engine.batch(function(){u.forEach(function(c){s.engine.removeColumns(s.sheetId,[c,1])})});this.renderDependentSheets(f)}}},{key:"onAfterDetachChild",value:function(o,i,a){var l,s=this;qo(this,Gn,!0);var u=this.hot.getSourceDataArray(a,0,a+(((l=i.__children)===null||l===void 0?void 0:l.length)||0),this.hot.countSourceCols());qo(this,Gn,!1),u.forEach(function(f,c){f.forEach(function(h,d){s.engine.setCellContents({col:d,row:a+c,sheet:s.sheetId},[[h]])})})}},{key:"onEngineValuesUpdated",value:function(o){this.hot.runHooks("afterFormulasValuesUpdate",o)}},{key:"onEngineNamedExpressionsAdded",value:function(o,i){this.hot.runHooks("afterNamedExpressionAdded",o,i)}},{key:"onEngineNamedExpressionsRemoved",value:function(o,i){this.hot.runHooks("afterNamedExpressionRemoved",o,i)}},{key:"onEngineSheetAdded",value:function(o){this.hot.runHooks("afterSheetAdded",o)}},{key:"onEngineSheetRenamed",value:function(o,i){this.hot.runHooks("afterSheetRenamed",o,i)}},{key:"onEngineSheetRemoved",value:function(o,i){this.hot.runHooks("afterSheetRemoved",o,i)}}],[{key:"PLUGIN_KEY",get:function(){return er}},{key:"PLUGIN_PRIORITY",get:function(){return JHe}},{key:"SETTING_KEYS",get:function(){return[er].concat(QHe)}}]),r}(it);function tLe(e,t){return iLe(e)||oLe(e,t)||nLe(e,t)||rLe()}function rLe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function nLe(e,t){if(e){if(typeof e=="string")return ON(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return ON(e,t)}}function ON(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function oLe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function iLe(e){if(Array.isArray(e))return e}function aLe(e){return{key:"hidden_columns_hide",name:function(){var r=this.getSelectedLast(),n=0;if(Array.isArray(r)){var o=tLe(r,4),i=o[1],a=o[3];i-a!==0&&(n=1)}return this.getTranslatedPhrase(Y0,n)},callback:function(){for(var r=this.getSelectedRangeLast(),n=r.from,o=r.to,i=Math.max(Math.min(n.col,o.col),0),a=Math.max(n.col,o.col),l=[],s=i;s<=a;s+=1)l.push(s);e.hideColumns(l);var u=l[l.length-1],f=this.columnIndexMapper.getNearestNotHiddenIndex(u,1,!0);Number.isInteger(f)&&f>=0?this.selectColumns(f):this.deselectCell(),this.render(),this.view.adjustElementsSize(!0)},disabled:!1,hidden:function(){return!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())}}}function by(e){return fLe(e)||uLe(e)||sLe(e)||lLe()}function lLe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function sLe(e,t){if(e){if(typeof e=="string")return CO(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return CO(e,t)}}function uLe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function fLe(e){if(Array.isArray(e))return CO(e)}function CO(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function cLe(e){var t=[];return{key:"hidden_columns_show",name:function(){var n=t.length>1?1:0;return this.getTranslatedPhrase(G0,n)},callback:function(){var n,o;if(t.length!==0){var i=t[0],a=t[t.length-1];i=(n=this.columnIndexMapper.getNearestNotHiddenIndex(i-1,-1))!==null&&n!==void 0?n:0,a=(o=this.columnIndexMapper.getNearestNotHiddenIndex(a+1,1))!==null&&o!==void 0?o:this.countCols()-1,e.showColumns(t),this.render(),this.view.adjustElementsSize(!0);var l=a-i+1===this.countCols();l||this.selectColumns(i,a)}},disabled:!1,hidden:function(){var n=this,o=Ye(e.getHiddenColumns(),function(S){return n.toPhysicalColumn(S)});if(!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())||o.length<1)return!0;t.length=0;var i=this.getSelectedRangeLast(),a=i.getTopStartCorner().col,l=i.getBottomEndCorner().col,s=this.columnIndexMapper,u=s.getRenderableFromVisualIndex(a),f=s.getRenderableFromVisualIndex(l),c=s.getNotTrimmedIndexes(),h=[];if(a!==l){var d=l-a+1,v=f-u+1;if(d>v){var y=c.slice(a,l+1);h.push.apply(h,by(y.filter(function(S){return o.includes(S)})))}}else if(u===0&&u<a)h.push.apply(h,by(c.slice(0,a)));else if(u===null)h.push.apply(h,by(c.slice(0,this.countCols())));else{var p=this.countCols()-1,w=s.getRenderableFromVisualIndex(s.getNearestNotHiddenIndex(p,-1));f===w&&p>l&&h.push.apply(h,by(c.slice(l+1)))}return I(h,function(S){t.push(n.toVisualColumn(S))}),t.length===0}}}function ku(e){"@babel/helpers - typeof";return ku=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ku(e)}function hLe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function RN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,vLe(n.key),n)}}function dLe(e,t,r){return t&&RN(e.prototype,t),r&&RN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function vLe(e){var t=yLe(e,"string");return ku(t)==="symbol"?t:String(t)}function yLe(e,t){if(ku(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ku(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ca(){return typeof Reflect<"u"&&Reflect.get?ca=Reflect.get.bind():ca=function(t,r,n){var o=gLe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},ca.apply(this,arguments)}function gLe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=bo(e),e!==null););return e}function mLe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_O(e,t)}function _O(e,t){return _O=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},_O(e,t)}function pLe(e){var t=wLe();return function(){var n=bo(e),o;if(t){var i=bo(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return bLe(this,o)}}function bLe(e,t){if(t&&(ku(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return OO(e)}function OO(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function wLe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function bo(e){return bo=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},bo(e)}function EN(e,t,r){SLe(e,t),t.set(e,r)}function SLe(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function $r(e,t){var r=DU(e,t,"get");return CLe(e,r)}function CLe(e,t){return t.get?t.get.call(e):t.value}function Gf(e,t,r){var n=DU(e,t,"set");return _Le(e,n,r),r}function DU(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function _Le(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}ge.getSingleton().register("beforeHideColumns");ge.getSingleton().register("afterHideColumns");ge.getSingleton().register("beforeUnhideColumns");ge.getSingleton().register("afterUnhideColumns");var rS="hiddenColumns",OLe=310,Sn=new WeakMap,Cn=new WeakMap,RLe=function(e){mLe(r,e);var t=pLe(r);function r(){var n;hLe(this,r);for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return n=t.call.apply(t,[this].concat(i)),EN(OO(n),Sn,{writable:!0,value:{}}),EN(OO(n),Cn,{writable:!0,value:null}),n}return dLe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[rS]}},{key:"enablePlugin",value:function(){var o=this;if(!this.enabled){var i=this.hot.getSettings()[rS];Ge(i)&&(Gf(this,Sn,i),gt(i.copyPasteEnabled)&&(i.copyPasteEnabled=!0)),Gf(this,Cn,new mp),$r(this,Cn).addLocalHook("init",function(){return o.onMapInit()}),this.hot.columnIndexMapper.registerMap(this.pluginName,$r(this,Cn)),this.addHook("afterContextMenuDefaultOptions",function(){return o.onAfterContextMenuDefaultOptions.apply(o,arguments)}),this.addHook("afterGetCellMeta",function(a,l,s){return o.onAfterGetCellMeta(a,l,s)}),this.addHook("modifyColWidth",function(a,l){return o.onModifyColWidth(a,l)}),this.addHook("afterGetColHeader",function(){return o.onAfterGetColHeader.apply(o,arguments)}),this.addHook("modifyCopyableRange",function(a){return o.onModifyCopyableRange(a)}),ca(bo(r.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),ca(bo(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),Gf(this,Sn,{}),ca(bo(r.prototype),"disablePlugin",this).call(this),this.resetCellsMeta()}},{key:"showColumns",value:function(o){var i=this,a=this.getHiddenColumns(),l=this.isValidConfig(o),s=a,u=$r(this,Cn).getValues().slice(),f=o.length>0;if(l&&f){var c=o.map(function(d){return i.hot.toPhysicalColumn(d)});I(c,function(d){u[d]=!1}),s=nr(u,function(d,v,y){return v&&d.push(i.hot.toVisualColumn(y)),d},[])}var h=this.hot.runHooks("beforeUnhideColumns",a,s,l&&f);h!==!1&&(l&&f&&$r(this,Cn).setValues(u),this.hot.view.adjustElementsSize(),this.hot.runHooks("afterUnhideColumns",a,s,l&&f,l&&s.length<a.length))}},{key:"showColumn",value:function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];this.showColumns(i)}},{key:"hideColumns",value:function(o){var i=this,a=this.getHiddenColumns(),l=this.isValidConfig(o),s=a;l&&(s=Array.from(new Set(a.concat(o))));var u=this.hot.runHooks("beforeHideColumns",a,s,l);u!==!1&&(l&&this.hot.batchExecution(function(){I(o,function(f){$r(i,Cn).setValueAtIndex(i.hot.toPhysicalColumn(f),!0)})},!0),this.hot.runHooks("afterHideColumns",a,s,l,l&&s.length>a.length))}},{key:"hideColumn",value:function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];this.hideColumns(i)}},{key:"getHiddenColumns",value:function(){var o=this;return Ye($r(this,Cn).getHiddenIndexes(),function(i){return o.hot.toVisualColumn(i)})}},{key:"isHidden",value:function(o){return $r(this,Cn).getValueAtIndex(this.hot.toPhysicalColumn(o))||!1}},{key:"isValidConfig",value:function(o){var i=this.hot.countCols();return Array.isArray(o)&&o.length>0?o.every(function(a){return Number.isInteger(a)&&a>=0&&a<i}):!1}},{key:"resetCellsMeta",value:function(){I(this.hot.getCellsMeta(),function(o){o&&(o.skipColumnOnPaste=!1)})}},{key:"onModifyColWidth",value:function(o,i){if(this.isHidden(i))return 0;if($r(this,Sn).indicators&&(this.isHidden(i+1)||this.isHidden(i-1))&&typeof o=="number"&&this.hot.hasColHeaders())return o+15}},{key:"onAfterGetCellMeta",value:function(o,i,a){if($r(this,Sn).copyPasteEnabled===!1&&this.isHidden(i)&&(a.skipColumnOnPaste=!0),this.isHidden(i-1))a.className=a.className||"",a.className.indexOf("afterHiddenColumn")===-1&&(a.className+=" afterHiddenColumn");else if(a.className){var l=a.className.split(" ");if(l.length>0){var s=l.indexOf("afterHiddenColumn");s>-1&&l.splice(s,1),a.className=l.join(" ")}}}},{key:"onModifyCopyableRange",value:function(o){var i=this;if($r(this,Sn).copyPasteEnabled)return o;var a=[],l=function(u,f,c,h){a.push({startRow:u,endRow:f,startCol:c,endCol:h})};return I(o,function(s){var u=!0,f=0;_e(s.startCol,s.endCol,function(c){i.isHidden(c)?(u||l(s.startRow,s.endRow,f,c-1),u=!0):(u&&(f=c),c===s.endCol&&l(s.startRow,s.endRow,f,c),u=!1)})}),a}},{key:"onAfterGetColHeader",value:function(o,i){if(!(!$r(this,Sn).indicators||o<0)){var a=[];o>=1&&this.isHidden(o-1)&&a.push("afterHiddenColumn"),o<this.hot.countCols()-1&&this.isHidden(o+1)&&a.push("beforeHiddenColumn"),re(i,a)}}},{key:"onAfterContextMenuDefaultOptions",value:function(o){o.items.push({name:ze},aLe(this),cLe(this))}},{key:"onMapInit",value:function(){Array.isArray($r(this,Sn).columns)&&this.hideColumns($r(this,Sn).columns)}},{key:"destroy",value:function(){Gf(this,Sn,null),Gf(this,Cn,null),ca(bo(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return rS}},{key:"PLUGIN_PRIORITY",get:function(){return OLe}}]),r}(it);function ELe(e,t){return $Le(e)||PLe(e,t)||kLe(e,t)||TLe()}function TLe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function kLe(e,t){if(e){if(typeof e=="string")return TN(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return TN(e,t)}}function TN(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function PLe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function $Le(e){if(Array.isArray(e))return e}function ALe(e){return{key:"hidden_rows_hide",name:function(){var r=this.getSelectedLast(),n=0;if(Array.isArray(r)){var o=ELe(r,3),i=o[0],a=o[2];i-a!==0&&(n=1)}return this.getTranslatedPhrase(K0,n)},callback:function(){for(var r=this.getSelectedRangeLast(),n=r.from,o=r.to,i=Math.max(Math.min(n.row,o.row),0),a=Math.max(n.row,o.row),l=[],s=i;s<=a;s+=1)l.push(s);e.hideRows(l);var u=l[l.length-1],f=this.rowIndexMapper.getNearestNotHiddenIndex(u,1,!0);Number.isInteger(f)&&f>=0?this.selectRows(f):this.deselectCell(),this.render(),this.view.adjustElementsSize(!0)},disabled:!1,hidden:function(){return!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())}}}function wy(e){return DLe(e)||xLe(e)||MLe(e)||ILe()}function ILe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function MLe(e,t){if(e){if(typeof e=="string")return RO(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return RO(e,t)}}function xLe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function DLe(e){if(Array.isArray(e))return RO(e)}function RO(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function NLe(e){var t=[];return{key:"hidden_rows_show",name:function(){var n=t.length>1?1:0;return this.getTranslatedPhrase(q0,n)},callback:function(){var n,o;if(t.length!==0){var i=t[0],a=t[t.length-1];i=(n=this.rowIndexMapper.getNearestNotHiddenIndex(i-1,-1))!==null&&n!==void 0?n:0,a=(o=this.rowIndexMapper.getNearestNotHiddenIndex(a+1,1))!==null&&o!==void 0?o:this.countRows()-1,e.showRows(t),this.render(),this.view.adjustElementsSize(!0);var l=a-i+1===this.countRows();l||this.selectRows(i,a)}},disabled:!1,hidden:function(){var n=this,o=Ye(e.getHiddenRows(),function(S){return n.toPhysicalRow(S)});if(!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())||o.length<1)return!0;t.length=0;var i=this.getSelectedRangeLast(),a=i.getTopStartCorner().row,l=i.getBottomEndCorner().row,s=this.rowIndexMapper,u=s.getRenderableFromVisualIndex(a),f=s.getRenderableFromVisualIndex(l),c=s.getNotTrimmedIndexes(),h=[];if(a!==l){var d=l-a+1,v=f-u+1;if(d>v){var y=c.slice(a,l+1);h.push.apply(h,wy(y.filter(function(S){return o.includes(S)})))}}else if(u===0&&u<a)h.push.apply(h,wy(c.slice(0,a)));else if(u===null)h.push.apply(h,wy(c.slice(0,this.countRows())));else{var p=this.countRows()-1,w=s.getRenderableFromVisualIndex(s.getNearestNotHiddenIndex(p,-1));f===w&&p>l&&h.push.apply(h,wy(c.slice(l+1)))}return I(h,function(S){t.push(n.toVisualRow(S))}),t.length===0}}}function Pu(e){"@babel/helpers - typeof";return Pu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Pu(e)}function HLe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function kN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,jLe(n.key),n)}}function LLe(e,t,r){return t&&kN(e.prototype,t),r&&kN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function jLe(e){var t=FLe(e,"string");return Pu(t)==="symbol"?t:String(t)}function FLe(e,t){if(Pu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Pu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ha(){return typeof Reflect<"u"&&Reflect.get?ha=Reflect.get.bind():ha=function(t,r,n){var o=BLe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},ha.apply(this,arguments)}function BLe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=wo(e),e!==null););return e}function VLe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&EO(e,t)}function EO(e,t){return EO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},EO(e,t)}function WLe(e){var t=zLe();return function(){var n=wo(e),o;if(t){var i=wo(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return ULe(this,o)}}function ULe(e,t){if(t&&(Pu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return TO(e)}function TO(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function zLe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function wo(e){return wo=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},wo(e)}function PN(e,t,r){YLe(e,t),t.set(e,r)}function YLe(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Vr(e,t){var r=NU(e,t,"get");return GLe(e,r)}function GLe(e,t){return t.get?t.get.call(e):t.value}function Kf(e,t,r){var n=NU(e,t,"set");return KLe(e,n,r),r}function NU(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function KLe(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}ge.getSingleton().register("beforeHideRows");ge.getSingleton().register("afterHideRows");ge.getSingleton().register("beforeUnhideRows");ge.getSingleton().register("afterUnhideRows");var nS="hiddenRows",qLe=320,Kn=new WeakMap,_n=new WeakMap,XLe=function(e){VLe(r,e);var t=WLe(r);function r(){var n;HLe(this,r);for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return n=t.call.apply(t,[this].concat(i)),PN(TO(n),Kn,{writable:!0,value:{}}),PN(TO(n),_n,{writable:!0,value:null}),n}return LLe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[nS]}},{key:"enablePlugin",value:function(){var o=this;if(!this.enabled){var i=this.hot.getSettings()[nS];Ge(i)&&(Kf(this,Kn,i),gt(i.copyPasteEnabled)&&(i.copyPasteEnabled=!0)),Kf(this,_n,new mp),Vr(this,_n).addLocalHook("init",function(){return o.onMapInit()}),this.hot.rowIndexMapper.registerMap(this.pluginName,Vr(this,_n)),this.addHook("afterContextMenuDefaultOptions",function(){return o.onAfterContextMenuDefaultOptions.apply(o,arguments)}),this.addHook("afterGetCellMeta",function(a,l,s){return o.onAfterGetCellMeta(a,l,s)}),this.addHook("modifyRowHeight",function(a,l){return o.onModifyRowHeight(a,l)}),this.addHook("afterGetRowHeader",function(){return o.onAfterGetRowHeader.apply(o,arguments)}),this.addHook("modifyCopyableRange",function(a){return o.onModifyCopyableRange(a)}),ha(wo(r.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),ha(wo(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.hot.rowIndexMapper.unregisterMap(this.pluginName),Kf(this,Kn,{}),ha(wo(r.prototype),"disablePlugin",this).call(this),this.resetCellsMeta()}},{key:"showRows",value:function(o){var i=this,a=this.getHiddenRows(),l=this.isValidConfig(o),s=a,u=Vr(this,_n).getValues().slice(),f=o.length>0;if(l&&f){var c=o.map(function(d){return i.hot.toPhysicalRow(d)});I(c,function(d){u[d]=!1}),s=nr(u,function(d,v,y){return v&&d.push(i.hot.toVisualRow(y)),d},[])}var h=this.hot.runHooks("beforeUnhideRows",a,s,l&&f);h!==!1&&(l&&f&&Vr(this,_n).setValues(u),this.hot.runHooks("afterUnhideRows",a,s,l&&f,l&&s.length<a.length))}},{key:"showRow",value:function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];this.showRows(i)}},{key:"hideRows",value:function(o){var i=this,a=this.getHiddenRows(),l=this.isValidConfig(o),s=a;l&&(s=Array.from(new Set(a.concat(o))));var u=this.hot.runHooks("beforeHideRows",a,s,l);u!==!1&&(l&&this.hot.batchExecution(function(){I(o,function(f){Vr(i,_n).setValueAtIndex(i.hot.toPhysicalRow(f),!0)})},!0),this.hot.runHooks("afterHideRows",a,s,l,l&&s.length>a.length))}},{key:"hideRow",value:function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];this.hideRows(i)}},{key:"getHiddenRows",value:function(){var o=this;return Ye(Vr(this,_n).getHiddenIndexes(),function(i){return o.hot.toVisualRow(i)})}},{key:"isHidden",value:function(o){return Vr(this,_n).getValueAtIndex(this.hot.toPhysicalRow(o))||!1}},{key:"isValidConfig",value:function(o){var i=this.hot.countRows();return Array.isArray(o)&&o.length>0?o.every(function(a){return Number.isInteger(a)&&a>=0&&a<i}):!1}},{key:"resetCellsMeta",value:function(){I(this.hot.getCellsMeta(),function(o){o&&(o.skipRowOnPaste=!1)})}},{key:"onModifyRowHeight",value:function(o,i){return this.isHidden(i)?0:o}},{key:"onAfterGetCellMeta",value:function(o,i,a){if(Vr(this,Kn).copyPasteEnabled===!1&&this.isHidden(o)&&(a.skipRowOnPaste=!0),this.isHidden(o-1))a.className=a.className||"",a.className.indexOf("afterHiddenRow")===-1&&(a.className+=" afterHiddenRow");else if(a.className){var l=a.className.split(" ");if(l.length>0){var s=l.indexOf("afterHiddenRow");s>-1&&l.splice(s,1),a.className=l.join(" ")}}}},{key:"onModifyCopyableRange",value:function(o){var i=this;if(Vr(this,Kn).copyPasteEnabled)return o;var a=[],l=function(u,f,c,h){a.push({startRow:u,endRow:f,startCol:c,endCol:h})};return I(o,function(s){var u=!0,f=0;_e(s.startRow,s.endRow,function(c){i.isHidden(c)?(u||l(f,c-1,s.startCol,s.endCol),u=!0):(u&&(f=c),c===s.endRow&&l(f,c,s.startCol,s.endCol),u=!1)})}),a}},{key:"onAfterGetRowHeader",value:function(o,i){if(!(!Vr(this,Kn).indicators||o<0)){var a=[];o>=1&&this.isHidden(o-1)&&a.push("afterHiddenRow"),o<this.hot.countRows()-1&&this.isHidden(o+1)&&a.push("beforeHiddenRow"),re(i,a)}}},{key:"onAfterContextMenuDefaultOptions",value:function(o){o.items.push({name:ze},ALe(this),NLe(this))}},{key:"onMapInit",value:function(){Array.isArray(Vr(this,Kn).rows)&&this.hideRows(Vr(this,Kn).rows)}},{key:"destroy",value:function(){Kf(this,Kn,null),Kf(this,_n,null),ha(wo(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return nS}},{key:"PLUGIN_PRIORITY",get:function(){return qLe}}]),r}(it);function ZLe(e,t){return tje(e)||eje(e,t)||JLe(e,t)||QLe()}function QLe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function JLe(e,t){if(e){if(typeof e=="string")return $N(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return $N(e,t)}}function $N(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function eje(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function tje(e){if(Array.isArray(e))return e}function rje(e){return{key:"freeze_column",name:function(){return this.getTranslatedPhrase(C0)},callback:function(r,n){var o=ZLe(n,1),i=o[0].start.col;e.freezeColumn(i),this.render(),this.view.adjustElementsSize(!0)},hidden:function(){var r=this.getSelectedRange(),n=!1;return(r===void 0||r.length>1||r[0].from.col!==r[0].to.col||r[0].from.col<=this.getSettings().fixedColumnsStart-1)&&(n=!0),n}}}function nje(e,t){return lje(e)||aje(e,t)||ije(e,t)||oje()}function oje(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ije(e,t){if(e){if(typeof e=="string")return AN(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return AN(e,t)}}function AN(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function aje(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function lje(e){if(Array.isArray(e))return e}function sje(e){return{key:"unfreeze_column",name:function(){return this.getTranslatedPhrase(_0)},callback:function(r,n){var o=nje(n,1),i=o[0].start.col;e.unfreezeColumn(i),this.render(),this.view.adjustElementsSize(!0)},hidden:function(){var r=this.getSelectedRange(),n=!1;return(r===void 0||r.length>1||r[0].from.col!==r[0].to.col||r[0].from.col>=this.getSettings().fixedColumnsStart)&&(n=!0),n}}}function $u(e){"@babel/helpers - typeof";return $u=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$u(e)}function uje(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function IN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,cje(n.key),n)}}function fje(e,t,r){return t&&IN(e.prototype,t),r&&IN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function cje(e){var t=hje(e,"string");return $u(t)==="symbol"?t:String(t)}function hje(e,t){if($u(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if($u(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Xl(){return typeof Reflect<"u"&&Reflect.get?Xl=Reflect.get.bind():Xl=function(t,r,n){var o=dje(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Xl.apply(this,arguments)}function dje(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=mi(e),e!==null););return e}function vje(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&kO(e,t)}function kO(e,t){return kO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},kO(e,t)}function yje(e){var t=mje();return function(){var n=mi(e),o;if(t){var i=mi(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return gje(this,o)}}function gje(e,t){if(t&&($u(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return HU(e)}function HU(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function mje(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function mi(e){return mi=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},mi(e)}ge.getSingleton().register("beforeColumnFreeze");ge.getSingleton().register("afterColumnFreeze");ge.getSingleton().register("beforeColumnUnfreeze");ge.getSingleton().register("afterColumnUnfreeze");var MN="manualColumnFreeze",pje=110,qf=new WeakMap,bje=function(e){vje(r,e);var t=yje(r);function r(n){var o;return uje(this,r),o=t.call(this,n),qf.set(HU(o),{afterFirstUse:!1}),o}return fje(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[MN]}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.addHook("afterContextMenuDefaultOptions",function(i){return o.addContextMenuEntry(i)}),this.addHook("beforeColumnMove",function(i,a){return o.onBeforeColumnMove(i,a)}),Xl(mi(r.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){var o=qf.get(this);o.afterFirstUse=!1,Xl(mi(r.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),Xl(mi(r.prototype),"updatePlugin",this).call(this)}},{key:"freezeColumn",value:function(o){var i=qf.get(this),a=this.hot.getSettings(),l=a.fixedColumnsStart<this.hot.countCols()&&o>a.fixedColumnsStart-1;i.afterFirstUse||(i.afterFirstUse=!0);var s=this.hot.runHooks("beforeColumnFreeze",o,l);s!==!1&&(l&&(this.hot.columnIndexMapper.moveIndexes(o,a.fixedColumnsStart),a._fixedColumnsStart+=1),this.hot.runHooks("afterColumnFreeze",o,l))}},{key:"unfreezeColumn",value:function(o){var i=qf.get(this),a=this.hot.getSettings(),l=a.fixedColumnsStart>0&&o<=a.fixedColumnsStart-1;i.afterFirstUse||(i.afterFirstUse=!0);var s=this.hot.runHooks("beforeColumnUnfreeze",o,l);s!==!1&&(l&&(a._fixedColumnsStart-=1,this.hot.columnIndexMapper.moveIndexes(o,a.fixedColumnsStart)),this.hot.runHooks("afterColumnUnfreeze",o,l))}},{key:"addContextMenuEntry",value:function(o){o.items.push({name:"---------"},rje(this),sje(this))}},{key:"onBeforeColumnMove",value:function(o,i){var a=qf.get(this);if(a.afterFirstUse){var l=this.hot.getSettings().fixedColumnsStart;if(i<l||o.some(function(s){return s<l}))return!1}}}],[{key:"PLUGIN_KEY",get:function(){return MN}},{key:"PLUGIN_PRIORITY",get:function(){return pje}}]),r}(it);function vd(e){"@babel/helpers - typeof";return vd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},vd(e)}function wje(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function xN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Cje(n.key),n)}}function Sje(e,t,r){return t&&xN(e.prototype,t),r&&xN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Cje(e){var t=_je(e,"string");return vd(t)==="symbol"?t:String(t)}function _je(e,t){if(vd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(vd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var oS=0,DN=1,NN=2,Rl="px",Oje=function(){function e(t){wje(this,e),this.hot=t,this._element=null,this.state=oS,this.inlineProperty=t.isRtl()?"right":"left"}return Sje(e,[{key:"appendTo",value:function(r){r.appendChild(this._element),this.state=NN}},{key:"build",value:function(){this.state===oS&&(this._element=this.hot.rootDocument.createElement("div"),this.state=DN)}},{key:"destroy",value:function(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=oS}},{key:"isAppended",value:function(){return this.state===NN}},{key:"isBuilt",value:function(){return this.state>=DN}},{key:"setPosition",value:function(r,n){Cr(r)&&(this._element.style.top=r+Rl),Cr(n)&&(this._element.style[this.inlineProperty]=n+Rl)}},{key:"getPosition",value:function(){var r=this._element.style;return{top:r.top?parseInt(r.top,10):0,start:r[this.inlineProperty]?parseInt(r[this.inlineProperty],10):0}}},{key:"setSize",value:function(r,n){Cr(r)&&(this._element.style.width=r+Rl),Cr(n)&&(this._element.style.height=n+Rl)}},{key:"getSize",value:function(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}},{key:"setOffset",value:function(r,n){Cr(r)&&(this._element.style.marginTop=r+Rl),Cr(n)&&(this._element.style["margin".concat(un(this.inlineProperty))]=n+Rl)}},{key:"getOffset",value:function(){var r=this._element.style,n="margin".concat(un(this.inlineProperty));return{top:r.marginTop?parseInt(r.marginTop,10):0,start:r[n]?parseInt(r[n],10):0}}}]),e}();const LU=Oje;function Au(e){"@babel/helpers - typeof";return Au=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Au(e)}function Rje(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function HN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Tje(n.key),n)}}function Eje(e,t,r){return t&&HN(e.prototype,t),r&&HN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Tje(e){var t=kje(e,"string");return Au(t)==="symbol"?t:String(t)}function kje(e,t){if(Au(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Au(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function cg(){return typeof Reflect<"u"&&Reflect.get?cg=Reflect.get.bind():cg=function(t,r,n){var o=Pje(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},cg.apply(this,arguments)}function Pje(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Iu(e),e!==null););return e}function $je(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&PO(e,t)}function PO(e,t){return PO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},PO(e,t)}function Aje(e){var t=xje();return function(){var n=Iu(e),o;if(t){var i=Iu(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Ije(this,o)}}function Ije(e,t){if(t&&(Au(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Mje(e)}function Mje(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function xje(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Iu(e){return Iu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Iu(e)}var Dje="ht__manualColumnMove--backlight",Nje=function(e){$je(r,e);var t=Aje(r);function r(){return Rje(this,r),t.apply(this,arguments)}return Eje(r,[{key:"build",value:function(){cg(Iu(r.prototype),"build",this).call(this),re(this._element,Dje)}}]),r}(LU);const Hje=Nje;function Mu(e){"@babel/helpers - typeof";return Mu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Mu(e)}function Lje(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function LN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Fje(n.key),n)}}function jje(e,t,r){return t&&LN(e.prototype,t),r&&LN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Fje(e){var t=Bje(e,"string");return Mu(t)==="symbol"?t:String(t)}function Bje(e,t){if(Mu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Mu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function hg(){return typeof Reflect<"u"&&Reflect.get?hg=Reflect.get.bind():hg=function(t,r,n){var o=Vje(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},hg.apply(this,arguments)}function Vje(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=xu(e),e!==null););return e}function Wje(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&$O(e,t)}function $O(e,t){return $O=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},$O(e,t)}function Uje(e){var t=Gje();return function(){var n=xu(e),o;if(t){var i=xu(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return zje(this,o)}}function zje(e,t){if(t&&(Mu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Yje(e)}function Yje(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Gje(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function xu(e){return xu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},xu(e)}var Kje="ht__manualColumnMove--guideline",qje=function(e){Wje(r,e);var t=Uje(r);function r(){return Lje(this,r),t.apply(this,arguments)}return jje(r,[{key:"build",value:function(){hg(xu(r.prototype),"build",this).call(this),re(this._element,Kje)}}]),r}(LU);const Xje=qje;function Du(e){"@babel/helpers - typeof";return Du=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Du(e)}function Zje(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function jN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Jje(n.key),n)}}function Qje(e,t,r){return t&&jN(e.prototype,t),r&&jN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Jje(e){var t=eFe(e,"string");return Du(t)==="symbol"?t:String(t)}function eFe(e,t){if(Du(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Du(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function da(){return typeof Reflect<"u"&&Reflect.get?da=Reflect.get.bind():da=function(t,r,n){var o=tFe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},da.apply(this,arguments)}function tFe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=So(e),e!==null););return e}function rFe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&AO(e,t)}function AO(e,t){return AO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},AO(e,t)}function nFe(e){var t=iFe();return function(){var n=So(e),o;if(t){var i=So(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return oFe(this,o)}}function oFe(e,t){if(t&&(Du(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return IO(e)}function IO(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function iFe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function So(e){return So=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},So(e)}ge.getSingleton().register("beforeColumnMove");ge.getSingleton().register("afterColumnMove");var iS="manualColumnMove",aFe=120,Xo=new WeakMap,FN="ht__manualColumnMove",Sy="show-ui",aS="on-moving--columns",lS="after-selection--columns",lFe=function(e){rFe(r,e);var t=nFe(r);function r(n){var o;return Zje(this,r),o=t.call(this,n),Xo.set(IO(o),{columnsToMove:[],countCols:0,fixedColumns:0,pressed:void 0,target:{eventPageX:void 0,coords:void 0,TD:void 0,col:void 0},cachedDropIndex:void 0}),o.eventManager=new Pt(IO(o)),o.backlight=new Hje(n),o.guideline=new Xje(n),o}return Qje(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[iS]}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){return o.onBeforeOnCellMouseDown.apply(o,arguments)}),this.addHook("beforeOnCellMouseOver",function(){return o.onBeforeOnCellMouseOver.apply(o,arguments)}),this.addHook("afterScrollVertically",function(){return o.onAfterScrollVertically()}),this.addHook("afterLoadData",function(){return o.onAfterLoadData.apply(o,arguments)}),this.buildPluginUI(),this.registerEvents(),re(this.hot.rootElement,FN),da(So(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),da(So(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){He(this.hot.rootElement,FN),this.unregisterEvents(),this.backlight.destroy(),this.guideline.destroy(),da(So(r.prototype),"disablePlugin",this).call(this)}},{key:"moveColumn",value:function(o,i){return this.moveColumns([o],i)}},{key:"moveColumns",value:function(o,i){var a=Xo.get(this),l=a.cachedDropIndex,s=this.isMovePossible(o,i),u=this.hot.runHooks("beforeColumnMove",o,i,l,s);if(a.cachedDropIndex=void 0,u!==!1){s&&this.hot.columnIndexMapper.moveIndexes(o,i);var f=s&&this.isColumnOrderChanged(o,i);return this.hot.runHooks("afterColumnMove",o,i,l,s,f),f}}},{key:"dragColumn",value:function(o,i){return this.dragColumns([o],i)}},{key:"dragColumns",value:function(o,i){var a=this.countFinalIndex(o,i),l=Xo.get(this);return l.cachedDropIndex=i,this.moveColumns(o,a)}},{key:"isMovePossible",value:function(o,i){var a=this.hot.columnIndexMapper.getNotTrimmedIndexesLength(),l=o.length+i>a,s=i<0,u=o.some(function(c){return c<0}),f=o.some(function(c){return c>=a});return!(l||s||u||f)}},{key:"isColumnOrderChanged",value:function(o,i){return o.some(function(a,l){return a-l!==i})}},{key:"countFinalIndex",value:function(o,i){var a=nr(o,function(l,s){return s<i&&(l+=1),l},0);return i-a}},{key:"getColumnsWidth",value:function(o,i){for(var a=this.hot.columnIndexMapper,l=0,s=o;s<=i;s+=1){var u=a.getRenderableFromVisualIndex(s);s<0?l+=this.hot.view._wt.wtViewport.getRowHeaderWidth()||0:u!==null&&(l+=this.hot.view._wt.wtTable.getStretchedColumnWidth(u)||0)}return l}},{key:"moveBySettingsOrLoad",value:function(){var o=this.hot.getSettings()[iS];if(Array.isArray(o))this.moveColumns(o,0);else if(o!==void 0){var i=this.persistentStateLoad();i.length&&this.moveColumns(i,0)}}},{key:"isFixedColumnsStart",value:function(o){return o<this.hot.getSettings().fixedColumnsStart}},{key:"persistentStateSave",value:function(){this.hot.runHooks("persistentStateSave","manualColumnMove",this.hot.columnIndexMapper.getIndexesSequence())}},{key:"persistentStateLoad",value:function(){var o={};return this.hot.runHooks("persistentStateLoad","manualColumnMove",o),o.value?o.value:[]}},{key:"prepareColumnsToMoving",value:function(o,i){var a=[];return _e(o,i,function(l){a.push(l)}),a}},{key:"refreshPositions",value:function(){var o=Xo.get(this),i=this.hot.view.getFirstFullyVisibleColumn();this.isFixedColumnsStart(o.hoveredColumn)&&i>0&&this.hot.scrollViewportTo(void 0,this.hot.columnIndexMapper.getNearestNotHiddenIndex(i-1,-1));var a=this.hot.view._wt.wtTable,l=this.hot.view._wt.wtOverlays.scrollableElement,s=typeof l.scrollX=="number"?l.scrollX:l.scrollLeft,u=this.hot.view.THEAD.offsetLeft+this.getColumnsWidth(0,o.hoveredColumn-1),f=a.hider.offsetWidth,c=a.TBODY.offsetLeft,h=this.backlight.getOffset().start,d=this.backlight.getSize().width,v=0,y=0;if(this.hot.isRtl()){var p=this.hot.rootWindow,w=ut(this.hot.rootElement),S=p.innerWidth-o.rootElementOffset-w;y=p.innerWidth-o.target.eventPageX-S-(l.scrollX===void 0?s:0)}else y=o.target.eventPageX-(o.rootElementOffset-(l.scrollX===void 0?s:0));if(o.hasRowHeaders&&(v=this.hot.view._wt.wtOverlays.inlineStartOverlay.clone.wtTable.getColumnHeader(-1).offsetWidth),this.isFixedColumnsStart(o.hoveredColumn)&&(u+=s),u+=v,o.hoveredColumn<0)o.fixedColumnsStart>0?o.target.col=0:o.target.col=i>0?i-1:i;else if(o.target.TD.offsetWidth/2+u<=y){var C=o.hoveredColumn>=o.countCols?o.countCols-1:o.hoveredColumn;o.target.col=C+1,u+=o.target.TD.offsetWidth}else o.target.col=o.hoveredColumn;var P=y,R=u;y+d+h>=f?P=f-d-h:y+h<c+v&&(P=c+v+Math.abs(h)),u>=f-1?R=f-1:R===0?R=1:l.scrollX!==void 0&&o.hoveredColumn<o.fixedColumnsStart&&(R-=o.rootElementOffset<=l.scrollX?o.rootElementOffset:0),this.backlight.setPosition(null,P),this.guideline.setPosition(null,R)}},{key:"registerEvents",value:function(){var o=this,i=this.hot.rootDocument.documentElement;this.eventManager.addEventListener(i,"mousemove",function(a){return o.onMouseMove(a)}),this.eventManager.addEventListener(i,"mouseup",function(){return o.onMouseUp()})}},{key:"unregisterEvents",value:function(){this.eventManager.clear()}},{key:"onBeforeOnCellMouseDown",value:function(o,i,a,l){var s=this.hot.view._wt.wtTable,u=this.hot.selection.isSelectedByColumnHeader(),f=this.hot.getSelectedRangeLast(),c=Xo.get(this),h=xe(o.target,"sortAction");if(!f||!u||c.pressed||o.button!==0||h){c.pressed=!1,c.columnsToMove.length=0,He(this.hot.rootElement,[aS,Sy]);return}var d=this.guideline.isBuilt()&&!this.guideline.isAppended(),v=this.backlight.isBuilt()&&!this.backlight.isAppended();d&&v&&(this.guideline.appendTo(s.hider),this.backlight.appendTo(s.hider));var y=f.from,p=f.to,w=Math.min(y.col,p.col),S=Math.max(y.col,p.col);if(i.row<0&&i.col>=w&&i.col<=S){l.column=!0,c.pressed=!0,c.target.eventPageX=o.pageX,c.target.eventOffsetX=o.offsetX,c.hoveredColumn=i.col,c.target.TD=a,c.target.col=i.col,c.columnsToMove=this.prepareColumnsToMoving(w,S),c.hasRowHeaders=!!this.hot.getSettings().rowHeaders,c.countCols=this.hot.countCols(),c.fixedColumnsStart=this.hot.getSettings().fixedColumnsStart,c.rootElementOffset=Vt(this.hot.rootElement).left;var C=c.hasRowHeaders?-1:0,P=s.holder.scrollTop+s.getColumnHeaderHeight(0)+1,R=i.col<c.fixedColumnsStart,W=Math.abs(this.hot.view._wt.wtOverlays.inlineStartOverlay.getScrollPosition()),Y=Math.abs(o.offsetX-(this.hot.isRtl()?o.target.offsetWidth:0)),q=this.getColumnsWidth(w,i.col-1)+Y,G=this.getColumnsWidth(C,w-1)+(R?W:0)+q;this.backlight.setPosition(P,G),this.backlight.setSize(this.getColumnsWidth(w,S),s.hider.offsetHeight-P),this.backlight.setOffset(null,-q),re(this.hot.rootElement,aS)}else He(this.hot.rootElement,lS),c.pressed=!1,c.columnsToMove.length=0}},{key:"onMouseMove",value:function(o){var i=Xo.get(this);if(i.pressed){if(o.target===this.backlight.element){var a=this.backlight.getSize().width;this.backlight.setSize(0),setTimeout(function(){this.backlight.setPosition(a)})}i.target.eventPageX=o.pageX,this.refreshPositions()}}},{key:"onBeforeOnCellMouseOver",value:function(o,i,a,l){var s=this.hot.getSelectedRangeLast(),u=Xo.get(this);!s||!u.pressed||(u.columnsToMove.indexOf(i.col)>-1?He(this.hot.rootElement,Sy):re(this.hot.rootElement,Sy),l.row=!0,l.column=!0,l.cell=!0,u.hoveredColumn=i.col,u.target.TD=a)}},{key:"onMouseUp",value:function(){var o=Xo.get(this),i=o.target.col,a=o.columnsToMove.length;if(o.hoveredColumn=void 0,o.pressed=!1,o.backlightWidth=0,He(this.hot.rootElement,[aS,Sy,lS]),this.hot.selection.isSelectedByColumnHeader()&&re(this.hot.rootElement,lS),!(a<1||i===void 0)){var l=o.columnsToMove[0],s=this.hot.toPhysicalColumn(l),u=this.dragColumns(o.columnsToMove,i);if(o.columnsToMove.length=0,u===!0){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize(!0);var f=this.hot.toVisualColumn(s),c=f+a-1;this.hot.selectColumns(f,c)}}}},{key:"onAfterScrollVertically",value:function(){var o=this.hot.view._wt.wtTable,i=o.getColumnHeaderHeight(0)+1,a=o.holder.scrollTop,l=i+a;this.backlight.setPosition(l),this.backlight.setSize(null,o.hider.offsetHeight-l)}},{key:"buildPluginUI",value:function(){this.backlight.build(),this.guideline.build()}},{key:"onAfterLoadData",value:function(){this.moveBySettingsOrLoad()}},{key:"destroy",value:function(){this.backlight.destroy(),this.guideline.destroy(),da(So(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return iS}},{key:"PLUGIN_PRIORITY",get:function(){return aFe}}]),r}(it);function Nu(e){"@babel/helpers - typeof";return Nu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Nu(e)}function sFe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function BN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,fFe(n.key),n)}}function uFe(e,t,r){return t&&BN(e.prototype,t),r&&BN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function fFe(e){var t=cFe(e,"string");return Nu(t)==="symbol"?t:String(t)}function cFe(e,t){if(Nu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Nu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function va(){return typeof Reflect<"u"&&Reflect.get?va=Reflect.get.bind():va=function(t,r,n){var o=hFe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},va.apply(this,arguments)}function hFe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Co(e),e!==null););return e}function dFe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&MO(e,t)}function MO(e,t){return MO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},MO(e,t)}function vFe(e){var t=gFe();return function(){var n=Co(e),o;if(t){var i=Co(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return yFe(this,o)}}function yFe(e,t){if(t&&(Nu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return xO(e)}function xO(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function gFe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Co(e){return Co=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Co(e)}var Cy="manualColumnResize",mFe=130,VN="manualColumnWidths",sS=new WeakMap,pFe=function(e){dFe(r,e);var t=vFe(r);function r(n){var o;sFe(this,r),o=t.call(this,n);var i=o.hot.rootDocument;return o.currentTH=null,o.currentCol=null,o.selectedCols=[],o.currentWidth=null,o.newSize=null,o.startY=null,o.startWidth=null,o.startOffset=null,o.handle=i.createElement("DIV"),o.guide=i.createElement("DIV"),o.eventManager=new Pt(xO(o)),o.pressed=null,o.dblclick=0,o.autoresizeTimeout=null,o.columnWidthsMap=void 0,sS.set(xO(o),{config:void 0}),re(o.handle,"manualColumnResizer"),re(o.guide,"manualColumnResizerGuide"),o}return uFe(r,[{key:"inlineDir",get:function(){return this.hot.isRtl()?"right":"left"}},{key:"isEnabled",value:function(){return this.hot.getSettings()[Cy]}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.columnWidthsMap=new Ri,this.columnWidthsMap.addLocalHook("init",function(){return o.onMapInit()}),this.hot.columnIndexMapper.registerMap(this.pluginName,this.columnWidthsMap),this.addHook("modifyColWidth",function(i,a){return o.onModifyColWidth(i,a)}),this.addHook("beforeStretchingColumnWidth",function(i,a){return o.onBeforeStretchingColumnWidth(i,a)}),this.addHook("beforeColumnResize",function(i,a,l){return o.onBeforeColumnResize(i,a,l)}),this.bindEvents(),va(Co(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),va(Co(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){var o=sS.get(this);o.config=this.columnWidthsMap.getValues(),this.hot.columnIndexMapper.unregisterMap(this.pluginName),va(Co(r.prototype),"disablePlugin",this).call(this)}},{key:"saveManualColumnWidths",value:function(){this.hot.runHooks("persistentStateSave",VN,this.columnWidthsMap.getValues())}},{key:"loadManualColumnWidths",value:function(){var o={};return this.hot.runHooks("persistentStateLoad",VN,o),o.value}},{key:"setManualSize",value:function(o,i){var a=Math.max(i,20),l=this.hot.toPhysicalColumn(o);return this.columnWidthsMap.setValueAtIndex(l,a),a}},{key:"clearManualSize",value:function(o){var i=this.hot.toPhysicalColumn(o);this.columnWidthsMap.setValueAtIndex(i,null)}},{key:"onMapInit",value:function(){var o=this,i=sS.get(this),a=this.hot.getSettings()[Cy],l=this.loadManualColumnWidths();typeof l<"u"?this.hot.batchExecution(function(){l.forEach(function(s,u){o.columnWidthsMap.setValueAtIndex(u,s)})},!0):Array.isArray(a)?(this.hot.batchExecution(function(){a.forEach(function(s,u){o.columnWidthsMap.setValueAtIndex(u,s)})},!0),i.config=a):a===!0&&Array.isArray(i.config)&&this.hot.batchExecution(function(){i.config.forEach(function(s,u){o.columnWidthsMap.setValueAtIndex(u,s)})},!0)}},{key:"setupHandlePosition",value:function(o){var i=this;if(o.parentNode){this.currentTH=o;var a=this.hot.view._wt,l=a.wtTable.getCoords(this.currentTH),s=l.col;if(!(s<0)){var u=Tt(this.currentTH),f=this.currentTH.getBoundingClientRect(),c=s<a.getSetting("fixedColumnsStart"),h;c&&(h=a.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(this.currentTH,l.row,l.col)),h||(h=a.wtOverlays.topOverlay.getRelativeCellPosition(this.currentTH,l.row,l.col)),this.currentCol=this.hot.columnIndexMapper.getVisualFromRenderableIndex(s),this.selectedCols=[];var d=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByColumnHeader();if(this.hot.selection.isSelected()&&d){var v=this.hot.getSelectedRange();I(v,function(y){var p=y.getTopStartCorner().col,w=y.getBottomEndCorner().col;_e(p,w,function(S){i.selectedCols.includes(S)||i.selectedCols.push(S)})})}this.selectedCols.includes(this.currentCol)||(this.selectedCols=[this.currentCol]),this.startOffset=h.start-6,this.startWidth=parseInt(f.width,10),this.handle.style.top="".concat(h.top,"px"),this.handle.style[this.inlineDir]="".concat(this.startOffset+this.startWidth,"px"),this.handle.style.height="".concat(u,"px"),this.hot.rootElement.appendChild(this.handle)}}}},{key:"refreshHandlePosition",value:function(){this.handle.style[this.inlineDir]="".concat(this.startOffset+this.currentWidth,"px")}},{key:"setupGuidePosition",value:function(){var o=parseInt(Tt(this.handle),10),i=parseInt(this.handle.style.top,10)+o,a=parseInt(this.hot.view.maximumVisibleElementHeight(0),10);re(this.handle,"active"),re(this.guide,"active"),this.guide.style.top="".concat(i,"px"),this.refreshGuidePosition(),this.guide.style.height="".concat(a-o,"px"),this.hot.rootElement.appendChild(this.guide)}},{key:"refreshGuidePosition",value:function(){this.guide.style[this.inlineDir]=this.handle.style[this.inlineDir]}},{key:"hideHandleAndGuide",value:function(){He(this.handle,"active"),He(this.guide,"active")}},{key:"checkIfColumnHeader",value:function(o){return!!Ra(o,["THEAD"],this.hot.rootElement)}},{key:"getClosestTHParent",value:function(o){return o.tagName!=="TABLE"?o.tagName==="TH"?o:this.getClosestTHParent(o.parentNode):null}},{key:"onMouseOver",value:function(o){if(!xB(o.target)&&this.checkIfColumnHeader(o.target)){var i=this.getClosestTHParent(o.target);if(!i)return;var a=i.getAttribute("colspan");i&&(a===null||a==="1")&&(this.pressed||this.setupHandlePosition(i))}}},{key:"afterMouseDownTimeout",value:function(){var o=this,i=function(){o.hot.forceFullRender=!0,o.hot.view.render(),o.hot.view.adjustElementsSize(!0)},a=function(u,f){var c=o.hot.runHooks("beforeColumnResize",o.newSize,u,!0);c!==void 0&&(o.newSize=c),o.hot.getSettings().stretchH==="all"?o.clearManualSize(u):o.setManualSize(u,o.newSize),o.saveManualColumnWidths(),o.hot.runHooks("afterColumnResize",o.newSize,u,!0),f&&i()};if(this.dblclick>=2){var l=this.selectedCols.length;l>1?(I(this.selectedCols,function(s){a(s)}),i()):I(this.selectedCols,function(s){a(s,!0)})}this.dblclick=0,this.autoresizeTimeout=null}},{key:"onMouseDown",value:function(o){var i=this;xe(o.target,"manualColumnResizer")&&(this.setupHandlePosition(this.currentTH),this.setupGuidePosition(),this.pressed=!0,this.autoresizeTimeout===null&&(this.autoresizeTimeout=setTimeout(function(){return i.afterMouseDownTimeout()},500),this.hot._registerTimeout(this.autoresizeTimeout)),this.dblclick+=1,this.startX=o.pageX,this.newSize=this.startWidth)}},{key:"onMouseMove",value:function(o){var i=this;if(this.pressed){var a=(o.pageX-this.startX)*this.hot.getDirectionFactor();this.currentWidth=this.startWidth+a,I(this.selectedCols,function(l){i.newSize=i.setManualSize(l,i.currentWidth)}),this.refreshHandlePosition(),this.refreshGuidePosition()}}},{key:"onMouseUp",value:function(){var o=this,i=function(){o.hot.forceFullRender=!0,o.hot.view.render(),o.hot.view.adjustElementsSize(!0)},a=function(u,f){o.hot.runHooks("beforeColumnResize",o.newSize,u,!1),f&&i(),o.saveManualColumnWidths(),o.hot.runHooks("afterColumnResize",o.newSize,u,!1)};if(this.pressed){if(this.hideHandleAndGuide(),this.pressed=!1,this.newSize!==this.startWidth){var l=this.selectedCols.length;l>1?(I(this.selectedCols,function(s){a(s)}),i()):I(this.selectedCols,function(s){a(s,!0)})}this.setupHandlePosition(this.currentTH)}}},{key:"bindEvents",value:function(){var o=this,i=this.hot,a=i.rootWindow,l=i.rootElement;this.eventManager.addEventListener(l,"mouseover",function(s){return o.onMouseOver(s)}),this.eventManager.addEventListener(l,"mousedown",function(s){return o.onMouseDown(s)}),this.eventManager.addEventListener(a,"mousemove",function(s){return o.onMouseMove(s)}),this.eventManager.addEventListener(a,"mouseup",function(){return o.onMouseUp()})}},{key:"onModifyColWidth",value:function(o,i){var a=o;if(this.enabled){var l=this.hot.toPhysicalColumn(i),s=this.columnWidthsMap.getValueAtIndex(l);this.hot.getSettings()[Cy]&&s&&(a=s)}return a}},{key:"onBeforeStretchingColumnWidth",value:function(o,i){var a=this.columnWidthsMap.getValueAtIndex(i);return a===null&&(a=o),a}},{key:"onBeforeColumnResize",value:function(){this.hot.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked()}},{key:"destroy",value:function(){va(Co(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return Cy}},{key:"PLUGIN_PRIORITY",get:function(){return mFe}}]),r}(it);function yd(e){"@babel/helpers - typeof";return yd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},yd(e)}function bFe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function WN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,SFe(n.key),n)}}function wFe(e,t,r){return t&&WN(e.prototype,t),r&&WN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function SFe(e){var t=CFe(e,"string");return yd(t)==="symbol"?t:String(t)}function CFe(e,t){if(yd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(yd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var uS=0,UN=1,zN=2,El="px",_Fe=function(){function e(t){bFe(this,e),this.hot=t,this._element=null,this.state=uS}return wFe(e,[{key:"appendTo",value:function(r){r.appendChild(this._element),this.state=zN}},{key:"build",value:function(){this.state===uS&&(this._element=this.hot.rootDocument.createElement("div"),this.state=UN)}},{key:"destroy",value:function(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=uS}},{key:"isAppended",value:function(){return this.state===zN}},{key:"isBuilt",value:function(){return this.state>=UN}},{key:"setPosition",value:function(r,n){r!==void 0&&(this._element.style.top=r+El),n!==void 0&&(this._element.style.left=n+El)}},{key:"getPosition",value:function(){return{top:this._element.style.top?parseInt(this._element.style.top,10):0,left:this._element.style.left?parseInt(this._element.style.left,10):0}}},{key:"setSize",value:function(r,n){r&&(this._element.style.width=r+El),n&&(this._element.style.height=n+El)}},{key:"getSize",value:function(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}},{key:"setOffset",value:function(r,n){r&&(this._element.style.marginTop=r+El),n&&(this._element.style.marginLeft=n+El)}},{key:"getOffset",value:function(){return{top:this._element.style.marginTop?parseInt(this._element.style.marginTop,10):0,left:this._element.style.marginLeft?parseInt(this._element.style.marginLeft,10):0}}}]),e}();const jU=_Fe;function Hu(e){"@babel/helpers - typeof";return Hu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Hu(e)}function OFe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function YN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,EFe(n.key),n)}}function RFe(e,t,r){return t&&YN(e.prototype,t),r&&YN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function EFe(e){var t=TFe(e,"string");return Hu(t)==="symbol"?t:String(t)}function TFe(e,t){if(Hu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Hu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function dg(){return typeof Reflect<"u"&&Reflect.get?dg=Reflect.get.bind():dg=function(t,r,n){var o=kFe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},dg.apply(this,arguments)}function kFe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Lu(e),e!==null););return e}function PFe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&DO(e,t)}function DO(e,t){return DO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},DO(e,t)}function $Fe(e){var t=MFe();return function(){var n=Lu(e),o;if(t){var i=Lu(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return AFe(this,o)}}function AFe(e,t){if(t&&(Hu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return IFe(e)}function IFe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function MFe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Lu(e){return Lu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Lu(e)}var xFe="ht__manualRowMove--backlight",DFe=function(e){PFe(r,e);var t=$Fe(r);function r(){return OFe(this,r),t.apply(this,arguments)}return RFe(r,[{key:"build",value:function(){dg(Lu(r.prototype),"build",this).call(this),re(this._element,xFe)}}]),r}(jU);const NFe=DFe;function ju(e){"@babel/helpers - typeof";return ju=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ju(e)}function HFe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function GN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,jFe(n.key),n)}}function LFe(e,t,r){return t&&GN(e.prototype,t),r&&GN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function jFe(e){var t=FFe(e,"string");return ju(t)==="symbol"?t:String(t)}function FFe(e,t){if(ju(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ju(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function vg(){return typeof Reflect<"u"&&Reflect.get?vg=Reflect.get.bind():vg=function(t,r,n){var o=BFe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},vg.apply(this,arguments)}function BFe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Fu(e),e!==null););return e}function VFe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&NO(e,t)}function NO(e,t){return NO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},NO(e,t)}function WFe(e){var t=YFe();return function(){var n=Fu(e),o;if(t){var i=Fu(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return UFe(this,o)}}function UFe(e,t){if(t&&(ju(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return zFe(e)}function zFe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function YFe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Fu(e){return Fu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Fu(e)}var GFe="ht__manualRowMove--guideline",KFe=function(e){VFe(r,e);var t=WFe(r);function r(){return HFe(this,r),t.apply(this,arguments)}return LFe(r,[{key:"build",value:function(){vg(Fu(r.prototype),"build",this).call(this),re(this._element,GFe)}}]),r}(jU);const qFe=KFe;function Bu(e){"@babel/helpers - typeof";return Bu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Bu(e)}function XFe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function KN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,QFe(n.key),n)}}function ZFe(e,t,r){return t&&KN(e.prototype,t),r&&KN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function QFe(e){var t=JFe(e,"string");return Bu(t)==="symbol"?t:String(t)}function JFe(e,t){if(Bu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Bu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ya(){return typeof Reflect<"u"&&Reflect.get?ya=Reflect.get.bind():ya=function(t,r,n){var o=eBe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},ya.apply(this,arguments)}function eBe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=_o(e),e!==null););return e}function tBe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&HO(e,t)}function HO(e,t){return HO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},HO(e,t)}function rBe(e){var t=oBe();return function(){var n=_o(e),o;if(t){var i=_o(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return nBe(this,o)}}function nBe(e,t){if(t&&(Bu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return LO(e)}function LO(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function oBe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function _o(e){return _o=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},_o(e)}ge.getSingleton().register("beforeRowMove");ge.getSingleton().register("afterRowMove");var fS="manualRowMove",iBe=140,Zo=new WeakMap,qN="ht__manualRowMove",_y="show-ui",cS="on-moving--rows",hS="after-selection--rows",aBe=function(e){tBe(r,e);var t=rBe(r);function r(n){var o;return XFe(this,r),o=t.call(this,n),Zo.set(LO(o),{rowsToMove:[],pressed:void 0,target:{eventPageY:void 0,coords:void 0,TD:void 0,row:void 0},cachedDropIndex:void 0}),o.eventManager=new Pt(LO(o)),o.backlight=new NFe(n),o.guideline=new qFe(n),o}return ZFe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[fS]}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){return o.onBeforeOnCellMouseDown.apply(o,arguments)}),this.addHook("beforeOnCellMouseOver",function(){return o.onBeforeOnCellMouseOver.apply(o,arguments)}),this.addHook("afterScrollHorizontally",function(){return o.onAfterScrollHorizontally()}),this.addHook("afterLoadData",function(){return o.onAfterLoadData.apply(o,arguments)}),this.buildPluginUI(),this.registerEvents(),re(this.hot.rootElement,qN),ya(_o(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),ya(_o(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){He(this.hot.rootElement,qN),this.unregisterEvents(),this.backlight.destroy(),this.guideline.destroy(),ya(_o(r.prototype),"disablePlugin",this).call(this)}},{key:"moveRow",value:function(o,i){return this.moveRows([o],i)}},{key:"moveRows",value:function(o,i){var a=Zo.get(this),l=a.cachedDropIndex,s=this.isMovePossible(o,i),u=this.hot.runHooks("beforeRowMove",o,i,l,s);if(a.cachedDropIndex=void 0,u!==!1){s&&this.hot.rowIndexMapper.moveIndexes(o,i);var f=s&&this.isRowOrderChanged(o,i);return this.hot.runHooks("afterRowMove",o,i,l,s,f),f}}},{key:"dragRow",value:function(o,i){return this.dragRows([o],i)}},{key:"dragRows",value:function(o,i){var a=this.countFinalIndex(o,i),l=Zo.get(this);return l.cachedDropIndex=i,this.moveRows(o,a)}},{key:"isMovePossible",value:function(o,i){var a=this.hot.rowIndexMapper.getNotTrimmedIndexesLength(),l=o.length+i>a,s=i<0,u=o.some(function(c){return c<0}),f=o.some(function(c){return c>=a});return!(l||s||u||f)}},{key:"isRowOrderChanged",value:function(o,i){return o.some(function(a,l){return a-l!==i})}},{key:"countFinalIndex",value:function(o,i){var a=nr(o,function(l,s){return s<i&&(l+=1),l},0);return i-a}},{key:"getRowsHeight",value:function(o,i){for(var a=this.hot.rowIndexMapper,l=0,s=o;s<=i;s++){var u=a.getRenderableFromVisualIndex(s);u!==null&&(l+=this.hot.view._wt.wtTable.getRowHeight(u)||23)}return l}},{key:"moveBySettingsOrLoad",value:function(){var o=this.hot.getSettings()[fS];if(Array.isArray(o))this.moveRows(o,0);else if(o!==void 0){var i=this.persistentStateLoad();i.length&&this.moveRows(i,0)}}},{key:"isFixedRowTop",value:function(o){return o<this.hot.getSettings().fixedRowsTop}},{key:"isFixedRowBottom",value:function(o){return o>this.hot.countRows()-1-this.hot.getSettings().fixedRowsBottom}},{key:"persistentStateSave",value:function(){this.hot.runHooks("persistentStateSave","manualRowMove",this.hot.rowIndexMapper.getIndexesSequence())}},{key:"persistentStateLoad",value:function(){var o={};return this.hot.runHooks("persistentStateLoad","manualRowMove",o),o.value?o.value:[]}},{key:"prepareRowsToMoving",value:function(){var o=this.hot.getSelectedRangeLast(),i=[];if(!o)return i;var a=o.from,l=o.to,s=Math.min(a.row,l.row),u=Math.max(a.row,l.row);return _e(s,u,function(f){i.push(f)}),i}},{key:"refreshPositions",value:function(){var o=Zo.get(this),i=o.target.coords,a=this.hot.view.getFirstFullyVisibleRow(),l=this.hot.view.getLastFullyVisibleRow(),s=this.hot.countRows();this.isFixedRowTop(i.row)&&a>0&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(a-1,-1)),this.isFixedRowBottom(i.row)&&l<s&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(l+1,1),void 0,!0);var u=this.hot.view._wt.wtTable,f=o.target.TD,c=this.hot.rootElement,h=Vt(c),d=ns(c),v=u.holder.scrollTop,y;this.hot.rootWindow===d?y=d.scrollY:y=d.scrollTop;var p=h.top-y,w=o.target.eventPageY-p+v,S=u.hider.offsetHeight,C=u.TBODY.offsetTop,P=this.backlight.getOffset().top,R=this.backlight.getSize().height,W=f.offsetHeight/2,Y=f.offsetHeight,q=this.hot.view.THEAD.offsetHeight+this.getRowsHeight(0,i.row-1),G=w>=q+W;this.isFixedRowTop(i.row)&&(q+=u.holder.scrollTop),i.row<0?o.target.row=a>0?a-1:a:G?(o.target.row=i.row+1,q+=i.row===0?Y-1:Y):o.target.row=i.row;var X=w,Q=q;w+R+P>=S?X=S-R-P:w+P<C&&(X=C+Math.abs(P)),q>=S-1&&(Q=S-1),this.backlight.setPosition(X),this.guideline.setPosition(Q)}},{key:"registerEvents",value:function(){var o=this,i=this.hot.rootDocument.documentElement;this.eventManager.addEventListener(i,"mousemove",function(a){return o.onMouseMove(a)}),this.eventManager.addEventListener(i,"mouseup",function(){return o.onMouseUp()})}},{key:"unregisterEvents",value:function(){this.eventManager.clear()}},{key:"onBeforeOnCellMouseDown",value:function(o,i,a,l){var s=this.hot.view._wt,u=s.wtTable,f=s.wtViewport,c=this.hot.selection.isSelectedByRowHeader(),h=this.hot.getSelectedRangeLast(),d=Zo.get(this);if(!h||!c||d.pressed||o.button!==0){d.pressed=!1,d.rowsToMove.length=0,He(this.hot.rootElement,[cS,_y]);return}var v=this.guideline.isBuilt()&&!this.guideline.isAppended(),y=this.backlight.isBuilt()&&!this.backlight.isAppended();v&&y&&(this.guideline.appendTo(u.hider),this.backlight.appendTo(u.hider));var p=h.from,w=h.to,S=Math.min(p.row,w.row),C=Math.max(p.row,w.row);if(i.col<0&&i.row>=S&&i.row<=C){l.row=!0,d.pressed=!0,d.target.eventPageY=o.pageY,d.target.coords=i,d.target.TD=a,d.rowsToMove=this.prepareRowsToMoving();var P=u.holder.scrollLeft+f.getRowHeaderWidth();this.backlight.setPosition(null,P),this.backlight.setSize(u.hider.offsetWidth-P,this.getRowsHeight(S,C)),this.backlight.setOffset((this.getRowsHeight(S,i.row-1)+o.offsetY)*-1,null),re(this.hot.rootElement,cS),this.refreshPositions()}else He(this.hot.rootElement,hS),d.pressed=!1,d.rowsToMove.length=0}},{key:"onMouseMove",value:function(o){var i=Zo.get(this);if(i.pressed){if(o.target===this.backlight.element){var a=this.backlight.getSize().height;this.backlight.setSize(null,0),setTimeout(function(){this.backlight.setPosition(null,a)})}i.target.eventPageY=o.pageY,this.refreshPositions()}}},{key:"onBeforeOnCellMouseOver",value:function(o,i,a,l){var s=this.hot.getSelectedRangeLast(),u=Zo.get(this);!s||!u.pressed||(u.rowsToMove.indexOf(i.row)>-1?He(this.hot.rootElement,_y):re(this.hot.rootElement,_y),l.row=!0,l.column=!0,l.cell=!0,u.target.coords=i,u.target.TD=a)}},{key:"onMouseUp",value:function(){var o=Zo.get(this),i=o.target.row,a=o.rowsToMove.length;if(o.pressed=!1,o.backlightHeight=0,He(this.hot.rootElement,[cS,_y,hS]),this.hot.selection.isSelectedByRowHeader()&&re(this.hot.rootElement,hS),!(a<1||i===void 0)){var l=o.rowsToMove[0],s=this.hot.toPhysicalRow(l),u=this.dragRows(o.rowsToMove,i);if(o.rowsToMove.length=0,u===!0){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize(!0);var f=this.hot.toVisualRow(s),c=f+a-1;this.hot.selectRows(f,c)}}}},{key:"onAfterScrollHorizontally",value:function(){var o=this.hot.view._wt.wtTable,i=this.hot.view._wt.wtViewport.getRowHeaderWidth(),a=o.holder.scrollLeft,l=i+a;this.backlight.setPosition(null,l),this.backlight.setSize(o.hider.offsetWidth-l)}},{key:"buildPluginUI",value:function(){this.backlight.build(),this.guideline.build()}},{key:"onAfterLoadData",value:function(){this.moveBySettingsOrLoad()}},{key:"destroy",value:function(){this.backlight.destroy(),this.guideline.destroy(),ya(_o(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return fS}},{key:"PLUGIN_PRIORITY",get:function(){return iBe}}]),r}(it);function Vu(e){"@babel/helpers - typeof";return Vu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Vu(e)}function lBe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function XN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,uBe(n.key),n)}}function sBe(e,t,r){return t&&XN(e.prototype,t),r&&XN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function uBe(e){var t=fBe(e,"string");return Vu(t)==="symbol"?t:String(t)}function fBe(e,t){if(Vu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Vu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ga(){return typeof Reflect<"u"&&Reflect.get?ga=Reflect.get.bind():ga=function(t,r,n){var o=cBe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},ga.apply(this,arguments)}function cBe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Oo(e),e!==null););return e}function hBe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&jO(e,t)}function jO(e,t){return jO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},jO(e,t)}function dBe(e){var t=yBe();return function(){var n=Oo(e),o;if(t){var i=Oo(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return vBe(this,o)}}function vBe(e,t){if(t&&(Vu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return FO(e)}function FO(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function yBe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Oo(e){return Oo=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Oo(e)}var Oy="manualRowResize",gBe=30,ZN="manualRowHeights",dS=new WeakMap,mBe=function(e){hBe(r,e);var t=dBe(r);function r(n){var o;lBe(this,r),o=t.call(this,n);var i=o.hot.rootDocument;return o.currentTH=null,o.currentRow=null,o.selectedRows=[],o.currentHeight=null,o.newSize=null,o.startY=null,o.startHeight=null,o.startOffset=null,o.handle=i.createElement("DIV"),o.guide=i.createElement("DIV"),o.eventManager=new Pt(FO(o)),o.pressed=null,o.dblclick=0,o.autoresizeTimeout=null,o.rowHeightsMap=void 0,dS.set(FO(o),{config:void 0}),re(o.handle,"manualRowResizer"),re(o.guide,"manualRowResizerGuide"),o}return sBe(r,[{key:"inlineDir",get:function(){return this.hot.isRtl()?"right":"left"}},{key:"isEnabled",value:function(){return this.hot.getSettings()[Oy]}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.rowHeightsMap=new Ri,this.rowHeightsMap.addLocalHook("init",function(){return o.onMapInit()}),this.hot.rowIndexMapper.registerMap(this.pluginName,this.rowHeightsMap),this.addHook("modifyRowHeight",function(i,a){return o.onModifyRowHeight(i,a)}),this.bindEvents(),ga(Oo(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),ga(Oo(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){var o=dS.get(this);o.config=this.rowHeightsMap.getValues(),this.hot.rowIndexMapper.unregisterMap(this.pluginName),ga(Oo(r.prototype),"disablePlugin",this).call(this)}},{key:"saveManualRowHeights",value:function(){this.hot.runHooks("persistentStateSave",ZN,this.rowHeightsMap.getValues())}},{key:"loadManualRowHeights",value:function(){var o={};return this.hot.runHooks("persistentStateLoad",ZN,o),o.value}},{key:"setManualSize",value:function(o,i){var a=this.hot.toPhysicalRow(o),l=Math.max(i,fV.DEFAULT_HEIGHT);return this.rowHeightsMap.setValueAtIndex(a,l),l}},{key:"setupHandlePosition",value:function(o){var i=this;this.currentTH=o;var a=this.hot.view,l=a._wt,s=l.wtTable.getCoords(this.currentTH),u=s.row;if(!(u<0)){var f=ut(this.currentTH),c=this.currentTH.getBoundingClientRect(),h=u<l.getSetting("fixedRowsTop"),d=u>=a.countNotHiddenRowIndexes(0,1)-l.getSetting("fixedRowsBottom"),v;h?v=l.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(this.currentTH,s.row,s.col):d&&(v=l.wtOverlays.bottomInlineStartCornerOverlay.getRelativeCellPosition(this.currentTH,s.row,s.col)),v||(v=l.wtOverlays.inlineStartOverlay.getRelativeCellPosition(this.currentTH,s.row,s.col)),this.currentRow=this.hot.rowIndexMapper.getVisualFromRenderableIndex(u),this.selectedRows=[];var y=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByRowHeader();if(this.hot.selection.isSelected()&&y){var p=this.hot.getSelectedRange();I(p,function(w){var S=w.getTopStartCorner().row,C=w.getBottomStartCorner().row;_e(S,C,function(P){i.selectedRows.includes(P)||i.selectedRows.push(P)})})}this.selectedRows.includes(this.currentRow)||(this.selectedRows=[this.currentRow]),this.startOffset=v.top-6,this.startHeight=parseInt(c.height,10),this.handle.style.top="".concat(this.startOffset+this.startHeight,"px"),this.handle.style[this.inlineDir]="".concat(v.start,"px"),this.handle.style.width="".concat(f,"px"),this.hot.rootElement.appendChild(this.handle)}}},{key:"refreshHandlePosition",value:function(){this.handle.style.top="".concat(this.startOffset+this.currentHeight,"px")}},{key:"setupGuidePosition",value:function(){var o=parseInt(ut(this.handle),10),i=parseInt(this.handle.style[this.inlineDir],10)+o,a=parseInt(this.hot.view.maximumVisibleElementWidth(0),10);re(this.handle,"active"),re(this.guide,"active"),this.guide.style.top=this.handle.style.top,this.guide.style[this.inlineDir]="".concat(i,"px"),this.guide.style.width="".concat(a-o,"px"),this.hot.rootElement.appendChild(this.guide)}},{key:"refreshGuidePosition",value:function(){this.guide.style.top=this.handle.style.top}},{key:"hideHandleAndGuide",value:function(){He(this.handle,"active"),He(this.guide,"active")}},{key:"checkIfRowHeader",value:function(o){var i,a,l=Ra(o,["TH"],this.hot.rootElement);return l&&((i=o.parentNode)===null||i===void 0||(a=i.parentNode)===null||a===void 0?void 0:a.tagName)==="TBODY"}},{key:"getClosestTHParent",value:function(o){return o.tagName!=="TABLE"?o.tagName==="TH"?o:this.getClosestTHParent(o.parentNode):null}},{key:"getActualRowHeight",value:function(o){var i=this.hot.view._wt.wtTable.getRowHeight(o);return i!==void 0&&this.newSize<i?i:this.newSize}},{key:"onMouseOver",value:function(o){if(!xB(o.target)&&this.checkIfRowHeader(o.target)){var i=this.getClosestTHParent(o.target);i&&(this.pressed||this.setupHandlePosition(i))}}},{key:"afterMouseDownTimeout",value:function(){var o=this,i=function(){o.hot.forceFullRender=!0,o.hot.view.render(),o.hot.view.adjustElementsSize(!0)},a=function(u,f){var c=o.hot.runHooks("beforeRowResize",o.getActualRowHeight(u),u,!0);c!==void 0&&(o.newSize=c),o.setManualSize(u,o.newSize),o.hot.runHooks("afterRowResize",o.getActualRowHeight(u),u,!0),f&&i()};if(this.dblclick>=2){var l=this.selectedRows.length;l>1?(I(this.selectedRows,function(s){a(s)}),i()):I(this.selectedRows,function(s){a(s,!0)})}this.dblclick=0,this.autoresizeTimeout=null}},{key:"onMouseDown",value:function(o){var i=this;xe(o.target,"manualRowResizer")&&(this.setupHandlePosition(this.currentTH),this.setupGuidePosition(),this.pressed=!0,this.autoresizeTimeout===null&&(this.autoresizeTimeout=setTimeout(function(){return i.afterMouseDownTimeout()},500),this.hot._registerTimeout(this.autoresizeTimeout)),this.dblclick+=1,this.startY=o.pageY,this.newSize=this.startHeight)}},{key:"onMouseMove",value:function(o){var i=this;this.pressed&&(this.currentHeight=this.startHeight+(o.pageY-this.startY),I(this.selectedRows,function(a){i.newSize=i.setManualSize(a,i.currentHeight)}),this.refreshHandlePosition(),this.refreshGuidePosition())}},{key:"onMouseUp",value:function(){var o=this,i=function(){o.hot.forceFullRender=!0,o.hot.view.render(),o.hot.view.adjustElementsSize(!0)},a=function(u,f){o.hot.runHooks("beforeRowResize",o.getActualRowHeight(u),u,!1),f&&i(),o.saveManualRowHeights(),o.hot.runHooks("afterRowResize",o.getActualRowHeight(u),u,!1)};if(this.pressed){if(this.hideHandleAndGuide(),this.pressed=!1,this.newSize!==this.startHeight){var l=this.selectedRows.length;l>1?(I(this.selectedRows,function(s){a(s)}),i()):I(this.selectedRows,function(s){a(s,!0)})}this.setupHandlePosition(this.currentTH)}}},{key:"bindEvents",value:function(){var o=this,i=this.hot,a=i.rootElement,l=i.rootWindow;this.eventManager.addEventListener(a,"mouseover",function(s){return o.onMouseOver(s)}),this.eventManager.addEventListener(a,"mousedown",function(s){return o.onMouseDown(s)}),this.eventManager.addEventListener(l,"mousemove",function(s){return o.onMouseMove(s)}),this.eventManager.addEventListener(l,"mouseup",function(){return o.onMouseUp()})}},{key:"onModifyRowHeight",value:function(o,i){var a=o;if(this.enabled){var l=this.hot.toPhysicalRow(i),s=this.rowHeightsMap.getValueAtIndex(l);this.hot.getSettings()[Oy]&&s&&(a=s)}return a}},{key:"onMapInit",value:function(){var o=this,i=dS.get(this),a=this.hot.getSettings()[Oy],l=this.loadManualRowHeights();this.hot.batchExecution(function(){typeof l<"u"?l.forEach(function(s,u){o.rowHeightsMap.setValueAtIndex(u,s)}):Array.isArray(a)?(a.forEach(function(s,u){o.rowHeightsMap.setValueAtIndex(u,s)}),i.config=a):a===!0&&Array.isArray(i.config)&&i.config.forEach(function(s,u){o.rowHeightsMap.setValueAtIndex(u,s)})},!0)}},{key:"destroy",value:function(){ga(Oo(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return Oy}},{key:"PLUGIN_PRIORITY",get:function(){return gBe}}]),r}(it);function gd(e){"@babel/helpers - typeof";return gd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},gd(e)}var QN,JN,eH,tH;function Ry(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function pBe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function rH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,wBe(n.key),n)}}function bBe(e,t,r){return t&&rH(e.prototype,t),r&&rH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function wBe(e){var t=SBe(e,"string");return gd(t)==="symbol"?t:String(t)}function SBe(e,t){if(gd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(gd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var CBe=function(){function e(t,r,n,o,i,a){pBe(this,e),this.row=t,this.col=r,this.rowspan=n,this.colspan=o,this.removed=!1,this.cellCoordsFactory=i,this.cellRangeFactory=a}return bBe(e,[{key:"normalize",value:function(r){var n=r.countRows(),o=r.countCols();this.row<0?this.row=0:this.row>n-1&&(this.row=n-1),this.col<0?this.col=0:this.col>o-1&&(this.col=o-1),this.row+this.rowspan>n-1&&(this.rowspan=n-this.row),this.col+this.colspan>o-1&&(this.colspan=o-this.col)}},{key:"includes",value:function(r,n){return this.row<=r&&this.col<=n&&this.row+this.rowspan-1>=r&&this.col+this.colspan-1>=n}},{key:"includesHorizontally",value:function(r){return this.col<=r&&this.col+this.colspan-1>=r}},{key:"includesVertically",value:function(r){return this.row<=r&&this.row+this.rowspan-1>=r}},{key:"shift",value:function(r,n){var o=r[0]||r[1],i=n+Math.abs(r[0]||r[1])-1,a=r[0]?"colspan":"rowspan",l=r[0]?"col":"row",s=Math.min(n,i),u=Math.max(n,i),f=this[l],c=this[l]+this[a]-1;if(f>=n&&(this[l]+=o),o>0)n<=c&&n>f&&(this[a]+=o);else if(o<0){if(s<=f&&u>=c)return this.removed=!0,!1;if(f>=s&&f<=u){var h=u-f+1,d=Math.abs(o)-h;this[l]-=d+o,this[a]-=h}else if(f<=s&&c>=u)this[a]+=o;else if(f<=s&&c>=s&&c<u){var v=c-s+1;this[a]-=v}}return!0}},{key:"isFarther",value:function(r,n){return r?n==="down"?r.row+r.rowspan-1<this.row+this.rowspan-1:n==="up"?r.row>this.row:n==="right"?r.col+r.colspan-1<this.col+this.colspan-1:n==="left"?r.col>this.col:null:!0}},{key:"getLastRow",value:function(){return this.row+this.rowspan-1}},{key:"getLastColumn",value:function(){return this.col+this.colspan-1}},{key:"getRange",value:function(){return this.cellRangeFactory(this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.getLastRow(),this.getLastColumn()))}}],[{key:"NEGATIVE_VALUES_WARNING",value:function(r){return ft(QN||(QN=Ry(["The merged cell declared with {row: ",", col: ",`, 
      rowspan: `,", colspan: ",`} contains negative values, which is 
      not supported. It will not be added to the collection.`],["The merged cell declared with {row: ",", col: ",`,\\x20
      rowspan: `,", colspan: ",`} contains negative values, which is\\x20
      not supported. It will not be added to the collection.`])),r.row,r.col,r.rowspan,r.colspan)}},{key:"IS_OUT_OF_BOUNDS_WARNING",value:function(r){return ft(JN||(JN=Ry(["The merged cell declared at [",", ",`] is positioned 
      (or positioned partially) outside of the table range. It was not added to the table, please fix your setup.`],["The merged cell declared at [",", ",`] is positioned\\x20
      (or positioned partially) outside of the table range. It was not added to the table, please fix your setup.`])),r.row,r.col)}},{key:"IS_SINGLE_CELL",value:function(r){return ft(eH||(eH=Ry(["The merged cell declared at [",", ",`] has both "rowspan" 
      and "colspan" declared as "1", which makes it a single cell. It cannot be added to the collection.`],["The merged cell declared at [",", ",`] has both "rowspan"\\x20
      and "colspan" declared as "1", which makes it a single cell. It cannot be added to the collection.`])),r.row,r.col)}},{key:"ZERO_SPAN_WARNING",value:function(r){return ft(tH||(tH=Ry(["The merged cell declared at [",", ",`] has "rowspan" 
      or "colspan" declared as "0", which is not supported. It cannot be added to the collection.`],["The merged cell declared at [",", ",`] has "rowspan"\\x20
      or "colspan" declared as "0", which is not supported. It cannot be added to the collection.`])),r.row,r.col)}},{key:"containsNegativeValues",value:function(r){return r.row<0||r.col<0||r.rowspan<0||r.colspan<0}},{key:"isSingleCell",value:function(r){return r.colspan===1&&r.rowspan===1}},{key:"containsZeroSpan",value:function(r){return r.colspan===0||r.rowspan===0}},{key:"isOutOfBounds",value:function(r,n,o){return r.row<0||r.col<0||r.row>=n||r.row+r.rowspan-1>=n||r.col>=o||r.col+r.colspan-1>=o}}]),e}();const Tn=CBe;function BO(e,t,r,n){t?t.row===r&&t.col===n?(e.setAttribute("rowspan",t.rowspan.toString()),e.setAttribute("colspan",t.colspan.toString())):(e.removeAttribute("rowspan"),e.removeAttribute("colspan"),e.style.display="none"):(e.removeAttribute("rowspan"),e.removeAttribute("colspan"),e.style.display="")}function md(e){"@babel/helpers - typeof";return md=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},md(e)}var nH;function _Be(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function oH(e){return TBe(e)||EBe(e)||RBe(e)||OBe()}function OBe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function RBe(e,t){if(e){if(typeof e=="string")return VO(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return VO(e,t)}}function EBe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function TBe(e){if(Array.isArray(e))return VO(e)}function VO(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function kBe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function iH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,$Be(n.key),n)}}function PBe(e,t,r){return t&&iH(e.prototype,t),r&&iH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function $Be(e){var t=ABe(e,"string");return md(t)==="symbol"?t:String(t)}function ABe(e,t){if(md(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(md(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var IBe=function(){function e(t){kBe(this,e),this.plugin=t,this.mergedCells=[],this.hot=t.hot}return PBe(e,[{key:"get",value:function(r,n){var o=this.mergedCells,i=!1;return I(o,function(a){return a.row<=r&&a.row+a.rowspan-1>=r&&a.col<=n&&a.col+a.colspan-1>=n?(i=a,!1):!0}),i}},{key:"getByRange",value:function(r){var n=this.mergedCells,o=!1;return I(n,function(i){return i.row<=r.from.row&&i.row+i.rowspan-1>=r.to.row&&i.col<=r.from.col&&i.col+i.colspan-1>=r.to.col?(o=i,o):!0}),o}},{key:"getWithinRange",value:function(r){var n=this,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,i=this.mergedCells,a=[],l=r;if(!l.includesRange){var s=this.hot._createCellCoords(l.from.row,l.from.col),u=this.hot._createCellCoords(l.to.row,l.to.col);l=this.hot._createCellRange(s,s,u)}return I(i,function(f){var c=n.hot._createCellCoords(f.row,f.col),h=n.hot._createCellCoords(f.row+f.rowspan-1,f.col+f.colspan-1),d=n.hot._createCellRange(c,c,h);o?l.overlaps(d)&&a.push(f):l.includesRange(d)&&a.push(f)}),a.length?a:!1}},{key:"add",value:function(r){var n=this.mergedCells,o=r.row,i=r.col,a=r.rowspan,l=r.colspan,s=new Tn(o,i,a,l,this.hot._createCellCoords,this.hot._createCellRange),u=this.get(o,i),f=this.isOverlapping(s);return!u&&!f?(this.hot&&s.normalize(this.hot),n.push(s),s):(yt(e.IS_OVERLAPPING_WARNING(s)),!1)}},{key:"remove",value:function(r,n){var o=this.mergedCells,i=this.get(r,n),a=i?this.mergedCells.indexOf(i):-1;return i&&a!==-1?(o.splice(a,1),i):!1}},{key:"clear",value:function(){var r=this,n=this.mergedCells,o=[],i=[];I(n,function(a){var l=r.hot.getCell(a.row,a.col);l&&o.push([l,r.get(a.row,a.col),a.row,a.col])}),this.mergedCells.length=0,I(o,function(a,l){_e(0,a.rowspan-1,function(s){_e(0,a.colspan-1,function(u){if(u!==0||s!==0){var f=r.hot.getCell(a.row+s,a.col+u);f&&i.push([f,null,null,null])}})}),o[l][1]=null}),I(o,function(a){BO.apply(void 0,oH(a))}),I(i,function(a){BO.apply(void 0,oH(a))})}},{key:"isOverlapping",value:function(r){var n=this,o=this.hot._createCellRange(this.hot._createCellCoords(0,0),this.hot._createCellCoords(r.row,r.col),this.hot._createCellCoords(r.row+r.rowspan-1,r.col+r.colspan-1)),i=!1;return I(this.mergedCells,function(a){var l=n.hot._createCellRange(n.hot._createCellCoords(0,0),n.hot._createCellCoords(a.row,a.col),n.hot._createCellCoords(a.row+a.rowspan-1,a.col+a.colspan-1));return l.overlaps(o)?(i=!0,!1):!0}),i}},{key:"isFirstRenderableMergedCell",value:function(r,n){var o=this.get(r,n);return o&&this.hot.rowIndexMapper.getNearestNotHiddenIndex(o.row,1)===r&&this.hot.columnIndexMapper.getNearestNotHiddenIndex(o.col,1)===n}},{key:"getFirstRenderableCoords",value:function(r,n){var o=this.get(r,n);if(!o||this.isFirstRenderableMergedCell(r,n))return this.hot._createCellCoords(r,n);var i=this.hot.rowIndexMapper.getNearestNotHiddenIndex(o.row,1),a=this.hot.columnIndexMapper.getNearestNotHiddenIndex(o.col,1);return this.hot._createCellCoords(i,a)}},{key:"shiftCollections",value:function(r,n,o){var i=this,a=[0,0];switch(r){case"right":a[0]+=o;break;case"left":a[0]-=o;break;case"down":a[1]+=o;break;case"up":a[1]-=o;break}I(this.mergedCells,function(l){l.shift(a,n)}),CC(this.mergedCells.length-1,0,function(l){var s=i.mergedCells[l];s&&s.removed&&i.mergedCells.splice(i.mergedCells.indexOf(s),1)})}}],[{key:"IS_OVERLAPPING_WARNING",value:function(r){return ft(nH||(nH=_Be(["The merged cell declared at [",", ",`], overlaps 
      with the other declared merged cell. The overlapping merged cell was not added to the table, please 
      fix your setup.`],["The merged cell declared at [",", ",`], overlaps\\x20
      with the other declared merged cell. The overlapping merged cell was not added to the table, please\\x20
      fix your setup.`])),r.row,r.col)}}]),e}();const MBe=IBe;function pd(e){"@babel/helpers - typeof";return pd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},pd(e)}function Wi(e,t){return HBe(e)||NBe(e,t)||DBe(e,t)||xBe()}function xBe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function DBe(e,t){if(e){if(typeof e=="string")return aH(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return aH(e,t)}}function aH(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function NBe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function HBe(e){if(Array.isArray(e))return e}function LBe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function lH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,FBe(n.key),n)}}function jBe(e,t,r){return t&&lH(e.prototype,t),r&&lH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function FBe(e){var t=BBe(e,"string");return pd(t)==="symbol"?t:String(t)}function BBe(e,t){if(pd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(pd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var VBe=function(){function e(t){LBe(this,e),this.plugin=t,this.mergedCellsCollection=this.plugin.mergedCellsCollection,this.currentFillData=null}return jBe(e,[{key:"correctSelectionAreaSize",value:function(r){if(r[0]===r[2]&&r[1]===r[3]){var n=this.mergedCellsCollection.get(r[0],r[1]);n&&(r[2]=r[0]+n.rowspan-1,r[3]=r[1]+n.colspan-1)}}},{key:"getDirection",value:function(r,n){var o=null;return n[0]===r[0]&&n[1]===r[1]&&n[3]===r[3]?o="down":n[2]===r[2]&&n[1]===r[1]&&n[3]===r[3]?o="up":n[1]===r[1]&&n[2]===r[2]?o="right":o="left",o}},{key:"snapDragArea",value:function(r,n,o,i){var a=n.slice(0),l=this.getAutofillSize(r,n,o),s=Wi(r,4),u=s[0],f=s[1],c=s[2],h=s[3],d=["up","down"].indexOf(o)>-1,v=d?c-u+1:h-f+1,y=Math.floor(l/v)*v,p=l-y,w=this.getFarthestCollection(r,n,o,i);if(w){if(o==="down"){var S=w.row+w.rowspan-u-p,C=a[2]+S;C>=this.plugin.hot.countRows()?a[2]-=p:a[2]+=p?S:0}else if(o==="right"){var P=w.col+w.colspan-f-p,R=a[3]+P;R>=this.plugin.hot.countCols()?a[3]-=p:a[3]+=p?P:0}else if(o==="up"){var W=c-p-w.row+1,Y=a[0]+W;Y<0?a[0]+=p:a[0]-=p?W:0}else if(o==="left"){var q=h-p-w.col+1,G=a[1]+q;G<0?a[1]+=p:a[1]-=p?q:0}}return this.updateCurrentFillCache({baseArea:r,dragDirection:o,foundMergedCells:i,fillSize:l,dragArea:a,cycleLength:v}),a}},{key:"updateCurrentFillCache",value:function(r){this.currentFillData||(this.currentFillData={}),Wt(this.currentFillData,r)}},{key:"getAutofillSize",value:function(r,n,o){var i=Wi(r,4),a=i[0],l=i[1],s=i[2],u=i[3],f=Wi(n,4),c=f[0],h=f[1],d=f[2],v=f[3];switch(o){case"up":return a-c;case"down":return d-s;case"left":return l-h;case"right":return v-u;default:return null}}},{key:"getDragArea",value:function(r,n,o){var i=Wi(r,4),a=i[0],l=i[1],s=i[2],u=i[3],f=Wi(n,4),c=f[0],h=f[1],d=f[2],v=f[3];switch(o){case"up":return[c,h,a-1,u];case"down":return[s+1,l,d,u];case"left":return[c,h,s,l-1];case"right":return[a,u+1,d,v];default:return null}}},{key:"getFarthestCollection",value:function(r,n,o,i){var a=Wi(r,4),l=a[0],s=a[1],u=a[2],f=a[3],c=["up","down"].indexOf(o)>-1,h=c?u:f,d=c?l:s,v=this.getAutofillSize(r,n,o),y=c?u-l+1:f-s+1,p=Math.floor(v/y)*y,w=v-p,S=null,C=null,P=null;switch(o){case"up":S="includesVertically",P=h-w+1;break;case"left":S="includesHorizontally",P=h-w+1;break;case"down":S="includesVertically",P=d+w-1;break;case"right":S="includesHorizontally",P=d+w-1;break}return I(i,function(R){R[S](P)&&R.isFarther(C,o)&&(C=R)}),C}},{key:"recreateAfterDataPopulation",value:function(r){if(this.currentFillData){var n=this.getRangeFromChanges(r),o=this.currentFillData.foundMergedCells,i=this.currentFillData.dragDirection,a=function(h,d){switch(i){case"up":return h.row-d>=n.from.row;case"down":return h.row+h.rowspan-1+d<=n.to.row;case"left":return h.col-d>=n.from.column;case"right":return h.col+h.colspan-1+d<=n.to.column;default:return null}},l=0,s=null,u=1;do for(var f=0;f<o.length;f+=1){if(s=o[f],l=u*this.currentFillData.cycleLength,a(s,l))switch(i){case"up":this.plugin.mergedCellsCollection.add({row:s.row-l,rowspan:s.rowspan,col:s.col,colspan:s.colspan});break;case"down":this.plugin.mergedCellsCollection.add({row:s.row+l,rowspan:s.rowspan,col:s.col,colspan:s.colspan});break;case"left":this.plugin.mergedCellsCollection.add({row:s.row,rowspan:s.rowspan,col:s.col-l,colspan:s.colspan});break;case"right":this.plugin.mergedCellsCollection.add({row:s.row,rowspan:s.rowspan,col:s.col+l,colspan:s.colspan});break}f===o.length-1&&(u+=1)}while(a(s,l));this.currentFillData=null,this.plugin.hot.render(),o.length>0&&this.plugin.ifChromeForceRepaint()}}},{key:"getRangeFromChanges",value:function(r){var n=this,o={min:null,max:null},i={min:null,max:null};return I(r,function(a){var l=a[0],s=n.plugin.hot.propToCol(a[1]);(o.min===null||l<o.min)&&(o.min=l),(o.max===null||l>o.max)&&(o.max=l),(i.min===null||s<i.min)&&(i.min=s),(i.max===null||s>i.max)&&(i.max=s)}),{from:{row:o.min,column:i.min},to:{row:o.max,column:i.max}}}},{key:"dragAreaOverlapsCollections",value:function(r,n,o){var i=this.getDragArea(r,n,o),a=Wi(i,4),l=a[0],s=a[1],u=a[2],f=a[3],c=this.plugin.hot._createCellCoords(l,s),h=this.plugin.hot._createCellCoords(u,f),d=this.plugin.hot._createCellRange(c,c,h);return!!this.mergedCellsCollection.getWithinRange(d,!0)}}]),e}();const WBe=VBe;function bd(e){"@babel/helpers - typeof";return bd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},bd(e)}function UBe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function sH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,YBe(n.key),n)}}function zBe(e,t,r){return t&&sH(e.prototype,t),r&&sH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function YBe(e){var t=GBe(e,"string");return bd(t)==="symbol"?t:String(t)}function GBe(e,t){if(bd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(bd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var KBe=function(){function e(t){UBe(this,e),this.plugin=t,this.hot=t.hot,this.fullySelectedMergedCellClassName="fullySelectedMergedCell"}return zBe(e,[{key:"snapDelta",value:function(r,n,o){var i=n.to,a=i.row+r.row,l=i.col+r.col;r.row?this.jumpOverMergedCell(r,o,a):r.col&&this.jumpOverMergedCell(r,o,l)}},{key:"jumpOverMergedCell",value:function(r,n,o){var i=r.row||r.col,a=null,l=null,s=null;r.row?(a=n.includesVertically(o),l=n.row,s=n.getLastRow()):r.col&&(a=n.includesHorizontally(o),l=n.col,s=n.getLastColumn()),i!==0&&(i>0?a&&o!==l&&(i+=s-o+1):a&&o!==s&&(i-=o-l+1),r.row?r.row=i:r.col&&(r.col=i))}},{key:"getUpdatedSelectionRange",value:function(r,n){return this.hot._createCellRange(r.highlight,r.from,this.hot._createCellCoords(r.to.row+n.row,r.to.col+n.col))}},{key:"getSelectedMergedCellClassName",value:function(r,n,o,i){var a=Math.min(o[0],o[2]),l=Math.min(o[1],o[3]),s=Math.max(o[0],o[2]),u=Math.max(o[1],o[3]);if(i!==void 0){var f=this.plugin.mergedCellsCollection.isFirstRenderableMergedCell(r,n);if(f){var c=this.plugin.mergedCellsCollection.get(r,n);if(c){var h=c.getLastRow(),d=c.getLastColumn(),v=a<=c.row&&l<=c.col&&s>=h&&u>=d;if(v)return"".concat(this.fullySelectedMergedCellClassName,"-").concat(i);if(this.plugin.selectionCalculations.isMergeCellFullySelected(c,this.plugin.hot.getSelectedRange()))return"".concat(this.fullySelectedMergedCellClassName,"-multiple")}}}}},{key:"isMergeCellFullySelected",value:function(r,n){var o=[];if(!n||!r)return!1;for(var i=0;i<r.rowspan;i+=1)for(var a=0;a<r.colspan;a+=1)o.push(this.hot._createCellCoords(r.row+i,r.col+a));for(var l=0;l<o.length;l+=1){for(var s=[],u=0;u<n.length;u+=1)s[u]=n[u].includes(o[l]);if(!s.includes(!0))return!1}return!0}},{key:"getSelectedMergedCellClassNameToRemove",value:function(){for(var r=[],n=0;n<=7;n+=1)r.push("".concat(this.fullySelectedMergedCellClassName,"-").concat(n));return r.push("".concat(this.fullySelectedMergedCellClassName,"-multiple")),r}}]),e}();const qBe=KBe;function XBe(e){return{key:"mergeCells",name:function(){var r=this.getSelectedLast();if(r){var n=e.mergedCellsCollection.get(r[0],r[1]);if(n.row===r[0]&&n.col===r[1]&&n.row+n.rowspan-1===r[2]&&n.col+n.colspan-1===r[3])return this.getTranslatedPhrase(R0)}return this.getTranslatedPhrase(O0)},callback:function(){e.toggleMergeOnSelection()},disabled:function(){var r=this.getSelectedLast();if(!r)return!0;var n=Tn.isSingleCell({row:r[0],col:r[1],rowspan:r[2]-r[0]+1,colspan:r[3]-r[1]+1});return n||this.selection.isSelectedByCorner()},hidden:!1}}function Wu(e){"@babel/helpers - typeof";return Wu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Wu(e)}function ZBe(e,t){return eVe(e)||JBe(e,t)||FU(e,t)||QBe()}function QBe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function JBe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function eVe(e){if(Array.isArray(e))return e}function tVe(e){return oVe(e)||nVe(e)||FU(e)||rVe()}function rVe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function FU(e,t){if(e){if(typeof e=="string")return WO(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return WO(e,t)}}function nVe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function oVe(e){if(Array.isArray(e))return WO(e)}function WO(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function iVe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function uH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,lVe(n.key),n)}}function aVe(e,t,r){return t&&uH(e.prototype,t),r&&uH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function lVe(e){var t=sVe(e,"string");return Wu(t)==="symbol"?t:String(t)}function sVe(e,t){if(Wu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Wu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Zl(){return typeof Reflect<"u"&&Reflect.get?Zl=Reflect.get.bind():Zl=function(t,r,n){var o=uVe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Zl.apply(this,arguments)}function uVe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=pi(e),e!==null););return e}function fVe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&UO(e,t)}function UO(e,t){return UO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},UO(e,t)}function cVe(e){var t=dVe();return function(){var n=pi(e),o;if(t){var i=pi(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return hVe(this,o)}}function hVe(e,t){if(t&&(Wu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return BU(e)}function BU(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function dVe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function pi(e){return pi=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},pi(e)}ge.getSingleton().register("beforeMergeCells");ge.getSingleton().register("afterMergeCells");ge.getSingleton().register("beforeUnmergeCells");ge.getSingleton().register("afterUnmergeCells");var oc="mergeCells",vVe=150,fH=new WeakMap,cH=oc,yVe=function(e){fVe(r,e);var t=cVe(r);function r(n){var o;return iVe(this,r),o=t.call(this,n),fH.set(BU(o),{lastDesiredCoords:null}),o.mergedCellsCollection=null,o.autofillCalculations=null,o.selectionCalculations=null,o}return aVe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[oc]}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.mergedCellsCollection=new MBe(this),this.autofillCalculations=new WBe(this),this.selectionCalculations=new qBe(this),this.addHook("afterInit",function(){return o.onAfterInit.apply(o,arguments)}),this.addHook("modifyTransformStart",function(){return o.onModifyTransformStart.apply(o,arguments)}),this.addHook("afterModifyTransformStart",function(){return o.onAfterModifyTransformStart.apply(o,arguments)}),this.addHook("modifyTransformEnd",function(){return o.onModifyTransformEnd.apply(o,arguments)}),this.addHook("modifyGetCellCoords",function(){return o.onModifyGetCellCoords.apply(o,arguments)}),this.addHook("beforeSetRangeStart",function(){return o.onBeforeSetRangeStart.apply(o,arguments)}),this.addHook("beforeSetRangeStartOnly",function(){return o.onBeforeSetRangeStart.apply(o,arguments)}),this.addHook("beforeSetRangeEnd",function(){return o.onBeforeSetRangeEnd.apply(o,arguments)}),this.addHook("afterIsMultipleSelection",function(){return o.onAfterIsMultipleSelection.apply(o,arguments)}),this.addHook("afterRenderer",function(){return o.onAfterRenderer.apply(o,arguments)}),this.addHook("afterContextMenuDefaultOptions",function(){return o.addMergeActionsToContextMenu.apply(o,arguments)}),this.addHook("afterGetCellMeta",function(){return o.onAfterGetCellMeta.apply(o,arguments)}),this.addHook("afterViewportRowCalculatorOverride",function(){return o.onAfterViewportRowCalculatorOverride.apply(o,arguments)}),this.addHook("afterViewportColumnCalculatorOverride",function(){return o.onAfterViewportColumnCalculatorOverride.apply(o,arguments)}),this.addHook("modifyAutofillRange",function(){return o.onModifyAutofillRange.apply(o,arguments)}),this.addHook("afterCreateCol",function(){return o.onAfterCreateCol.apply(o,arguments)}),this.addHook("afterRemoveCol",function(){return o.onAfterRemoveCol.apply(o,arguments)}),this.addHook("afterCreateRow",function(){return o.onAfterCreateRow.apply(o,arguments)}),this.addHook("afterRemoveRow",function(){return o.onAfterRemoveRow.apply(o,arguments)}),this.addHook("afterChange",function(){return o.onAfterChange.apply(o,arguments)}),this.addHook("beforeDrawBorders",function(){return o.onBeforeDrawAreaBorders.apply(o,arguments)}),this.addHook("afterDrawSelection",function(){return o.onAfterDrawSelection.apply(o,arguments)}),this.addHook("beforeRemoveCellClassNames",function(){return o.onBeforeRemoveCellClassNames.apply(o,arguments)}),this.addHook("beforeUndoStackChange",function(i,a){if(a==="MergeCells")return!1}),this.registerShortcuts(),Zl(pi(r.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.clearCollections(),this.unregisterShortcuts(),this.hot.render(),Zl(pi(r.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){var o=this.hot.getSettings()[oc];this.disablePlugin(),this.enablePlugin(),this.generateFromSettings(o),Zl(pi(r.prototype),"updatePlugin",this).call(this)}},{key:"ifChromeForceRepaint",value:function(){var o=this;if(IF()){var i=[],a=[];this.mergedCellsCollection.mergedCells.forEach(function(l){for(var s=l.row,u=l.rowspan,f=s+1;f<s+u;f++)a.push(f)}),a=tVe(new Set(a)),a.forEach(function(l){var s=o.hot.rowIndexMapper.getRenderableFromVisualIndex(l);o.hot.view._wt.wtOverlays.getOverlays(!0).map(function(u){return(u==null?void 0:u.name)==="master"?u:u.clone.wtTable}).forEach(function(u){var f=u.getRow(s);f&&(f.style.background=Ac(f,"backgroundColor").replace(")",", 0.99)"),i.push(f))})}),this.hot._registerTimeout(function(){i.forEach(function(l){l.style.background=Ac(l,"backgroundColor").replace(", 0.99)",")")})},1)}}},{key:"validateSetting",value:function(o){var i=!0;return o?(Tn.containsNegativeValues(o)?(yt(Tn.NEGATIVE_VALUES_WARNING(o)),i=!1):Tn.isOutOfBounds(o,this.hot.countRows(),this.hot.countCols())?(yt(Tn.IS_OUT_OF_BOUNDS_WARNING(o)),i=!1):Tn.isSingleCell(o)?(yt(Tn.IS_SINGLE_CELL(o)),i=!1):Tn.containsZeroSpan(o)&&(yt(Tn.ZERO_SPAN_WARNING(o)),i=!1),i):!1}},{key:"generateFromSettings",value:function(o){var i=this;if(Array.isArray(o)){var a=[];if(I(o,function(l){if(i.validateSetting(l)){var s=i.hot._createCellCoords(l.row,l.col),u=i.hot._createCellCoords(l.row+l.rowspan-1,l.col+l.colspan-1),f=i.hot._createCellRange(s,s,u);i.mergeRange(f,!0,!0),_e(l.row,l.row+l.rowspan-1,function(c){_e(l.col,l.col+l.colspan-1,function(h){c===l.row&&h===l.col||a.push([c,h,null])})})}}),a.length===0)return;this.hot.setDataAtCell(a)}}},{key:"clearCollections",value:function(){this.mergedCellsCollection.clear()}},{key:"canMergeRange",value:function(o){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return i?!0:this.validateSetting(o)}},{key:"toggleMergeOnSelection",value:function(){var o=this.hot.getSelectedRangeLast();if(o){o.setDirection(this.hot.isRtl()?"NE-SW":"NW-SE");var i=o.from,a=o.to;this.toggleMerge(o),this.hot.selectCell(i.row,i.col,a.row,a.col,!1)}}},{key:"mergeSelection",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hot.getSelectedRangeLast();if(o){o.setDirection(this.hot.isRtl()?"NE-SW":"NW-SE");var i=o.from,a=o.to;this.unmergeRange(o,!0),this.mergeRange(o),this.hot.selectCell(i.row,i.col,a.row,a.col,!1)}}},{key:"unmergeSelection",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hot.getSelectedRangeLast();if(o){var i=o.from,a=o.to;this.unmergeRange(o,!0),this.hot.selectCell(i.row,i.col,a.row,a.col,!1)}}},{key:"mergeRange",value:function(o){var i=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,s=o.getTopStartCorner(),u=o.getBottomEndCorner(),f={row:s.row,col:s.col,rowspan:u.row-s.row+1,colspan:u.col-s.col+1},c=[],h=null;if(!this.canMergeRange(f,a))return!1;this.hot.runHooks("beforeMergeCells",o,a),_e(0,f.rowspan-1,function(v){_e(0,f.colspan-1,function(y){var p=null;c[v]||(c[v]=[]),v===0&&y===0?p=i.hot.getSourceDataAtCell(i.hot.toPhysicalRow(f.row),i.hot.toPhysicalColumn(f.col)):i.hot.setCellMeta(f.row+v,f.col+y,"hidden",!0),c[v][y]=p})}),this.hot.setCellMeta(f.row,f.col,"spanned",!0);var d=this.mergedCellsCollection.add(f);return d?(l?h=[f.row,f.col,c]:this.hot.populateFromArray(f.row,f.col,c,void 0,void 0,this.pluginName),a||this.ifChromeForceRepaint(),this.hot.runHooks("afterMergeCells",o,f,a),h):!0}},{key:"unmergeRange",value:function(o){var i=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,l=this.mergedCellsCollection.getWithinRange(o);l&&(this.hot.runHooks("beforeUnmergeCells",o,a),I(l,function(s){i.mergedCellsCollection.remove(s.row,s.col),_e(0,s.rowspan-1,function(u){_e(0,s.colspan-1,function(f){i.hot.removeCellMeta(s.row+u,s.col+f,"hidden")})}),i.hot.removeCellMeta(s.row,s.col,"spanned")}),this.hot.runHooks("afterUnmergeCells",o,a),this.hot.render())}},{key:"toggleMerge",value:function(o){var i=this.mergedCellsCollection.get(o.from.row,o.from.col),a=i.row===o.from.row&&i.col===o.from.col&&i.row+i.rowspan-1===o.to.row&&i.col+i.colspan-1===o.to.col;a?this.unmergeRange(o):this.mergeSelection(o)}},{key:"merge",value:function(o,i,a,l){var s=this.hot._createCellCoords(o,i),u=this.hot._createCellCoords(a,l);this.mergeRange(this.hot._createCellRange(s,s,u))}},{key:"unmerge",value:function(o,i,a,l){var s=this.hot._createCellCoords(o,i),u=this.hot._createCellCoords(a,l);this.unmergeRange(this.hot._createCellRange(s,s,u))}},{key:"onAfterInit",value:function(){this.generateFromSettings(this.hot.getSettings()[oc]),this.hot.render()}},{key:"registerShortcuts",value:function(){var o=this,i=this.hot.getShortcutManager(),a=i.getContext("grid");a.addShortcut({keys:[["Control","m"]],callback:function(){o.toggleMerge(o.hot.getSelectedRangeLast()),o.hot.render()},runOnlyIf:function(s){return!s.altKey},group:cH})}},{key:"unregisterShortcuts",value:function(){var o=this.hot.getShortcutManager(),i=o.getContext("grid");i.removeShortcutsByGroup(cH)}},{key:"onAfterIsMultipleSelection",value:function(o){if(o){for(var i=this.mergedCellsCollection.mergedCells,a=this.hot.getSelectedRangeLast(),l=0;l<i.length;l+=1)if(a.from.row===i[l].row&&a.from.col===i[l].col&&a.to.row===i[l].row+i[l].rowspan-1&&a.to.col===i[l].col+i[l].colspan-1)return!1}return o}},{key:"onModifyTransformStart",value:function(o){var i=fH.get(this),a=this.hot.getSelectedRangeLast(),l={row:o.row,col:o.col},s=null,u=this.hot._createCellCoords(a.highlight.row,a.highlight.col),f=this.mergedCellsCollection.get(u.row,u.col);if(i.lastDesiredCoords||(i.lastDesiredCoords=this.hot._createCellCoords(null,null)),f){var c=this.hot._createCellCoords(f.row,f.col),h=this.hot._createCellCoords(f.row+f.rowspan-1,f.col+f.colspan-1),d=this.hot._createCellRange(c,c,h);d.includes(i.lastDesiredCoords)||(i.lastDesiredCoords=this.hot._createCellCoords(null,null)),l.row=i.lastDesiredCoords.row?i.lastDesiredCoords.row-u.row:l.row,l.col=i.lastDesiredCoords.col?i.lastDesiredCoords.col-u.col:l.col,o.row>0?l.row=f.row+f.rowspan-1-u.row+o.row:o.row<0&&(l.row=u.row-f.row+o.row),o.col>0?l.col=f.col+f.colspan-1-u.col+o.col:o.col<0&&(l.col=u.col-f.col+o.col)}s=this.hot._createCellCoords(a.highlight.row+l.row,a.highlight.col+l.col);var v=this.mergedCellsCollection.get(s.row,s.col);if(v){var y=this.mergedCellsCollection.getFirstRenderableCoords(v.row,v.col);i.lastDesiredCoords=s,l={row:y.row-u.row,col:y.col-u.col}}l.row!==0&&(o.row=l.row),l.col!==0&&(o.col=l.col)}},{key:"onModifyTransformEnd",value:function(o){var i=this,a=this.hot.getSelectedRangeLast(),l=_r(o),s=this.selectionCalculations.getUpdatedSelectionRange(a,o),u=_r(l),f=this.mergedCellsCollection.getWithinRange(s,!0);do u=_r(l),this.selectionCalculations.getUpdatedSelectionRange(a,l),I(f,function(c){i.selectionCalculations.snapDelta(l,a,c)});while(l.row!==u.row||l.col!==u.col);o.row=l.row,o.col=l.col}},{key:"onModifyGetCellCoords",value:function(o,i){if(!(o<0||i<0)){var a=this.mergedCellsCollection.get(o,i);if(a){var l=a.row,s=a.col,u=a.colspan,f=a.rowspan;return[l,s,l+f-1,s+u-1]}}}},{key:"addMergeActionsToContextMenu",value:function(o){o.items.push({name:"---------"},XBe(this))}},{key:"onAfterRenderer",value:function(o,i,a){var l=this.mergedCellsCollection.get(i,a),s=Ge(l)?_r(l):void 0;if(Ge(s)){var u=this.hot,f=u.rowIndexMapper,c=u.columnIndexMapper,h=s.row,d=s.col,v=s.colspan,y=s.rowspan,p=this.translateMergedCellToRenderable(h,y,d,v),w=ZBe(p,2),S=w[0],C=w[1],P=f.getRenderableFromVisualIndex(i),R=c.getRenderableFromVisualIndex(a),W=S-P+1,Y=C-R+1;s.row=f.getNearestNotHiddenIndex(s.row,1),s.col=c.getNearestNotHiddenIndex(s.col,1),s.rowspan=Math.min(s.rowspan,W),s.colspan=Math.min(s.colspan,Y)}BO(o,s,i,a)}},{key:"onBeforeSetRangeStart",value:function(o){if(this.mergedCellsCollection.isFirstRenderableMergedCell(o.row,o.col)){var i=this.mergedCellsCollection.get(o.row,o.col),a=[i.row,i.col];o.row=a[0],o.col=a[1]}}},{key:"onBeforeSetRangeEnd",value:function(o){var i=this.hot.getSelectedRangeLast();i.highlight=this.hot._createCellCoords(i.highlight.row,i.highlight.col),i.to=o;var a=!1;if(!(this.hot.selection.isSelectedByColumnHeader()||this.hot.selection.isSelectedByRowHeader()))do{a=!1;for(var l=0;l<this.mergedCellsCollection.mergedCells.length;l+=1){var s=this.mergedCellsCollection.mergedCells[l],u=s.getRange();i.expandByRange(u)&&(o.row=i.to.row,o.col=i.to.col,a=!0)}}while(a)}},{key:"onAfterGetCellMeta",value:function(o,i,a){var l=this.mergedCellsCollection.get(o,i);l&&(l.row!==o||l.col!==i?a.copyable=!1:(a.rowspan=l.rowspan,a.colspan=l.colspan))}},{key:"onAfterViewportRowCalculatorOverride",value:function(o){var i=this.hot.countCols();this.modifyViewportRowStart(o,i),this.modifyViewportRowEnd(o,i)}},{key:"modifyViewportRowStart",value:function(o,i){for(var a=this.hot.rowIndexMapper,l=a.getVisualFromRenderableIndex(o.startRow),s=0;s<i;s+=1){var u=this.mergedCellsCollection.get(l,s);if(Ge(u)){var f=a.getRenderableFromVisualIndex(a.getNearestNotHiddenIndex(u.row,1));if(f<o.startRow){o.startRow=f,this.modifyViewportRowStart(o,i);return}}}}},{key:"modifyViewportRowEnd",value:function(o,i){for(var a=this.hot.rowIndexMapper,l=a.getVisualFromRenderableIndex(o.endRow),s=0;s<i;s+=1){var u=this.mergedCellsCollection.get(l,s);if(Ge(u)){var f=u.row+u.rowspan-1,c=a.getRenderableFromVisualIndex(a.getNearestNotHiddenIndex(f,-1));if(c>o.endRow){o.endRow=c,this.modifyViewportRowEnd(o,i);return}}}}},{key:"onAfterViewportColumnCalculatorOverride",value:function(o){var i=this.hot.countRows();this.modifyViewportColumnStart(o,i),this.modifyViewportColumnEnd(o,i)}},{key:"modifyViewportColumnStart",value:function(o,i){for(var a=this.hot.columnIndexMapper,l=a.getVisualFromRenderableIndex(o.startColumn),s=0;s<i;s+=1){var u=this.mergedCellsCollection.get(s,l);if(Ge(u)){var f=a.getRenderableFromVisualIndex(a.getNearestNotHiddenIndex(u.col,1));if(f<o.startColumn){o.startColumn=f,this.modifyViewportColumnStart(o,i);return}}}}},{key:"modifyViewportColumnEnd",value:function(o,i){for(var a=this.hot.columnIndexMapper,l=a.getVisualFromRenderableIndex(o.endColumn),s=0;s<i;s+=1){var u=this.mergedCellsCollection.get(s,l);if(Ge(u)){var f=u.col+u.colspan-1,c=a.getRenderableFromVisualIndex(a.getNearestNotHiddenIndex(f,-1));if(c>o.endColumn){o.endColumn=c,this.modifyViewportColumnEnd(o,i);return}}}}},{key:"translateMergedCellToRenderable",value:function(o,i,a,l){var s=this.hot,u=s.rowIndexMapper,f=s.columnIndexMapper,c,h;i===0?c=u.getNearestNotHiddenIndex(o,1):c=u.getNearestNotHiddenIndex(o+i-1,-1),l===0?h=f.getNearestNotHiddenIndex(a,1):h=f.getNearestNotHiddenIndex(a+l-1,-1);var d=o>=0?u.getRenderableFromVisualIndex(c):o,v=a>=0?f.getRenderableFromVisualIndex(h):a;return[d,v]}},{key:"onModifyAutofillRange",value:function(o,i){this.autofillCalculations.correctSelectionAreaSize(i);var a=this.autofillCalculations.getDirection(i,o),l=o;if(this.autofillCalculations.dragAreaOverlapsCollections(i,l,a))return l=i,l;var s=this.mergedCellsCollection.getWithinRange({from:{row:i[0],col:i[1]},to:{row:i[2],col:i[3]}});return s&&(l=this.autofillCalculations.snapDragArea(i,l,a,s)),l}},{key:"onAfterCreateCol",value:function(o,i){this.mergedCellsCollection.shiftCollections("right",o,i)}},{key:"onAfterRemoveCol",value:function(o,i){this.mergedCellsCollection.shiftCollections("left",o,i)}},{key:"onAfterCreateRow",value:function(o,i,a){a!=="auto"&&this.mergedCellsCollection.shiftCollections("down",o,i)}},{key:"onAfterRemoveRow",value:function(o,i){this.mergedCellsCollection.shiftCollections("up",o,i)}},{key:"onAfterChange",value:function(o,i){i==="Autofill.fill"&&this.autofillCalculations.recreateAfterDataPopulation(o)}},{key:"onBeforeDrawAreaBorders",value:function(o,i){if(i&&i==="area"){var a=this.hot.getSelectedRangeLast(),l=this.mergedCellsCollection.getWithinRange(a);I(l,function(s){a.getBottomEndCorner().row===s.getLastRow()&&a.getBottomEndCorner().col===s.getLastColumn()&&(o[2]=s.row,o[3]=s.col)})}}},{key:"onAfterModifyTransformStart",value:function(o,i,a){if(this.enabled){var l=this.mergedCellsCollection.get(o.row,o.col);if(l){var s=i>0,u=i<0,f=a<0,c=a>0,h=l.row+l.rowspan-1===this.hot.countRows()-1,d=l.row===0,v=l.col+l.colspan-1===this.hot.countCols()-1,y=l.col===0;(s&&h||u&&d||c&&v||f&&y)&&(o.row=l.row,o.col=l.col)}}}},{key:"onAfterDrawSelection",value:function(o,i,a,l){if(a)return this.selectionCalculations.getSelectedMergedCellClassName(o,i,a,l)}},{key:"onBeforeRemoveCellClassNames",value:function(){return this.selectionCalculations.getSelectedMergedCellClassNameToRemove()}}],[{key:"PLUGIN_KEY",get:function(){return oc}},{key:"PLUGIN_PRIORITY",get:function(){return vVe}}]),r}(it);function hH(e){return bVe(e)||pVe(e)||mVe(e)||gVe()}function gVe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function mVe(e,t){if(e){if(typeof e=="string")return dH(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return dH(e,t)}}function dH(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function pVe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function bVe(e){if(Array.isArray(e))return e}function wVe(e,t){return function(r,n){var o=hH(r),i=o.slice(1),a=hH(n),l=a.slice(1);return function s(u){var f=e[u],c=t[u],h=i[u],d=l[u],v=c.multiColumnSorting,y=v.compareFunctionFactory?v.compareFunctionFactory:C2(c.type),p=y(f,c,v)(h,d);if(p===In){var w=u+1;if(typeof t[w]<"u")return s(w)}return p}(0)}}var vH;function SVe(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function yH(){yt(ft(vH||(vH=SVe(["Plugins `columnSorting` and `multiColumnSorting` should not be enabled simultaneously. \n    Only `multiColumnSorting` will work."],["Plugins \\`columnSorting\\` and \\`multiColumnSorting\\` should not be enabled simultaneously. \n    Only \\`multiColumnSorting\\` will work."]))))}var VU="sort";function CVe(e,t,r){var n=[];return r===!1||e.isColumnSorted(t)&&e.getNumberOfSortedColumns()>1&&n.push("".concat(VU,"-").concat(e.getIndexOfColumnInSortQueue(t)+1)),n}function _Ve(e){var t=e.className.split(" "),r=new RegExp("^".concat(VU,"-[0-9]{1,2}$"));return t.filter(function(n){return r.test(n)})}function Uu(e){"@babel/helpers - typeof";return Uu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Uu(e)}function OVe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function gH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,EVe(n.key),n)}}function RVe(e,t,r){return t&&gH(e.prototype,t),r&&gH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function EVe(e){var t=TVe(e,"string");return Uu(t)==="symbol"?t:String(t)}function TVe(e,t){if(Uu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Uu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Mr(){return typeof Reflect<"u"&&Reflect.get?Mr=Reflect.get.bind():Mr=function(t,r,n){var o=kVe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Mr.apply(this,arguments)}function kVe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=hr(e),e!==null););return e}function PVe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&zO(e,t)}function zO(e,t){return zO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},zO(e,t)}function $Ve(e){var t=MVe();return function(){var n=hr(e),o;if(t){var i=hr(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return AVe(this,o)}}function AVe(e,t){if(t&&(Uu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return IVe(e)}function IVe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function MVe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function hr(e){return hr=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},hr(e)}var YO="multiColumnSorting",xVe=170,DVe="append",mH="columnSorting";S2(YO,wVe);var NVe=function(e){PVe(r,e);var t=$Ve(r);function r(n){var o;return OVe(this,r),o=t.call(this,n),o.pluginKey=YO,o}return RVe(r,[{key:"isEnabled",value:function(){return Mr(hr(r.prototype),"isEnabled",this).call(this)}},{key:"enablePlugin",value:function(){!this.enabled&&this.hot.getSettings()[this.pluginKey]&&this.hot.getSettings()[mH]&&yH(),Mr(hr(r.prototype),"enablePlugin",this).call(this)}},{key:"disablePlugin",value:function(){Mr(hr(r.prototype),"disablePlugin",this).call(this)}},{key:"sort",value:function(o){Mr(hr(r.prototype),"sort",this).call(this,o)}},{key:"clearSort",value:function(){Mr(hr(r.prototype),"clearSort",this).call(this)}},{key:"isSorted",value:function(){return Mr(hr(r.prototype),"isSorted",this).call(this)}},{key:"getSortConfig",value:function(o){return Mr(hr(r.prototype),"getSortConfig",this).call(this,o)}},{key:"setSortConfig",value:function(o){Mr(hr(r.prototype),"setSortConfig",this).call(this,o)}},{key:"getNormalizedSortConfigs",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Array.isArray(o)?o:[o]}},{key:"updateHeaderClasses",value:function(o){for(var i,a=arguments.length,l=new Array(a>1?a-1:0),s=1;s<a;s++)l[s-1]=arguments[s];(i=Mr(hr(r.prototype),"updateHeaderClasses",this)).call.apply(i,[this,o].concat(l)),He(o,_Ve(o)),this.enabled!==!1&&re(o,CVe.apply(void 0,l))}},{key:"onUpdateSettings",value:function(o){this.hot.getSettings()[this.pluginKey]&&this.hot.getSettings()[mH]&&yH(),Mr(hr(r.prototype),"onUpdateSettings",this).call(this,o)}},{key:"onAfterOnCellMouseDown",value:function(o,i){V_(i.row,i.col,o)!==!1&&this.wasClickableHeaderClicked(o,i.col)&&(this.hot.getShortcutManager().isCtrlPressed()?(this.hot.deselectCell(),this.hot.selectColumns(i.col),this.sort(this.getNextSortConfig(i.col,DVe))):this.sort(this.getColumnNextConfig(i.col)))}}],[{key:"PLUGIN_KEY",get:function(){return YO}},{key:"PLUGIN_PRIORITY",get:function(){return xVe}}]),r}(O2);function zu(e){"@babel/helpers - typeof";return zu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},zu(e)}function HVe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function pH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,jVe(n.key),n)}}function LVe(e,t,r){return t&&pH(e.prototype,t),r&&pH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function jVe(e){var t=FVe(e,"string");return zu(t)==="symbol"?t:String(t)}function FVe(e,t){if(zu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(zu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function yg(){return typeof Reflect<"u"&&Reflect.get?yg=Reflect.get.bind():yg=function(t,r,n){var o=BVe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},yg.apply(this,arguments)}function BVe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Yu(e),e!==null););return e}function VVe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&GO(e,t)}function GO(e,t){return GO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},GO(e,t)}function WVe(e){var t=YVe();return function(){var n=Yu(e),o;if(t){var i=Yu(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return UVe(this,o)}}function UVe(e,t){if(t&&(zu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return zVe(e)}function zVe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function YVe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Yu(e){return Yu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Yu(e)}var GVe="multipleSelectionHandles",KVe=160,qVe=function(e){VVe(r,e);var t=WVe(r);function r(n){var o;return HVe(this,r),o=t.call(this,n),o.dragged=[],o.eventManager=null,o.lastSetCell=null,o}return LVe(r,[{key:"isEnabled",value:function(){return An()}},{key:"enablePlugin",value:function(){this.enabled||(this.eventManager||(this.eventManager=new Pt(this)),this.registerListeners(),yg(Yu(r.prototype),"enablePlugin",this).call(this))}},{key:"registerListeners",value:function(){var o=this,i=this,a=this.hot.rootElement;function l(s){if(i.dragged.length===1)return i.dragged.splice(0,i.dragged.length),!0;var u=i.dragged.indexOf(s);if(u===-1)return!1;u===0?i.dragged=i.dragged.slice(0,1):u===1&&(i.dragged=i.dragged.slice(-1))}this.eventManager.addEventListener(a,"touchstart",function(s){var u;if(xe(s.target,"topSelectionHandle-HitArea"))return u=i.hot.getSelectedRangeLast(),i.dragged.push("top"),i.touchStartRange={width:u.getWidth(),height:u.getHeight(),direction:u.getDirection()},s.preventDefault(),!1;if(xe(s.target,"bottomSelectionHandle-HitArea"))return u=i.hot.getSelectedRangeLast(),i.dragged.push("bottom"),i.touchStartRange={width:u.getWidth(),height:u.getHeight(),direction:u.getDirection()},s.preventDefault(),!1}),this.eventManager.addEventListener(a,"touchend",function(s){if(xe(s.target,"topSelectionHandle-HitArea"))return l.call(i,"top"),i.touchStartRange=void 0,s.preventDefault(),!1;if(xe(s.target,"bottomSelectionHandle-HitArea"))return l.call(i,"bottom"),i.touchStartRange=void 0,s.preventDefault(),!1}),this.eventManager.addEventListener(a,"touchmove",function(s){var u=o.hot.rootDocument,f,c,h,d,v,y;if(i.dragged.length!==0){var p=u.elementFromPoint(s.touches[0].clientX,s.touches[0].clientY);!p||p===i.lastSetCell||((p.nodeName==="TD"||p.nodeName==="TH")&&(f=i.hot.getCoords(p),f.col===-1&&(f.col=0),c=i.hot.getSelectedRangeLast(),h=c.getWidth(),d=c.getHeight(),v=c.getDirection(),h===1&&d===1&&i.hot.selection.setRangeEnd(f),y=i.getCurrentRangeCoords(c,f,i.touchStartRange.direction,v,i.dragged[0]),y.start!==null&&i.hot.selection.setRangeStart(y.start),i.hot.selection.setRangeEnd(y.end),i.lastSetCell=p),s.preventDefault())}})}},{key:"getCurrentRangeCoords",value:function(o,i,a,l,s){var u=o.getTopStartCorner(),f=o.getBottomEndCorner(),c=o.getBottomStartCorner(),h=o.getTopEndCorner(),d={start:null,end:null};switch(a){case"NE-SW":switch(l){case"NE-SW":case"NW-SE":s==="top"?d={start:this.hot._createCellCoords(i.row,o.highlight.col),end:this.hot._createCellCoords(c.row,i.col)}:d={start:this.hot._createCellCoords(o.highlight.row,i.col),end:this.hot._createCellCoords(i.row,u.col)};break;case"SE-NW":s==="bottom"&&(d={start:this.hot._createCellCoords(f.row,i.col),end:this.hot._createCellCoords(i.row,u.col)});break}break;case"NW-SE":switch(l){case"NE-SW":s==="top"?d={start:i,end:c}:d.end=i;break;case"NW-SE":s==="top"?d={start:i,end:f}:d.end=i;break;case"SE-NW":s==="top"?d={start:i,end:u}:d.end=i;break;case"SW-NE":s==="top"?d={start:i,end:h}:d.end=i;break}break;case"SW-NE":switch(l){case"NW-SE":s==="bottom"?d={start:this.hot._createCellCoords(i.row,u.col),end:this.hot._createCellCoords(c.row,i.col)}:d={start:this.hot._createCellCoords(u.row,i.col),end:this.hot._createCellCoords(i.row,f.col)};break;case"SW-NE":s==="top"?d={start:this.hot._createCellCoords(o.highlight.row,i.col),end:this.hot._createCellCoords(i.row,f.col)}:d={start:this.hot._createCellCoords(i.row,u.col),end:this.hot._createCellCoords(u.row,i.col)};break;case"SE-NW":s==="bottom"?d={start:this.hot._createCellCoords(i.row,h.col),end:this.hot._createCellCoords(u.row,i.col)}:s==="top"&&(d={start:c,end:i});break}break;case"SE-NW":switch(l){case"NW-SE":case"NE-SW":case"SW-NE":s==="top"&&(d.end=i);break;case"SE-NW":s==="top"?d.end=i:d={start:i,end:u};break}break}return d}},{key:"isDragged",value:function(){return this.dragged.length>0}}],[{key:"PLUGIN_KEY",get:function(){return GVe}},{key:"PLUGIN_PRIORITY",get:function(){return KVe}}]),r}(it);function KO(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=e.label,r=t===void 0?"":t,n=e.colspan,o=n===void 0?1:n,i=e.origColspan,a=i===void 0?1:i,l=e.collapsible,s=l===void 0?!1:l,u=e.crossHiddenColumns,f=u===void 0?[]:u,c=e.isCollapsed,h=c===void 0?!1:c,d=e.isHidden,v=d===void 0?!1:d,y=e.isRoot,p=y===void 0?!1:y,w=e.isPlaceholder,S=w===void 0?!1:w;return{label:r,colspan:o,origColspan:a,collapsible:s,isCollapsed:h,crossHiddenColumns:f,isHidden:v,isRoot:p,isPlaceholder:S}}function WU(){return{label:"",isPlaceholder:!0}}function bH(e){return JVe(e)||QVe(e)||ZVe(e)||XVe()}function XVe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ZVe(e,t){if(e){if(typeof e=="string")return qO(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return qO(e,t)}}function QVe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function JVe(e){if(Array.isArray(e))return qO(e)}function qO(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function eWe(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1/0,r=[];if(t===0)return r;I(e,function(o){var i=[],a=0;r.push(i),I(o,function(l){var s=KO();if(Ge(l)){var u=l.label,f=l.colspan;s.label=Ht(u),typeof f=="number"&&f>1&&(s.colspan=f,s.origColspan=f)}else s.label=Ht(l);a+=s.origColspan;var c=!1;if(a>=t&&(s.colspan=s.origColspan-(a-t),s.origColspan=s.colspan,c=!0),i.push(s),s.colspan>1)for(var h=0;h<s.colspan-1;h++)i.push(WU());return!c})});var n=Math.max.apply(Math,bH(Ye(r,function(o){return o.length})));return I(r,function(o){if(o.length<n){var i=Ye(new Array(n-o.length),function(){return KO()});o.splice.apply(o,[o.length,0].concat(bH(i)))}}),r}function wd(e){"@babel/helpers - typeof";return wd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},wd(e)}var tWe=["row","col"];function wH(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function rWe(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?wH(Object(r),!0).forEach(function(n){nWe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):wH(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function nWe(e,t,r){return t=UU(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function oWe(e,t){if(e==null)return{};var r=iWe(e,t),n,o;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)n=i[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function iWe(e,t){if(e==null)return{};var r={},n=Object.keys(e),o,i;for(i=0;i<n.length;i++)o=n[i],!(t.indexOf(o)>=0)&&(r[o]=e[o]);return r}function aWe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function SH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,UU(n.key),n)}}function lWe(e,t,r){return t&&SH(e.prototype,t),r&&SH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function UU(e){var t=sWe(e,"string");return wd(t)==="symbol"?t:String(t)}function sWe(e,t){if(wd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(wd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function vS(e,t,r){uWe(e,t),t.set(e,r)}function uWe(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function tn(e,t){var r=zU(e,t,"get");return fWe(e,r)}function fWe(e,t){return t.get?t.get.call(e):t.value}function Xf(e,t,r){var n=zU(e,t,"set");return cWe(e,n,r),r}function zU(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function cWe(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}var CH=["label","collapsible"],qn=new WeakMap,Ui=new WeakMap,yS=new WeakMap,hWe=function(){function e(){aWe(this,e),vS(this,qn,{writable:!0,value:[]}),vS(this,Ui,{writable:!0,value:0}),vS(this,yS,{writable:!0,value:1/0})}return lWe(e,[{key:"setColumnsLimit",value:function(r){Xf(this,yS,r)}},{key:"setData",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];Xf(this,qn,eWe(r,tn(this,yS))),Xf(this,Ui,tn(this,qn).length)}},{key:"getData",value:function(){return tn(this,qn)}},{key:"mergeWith",value:function(r){var n=this;I(r,function(o){var i=o.row,a=o.col,l=oWe(o,tWe),s=n.getHeaderSettings(i,a);s!==null&&Wt(s,l,CH)})}},{key:"map",value:function(r){I(tn(this,qn),function(n){I(n,function(o){var i=r(rWe({},o));Ge(i)&&Wt(o,i,CH)})})}},{key:"getHeaderSettings",value:function(r,n){var o;if(r>=tn(this,Ui)||r<0)return null;var i=tn(this,qn)[r];return n>=i.length?null:(o=i[n])!==null&&o!==void 0?o:null}},{key:"getHeadersSettings",value:function(r,n){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,i=[];if(r>=tn(this,Ui)||r<0)return i;for(var a=tn(this,qn)[r],l=0,s=n;s<a.length;s++){var u=a[s];if(u.isPlaceholder)throw new Error("The first column settings cannot overlap the other header layers");if(l+=u.colspan,i.push(u),u.colspan>1&&(s+=u.colspan-1),l===o)break;if(l>o)throw new Error("The last column settings cannot overlap the other header layers")}return i}},{key:"getLayersCount",value:function(){return tn(this,Ui)}},{key:"getColumnsCount",value:function(){return tn(this,Ui)>0?tn(this,qn)[0].length:0}},{key:"clear",value:function(){Xf(this,qn,[]),Xf(this,Ui,0)}}]),e}();function Sd(e){"@babel/helpers - typeof";return Sd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Sd(e)}function _H(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function OH(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?_H(Object(r),!0).forEach(function(n){gg(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):_H(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function dWe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function RH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,YU(n.key),n)}}function vWe(e,t,r){return t&&RH(e.prototype,t),r&&RH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function gg(e,t,r){return t=YU(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function YU(e){var t=yWe(e,"string");return Sd(t)==="symbol"?t:String(t)}function yWe(e,t){if(Sd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Sd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function gWe(e){return wWe(e)||bWe(e)||pWe(e)||mWe()}function mWe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function pWe(e,t){if(e){if(typeof e=="string")return XO(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return XO(e,t)}}function bWe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function wWe(e){if(Array.isArray(e))return XO(e)}function XO(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var SWe="DF-pre-order";function GU(e,t){for(var r=e.call(t,this),n=0;n<this.childs.length;n++){if(r===!1)return!1;r=GU.call(this.childs[n],e,t)}return r}var CWe="DF-post-order";function KU(e,t){for(var r=0;r<this.childs.length;r++){var n=KU.call(this.childs[r],e,t);if(n===!1)return!1}return e.call(t,this)}var qU="BF";function _We(e,t){var r=[this];function n(){if(r.length!==0){var o=r.shift();r.push.apply(r,gWe(o.childs)),e.call(t,o)!==!1&&n()}}n()}var OWe=qU,EH=new Map([[SWe,GU],[CWe,KU],[qU,_We]]),TH=function(){function e(t){dWe(this,e),gg(this,"data",{}),gg(this,"parent",null),gg(this,"childs",[]),this.data=t}return vWe(e,[{key:"addChild",value:function(r){r.parent=this,this.childs.push(r)}},{key:"cloneTree",value:function(){for(var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this,n=new e(OH({},r.data)),o=0;o<r.childs.length;o++)n.addChild(this.cloneTree(r.childs[o]));return n}},{key:"replaceTreeWith",value:function(r){this.data=OH({},r.data),this.childs=[];for(var n=0;n<r.childs.length;n++)this.addChild(r.childs[n])}},{key:"walkDown",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:OWe;if(!EH.has(n))throw new Error('Traversal strategy "'.concat(n,'" does not exist'));EH.get(n).call(this,r,this)}},{key:"walkUp",value:function(r){var n=this,o=function i(a){var l=r.call(n,a);l!==!1&&a.parent!==null&&i(a.parent)};o(this)}}]),e}();function Cd(e){"@babel/helpers - typeof";return Cd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Cd(e)}function kH(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function PH(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?kH(Object(r),!0).forEach(function(n){RWe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):kH(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function RWe(e,t,r){return t=XU(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function EWe(e,t){return $We(e)||PWe(e,t)||kWe(e,t)||TWe()}function TWe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function kWe(e,t){if(e){if(typeof e=="string")return $H(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return $H(e,t)}}function $H(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function PWe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function $We(e){if(Array.isArray(e))return e}function AWe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function AH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,XU(n.key),n)}}function IWe(e,t,r){return t&&AH(e.prototype,t),r&&AH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function XU(e){var t=MWe(e,"string");return Cd(t)==="symbol"?t:String(t)}function MWe(e,t){if(Cd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Cd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function gS(e,t,r){xWe(e,t),t.set(e,r)}function xWe(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ur(e,t){var r=ZU(e,t,"get");return DWe(e,r)}function DWe(e,t){return t.get?t.get.call(e):t.value}function NWe(e,t,r){var n=ZU(e,t,"set");return HWe(e,n,r),r}function ZU(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function HWe(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}var Tl=new WeakMap,zi=new WeakMap,kl=new WeakMap,LWe=function(){function e(t){AWe(this,e),gS(this,Tl,{writable:!0,value:new Map}),gS(this,zi,{writable:!0,value:new Map}),gS(this,kl,{writable:!0,value:null}),NWe(this,kl,t)}return IWe(e,[{key:"getRoots",value:function(){return Array.from(ur(this,Tl).values())}},{key:"getRootByColumn",value:function(r){var n;return ur(this,zi).has(r)&&(n=ur(this,Tl).get(ur(this,zi).get(r))),n}},{key:"getNode",value:function(r,n){var o=this.getRootByColumn(n);if(o){var i=n-ur(this,zi).get(n),a=0,l;return o.walkDown(function(s){var u=s.data,f=u.origColspan,c=u.headerLevel;if(r===c){if(i>=a&&i<=a+f-1)return l=s,l.data.isRoot=n===l.data.columnIndex,!1;a+=f}}),l}}},{key:"rebuildTreeIndex",value:function(){var r=this,n=0;ur(this,zi).clear(),I(ur(this,Tl),function(o){for(var i=EWe(o,2),a=i[1].data.colspan,l=n;l<n+a;l++)ur(r,zi).set(l,n);n+=a})}},{key:"buildTree",value:function(){this.clear();for(var r=ur(this,kl).getColumnsCount(),n=0;n<r;){var o=ur(this,kl).getHeaderSettings(0,n),i=new TH;ur(this,Tl).set(n,i),this.buildLeaves(i,n,0,o.origColspan),n+=o.origColspan}this.rebuildTreeIndex()}},{key:"buildLeaves",value:function(r,n,o){var i=this,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1,l=ur(this,kl).getHeadersSettings(o,n,a);o+=1,I(l,function(s){var u=PH(PH({},s),{},{headerLevel:o-1,columnIndex:n}),f;o===1?(r.data=u,f=r):(f=new TH(u),r.addChild(f)),o<ur(i,kl).getLayersCount()&&i.buildLeaves(f,n,o,s.origColspan),n+=s.origColspan})}},{key:"clear",value:function(){ur(this,Tl).clear(),ur(this,zi).clear()}}]),e}();function QU(e,t){e.walkDown(function(r){var n=r.data,o=r.childs;if(!n.isHidden&&(t(n.columnIndex),o.length===0))for(var i=1;i<n.colspan;i++)t(n.columnIndex+i)})}function Tm(e,t){var r=e.childs;if(r.length!==0)return r[0].data[t]}function km(e){return Tm(e,"origColspan")===e.data.origColspan}function QT(e){var t=e.data,r=e.childs;if(!t.isCollapsed||t.isHidden||t.origColspan<=1)return{rollbackModification:function(){},affectedColumns:[],colspanCompensation:0};var n=km(e);if(n)return QT(r[0]);t.isCollapsed=!1;var o=r.slice(1),i=new Set,a=0;if(o.length>0)I(o,function(c){c.replaceTreeWith(c.data.clonedTree),c.data.clonedTree=null;var h=c.data;a+=h.colspan,QU(c,function(d){i.add(d)})});else{var l=t.colspan,s=t.origColspan,u=t.columnIndex;a=s-l;for(var f=1;f<s;f++)i.add(u+f)}return e.walkUp(function(c){var h=c.data;h.colspan+=a,h.colspan>=h.origColspan?(h.colspan=h.origColspan,h.isCollapsed=!1):km(c)&&(h.isCollapsed=Tm(c,"isCollapsed"))}),{rollbackModification:function(){return JT(e)},affectedColumns:Array.from(i),colspanCompensation:a}}function JT(e){var t,r=e.data,n=e.childs;if(r.isCollapsed||r.isHidden||r.origColspan<=1)return{rollbackModification:function(){},affectedColumns:[],colspanCompensation:0};var o=km(e);if(o)return JT(n[0]);r.isCollapsed=!0;var i=n.slice(1),a=new Set;if(i.length>0)I(i,function(h){QU(h,function(d){a.add(d)}),h.data.clonedTree=h.cloneTree(),h.walkDown(function(d){var v=d.data;v.isHidden=!0})});else for(var l=r.origColspan,s=r.columnIndex,u=1;u<l;u++){var f=s+u;a.add(f)}var c=r.colspan-((t=Tm(e,"colspan"))!==null&&t!==void 0?t:1);return e.walkUp(function(h){var d=h.data;d.colspan-=c,d.colspan<=1?(d.colspan=1,d.isCollapsed=!0):km(h)&&(d.isCollapsed=Tm(h,"isCollapsed"))}),{rollbackModification:function(){return QT(e)},affectedColumns:Array.from(a),colspanCompensation:c}}var IH;function jWe(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function FWe(e,t){if(!Number.isInteger(t))throw new Error("The passed gridColumnIndex argument has invalid type.");if(e.childs.length>0)throw new Error(ft(IH||(IH=jWe([`The passed node is not the last node on the tree. Only for 
the last node, the hide column modification can be applied.`],[`The passed node is not the last node on the tree. Only for\\x20
the last node, the hide column modification can be applied.`]))));var r=e.data.crossHiddenColumns;if(!r.includes(t)){var n=!1;e.walkUp(function(o){var i=o.data.collapsible;if(i)return n=!0,!1}),!n&&e.walkUp(function(o){var i=o.data;i.crossHiddenColumns.push(t),i.colspan>1?i.colspan-=1:i.isHidden=!0})}}var MH;function BWe(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function VWe(e,t){if(!Number.isInteger(t))throw new Error("The passed gridColumnIndex argument has invalid type.");if(e.childs.length>0)throw new Error(ft(MH||(MH=BWe([`The passed node is not the last node on the tree. Only for 
the last node, the show column modification can be applied.`],[`The passed node is not the last node on the tree. Only for\\x20
the last node, the show column modification can be applied.`]))));var r=e.data.crossHiddenColumns;if(r.includes(t)){var n=!1;e.walkUp(function(o){var i=o.data.collapsible;if(i)return n=!0,!1}),!n&&e.walkUp(function(o){var i=o.data;i.crossHiddenColumns.splice(i.crossHiddenColumns.indexOf(t),1),!i.isHidden&&i.colspan<i.origColspan&&(i.colspan+=1),i.isHidden=!1})}}var xH=new Map([["collapse",JT],["expand",QT],["hide-column",FWe],["show-column",VWe]]);function WWe(e,t,r){if(!xH.has(e))throw new Error('The node modifier action ("'.concat(e,'") does not exist.'));return xH.get(e)(t,r)}var UWe=["crossHiddenColumns"];function zWe(e,t){if(e==null)return{};var r=YWe(e,t),n,o;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)n=i[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function YWe(e,t){if(e==null)return{};var r={},n=Object.keys(e),o,i;for(i=0;i<n.length;i++)o=n[i],!(t.indexOf(o)>=0)&&(r[o]=e[o]);return r}function Ey(e){var t=[];return I(e,function(r){r.walkDown(function(n){for(var o=n.data,i=o.origColspan,a=o.columnIndex,l=o.headerLevel,s=o.crossHiddenColumns,u=KWe(t,l),f=!1,c=a;c<a+i;c++){var h=s.includes(c);if(h||f)u.push(WU());else{var d=GWe(o);d.isRoot=!0,u.push(d),f=!0}}})}),t}function GWe(e){var t=KO(e);t.crossHiddenColumns;var r=zWe(t,UWe);return r}function KWe(e,t){var r;return Array.isArray(e[t])?r=e[t]:(r=[],e[t]=r),r}function _d(e){"@babel/helpers - typeof";return _d=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_d(e)}var qWe=["row"];function DH(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function NH(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?DH(Object(r),!0).forEach(function(n){XWe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):DH(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function XWe(e,t,r){return t=JU(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ZWe(e,t){if(e==null)return{};var r=QWe(e,t),n,o;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)n=i[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function QWe(e,t){if(e==null)return{};var r={},n=Object.keys(e),o,i;for(i=0;i<n.length;i++)o=n[i],!(t.indexOf(o)>=0)&&(r[o]=e[o]);return r}function JWe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function HH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,JU(n.key),n)}}function e2e(e,t,r){return t&&HH(e.prototype,t),r&&HH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function JU(e){var t=t2e(e,"string");return _d(t)==="symbol"?t:String(t)}function t2e(e,t){if(_d(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_d(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function mS(e,t,r){r2e(e,t),t.set(e,r)}function r2e(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Zf(e,t,r){var n=ez(e,t,"set");return n2e(e,n,r),r}function n2e(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}function At(e,t){var r=ez(e,t,"get");return o2e(e,r)}function ez(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function o2e(e,t){return t.get?t.get.call(e):t.value}var On=new WeakMap,Ar=new WeakMap,Yi=new WeakMap,i2e=function(){function e(){JWe(this,e),mS(this,On,{writable:!0,value:new hWe}),mS(this,Ar,{writable:!0,value:new LWe(At(this,On))}),mS(this,Yi,{writable:!0,value:[[]]})}return e2e(e,[{key:"setState",value:function(r){At(this,On).setData(r);var n=!1;try{At(this,Ar).buildTree()}catch{At(this,Ar).clear(),At(this,On).clear(),n=!0}return Zf(this,Yi,Ey(At(this,Ar).getRoots())),n}},{key:"setColumnsLimit",value:function(r){At(this,On).setColumnsLimit(r)}},{key:"mergeStateWith",value:function(r){var n=this,o=Ye(r,function(i){var a=i.row,l=ZWe(i,qWe);return NH({row:a<0?n.rowCoordsToLevel(a):a},l)});At(this,On).mergeWith(o),At(this,Ar).buildTree(),Zf(this,Yi,Ey(At(this,Ar).getRoots()))}},{key:"mapState",value:function(r){At(this,On).map(r),At(this,Ar).buildTree(),Zf(this,Yi,Ey(At(this,Ar).getRoots()))}},{key:"mapNodes",value:function(r){return nr(At(this,Ar).getRoots(),function(n,o){return o.walkDown(function(i){var a=r(i.data);a!==void 0&&n.push(a)}),n},[])}},{key:"triggerNodeModification",value:function(r,n,o){n<0&&(n=this.rowCoordsToLevel(n));var i=At(this,Ar).getNode(n,o),a;return i&&(a=WWe(r,i,o),Zf(this,Yi,Ey(At(this,Ar).getRoots()))),a}},{key:"triggerColumnModification",value:function(r,n){return this.triggerNodeModification(r,-1,n)}},{key:"rowCoordsToLevel",value:function(r){if(r>=0)return null;var n=r+Math.max(this.getLayersCount(),1);return n<0?null:n}},{key:"levelToRowCoords",value:function(r){if(r<0)return null;var n=r-Math.max(this.getLayersCount(),1);return n>=0?null:n}},{key:"getHeaderSettings",value:function(r,n){var o,i;return r<0&&(r=this.rowCoordsToLevel(r)),r===null||r>=this.getLayersCount()?null:(o=(i=At(this,Yi)[r])===null||i===void 0?void 0:i[n])!==null&&o!==void 0?o:null}},{key:"getHeaderTreeNodeData",value:function(r,n){if(r<0&&(r=this.rowCoordsToLevel(r)),r===null||r>=this.getLayersCount())return null;var o=At(this,Ar).getNode(r,n);return o?NH({},o.data):null}},{key:"findLeftMostColumnIndex",value:function(r,n){var o,i=(o=this.getHeaderSettings(r,n))!==null&&o!==void 0?o:{isRoot:!0},a=i.isRoot;if(a)return n;for(var l=n-1;l>=0;){var s,u=(s=this.getHeaderSettings(r,l))!==null&&s!==void 0?s:{isRoot:!0},f=u.isRoot;if(f)break;l-=1}return l}},{key:"getLayersCount",value:function(){return At(this,On).getLayersCount()}},{key:"getColumnsCount",value:function(){return At(this,On).getColumnsCount()}},{key:"clear",value:function(){Zf(this,Yi,[]),At(this,On).clear(),At(this,Ar).clear()}}]),e}();function Od(e){"@babel/helpers - typeof";return Od=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Od(e)}function a2e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function LH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,tz(n.key),n)}}function l2e(e,t,r){return t&&LH(e.prototype,t),r&&LH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Qf(e,t,r){return t=tz(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function tz(e){var t=s2e(e,"string");return Od(t)==="symbol"?t:String(t)}function s2e(e,t){if(Od(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Od(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var u2e=function(){function e(t,r){a2e(this,e),Qf(this,"hot",void 0),Qf(this,"nestedHeaderSettingsGetter",void 0),Qf(this,"layersCount",0),Qf(this,"container",void 0),Qf(this,"widthsMap",void 0),this.hot=t,this.nestedHeaderSettingsGetter=r,this.widthsMap=this.hot.columnIndexMapper.createAndRegisterIndexMap("nestedHeaders.widthsMap","physicalIndexToValue")}return l2e(e,[{key:"setLayersCount",value:function(r){return this.layersCount=r,this}},{key:"getWidth",value:function(r){return this.widthsMap.getValueAtIndex(this.hot.toPhysicalColumn(r))}},{key:"buildWidthsMap",value:function(){this.container=this.hot.rootDocument.createElement("div"),this.container.classList.add("handsontable","htGhostTable","htAutoSize"),this._buildGhostTable(this.container),this.hot.rootDocument.body.appendChild(this.container);var r=this.container.querySelectorAll("tr:last-of-type th"),n=r.length;this.widthsMap.clear();for(var o=0;o<n;o++){var i=this.hot.columnIndexMapper.getVisualFromRenderableIndex(o),a=this.hot.toPhysicalColumn(i);this.widthsMap.setValueAtIndex(a,r[o].offsetWidth)}this.container.parentNode.removeChild(this.container),this.container=null}},{key:"_buildGhostTable",value:function(r){for(var n=this.hot,o=n.rootDocument,i=n.columnIndexMapper,a=o.createDocumentFragment(),l=o.createElement("table"),s=!!this.hot.getSettings().dropdownMenu,u=i.getRenderableIndexesLength(),f=0;f<this.layersCount;f++){for(var c=o.createElement("tr"),h=0;h<u;h++){var d=i.getVisualFromRenderableIndex(h);d===null&&(d=h);var v=o.createElement("th"),y=this.nestedHeaderSettingsGetter(f,d);if(y&&(!y.isPlaceholder||y.isHidden)){var p=y.label;s&&(p+='<button class="changeType"></button>'),vf(v,p),v.colSpan=y.colspan,c.appendChild(v)}}l.appendChild(c)}a.appendChild(l),r.appendChild(a)}},{key:"clear",value:function(){this.widthsMap.clear(),this.container=null}}]),e}();const f2e=u2e;function Gu(e){"@babel/helpers - typeof";return Gu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Gu(e)}var jH,FH;function BH(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function c2e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function VH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,rz(n.key),n)}}function h2e(e,t,r){return t&&VH(e.prototype,t),r&&VH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function ma(){return typeof Reflect<"u"&&Reflect.get?ma=Reflect.get.bind():ma=function(t,r,n){var o=d2e(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},ma.apply(this,arguments)}function d2e(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Ro(e),e!==null););return e}function v2e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ZO(e,t)}function ZO(e,t){return ZO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},ZO(e,t)}function y2e(e){var t=m2e();return function(){var n=Ro(e),o;if(t){var i=Ro(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return g2e(this,o)}}function g2e(e,t){if(t&&(Gu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return ic(e)}function ic(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function m2e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ro(e){return Ro=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Ro(e)}function WH(e,t,r){return t=rz(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function rz(e){var t=p2e(e,"string");return Gu(t)==="symbol"?t:String(t)}function p2e(e,t){if(Gu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Gu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function UH(e,t,r){b2e(e,t),t.set(e,r)}function b2e(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ty(e,t,r){var n=nz(e,t,"set");return w2e(e,n,r),r}function w2e(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}function Ot(e,t){var r=nz(e,t,"get");return S2e(e,r)}function nz(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function S2e(e,t){return t.get?t.get.call(e):t.value}var zH="nestedHeaders",C2e=280,Dt=new WeakMap,Qo=new WeakMap,_2e=function(e){v2e(r,e);var t=y2e(r);function r(){var n;c2e(this,r);for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return n=t.call.apply(t,[this].concat(i)),UH(ic(n),Dt,{writable:!0,value:new i2e}),UH(ic(n),Qo,{writable:!0,value:null}),WH(ic(n),"ghostTable",new f2e(n.hot,function(l,s){return n.getHeaderSettings(l,s)})),WH(ic(n),"detectedOverlappedHeaders",!1),n}return h2e(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[zH]}},{key:"enablePlugin",value:function(){var o=this;if(!this.enabled){var i=this.hot.getSettings(),a=i.nestedHeaders;(!Array.isArray(a)||!Array.isArray(a[0]))&&yt(ft(jH||(jH=BH([`Your Nested Headers plugin configuration is invalid. The settings has to be 
                        passed as an array of arrays e.q. [['A1', { label: 'A2', colspan: 2 }]]`],[`Your Nested Headers plugin configuration is invalid. The settings has to be\\x20
                        passed as an array of arrays e.q. [['A1', { label: 'A2', colspan: 2 }]]`])))),this.addHook("init",function(){return o.onInit()}),this.addHook("afterLoadData",function(){return o.onAfterLoadData.apply(o,arguments)}),this.addHook("beforeOnCellMouseDown",function(){return o.onBeforeOnCellMouseDown.apply(o,arguments)}),this.addHook("afterOnCellMouseDown",function(){return o.onAfterOnCellMouseDown.apply(o,arguments)}),this.addHook("beforeOnCellMouseOver",function(){return o.onBeforeOnCellMouseOver.apply(o,arguments)}),this.addHook("afterGetColumnHeaderRenderers",function(l){return o.onAfterGetColumnHeaderRenderers(l)}),this.addHook("modifyColWidth",function(){return o.onModifyColWidth.apply(o,arguments)}),this.addHook("modifyColumnHeaderValue",function(){return o.onModifyColumnHeaderValue.apply(o,arguments)}),this.addHook("beforeHighlightingColumnHeader",function(){return o.onBeforeHighlightingColumnHeader.apply(o,arguments)}),this.addHook("beforeCopy",function(){return o.onBeforeCopy.apply(o,arguments)}),this.addHook("afterViewportColumnCalculatorOverride",function(){return o.onAfterViewportColumnCalculatorOverride.apply(o,arguments)}),ma(Ro(r.prototype),"enablePlugin",this).call(this),this.updatePlugin()}}},{key:"updatePlugin",value:function(){var o=this;if(this.hot.view){var i=this.hot.getSettings(),a=i.nestedHeaders;Ot(this,Dt).setColumnsLimit(this.hot.countCols()),Array.isArray(a)&&(this.detectedOverlappedHeaders=Ot(this,Dt).setState(a)),this.detectedOverlappedHeaders&&yt(ft(FH||(FH=BH([`Your Nested Headers plugin setup contains overlapping headers. This kind of configuration 
                        is currently not supported.`],[`Your Nested Headers plugin setup contains overlapping headers. This kind of configuration\\x20
                        is currently not supported.`])))),this.enabled&&this.hot.columnIndexMapper.hidingMapsCollection.getMergedValues().forEach(function(l,s){var u=l===!0?"hide-column":"show-column";Ot(o,Dt).triggerColumnModification(u,s)}),!Ot(this,Qo)&&this.enabled&&Ty(this,Qo,this.hot.columnIndexMapper.createChangesObserver("hiding").subscribe(function(l){l.forEach(function(s){var u=s.op,f=s.index,c=s.newValue;if(u==="replace"){var h=c===!0?"hide-column":"show-column";Ot(o,Dt).triggerColumnModification(h,f)}}),o.ghostTable.buildWidthsMap()})),this.ghostTable.setLayersCount(this.getLayersCount()).buildWidthsMap(),ma(Ro(r.prototype),"updatePlugin",this).call(this)}}},{key:"disablePlugin",value:function(){this.clearColspans(),Ot(this,Dt).clear(),Ot(this,Qo).unsubscribe(),Ty(this,Qo,null),this.ghostTable.clear(),ma(Ro(r.prototype),"disablePlugin",this).call(this)}},{key:"getStateManager",value:function(){return Ot(this,Dt)}},{key:"getLayersCount",value:function(){return Ot(this,Dt).getLayersCount()}},{key:"getHeaderSettings",value:function(o,i){return Ot(this,Dt).getHeaderSettings(o,i)}},{key:"clearColspans",value:function(){if(this.hot.view)for(var o=this.hot.view._wt,i=o.getSetting("columnHeaders").length,a=o.wtTable.THEAD,l=o.wtOverlays.topOverlay.clone.wtTable.THEAD,s=o.wtOverlays.topInlineStartCornerOverlay?o.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null,u=0;u<i;u++){var f=a.childNodes[u];if(!f)break;for(var c=l.childNodes[u],h=s?s.childNodes[u]:null,d=0,v=f.childNodes.length;d<v;d++)f.childNodes[d].removeAttribute("colspan"),He(f.childNodes[d],"hiddenHeader"),c&&c.childNodes[d]&&(c.childNodes[d].removeAttribute("colspan"),He(c.childNodes[d],"hiddenHeader")),s&&h&&h.childNodes[d]&&(h.childNodes[d].removeAttribute("colspan"),He(h.childNodes[d],"hiddenHeader"))}}},{key:"headerRendererFactory",value:function(o){var i=this,a=this.hot.view._wt.getSetting("fixedColumnsStart");return function(l,s){var u,f=i.hot,c=f.columnIndexMapper,h=f.view,d=c.getVisualFromRenderableIndex(l);d===null&&(d=l),s.removeAttribute("colspan"),He(s,"hiddenHeader");var v=(u=Ot(i,Dt).getHeaderSettings(o,d))!==null&&u!==void 0?u:{label:""},y=v.colspan,p=v.isHidden,w=v.isPlaceholder;if(w||p)re(s,"hiddenHeader");else if(y>1){var S,C,P=h._wt.wtOverlays,R=(S=P.topInlineStartCornerOverlay)===null||S===void 0?void 0:S.clone.wtTable.THEAD.contains(s),W=(C=P.inlineStartOverlay)===null||C===void 0?void 0:C.clone.wtTable.THEAD.contains(s),Y=R||W?Math.min(y,a-l):y;Y>1&&s.setAttribute("colspan",Y)}i.hot.view.appendColHeader(d,s,function(){return i.getColumnHeaderValue.apply(i,arguments)},o)}}},{key:"getColumnHeaderValue",value:function(o,i){var a,l=(a=Ot(this,Dt).getHeaderSettings(i,o))!==null&&a!==void 0?a:{},s=l.isHidden,u=l.isPlaceholder;return u||s?"":this.hot.getColHeader(o,i)}},{key:"onBeforeHighlightingColumnHeader",value:function(o,i,a){var l=Ot(this,Dt).getHeaderTreeNodeData(i,o);if(!l)return o;var s=a.classNames,u=a.columnCursor,f=a.selectionType,c=a.selectionWidth,h=Ot(this,Dt).getHeaderSettings(i,o),d=h.isRoot,v=h.colspan;if(f===fv){if(!d)return l.columnIndex}else f===Cp&&(v>c-u||!d)&&(s.length=0);return o}},{key:"onBeforeCopy",value:function(o,i,a){var l=a.columnHeadersCount;if(l!==0)for(var s=0;s<i.length;s++){var u=i[s],f=u.startRow,c=u.startCol,h=u.endRow,d=u.endCol,v=h-f+1,y=c-d+1;if(f>=0||y===1)break;for(var p=c;p<=d;p++)for(var w=f;w<=h;w++){var S,C=v+w,P=p-c;if(P!==0){var R=(S=Ot(this,Dt).getHeaderTreeNodeData(w,p))===null||S===void 0?void 0:S.isRoot;R===!1&&(o[C][P]="")}}}}},{key:"onBeforeOnCellMouseDown",value:function(o,i,a,l){var s=this._getHeaderTreeNodeDataByCoords(i);s&&(l.column=!0)}},{key:"onAfterOnCellMouseDown",value:function(o,i){var a=this._getHeaderTreeNodeDataByCoords(i);if(a){var l=this.hot.selection,s=l.isSelected()?l.getSelectedRange().current():null,u=[],f=a.columnIndex,c=a.origColspan,h=!l.inInSelection(i);o.shiftKey&&s?i.col<s.from.col?u.push(s.getTopEndCorner().col,f,i.row):i.col>s.from.col?u.push(s.getTopStartCorner().col,f+c-1,i.row):u.push(f,f+c-1,i.row):(HE(o)||$a(o)&&h)&&u.push(f,f+c-1,i.row),l.selectColumns.apply(l,u)}}},{key:"onBeforeOnCellMouseOver",value:function(o,i,a,l){var s;if(this.hot.view.isMouseDown()){var u=this._getHeaderTreeNodeDataByCoords(i);if(u){var f=u.columnIndex,c=u.origColspan,h=this.hot.getSelectedRangeLast(),d=h.getTopStartCorner(),v=h.getBottomEndCorner(),y=h.from;l.column=!0,l.cell=!0;var p=[];i.col<y.col?p.push(v.col,f):i.col>y.col?p.push(d.col,f+c-1):p.push(f,f+c-1),(s=this.hot).selectColumns.apply(s,p)}}}},{key:"onAfterGetColumnHeaderRenderers",value:function(o){o.length=0;for(var i=0;i<Ot(this,Dt).getLayersCount();i++)o.push(this.headerRendererFactory(i))}},{key:"onAfterViewportColumnCalculatorOverride",value:function(o){for(var i=Ot(this,Dt).getLayersCount(),a=o.startColumn,l=!!i,s=0;s<i;s++){var u=Ot(this,Dt).findLeftMostColumnIndex(s,o.startColumn),f=this.hot.columnIndexMapper.getRenderableFromVisualIndex(u);if(u>=0&&(l=!1),Cr(f)&&f<o.startColumn){a=f;break}}o.startColumn=l?Ot(this,Dt).getHeaderTreeNodeData(0,a).columnIndex:a}},{key:"onModifyColWidth",value:function(o,i){var a=this.ghostTable.getWidth(i);return o>a?o:a}},{key:"onModifyColumnHeaderValue",value:function(o,i,a){var l,s=(l=Ot(this,Dt).getHeaderTreeNodeData(a,i))!==null&&l!==void 0?l:{label:""},u=s.label;return u}},{key:"onInit",value:function(){this.updatePlugin()}},{key:"onAfterLoadData",value:function(o,i){i||this.updatePlugin()}},{key:"destroy",value:function(){Ty(this,Dt,null),Ot(this,Qo)!==null&&(Ot(this,Qo).unsubscribe(),Ty(this,Qo,null)),ma(Ro(r.prototype),"destroy",this).call(this)}},{key:"_getHeaderTreeNodeDataByCoords",value:function(o){if(!(o.row>=0||o.col<0))return Ot(this,Dt).getHeaderTreeNodeData(o.row,o.col)}}],[{key:"PLUGIN_KEY",get:function(){return zH}},{key:"PLUGIN_PRIORITY",get:function(){return C2e}}]),r}(it);function YH(e){return T2e(e)||E2e(e)||R2e(e)||O2e()}function O2e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function R2e(e,t){if(e){if(typeof e=="string")return QO(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return QO(e,t)}}function E2e(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function T2e(e){if(Array.isArray(e))return QO(e)}function QO(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Ku(e){"@babel/helpers - typeof";return Ku=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ku(e)}function k2e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function GH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,$2e(n.key),n)}}function P2e(e,t,r){return t&&GH(e.prototype,t),r&&GH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function $2e(e){var t=A2e(e,"string");return Ku(t)==="symbol"?t:String(t)}function A2e(e,t){if(Ku(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ku(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var I2e=function(){function e(t,r){k2e(this,e),this.hot=r,this.data=null,this.plugin=t,this.parentReference=new WeakMap,this.cache={levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap}}return P2e(e,[{key:"setData",value:function(r){this.data=r}},{key:"getData",value:function(){return this.data}},{key:"getRawSourceData",value:function(){var r=null;return this.plugin.disableCoreAPIModifiers(),r=this.hot.getSourceData(),this.plugin.enableCoreAPIModifiers(),r}},{key:"updateWithData",value:function(r){this.setData(r),this.rewriteCache()}},{key:"rewriteCache",value:function(){var r=this;this.cache={levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap},_e(0,this.data.length-1,function(n){r.cacheNode(r.data[n],0,null)})}},{key:"cacheNode",value:function(r,n,o){var i=this;this.cache.levels[n]||(this.cache.levels[n]=[],this.cache.levelCount+=1),this.cache.levels[n].push(r),this.cache.rows.push(r),this.cache.nodeInfo.set(r,{parent:o,row:this.cache.rows.length-1,level:n}),this.hasChildren(r)&&I(r.__children,function(a){i.cacheNode(a,n+1,r)})}},{key:"getDataObject",value:function(r){return r==null?null:this.cache.rows[r]}},{key:"readTreeNodes",value:function(r,n,o,i){var a=this,l=!1,s=n;if(isNaN(s)&&s.end)return s;var u=r;return u||(u={__children:this.data},l=!0,s-=1),o!=null&&s===o?{result:u,end:!0}:i!=null&&u===i?{result:s,end:!0}:(s+=1,u.__children&&I(u.__children,function(f){if(a.parentReference.set(f,l?null:u),s=a.readTreeNodes(f,s,o,i),isNaN(s)&&s.end)return!1}),s)}},{key:"mockParent",value:function(){var r=this.mockNode();return r.__children=this.data,r}},{key:"mockNode",value:function(){var r={};return Ke(this.data[0],function(n,o){r[o]=null}),r}},{key:"getRowIndex",value:function(r){return r==null?null:this.cache.nodeInfo.get(r).row}},{key:"getRowIndexWithinParent",value:function(r){var n=null;isNaN(r)?n=r:n=this.getDataObject(r);var o=this.getRowParent(r);return o==null?this.data.indexOf(n):o.__children.indexOf(n)}},{key:"countAllRows",value:function(){var r={__children:this.data};return this.countChildren(r)}},{key:"countChildren",value:function(r){var n=this,o=0,i=r;return isNaN(i)||(i=this.getDataObject(i)),!i||!i.__children?0:(I(i.__children,function(a){o+=1,a.__children&&(o+=n.countChildren(a))}),o)}},{key:"getRowParent",value:function(r){var n;return isNaN(r)?n=r:n=this.getDataObject(r),this.getRowObjectParent(n)}},{key:"getRowObjectParent",value:function(r){return!r||Ku(r)!=="object"?null:this.cache.nodeInfo.get(r).parent}},{key:"getRowLevel",value:function(r){var n=null;return isNaN(r)?n=r:n=this.getDataObject(r),n?this.getRowObjectLevel(n):null}},{key:"getRowObjectLevel",value:function(r){return r==null?null:this.cache.nodeInfo.get(r).level}},{key:"hasChildren",value:function(r){var n=r;return isNaN(n)||(n=this.getDataObject(n)),!!(n.__children&&n.__children.length)}},{key:"isChild",value:function(r){return this.getRowParent(r)!==null}},{key:"getChild",value:function(r,n){var o;return((o=r.__children)===null||o===void 0?void 0:o[n])||null}},{key:"isRowHighestLevel",value:function(r){return!this.isChild(r)}},{key:"isParent",value:function(r){var n,o=r;return isNaN(o)||(o=this.getDataObject(o)),o&&!!o.__children&&((n=o.__children)===null||n===void 0?void 0:n.length)!==0}},{key:"addChild",value:function(r,n){var o=n;this.hot.runHooks("beforeAddChild",r,o);var i=null;r&&(i=this.getRowIndex(r)),this.hot.runHooks("beforeCreateRow",i+this.countChildren(r)+1,1);var a=r;r||(a=this.mockParent()),a.__children||(a.__children=[]),o||(o=this.mockNode()),a.__children.push(o),this.rewriteCache();var l=this.getRowIndex(o);this.hot.rowIndexMapper.insertIndexes(l,1),this.hot.runHooks("afterCreateRow",l,1),this.hot.runHooks("afterAddChild",r,o)}},{key:"addChildAtIndex",value:function(r,n,o){var i=o,a;if(i||(i=this.mockNode()),this.hot.runHooks("beforeAddChild",r,i,n),r){var l=this.getRowIndex(r),s=l+n+1;this.hot.runHooks("beforeCreateRow",s,1),r.__children.splice(n,null,i),this.rewriteCache(),this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndexWithinParent(r),"__children",r.__children,"NestedRows.addChildAtIndex"),this.hot.rowIndexMapper.insertIndexes(s,1),this.plugin.enableCoreAPIModifiers(),this.hot.runHooks("afterCreateRow",s,1),a=s}else this.plugin.disableCoreAPIModifiers(),this.hot.alter("insert_row_above",n,1,"NestedRows.addChildAtIndex"),this.plugin.enableCoreAPIModifiers(),a=this.getRowIndex(this.data[n]);i=this.getDataObject(a),this.hot.runHooks("afterAddChild",r,i,n)}},{key:"addSibling",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"below",o=this.translateTrimmedRow(r),i=this.getRowParent(o),a=this.getRowIndexWithinParent(o);switch(n){case"below":this.addChildAtIndex(i,a+1,null);break;case"above":this.addChildAtIndex(i,a,null);break}}},{key:"detachFromParent",value:function(r){var n=this,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,i=null,a=[];Array.isArray(r)?(_e(r[0],r[2],function(w){var S=n.translateTrimmedRow(w);a.push(n.getDataObject(S))}),_e(0,a.length-2,function(w){n.detachFromParent(a[w],!1)}),i=a[a.length-1]):i=r;var l=this.getRowIndex(i),s=this.countChildren(i),u=this.getRowIndexWithinParent(i),f=this.getRowParent(i),c=this.getRowParent(f),h=this.getRowIndex(c),d=null;if(this.hot.runHooks("beforeDetachChild",f,i),u!=null){var v=Array.from(new Array(l+s+1).keys()).splice(-1*(s+1));if(this.hot.runHooks("beforeRemoveRow",l,s+1,v,this.plugin.pluginName),f.__children.splice(u,1),this.rewriteCache(),this.hot.runHooks("afterRemoveRow",l,s+1,v,this.plugin.pluginName),c){d=h+this.countChildren(c);var y=this.getChild(c,this.countChildren(c)-1),p=this.getRowIndex(y);this.hot.runHooks("beforeCreateRow",p+1,s+1,this.plugin.pluginName),c.__children.push(i)}else d=this.hot.countRows()+1,this.hot.runHooks("beforeCreateRow",d-2,s+1,this.plugin.pluginName),this.data.push(i)}this.rewriteCache(),this.hot.runHooks("afterCreateRow",d-2,s+1,this.plugin.pluginName),this.hot.runHooks("afterDetachChild",f,i,this.getRowIndex(i)),o&&this.hot.render()}},{key:"filterData",value:function(r,n,o){var i=this,a=[];I(o,function(l){a.push(i.getDataObject(l))}),I(a,function(l){var s=i.getRowIndexWithinParent(l),u=i.getRowParent(l);u===null?i.data.splice(s,1):u.__children.splice(s,1)}),this.rewriteCache()}},{key:"spliceData",value:function(r,n,o){var i=this.getDataObject(r-1),a=null,l=r;if(i&&i.__children&&i.__children.length===0?(a=i,l=0):r<this.countAllRows()&&(a=this.getRowParent(r),l=this.getRowIndexWithinParent(r)),a)if(o){var s;(s=a.__children).splice.apply(s,[l,n].concat(YH(o)))}else a.__children.splice(l,n);else if(o){var u;(u=this.data).splice.apply(u,[l,n].concat(YH(o)))}else this.data.splice(l,n);this.rewriteCache()}},{key:"syncRowWithRawSource",value:function(r){var n=r,o=null;do o=this.getRowParent(o),o!==null&&(n=o);while(o!==null);this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndex(n),"__children",n.__children,"NestedRows.syncRowWithRawSource"),this.plugin.enableCoreAPIModifiers()}},{key:"moveRow",value:function(r,n,o,i){var a=n===this.hot.countRows(),l=this.getRowParent(r),s=this.getRowIndexWithinParent(r),u=l.__children.slice(s,s+1),f=r>n,c=a?this.getRowParent(n-1):this.getRowParent(n);c==null&&(c=this.getRowParent(n-1)),c==null&&(c=this.getDataObject(n-1)),c?c.__children||(c.__children=[]):(c=this.getDataObject(n),c.__children=[]);var h=a||o||i?c.__children.length:this.getRowIndexWithinParent(n),d=l===c;c.__children.splice(h,0,u[0]),l.__children.splice(s+(f&&d?1:0),1),this.syncRowWithRawSource(l),d||this.syncRowWithRawSource(c)}},{key:"translateTrimmedRow",value:function(r){return this.plugin.collapsingUI?this.plugin.collapsingUI.translateTrimmedRow(r):r}},{key:"untranslateTrimmedRow",value:function(r){return this.plugin.collapsingUI?this.plugin.collapsingUI.untranslateTrimmedRow(r):r}}]),e}();const M2e=I2e;function Rd(e){"@babel/helpers - typeof";return Rd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Rd(e)}function KH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,D2e(n.key),n)}}function x2e(e,t,r){return t&&KH(e.prototype,t),r&&KH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function D2e(e){var t=N2e(e,"string");return Rd(t)==="symbol"?t:String(t)}function N2e(e,t){if(Rd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Rd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function H2e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var L2e=x2e(function e(t,r){H2e(this,e),this.hot=r,this.plugin=t});const ek=L2e;function qu(e){"@babel/helpers - typeof";return qu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},qu(e)}function j2e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function qH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,B2e(n.key),n)}}function F2e(e,t,r){return t&&qH(e.prototype,t),r&&qH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function B2e(e){var t=V2e(e,"string");return qu(t)==="symbol"?t:String(t)}function V2e(e,t){if(qu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(qu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function W2e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&JO(e,t)}function JO(e,t){return JO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},JO(e,t)}function U2e(e){var t=G2e();return function(){var n=Pm(e),o;if(t){var i=Pm(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return z2e(this,o)}}function z2e(e,t){if(t&&(qu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Y2e(e)}function Y2e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function G2e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Pm(e){return Pm=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Pm(e)}var K2e=function(e){W2e(r,e);var t=U2e(r);function r(n,o){var i;return j2e(this,r),i=t.call(this,n,o),i.dataManager=i.plugin.dataManager,i.collapsingUI=i.plugin.collapsingUI,i.rowHeaderWidthCache=null,i}return F2e(r,[{key:"appendLevelIndicators",value:function(o,i){var a=this.hot.toPhysicalRow(o),l=this.dataManager.getRowLevel(a),s=this.dataManager.getDataObject(a),u=i.getElementsByTagName("DIV")[0],f=u.querySelector("span.rowHeader"),c=u.querySelectorAll('[class^="ht_nesting"]');if(I(c,function(y){y&&u.removeChild(y)}),re(i,r.CSS_CLASSES.indicatorContainer),l){var h=this.hot.rootDocument,d=f.cloneNode(!0);u.innerHTML="",_e(0,l-1,function(){var y=h.createElement("SPAN");re(y,r.CSS_CLASSES.emptyIndicator),u.appendChild(y)}),u.appendChild(d)}if(this.dataManager.hasChildren(s)){var v=this.hot.rootDocument.createElement("DIV");re(i,r.CSS_CLASSES.parent),this.collapsingUI.areChildrenCollapsed(a)?re(v,"".concat(r.CSS_CLASSES.button," ").concat(r.CSS_CLASSES.expandButton)):re(v,"".concat(r.CSS_CLASSES.button," ").concat(r.CSS_CLASSES.collapseButton)),u.appendChild(v)}}},{key:"updateRowHeaderWidth",value:function(o){var i=o;i||(i=this.dataManager.cache.levelCount),this.rowHeaderWidthCache=Math.max(50,11+10*i+25),this.hot.render()}}],[{key:"CSS_CLASSES",get:function(){return{indicatorContainer:"ht_nestingLevels",parent:"ht_nestingParent",indicator:"ht_nestingLevel",emptyIndicator:"ht_nestingLevel_empty",button:"ht_nestingButton",expandButton:"ht_nestingExpand",collapseButton:"ht_nestingCollapse"}}}]),r}(ek);const oz=K2e;function Xu(e){"@babel/helpers - typeof";return Xu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Xu(e)}function XH(e){return Q2e(e)||Z2e(e)||X2e(e)||q2e()}function q2e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function X2e(e,t){if(e){if(typeof e=="string")return eR(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return eR(e,t)}}function Z2e(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Q2e(e){if(Array.isArray(e))return eR(e)}function eR(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function J2e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ZH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,tUe(n.key),n)}}function eUe(e,t,r){return t&&ZH(e.prototype,t),r&&ZH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function tUe(e){var t=rUe(e,"string");return Xu(t)==="symbol"?t:String(t)}function rUe(e,t){if(Xu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Xu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function nUe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&tR(e,t)}function tR(e,t){return tR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},tR(e,t)}function oUe(e){var t=lUe();return function(){var n=$m(e),o;if(t){var i=$m(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return iUe(this,o)}}function iUe(e,t){if(t&&(Xu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return aUe(e)}function aUe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function lUe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function $m(e){return $m=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},$m(e)}var sUe=function(e){nUe(r,e);var t=oUe(r);function r(n,o){var i;return J2e(this,r),i=t.call(this,n,o),i.dataManager=i.plugin.dataManager,i.collapsedRows=[],i.collapsedRowsStash={stash:function(){var l=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;i.lastCollapsedRows=i.collapsedRows.slice(0),i.expandMultipleChildren(i.lastCollapsedRows,l)},shiftStash:function(l,s){var u=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;s==null&&(s=1/0),I(i.lastCollapsedRows,function(f,c){f>=l&&f<s&&(i.lastCollapsedRows[c]=f+u)})},applyStash:function(){var l=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;i.collapseMultipleChildren(i.lastCollapsedRows,l),i.lastCollapsedRows=void 0},trimStash:function(l,s){_e(l,l+s-1,function(u){var f=i.lastCollapsedRows.indexOf(u);f>-1&&i.lastCollapsedRows.splice(f,1)})}},i}return eUe(r,[{key:"collapseChildren",value:function(o){var i=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,s=[],u=null,f=null,c=null;return isNaN(o)?(u=o,f=this.dataManager.getRowIndex(u)):(u=this.dataManager.getDataObject(o),f=o),this.dataManager.hasChildren(u)&&I(u.__children,function(h){s.push(i.dataManager.getRowIndex(h))}),c=this.collapseRows(s,!0,!1),l&&this.trimRows(c),a&&this.renderAndAdjust(),this.collapsedRows.indexOf(f)===-1&&this.collapsedRows.push(f),c}},{key:"collapseMultipleChildren",value:function(o){var i=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,s=[];I(o,function(u){s.push.apply(s,XH(i.collapseChildren(u,!1,!1)))}),l&&this.trimRows(s),a&&this.renderAndAdjust()}},{key:"collapseRow",value:function(o){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.collapseRows([o],i)}},{key:"collapseRows",value:function(o){var i=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,s=[];return I(o,function(u){s.push(u),a&&i.collapseChildRows(u,s)}),l&&this.trimRows(s),s}},{key:"collapseChildRows",value:function(o){var i=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],l=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(this.dataManager.hasChildren(o)){var s=this.dataManager.getDataObject(o);I(s.__children,function(u){var f=i.dataManager.getRowIndex(u);a.push(f),i.collapseChildRows(f,a)})}l&&this.trimRows(a)}},{key:"expandRow",value:function(o){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.expandRows([o],i)}},{key:"expandRows",value:function(o){var i=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,s=[];return I(o,function(u){s.push(u),a&&i.expandChildRows(u,s)}),l&&this.untrimRows(s),s}},{key:"expandChildRows",value:function(o){var i=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],l=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(this.dataManager.hasChildren(o)){var s=this.dataManager.getDataObject(o);I(s.__children,function(u){if(!i.isAnyParentCollapsed(u)){var f=i.dataManager.getRowIndex(u);a.push(f),i.expandChildRows(f,a)}})}l&&this.untrimRows(a)}},{key:"expandChildren",value:function(o){var i=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,s=[],u=null,f=null,c=null;return isNaN(o)?(u=o,f=this.dataManager.getRowIndex(o)):(u=this.dataManager.getDataObject(o),f=o),this.collapsedRows.splice(this.collapsedRows.indexOf(f),1),this.dataManager.hasChildren(u)&&I(u.__children,function(h){var d=i.dataManager.getRowIndex(h);s.push(d)}),c=this.expandRows(s,!0,!1),l&&this.untrimRows(c),a&&this.renderAndAdjust(),c}},{key:"expandMultipleChildren",value:function(o){var i=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,s=[];I(o,function(u){s.push.apply(s,XH(i.expandChildren(u,!1,!1)))}),l&&this.untrimRows(s),a&&this.renderAndAdjust()}},{key:"collapseAll",value:function(){var o=this,i=this.dataManager.getData(),a=[];I(i,function(l){o.dataManager.hasChildren(l)&&a.push(l)}),this.collapseMultipleChildren(a),this.renderAndAdjust()}},{key:"expandAll",value:function(){var o=this,i=this.dataManager.getData(),a=[];I(i,function(l){o.dataManager.hasChildren(l)&&a.push(l)}),this.expandMultipleChildren(a),this.renderAndAdjust()}},{key:"trimRows",value:function(o){var i=this;this.hot.batchExecution(function(){I(o,function(a){i.plugin.collapsedRowsMap.setValueAtIndex(a,!0)})},!0)}},{key:"untrimRows",value:function(o){var i=this;this.hot.batchExecution(function(){I(o,function(a){i.plugin.collapsedRowsMap.setValueAtIndex(a,!1)})},!0)}},{key:"areChildrenCollapsed",value:function(o){var i=this,a=isNaN(o)?o:this.dataManager.getDataObject(o),l=!0;return a===null&&(a={__children:this.dataManager.data}),this.dataManager.hasChildren(a)&&I(a.__children,function(s){var u=i.dataManager.getRowIndex(s);if(!i.plugin.collapsedRowsMap.getValueAtIndex(u))return l=!1,!1}),l}},{key:"isAnyParentCollapsed",value:function(o){for(var i=o;i!==null;){i=this.dataManager.getRowParent(i);var a=this.dataManager.getRowIndex(i);if(this.collapsedRows.indexOf(a)>-1)return!0}return!1}},{key:"toggleState",value:function(o,i){if(!(i.col>=0)){var a=this.translateTrimmedRow(i.row);xe(o.target,oz.CSS_CLASSES.button)&&(this.areChildrenCollapsed(a)?this.expandChildren(a):this.collapseChildren(a),Dn(o))}}},{key:"translateTrimmedRow",value:function(o){return this.hot.toPhysicalRow(o)}},{key:"untranslateTrimmedRow",value:function(o){return this.hot.toVisualRow(o)}},{key:"renderAndAdjust",value:function(){this.hot.render(),this.hot.view.adjustElementsSize()}}]),r}(ek);const uUe=sUe;function Zu(e){"@babel/helpers - typeof";return Zu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Zu(e)}function fUe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function QH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,hUe(n.key),n)}}function cUe(e,t,r){return t&&QH(e.prototype,t),r&&QH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function hUe(e){var t=dUe(e,"string");return Zu(t)==="symbol"?t:String(t)}function dUe(e,t){if(Zu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Zu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function vUe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&rR(e,t)}function rR(e,t){return rR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},rR(e,t)}function yUe(e){var t=mUe();return function(){var n=Am(e),o;if(t){var i=Am(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return gUe(this,o)}}function gUe(e,t){if(t&&(Zu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return iz(e)}function iz(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function mUe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Am(e){return Am=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Am(e)}var JH=new WeakMap,pUe=function(e){vUe(r,e);var t=yUe(r);function r(n,o){var i;return fUe(this,r),i=t.call(this,n,o),JH.set(iz(i),{row_above:function(l,s){var u=s[s.length-1];i.dataManager.addSibling(u.start.row,"above")},row_below:function(l,s){var u=s[s.length-1];i.dataManager.addSibling(u.start.row,"below")}}),i.dataManager=i.plugin.dataManager,i}return cUe(r,[{key:"appendOptions",value:function(o){var i=this,a=[{key:"add_child",name:function(){return this.getTranslatedPhrase(U0)},callback:function(){var s=i.dataManager.translateTrimmedRow(i.hot.getSelectedLast()[0]),u=i.dataManager.getDataObject(s);i.dataManager.addChild(u)},disabled:function(){var s=i.hot.getSelectedLast();return!s||s[0]<0||i.hot.selection.isSelectedByColumnHeader()||i.hot.countRows()>=i.hot.getSettings().maxRows}},{key:"detach_from_parent",name:function(){return this.getTranslatedPhrase(z0)},callback:function(){i.dataManager.detachFromParent(i.hot.getSelectedLast())},disabled:function(){var s=i.hot.getSelectedLast(),u=i.dataManager.translateTrimmedRow(s[0]),f=i.dataManager.getRowParent(u);return!f||!s||s[0]<0||i.hot.selection.isSelectedByColumnHeader()||i.hot.countRows()>=i.hot.getSettings().maxRows}},{name:"---------"}];return _e(0,o.items.length-1,function(l){if(l===0)return I(a,function(s,u){o.items.splice(l+u,0,s)}),!1}),this.modifyRowInsertingOptions(o)}},{key:"modifyRowInsertingOptions",value:function(o){var i=JH.get(this);return _e(0,o.items.length-1,function(a){var l=i[o.items[a].key];l!=null&&(o.items[a].callback=l)}),o}}]),r}(ek);const bUe=pUe;function Ed(e){"@babel/helpers - typeof";return Ed=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ed(e)}var eL;function tL(e){return _Ue(e)||CUe(e)||SUe(e)||wUe()}function wUe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function SUe(e,t){if(e){if(typeof e=="string")return nR(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return nR(e,t)}}function CUe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function _Ue(e){if(Array.isArray(e))return nR(e)}function nR(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function OUe(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function RUe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function rL(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,TUe(n.key),n)}}function EUe(e,t,r){return t&&rL(e.prototype,t),r&&rL(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function TUe(e){var t=kUe(e,"string");return Ed(t)==="symbol"?t:String(t)}function kUe(e,t){if(Ed(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ed(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var PUe=function(){function e(t){RUe(this,e),this.plugin=t,this.hot=t.hot,this.dataManager=t.dataManager,this.collapsingUI=t.collapsingUI}return EUe(e,[{key:"onBeforeRowMove",value:function(r,n,o,i){var a=this,l=this.displayAPICompatibilityWarning({rows:r,finalIndex:n,dropIndex:o,movePossible:i});if(l)return!1;this.movedToCollapsed=!1;var s=o===this.hot.countRows(),u=s?this.hot.countSourceRows():this.dataManager.translateTrimmedRow(o),f=!0,c=r.map(function(p){if(!f)return!1;var w=a.dataManager.translateTrimmedRow(p);return f=a.shouldAllowMoving(w,u),w}),h=c.indexOf(u)===-1;if(!f||!h)return!1;var d=this.getBaseParent(c),v=this.getTargetParent(s,u),y=d===v;return this.movedToCollapsed=this.collapsingUI.areChildrenCollapsed(v),this.collapsingUI.collapsedRowsStash.stash(),this.shiftCollapsibleParentsLocations(c,u,y),this.moveRows(c,u,v),this.dataManager.rewriteCache(),this.moveCellsMeta(c,u),this.collapsingUI.collapsedRowsStash.applyStash(!1),this.hot.runHooks("afterRowMove",r,n,o,i,i&&this.isRowOrderChanged(r,n)),this.hot.render(),this.selectCells(r,o),!1}},{key:"displayAPICompatibilityWarning",value:function(r){var n=r.rows,o=r.finalIndex,i=r.dropIndex,a=r.movePossible,l=!1;return gt(i)&&(yt(ft(eL||(eL=OUe([`Since version 8.0.0 of the Handsontable the 'moveRows' method isn't used for moving rows 
      when the NestedRows plugin is enabled. Please use the 'dragRows' method instead.`],[`Since version 8.0.0 of the Handsontable the 'moveRows' method isn't used for moving rows\\x20
      when the NestedRows plugin is enabled. Please use the 'dragRows' method instead.`])))),this.hot.runHooks("afterRowMove",n,o,i,a,!1),l=!0),l}},{key:"shouldAllowMoving",value:function(r,n){return!(this.dataManager.isParent(r)||this.dataManager.isRowHighestLevel(r)||r===n||n===0)}},{key:"getBaseParent",value:function(r){return this.dataManager.getRowParent(r[0])}},{key:"getTargetParent",value:function(r,n){var o=this.dataManager.getRowParent(r?n-1:n);return o==null&&(o=this.dataManager.getRowParent(n-1)),o}},{key:"shiftCollapsibleParentsLocations",value:function(r,n,o){o||(Math.max.apply(Math,tL(r))<=n?this.collapsingUI.collapsedRowsStash.shiftStash(r[0],n,-1*r.length):this.collapsingUI.collapsedRowsStash.shiftStash(n,r[0],r.length))}},{key:"moveRows",value:function(r,n,o){var i=this,a=n===this.dataManager.getRowIndex(o)+this.dataManager.countChildren(o)+1;this.hot.batchRender(function(){r.forEach(function(l){i.dataManager.moveRow(l,n,i.movedToCollapsed,a)})})}},{key:"moveCellsMeta",value:function(r,n){var o=this,i,a=[],l=Math.max.apply(Math,tL(r))<n;r.forEach(function(s){a.push(o.hot.getCellMetaAtRow(s))}),this.hot.spliceCellsMeta(r[0],r.length),(i=this.hot).spliceCellsMeta.apply(i,[n-(l?a.length:0),0].concat(a))}},{key:"selectCells",value:function(r,n){var o=r.length,i=0,a=0,l=null,s=null;if(this.movedToCollapsed){var u=null;r[o-1]<n?u=this.dataManager.translateTrimmedRow(n-o):u=this.dataManager.translateTrimmedRow(n);var f=this.dataManager.getRowParent(u===null?this.hot.countSourceRows()-1:u-1),c=this.dataManager.getRowIndex(f);i=this.dataManager.untranslateTrimmedRow(c),a=i}else r[o-1]<n?(a=n-1,i=a-o+1):(i=n,a=i+o-1);l=this.hot.selection,s=this.hot.countCols()-1,l.setRangeStart(this.hot._createCellCoords(i,0)),l.setRangeEnd(this.hot._createCellCoords(a,s),!0)}},{key:"isRowOrderChanged",value:function(r,n){return r.some(function(o,i){return o-i!==n})}}]),e}();function Qu(e){"@babel/helpers - typeof";return Qu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Qu(e)}function $Ue(e){return xUe(e)||MUe(e)||IUe(e)||AUe()}function AUe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function IUe(e,t){if(e){if(typeof e=="string")return oR(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return oR(e,t)}}function MUe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function xUe(e){if(Array.isArray(e))return oR(e)}function oR(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function DUe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function nL(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,HUe(n.key),n)}}function NUe(e,t,r){return t&&nL(e.prototype,t),r&&nL(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function HUe(e){var t=LUe(e,"string");return Qu(t)==="symbol"?t:String(t)}function LUe(e,t){if(Qu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Qu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function pa(){return typeof Reflect<"u"&&Reflect.get?pa=Reflect.get.bind():pa=function(t,r,n){var o=jUe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},pa.apply(this,arguments)}function jUe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Eo(e),e!==null););return e}function FUe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&iR(e,t)}function iR(e,t){return iR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},iR(e,t)}function BUe(e){var t=WUe();return function(){var n=Eo(e),o;if(t){var i=Eo(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return VUe(this,o)}}function VUe(e,t){if(t&&(Qu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return az(e)}function az(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function WUe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Eo(e){return Eo=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Eo(e)}var pS="nestedRows",UUe=300,Xn=new WeakMap,zUe="The Nested Rows plugin requires an Array of Objects as a dataset to be provided. The plugin has been disabled.",YUe=function(e){FUe(r,e);var t=BUe(r);function r(n){var o;return DUe(this,r),o=t.call(this,n),o.dataManager=null,o.headersUI=null,o.collapsedRowsMap=null,Xn.set(az(o),{movedToCollapsed:!1,skipRender:null,skipCoreAPIModifiers:!1}),o}return NUe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[pS]}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.collapsedRowsMap=this.hot.rowIndexMapper.registerMap("nestedRows",new uv),this.dataManager=new M2e(this,this.hot),this.collapsingUI=new uUe(this,this.hot),this.headersUI=new oz(this,this.hot),this.contextMenuUI=new bUe(this,this.hot),this.rowMoveController=new PUe(this),this.addHook("afterInit",function(){return o.onAfterInit.apply(o,arguments)}),this.addHook("beforeViewRender",function(){return o.onBeforeViewRender.apply(o,arguments)}),this.addHook("modifyRowData",function(){return o.onModifyRowData.apply(o,arguments)}),this.addHook("modifySourceLength",function(){return o.onModifySourceLength.apply(o,arguments)}),this.addHook("beforeDataSplice",function(){return o.onBeforeDataSplice.apply(o,arguments)}),this.addHook("filterData",function(){return o.onFilterData.apply(o,arguments)}),this.addHook("afterContextMenuDefaultOptions",function(){return o.onAfterContextMenuDefaultOptions.apply(o,arguments)}),this.addHook("afterGetRowHeader",function(){return o.onAfterGetRowHeader.apply(o,arguments)}),this.addHook("beforeOnCellMouseDown",function(){return o.onBeforeOnCellMouseDown.apply(o,arguments)}),this.addHook("beforeRemoveRow",function(){return o.onBeforeRemoveRow.apply(o,arguments)}),this.addHook("afterRemoveRow",function(){return o.onAfterRemoveRow.apply(o,arguments)}),this.addHook("beforeAddChild",function(){return o.onBeforeAddChild.apply(o,arguments)}),this.addHook("afterAddChild",function(){return o.onAfterAddChild.apply(o,arguments)}),this.addHook("beforeDetachChild",function(){return o.onBeforeDetachChild.apply(o,arguments)}),this.addHook("afterDetachChild",function(){return o.onAfterDetachChild.apply(o,arguments)}),this.addHook("modifyRowHeaderWidth",function(){return o.onModifyRowHeaderWidth.apply(o,arguments)}),this.addHook("afterCreateRow",function(){return o.onAfterCreateRow.apply(o,arguments)}),this.addHook("beforeRowMove",function(){return o.onBeforeRowMove.apply(o,arguments)}),this.addHook("beforeLoadData",function(i){return o.onBeforeLoadData(i)}),this.addHook("beforeUpdateData",function(i){return o.onBeforeLoadData(i)}),pa(Eo(r.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.hot.rowIndexMapper.unregisterMap("nestedRows"),pa(Eo(r.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){this.disablePlugin();var o=this.dataManager.getData();this.enablePlugin(),this.dataManager.updateWithData(o),pa(Eo(r.prototype),"updatePlugin",this).call(this)}},{key:"onBeforeRowMove",value:function(o,i,a,l){return this.rowMoveController.onBeforeRowMove(o,i,a,l)}},{key:"disableCoreAPIModifiers",value:function(){var o=Xn.get(this);o.skipCoreAPIModifiers=!0}},{key:"enableCoreAPIModifiers",value:function(){var o=Xn.get(this);o.skipCoreAPIModifiers=!1}},{key:"onBeforeOnCellMouseDown",value:function(o,i,a){this.collapsingUI.toggleState(o,i,a)}},{key:"onModifyRowData",value:function(o){var i=Xn.get(this);if(!i.skipCoreAPIModifiers)return this.dataManager.getDataObject(o)}},{key:"onModifySourceLength",value:function(){var o=Xn.get(this);if(!o.skipCoreAPIModifiers)return this.dataManager.countAllRows()}},{key:"onBeforeDataSplice",value:function(o,i,a){var l=Xn.get(this);return l.skipCoreAPIModifiers||this.dataManager.isRowHighestLevel(o)?!0:(this.dataManager.spliceData(o,i,a),!1)}},{key:"onFilterData",value:function(o,i,a){var l=Xn.get(this);return this.collapsingUI.collapsedRowsStash.stash(),this.collapsingUI.collapsedRowsStash.trimStash(a[0],i),this.collapsingUI.collapsedRowsStash.shiftStash(a[0],null,-1*i),this.dataManager.filterData(o,i,a),l.skipRender=!0,this.dataManager.getData().slice()}},{key:"onAfterContextMenuDefaultOptions",value:function(o){return this.contextMenuUI.appendOptions(o)}},{key:"onAfterGetRowHeader",value:function(o,i){this.headersUI.appendLevelIndicators(o,i)}},{key:"onModifyRowHeaderWidth",value:function(o){return this.headersUI.rowHeaderWidthCache||o}},{key:"onAfterRemoveRow",value:function(o,i,a,l){var s=this;if(l!==this.pluginName){var u=Xn.get(this);setTimeout(function(){u.skipRender=null,s.headersUI.updateRowHeaderWidth(),s.collapsingUI.collapsedRowsStash.applyStash()},0)}}},{key:"onBeforeRemoveRow",value:function(o,i,a){var l=this,s=Array.from(a.reduce(function(u,f){if(l.dataManager.isParent(f)){var c=l.dataManager.getDataObject(f).__children;return u.add(f),Array.isArray(c)&&c.forEach(function(h){return u.add(l.dataManager.getRowIndex(h))}),u}return u.add(f)},new Set));a.length=0,a.push.apply(a,s)}},{key:"onBeforeAddChild",value:function(){this.collapsingUI.collapsedRowsStash.stash()}},{key:"onAfterAddChild",value:function(o,i){this.collapsingUI.collapsedRowsStash.shiftStash(this.dataManager.getRowIndex(i)),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}},{key:"onBeforeDetachChild",value:function(){this.collapsingUI.collapsedRowsStash.stash()}},{key:"onAfterDetachChild",value:function(o,i,a){this.collapsingUI.collapsedRowsStash.shiftStash(a,null,-1),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}},{key:"onAfterCreateRow",value:function(){this.dataManager.rewriteCache()}},{key:"onAfterInit",value:function(){var o=Math.max.apply(Math,$Ue(this.dataManager.cache.levels));o>0&&this.headersUI.updateRowHeaderWidth(o)}},{key:"onBeforeViewRender",value:function(o,i){var a=Xn.get(this);a.skipRender&&(i.skipRender=!0)}},{key:"destroy",value:function(){pa(Eo(r.prototype),"destroy",this).call(this)}},{key:"onBeforeLoadData",value:function(o){if(!wye(o)){LE(zUe),this.hot.getSettings()[pS]=!1,this.disablePlugin();return}this.dataManager.setData(o),this.dataManager.rewriteCache()}}],[{key:"PLUGIN_KEY",get:function(){return pS}},{key:"PLUGIN_PRIORITY",get:function(){return UUe}}]),r}(it);function Td(e){"@babel/helpers - typeof";return Td=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Td(e)}function GUe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function oL(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,qUe(n.key),n)}}function KUe(e,t,r){return t&&oL(e.prototype,t),r&&oL(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function qUe(e){var t=XUe(e,"string");return Td(t)==="symbol"?t:String(t)}function XUe(e,t){if(Td(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Td(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var ZUe=function(){function e(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;GUe(this,e),this.rootWindow=r,this.prefix=t,this.savedKeys=[],this.loadSavedKeys()}return KUe(e,[{key:"saveValue",value:function(r,n){this.rootWindow.localStorage.setItem("".concat(this.prefix,"_").concat(r),JSON.stringify(n)),this.savedKeys.indexOf(r)===-1&&(this.savedKeys.push(r),this.saveSavedKeys())}},{key:"loadValue",value:function(r,n){var o=typeof r>"u"?n:r,i=this.rootWindow.localStorage.getItem("".concat(this.prefix,"_").concat(o));return i===null?void 0:JSON.parse(i)}},{key:"reset",value:function(r){this.rootWindow.localStorage.removeItem("".concat(this.prefix,"_").concat(r))}},{key:"resetAll",value:function(){var r=this;I(this.savedKeys,function(n,o){r.rootWindow.localStorage.removeItem("".concat(r.prefix,"_").concat(r.savedKeys[o]))}),this.clearSavedKeys()}},{key:"loadSavedKeys",value:function(){var r=this.rootWindow.localStorage.getItem("".concat(this.prefix,"__persistentStateKeys")),n=typeof r=="string"?JSON.parse(r):void 0;this.savedKeys=n||[]}},{key:"saveSavedKeys",value:function(){this.rootWindow.localStorage.setItem("".concat(this.prefix,"__persistentStateKeys"),JSON.stringify(this.savedKeys))}},{key:"clearSavedKeys",value:function(){this.savedKeys.length=0,this.saveSavedKeys()}}]),e}();const QUe=ZUe;function Ju(e){"@babel/helpers - typeof";return Ju=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ju(e)}function JUe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function iL(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,tze(n.key),n)}}function eze(e,t,r){return t&&iL(e.prototype,t),r&&iL(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function tze(e){var t=rze(e,"string");return Ju(t)==="symbol"?t:String(t)}function rze(e,t){if(Ju(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ju(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ba(){return typeof Reflect<"u"&&Reflect.get?ba=Reflect.get.bind():ba=function(t,r,n){var o=nze(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},ba.apply(this,arguments)}function nze(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=To(e),e!==null););return e}function oze(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&aR(e,t)}function aR(e,t){return aR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},aR(e,t)}function ize(e){var t=sze();return function(){var n=To(e),o;if(t){var i=To(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return aze(this,o)}}function aze(e,t){if(t&&(Ju(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return lze(e)}function lze(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function sze(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function To(e){return To=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},To(e)}ge.getSingleton().register("persistentStateSave");ge.getSingleton().register("persistentStateLoad");ge.getSingleton().register("persistentStateReset");var aL="persistentState",uze=0,fze=function(e){oze(r,e);var t=ize(r);function r(n){var o;return JUe(this,r),o=t.call(this,n),o.storage=void 0,o}return eze(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[aL]}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.storage||(this.storage=new QUe(this.hot.rootElement.id,this.hot.rootWindow)),this.addHook("persistentStateSave",function(i,a){return o.saveValue(i,a)}),this.addHook("persistentStateLoad",function(i,a){return o.loadValue(i,a)}),this.addHook("persistentStateReset",function(){return o.resetValue()}),ba(To(r.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.storage=void 0,ba(To(r.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),ba(To(r.prototype),"updatePlugin",this).call(this)}},{key:"loadValue",value:function(o,i){i.value=this.storage.loadValue(o)}},{key:"saveValue",value:function(o,i){this.storage.saveValue(o,i)}},{key:"resetValue",value:function(o){typeof o>"u"?this.storage.resetAll():this.storage.reset(o)}},{key:"destroy",value:function(){ba(To(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return aL}},{key:"PLUGIN_PRIORITY",get:function(){return uze}}]),r}(it);function ef(e){"@babel/helpers - typeof";return ef=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ef(e)}function cze(e){return yze(e)||vze(e)||dze(e)||hze()}function hze(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function dze(e,t){if(e){if(typeof e=="string")return lR(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return lR(e,t)}}function vze(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function yze(e){if(Array.isArray(e))return lR(e)}function lR(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function gze(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function lL(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,pze(n.key),n)}}function mze(e,t,r){return t&&lL(e.prototype,t),r&&lL(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function pze(e){var t=bze(e,"string");return ef(t)==="symbol"?t:String(t)}function bze(e,t){if(ef(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ef(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function wa(){return typeof Reflect<"u"&&Reflect.get?wa=Reflect.get.bind():wa=function(t,r,n){var o=wze(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},wa.apply(this,arguments)}function wze(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=ko(e),e!==null););return e}function Sze(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&sR(e,t)}function sR(e,t){return sR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},sR(e,t)}function Cze(e){var t=Rze();return function(){var n=ko(e),o;if(t){var i=ko(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return _ze(this,o)}}function _ze(e,t){if(t&&(ef(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Oze(e)}function Oze(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Rze(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function ko(e){return ko=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},ko(e)}var bS="search",Eze=190,Tze="htSearchResult",kze=function(t,r,n,o,i){t.getCellMeta(r,n).isSearchResult=i},Pze=function(t,r,n){return gt(t)||t===null||!t.toLocaleLowerCase||t.length===0||gt(r)||r===null?!1:r.toString().toLocaleLowerCase(n.locale).indexOf(t.toLocaleLowerCase(n.locale))!==-1},$ze=function(e){Sze(r,e);var t=Cze(r);function r(n){var o;return gze(this,r),o=t.call(this,n),o.callback=kze,o.queryMethod=Pze,o.searchResultClass=Tze,o}return mze(r,[{key:"isEnabled",value:function(){return this.hot.getSettings()[bS]}},{key:"enablePlugin",value:function(){var o=this;if(!this.enabled){var i=this.hot.getSettings()[bS];this.updatePluginSettings(i),this.addHook("beforeRenderer",function(){return o.onBeforeRenderer.apply(o,arguments)}),wa(ko(r.prototype),"enablePlugin",this).call(this)}}},{key:"disablePlugin",value:function(){var o=this,i=function(){return o.onBeforeRenderer.apply(o,arguments)};this.hot.addHook("beforeRenderer",i),this.hot.addHookOnce("afterViewRender",function(){o.hot.removeHook("beforeRenderer",i)}),wa(ko(r.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),wa(ko(r.prototype),"updatePlugin",this).call(this)}},{key:"query",value:function(o){var i=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getCallback(),l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.getQueryMethod(),s=this.hot.countRows(),u=this.hot.countCols(),f=[],c=this.hot;return _e(0,s-1,function(h){_e(0,u-1,function(d){var v=i.hot.getDataAtCell(h,d),y=i.hot.getCellMeta(h,d),p=y.search.callback||a,w=y.search.queryMethod||l,S=w(o,v,y);if(S){var C={row:h,col:d,data:v};f.push(C)}p&&p(c,h,d,v,S)})}),f}},{key:"getCallback",value:function(){return this.callback}},{key:"setCallback",value:function(o){this.callback=o}},{key:"getQueryMethod",value:function(){return this.queryMethod}},{key:"setQueryMethod",value:function(o){this.queryMethod=o}},{key:"getSearchResultClass",value:function(){return this.searchResultClass}},{key:"setSearchResultClass",value:function(o){this.searchResultClass=o}},{key:"updatePluginSettings",value:function(o){Ge(o)&&(o.searchResultClass&&this.setSearchResultClass(o.searchResultClass),o.queryMethod&&this.setQueryMethod(o.queryMethod),o.callback&&this.setCallback(o.callback))}},{key:"onBeforeRenderer",value:function(o,i,a,l,s,u){var f=u.className||[],c=[];if(typeof f=="string")c=f.split(" ");else{var h;(h=c).push.apply(h,cze(f))}this.isEnabled()&&u.isSearchResult?c.includes(this.searchResultClass)||c.push("".concat(this.searchResultClass)):c.includes(this.searchResultClass)&&c.splice(c.indexOf(this.searchResultClass),1),u.className=c.join(" ")}},{key:"destroy",value:function(){wa(ko(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return bS}},{key:"PLUGIN_PRIORITY",get:function(){return Eze}}]),r}(it);function tf(e){"@babel/helpers - typeof";return tf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},tf(e)}function Aze(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function sL(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Mze(n.key),n)}}function Ize(e,t,r){return t&&sL(e.prototype,t),r&&sL(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Mze(e){var t=xze(e,"string");return tf(t)==="symbol"?t:String(t)}function xze(e,t){if(tf(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(tf(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Ql(){return typeof Reflect<"u"&&Reflect.get?Ql=Reflect.get.bind():Ql=function(t,r,n){var o=Dze(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Ql.apply(this,arguments)}function Dze(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=bi(e),e!==null););return e}function Nze(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&uR(e,t)}function uR(e,t){return uR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},uR(e,t)}function Hze(e){var t=Fze();return function(){var n=bi(e),o;if(t){var i=bi(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Lze(this,o)}}function Lze(e,t){if(t&&(tf(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return jze(e)}function jze(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Fze(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function bi(e){return bi=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},bi(e)}var Bze="touchScroll",Vze=200,Wze=function(e){Nze(r,e);var t=Hze(r);function r(n){var o;return Aze(this,r),o=t.call(this,n),o.scrollbars=[],o.clones=[],o.lockedCollection=!1,o.freezeOverlays=!1,o}return Ize(r,[{key:"isEnabled",value:function(){return EF()}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.addHook("afterViewRender",function(){return o.onAfterViewRender()}),this.registerEvents(),Ql(bi(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.lockedCollection=!1,Ql(bi(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){Ql(bi(r.prototype),"disablePlugin",this).call(this)}},{key:"registerEvents",value:function(){var o=this;this.addHook("beforeTouchScroll",function(){return o.onBeforeTouchScroll()}),this.addHook("afterMomentumScroll",function(){return o.onAfterMomentumScroll()})}},{key:"onAfterViewRender",value:function(){if(!this.lockedCollection){var o=this.hot.view._wt.wtOverlays,i=o.topOverlay,a=o.bottomOverlay,l=o.inlineStartOverlay,s=o.topInlineStartCornerOverlay,u=o.bottomInlineStartCornerOverlay;this.lockedCollection=!0,this.scrollbars.length=0,this.scrollbars.push(i),a.clone&&this.scrollbars.push(a),this.scrollbars.push(l),s&&this.scrollbars.push(s),u&&u.clone&&this.scrollbars.push(u),this.clones=[],i.needFullRender&&this.clones.push(i.clone.wtTable.holder.parentNode),a.needFullRender&&this.clones.push(a.clone.wtTable.holder.parentNode),l.needFullRender&&this.clones.push(l.clone.wtTable.holder.parentNode),s&&this.clones.push(s.clone.wtTable.holder.parentNode),u&&u.clone&&this.clones.push(u.clone.wtTable.holder.parentNode)}}},{key:"onBeforeTouchScroll",value:function(){this.freezeOverlays=!0,I(this.clones,function(o){re(o,"hide-tween")})}},{key:"onAfterMomentumScroll",value:function(){var o=this;this.freezeOverlays=!1,I(this.clones,function(i){He(i,"hide-tween"),re(i,"show-tween")}),this.hot._registerTimeout(function(){I(o.clones,function(i){He(i,"show-tween")})},400),I(this.scrollbars,function(i){i.refresh(),i.resetFixedPosition()}),this.hot.view._wt.wtOverlays.syncScrollWithMaster()}}],[{key:"PLUGIN_KEY",get:function(){return Bze}},{key:"PLUGIN_PRIORITY",get:function(){return Vze}},{key:"SETTING_KEYS",get:function(){return!0}}]),r}(it);function rf(e){"@babel/helpers - typeof";return rf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},rf(e)}function Uze(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function uL(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Yze(n.key),n)}}function zze(e,t,r){return t&&uL(e.prototype,t),r&&uL(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Yze(e){var t=Gze(e,"string");return rf(t)==="symbol"?t:String(t)}function Gze(e,t){if(rf(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(rf(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Sa(){return typeof Reflect<"u"&&Reflect.get?Sa=Reflect.get.bind():Sa=function(t,r,n){var o=Kze(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Sa.apply(this,arguments)}function Kze(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Po(e),e!==null););return e}function qze(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&fR(e,t)}function fR(e,t){return fR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},fR(e,t)}function Xze(e){var t=Jze();return function(){var n=Po(e),o;if(t){var i=Po(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Zze(this,o)}}function Zze(e,t){if(t&&(rf(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Qze(e)}function Qze(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Jze(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Po(e){return Po=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Po(e)}var ky="trimRows",eYe=330,tYe=function(e){qze(r,e);var t=Xze(r);function r(n){var o;return Uze(this,r),o=t.call(this,n),o.trimmedRowsMap=null,o}return zze(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[ky]}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.trimmedRowsMap=this.hot.rowIndexMapper.registerMap("trimRows",new uv),this.trimmedRowsMap.addLocalHook("init",function(){return o.onMapInit()}),Sa(Po(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){var o=this,i=this.hot.getSettings()[ky];Array.isArray(i)&&this.hot.batchExecution(function(){o.trimmedRowsMap.clear(),I(i,function(a){o.trimmedRowsMap.setValueAtIndex(a,!0)})},!0),Sa(Po(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.hot.rowIndexMapper.unregisterMap("trimRows"),Sa(Po(r.prototype),"disablePlugin",this).call(this)}},{key:"getTrimmedRows",value:function(){return this.trimmedRowsMap.getTrimmedIndexes()}},{key:"trimRows",value:function(o){var i=this,a=this.getTrimmedRows(),l=this.isValidConfig(o),s=a;l&&(s=Array.from(new Set(a.concat(o))));var u=this.hot.runHooks("beforeTrimRow",a,s,l);u!==!1&&(l&&this.hot.batchExecution(function(){I(o,function(f){i.trimmedRowsMap.setValueAtIndex(f,!0)})},!0),this.hot.runHooks("afterTrimRow",a,s,l,l&&s.length>a.length))}},{key:"trimRow",value:function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];this.trimRows(i)}},{key:"untrimRows",value:function(o){var i=this.getTrimmedRows(),a=this.isValidConfig(o),l=i,s=this.trimmedRowsMap.getValues().slice(),u=o.length>0;a&&u&&(I(o,function(c){s[c]=!1}),l=nr(s,function(c,h,d){return h&&c.push(d),c},[]));var f=this.hot.runHooks("beforeUntrimRow",i,l,a&&u);f!==!1&&(a&&u&&this.trimmedRowsMap.setValues(s),this.hot.runHooks("afterUntrimRow",i,l,a&&u,a&&l.length<i.length))}},{key:"untrimRow",value:function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];this.untrimRows(i)}},{key:"isTrimmed",value:function(o){return this.trimmedRowsMap.getValueAtIndex(o)||!1}},{key:"untrimAll",value:function(){this.untrimRows(this.getTrimmedRows())}},{key:"isValidConfig",value:function(o){var i=this.hot.countSourceRows();return o.every(function(a){return Number.isInteger(a)&&a>=0&&a<i})}},{key:"onMapInit",value:function(){var o=this,i=this.hot.getSettings()[ky];Array.isArray(i)&&this.hot.batchExecution(function(){I(i,function(a){o.trimmedRowsMap.setValueAtIndex(a,!0)})},!0)}},{key:"destroy",value:function(){Sa(Po(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return ky}},{key:"PLUGIN_PRIORITY",get:function(){return eYe}}]),r}(it);function nf(e){"@babel/helpers - typeof";return nf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},nf(e)}function lz(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function fL(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,rYe(n.key),n)}}function sz(e,t,r){return t&&fL(e.prototype,t),r&&fL(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function rYe(e){var t=nYe(e,"string");return nf(t)==="symbol"?t:String(t)}function nYe(e,t){if(nf(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(nf(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function uz(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&cR(e,t)}function cR(e,t){return cR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},cR(e,t)}function fz(e){var t=aYe();return function(){var n=Im(e),o;if(t){var i=Im(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return oYe(this,o)}}function oYe(e,t){if(t&&(nf(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return iYe(e)}function iYe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function aYe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Im(e){return Im=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Im(e)}function lYe(e){return fYe(e)||uYe(e)||hz(e)||sYe()}function sYe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function uYe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function fYe(e){if(Array.isArray(e))return hR(e)}function cz(e,t){return dYe(e)||hYe(e,t)||hz(e,t)||cYe()}function cYe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function hz(e,t){if(e){if(typeof e=="string")return hR(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return hR(e,t)}}function hR(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function hYe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function dYe(e){if(Array.isArray(e))return e}var dz="undoRedo",vYe="undoRedo";function ve(e){var t=this;this.instance=e,this.doneActions=[],this.undoneActions=[],this.ignoreNewActions=!1,this.enabled=!1,e.addHook("afterChange",function(r,n){var o=this,i=r&&r.length;if(i){var a=r.find(function(s){var u=cz(s,4),f=u[2],c=u[3];return f!==c});if(a){var l=function(){var u=r.reduce(function(c,h){return c.push(lYe(h)),c},[]);I(u,function(c){c[1]=e.propToCol(c[1])});var f=i>1?o.getSelected():[[u[0][0],u[0][1]]];return new ve.ChangeAction(u,f)};t.done(l,n)}}}),e.addHook("afterCreateRow",function(r,n,o){t.done(function(){return new ve.CreateRowAction(r,n)},o)}),e.addHook("beforeRemoveRow",function(r,n,o,i){var a=function(){var s=e.toPhysicalRow(r),u=dr(t.instance.getSourceData(s,0,s+n-1,t.instance.countSourceCols()-1));return new ve.RemoveRowAction(s,u,e.getSettings().fixedRowsBottom,e.getSettings().fixedRowsTop,e.rowIndexMapper.getIndexesSequence())};t.done(a,i)}),e.addHook("afterCreateCol",function(r,n,o){t.done(function(){return new ve.CreateColumnAction(r,n)},o)}),e.addHook("beforeRemoveCol",function(r,n,o,i){var a=function(){var s=t.instance.getSourceDataArray(),u=(t.instance.countCols()+r)%t.instance.countCols(),f=[],c=[],h=[];_e(s.length-1,function(y){var p=[],w=s[y];_e(u,u+(n-1),function(S){p.push(w[e.toPhysicalColumn(S)])}),f.push(p)}),_e(n-1,function(y){h.push(e.toPhysicalColumn(u+y))}),Array.isArray(e.getSettings().colHeaders)&&_e(n-1,function(y){c.push(e.getSettings().colHeaders[e.toPhysicalColumn(u+y)]||null)});var d=e.columnIndexMapper.getIndexesSequence(),v=e.rowIndexMapper.getIndexesSequence();return new ve.RemoveColumnAction(u,h,f,c,d,v,e.getSettings().fixedColumnsStart)};t.done(a,i)}),e.addHook("beforeCellAlignment",function(r,n,o,i){t.done(function(){return new ve.CellAlignmentAction(r,n,o,i)})}),e.addHook("beforeFilter",function(r){t.done(function(){return new ve.FiltersAction(r)})}),e.addHook("beforeRowMove",function(r,n){r!==!1&&t.done(function(){return new ve.RowMoveAction(r,n)})}),e.addHook("beforeMergeCells",function(r,n){n||t.done(function(){return new ve.MergeCellsAction(e,r)})}),e.addHook("afterUnmergeCells",function(r,n){n||t.done(function(){return new ve.UnmergeCellsAction(e,r)})}),e.addHook("afterInit",function(){t.init()})}ve.prototype.done=function(e,t){if(!this.ignoreNewActions){var r=t==="UndoRedo.undo"||t==="UndoRedo.redo"||t==="auto";if(!r){var n=this.doneActions.slice(),o=this.instance.runHooks("beforeUndoStackChange",n,t);if(o!==!1){var i=e(),a=this.undoneActions.slice();this.doneActions.push(i),this.instance.runHooks("afterUndoStackChange",n,this.doneActions.slice()),this.instance.runHooks("beforeRedoStackChange",a),this.undoneActions.length=0,this.instance.runHooks("afterRedoStackChange",a,this.undoneActions.slice())}}}};ve.prototype.undo=function(){if(this.isUndoAvailable()){var e=this.doneActions.slice();this.instance.runHooks("beforeUndoStackChange",e);var t=this.doneActions.pop();this.instance.runHooks("afterUndoStackChange",e,this.doneActions.slice());var r=dr(t),n=this.instance.runHooks("beforeUndo",r);if(n===!1)return;this.ignoreNewActions=!0;var o=this,i=this.undoneActions.slice();this.instance.runHooks("beforeRedoStackChange",i),t.undo(this.instance,function(){o.ignoreNewActions=!1,o.undoneActions.push(t)}),this.instance.runHooks("afterRedoStackChange",i,this.undoneActions.slice()),this.instance.runHooks("afterUndo",r)}};ve.prototype.redo=function(){if(this.isRedoAvailable()){var e=this.undoneActions.slice();this.instance.runHooks("beforeRedoStackChange",e);var t=this.undoneActions.pop();this.instance.runHooks("afterRedoStackChange",e,this.undoneActions.slice());var r=dr(t),n=this.instance.runHooks("beforeRedo",r);if(n===!1)return;this.ignoreNewActions=!0;var o=this,i=this.doneActions.slice();this.instance.runHooks("beforeUndoStackChange",i),t.redo(this.instance,function(){o.ignoreNewActions=!1,o.doneActions.push(t)}),this.instance.runHooks("afterUndoStackChange",i,this.doneActions.slice()),this.instance.runHooks("afterRedo",r)}};ve.prototype.isUndoAvailable=function(){return this.doneActions.length>0};ve.prototype.isRedoAvailable=function(){return this.undoneActions.length>0};ve.prototype.clear=function(){this.doneActions.length=0,this.undoneActions.length=0};ve.prototype.isEnabled=function(){return this.enabled};ve.prototype.enable=function(){if(!this.isEnabled()){var e=this.instance;this.enabled=!0,mYe(e),this.registerShortcuts(),e.addHook("afterChange",vz)}};ve.prototype.disable=function(){if(this.isEnabled()){var e=this.instance;this.enabled=!1,pYe(e),this.unregisterShortcuts(),e.removeHook("afterChange",vz)}};ve.prototype.destroy=function(){this.clear(),this.instance=null,this.doneActions=null,this.undoneActions=null};ve.Action=function(){};ve.Action.prototype.undo=function(){};ve.Action.prototype.redo=function(){};ve.ChangeAction=function(e,t){this.changes=e,this.selected=t,this.actionType="change"};Oi(ve.ChangeAction,ve.Action);ve.ChangeAction.prototype.undo=function(e,t){for(var r=dr(this.changes),n=e.countEmptyRows(!0),o=e.countEmptyCols(!0),i=0,a=r.length;i<a;i++)r[i].splice(3,1);e.addHookOnce("afterChange",t),e.setDataAtCell(r,null,null,"UndoRedo.undo");for(var l=0,s=r.length;l<s;l++){var u=cz(r[l],2),f=u[0],c=u[1];e.getSettings().minSpareRows&&f+1+e.getSettings().minSpareRows===e.countRows()&&n===e.getSettings().minSpareRows&&(e.alter("remove_row",parseInt(f+1,10),e.getSettings().minSpareRows),e.undoRedo.doneActions.pop()),e.getSettings().minSpareCols&&c+1+e.getSettings().minSpareCols===e.countCols()&&o===e.getSettings().minSpareCols&&(e.alter("remove_col",parseInt(c+1,10),e.getSettings().minSpareCols),e.undoRedo.doneActions.pop())}e.selectCells(this.selected,!1,!1)};ve.ChangeAction.prototype.redo=function(e,t){for(var r=dr(this.changes),n=0,o=r.length;n<o;n++)r[n].splice(2,1);e.addHookOnce("afterChange",t),e.setDataAtCell(r,null,null,"UndoRedo.redo"),this.selected&&e.selectCells(this.selected,!1,!1)};ve.CreateRowAction=function(e,t){this.index=e,this.amount=t,this.actionType="insert_row"};Oi(ve.CreateRowAction,ve.Action);ve.CreateRowAction.prototype.undo=function(e,t){var r=e.countRows(),n=e.getSettings().minSpareRows;this.index>=r&&this.index-n<r&&(this.index-=n),e.addHookOnce("afterRemoveRow",t),e.alter("remove_row",this.index,this.amount,"UndoRedo.undo")};ve.CreateRowAction.prototype.redo=function(e,t){e.addHookOnce("afterCreateRow",t),e.alter("insert_row_above",this.index,this.amount,"UndoRedo.redo")};ve.RemoveRowAction=function(e,t,r,n,o){this.index=e,this.data=t,this.actionType="remove_row",this.fixedRowsBottom=r,this.fixedRowsTop=n,this.rowIndexesSequence=o};Oi(ve.RemoveRowAction,ve.Action);ve.RemoveRowAction.prototype.undo=function(e,t){var r=this,n=e.getSettings(),o=[];n.fixedRowsBottom=this.fixedRowsBottom,n.fixedRowsTop=this.fixedRowsTop,this.data.forEach(function(i,a){Object.keys(i).forEach(function(l){var s=parseInt(l,10);o.push([r.index+a,isNaN(s)?l:s,i[l]])})}),e.alter("insert_row_above",this.index,this.data.length,"UndoRedo.undo"),e.addHookOnce("afterViewRender",t),e.setSourceDataAtCell(o,null,null,"UndoRedo.undo"),e.rowIndexMapper.setIndexesSequence(this.rowIndexesSequence)};ve.RemoveRowAction.prototype.redo=function(e,t){e.addHookOnce("afterRemoveRow",t),e.alter("remove_row",this.index,this.data.length,"UndoRedo.redo")};ve.CreateColumnAction=function(e,t){this.index=e,this.amount=t,this.actionType="insert_col"};Oi(ve.CreateColumnAction,ve.Action);ve.CreateColumnAction.prototype.undo=function(e,t){e.addHookOnce("afterRemoveCol",t),e.alter("remove_col",this.index,this.amount,"UndoRedo.undo")};ve.CreateColumnAction.prototype.redo=function(e,t){e.addHookOnce("afterCreateCol",t),e.alter("insert_col_start",this.index,this.amount,"UndoRedo.redo")};ve.RemoveColumnAction=function(e,t,r,n,o,i,a){this.index=e,this.indexes=t,this.data=r,this.amount=this.data[0].length,this.headers=n,this.columnPositions=o.slice(0),this.rowPositions=i.slice(0),this.actionType="remove_col",this.fixedColumnsStart=a};Oi(ve.RemoveColumnAction,ve.Action);ve.RemoveColumnAction.prototype.undo=function(e,t){var r=this,n=e.getSettings();n.fixedColumnsStart=this.fixedColumnsStart;for(var o=this.indexes.slice(0).sort(),i=function(h,d,v){return v[r.indexes.indexOf(o[d])]},a=this.data.length,l=[],s=0;s<a;s++)l.push(Ye(this.data[s],i));var u=Ye(this.headers,i),f=[];e.alter("insert_col_start",this.indexes[0],this.indexes.length,"UndoRedo.undo"),I(e.getSourceDataArray(),function(c,h){I(o,function(d,v){c[d]=l[h][v],f.push([h,d,c[d]])})}),e.setSourceDataAtCell(f,void 0,void 0,"UndoRedo.undo"),typeof this.headers<"u"&&I(u,function(c,h){e.getSettings().colHeaders[o[h]]=c}),e.batchExecution(function(){e.rowIndexMapper.setIndexesSequence(r.rowPositions),e.columnIndexMapper.setIndexesSequence(r.columnPositions)},!0),e.addHookOnce("afterViewRender",t),e.render()};ve.RemoveColumnAction.prototype.redo=function(e,t){e.addHookOnce("afterRemoveCol",t),e.alter("remove_col",this.index,this.amount,"UndoRedo.redo")};ve.CellAlignmentAction=function(e,t,r,n){this.stateBefore=e,this.range=t,this.type=r,this.alignment=n};ve.CellAlignmentAction.prototype.undo=function(e,t){var r=this;I(this.range,function(n){n.forAll(function(o,i){o>=0&&i>=0&&e.setCellMeta(o,i,"className",r.stateBefore[o][i]||" htLeft")})}),e.addHookOnce("afterViewRender",t),e.render()};ve.CellAlignmentAction.prototype.redo=function(e,t){Jo(this.range,this.type,this.alignment,function(r,n){return e.getCellMeta(r,n)},function(r,n,o,i){return e.setCellMeta(r,n,o,i)}),e.addHookOnce("afterViewRender",t),e.render()};ve.FiltersAction=function(e){this.conditionsStack=e,this.actionType="filter"};Oi(ve.FiltersAction,ve.Action);ve.FiltersAction.prototype.undo=function(e,t){var r=e.getPlugin("filters");e.addHookOnce("afterViewRender",t),r.conditionCollection.importAllConditions(this.conditionsStack.slice(0,this.conditionsStack.length-1)),r.filter()};ve.FiltersAction.prototype.redo=function(e,t){var r=e.getPlugin("filters");e.addHookOnce("afterViewRender",t),r.conditionCollection.importAllConditions(this.conditionsStack),r.filter()};var yYe=function(e){uz(r,e);var t=fz(r);function r(n,o){var i;lz(this,r),i=t.call(this),i.cellRange=o;var a=i.cellRange.getTopStartCorner(),l=i.cellRange.getBottomEndCorner();return i.rangeData=n.getData(a.row,a.col,l.row,l.col),i}return sz(r,[{key:"undo",value:function(o,i){var a=o.getPlugin("mergeCells");o.addHookOnce("afterViewRender",i),a.unmergeRange(this.cellRange,!0);var l=this.cellRange.getTopStartCorner();o.populateFromArray(l.row,l.col,this.rangeData,void 0,void 0,"MergeCells")}},{key:"redo",value:function(o,i){var a=o.getPlugin("mergeCells");o.addHookOnce("afterViewRender",i),a.mergeRange(this.cellRange)}}]),r}(ve.Action);ve.MergeCellsAction=yYe;var gYe=function(e){uz(r,e);var t=fz(r);function r(n,o){var i;return lz(this,r),i=t.call(this),i.cellRange=o,i}return sz(r,[{key:"undo",value:function(o,i){var a=o.getPlugin("mergeCells");o.addHookOnce("afterViewRender",i),a.mergeRange(this.cellRange,!0)}},{key:"redo",value:function(o,i){var a=o.getPlugin("mergeCells");o.addHookOnce("afterViewRender",i),a.unmergeRange(this.cellRange,!0),o.render()}}]),r}(ve.Action);ve.UnmergeCellsAction=gYe;ve.RowMoveAction=function(e,t){this.rows=e.slice(),this.finalIndex=t,this.actionType="row_move"};Oi(ve.RowMoveAction,ve.Action);ve.RowMoveAction.prototype.undo=function(e,t){var r=this,n=e.getPlugin("manualRowMove"),o=[].concat(this.rows),i=o.filter(function(f){return f>r.finalIndex}),a=o.filter(function(f){return f<=r.finalIndex}),l=i.sort(function(f,c){return c-f}).concat(a.sort(function(f,c){return f-c}));e.addHookOnce("afterViewRender",t);for(var s=0;s<l.length;s+=1){var u=e.toVisualRow(l[s]);n.moveRow(u,l[s])}e.render(),e.deselectCell(),e.selectRows(this.rows[0],this.rows[0]+this.rows.length-1)};ve.RowMoveAction.prototype.redo=function(e,t){var r=e.getPlugin("manualRowMove");e.addHookOnce("afterViewRender",t),r.moveRows(this.rows.slice(),this.finalIndex),e.render(),e.deselectCell(),e.selectRows(this.finalIndex,this.finalIndex+this.rows.length-1)};ve.prototype.init=function(){var e=this.instance.getSettings().undo,t=typeof e>"u"||e;this.instance.undoRedo||(this.instance.undoRedo=this),t?this.instance.undoRedo.enable():this.instance.undoRedo.disable()};ve.prototype.registerShortcuts=function(){var e=this,t=this.instance.getShortcutManager(),r=t.getContext("grid"),n=function(a){return!a.altKey},o={runOnlyIf:n,group:dz};r.addShortcuts([{keys:[["Control/Meta","z"]],callback:function(){e.undo()}},{keys:[["Control/Meta","y"],["Control/Meta","Shift","z"]],callback:function(){e.redo()}}],o)};ve.prototype.unregisterShortcuts=function(){var e=this.instance.getShortcutManager(),t=e.getContext("grid");t.removeShortcutsByGroup(dz)};function vz(e,t){var r=this;if(t==="loadData")return r.undoRedo.clear()}function mYe(e){e.undo=function(){return e.undoRedo.undo()},e.redo=function(){return e.undoRedo.redo()},e.isUndoAvailable=function(){return e.undoRedo.isUndoAvailable()},e.isRedoAvailable=function(){return e.undoRedo.isRedoAvailable()},e.clearUndo=function(){return e.undoRedo.clear()}}function pYe(e){delete e.undo,delete e.redo,delete e.isUndoAvailable,delete e.isRedoAvailable,delete e.clearUndo}var pv=ge.getSingleton();pv.add("afterUpdateSettings",function(){var e;(e=this.getPlugin("undoRedo"))===null||e===void 0||e.init()});pv.register("beforeUndo");pv.register("afterUndo");pv.register("beforeRedo");pv.register("afterRedo");ve.PLUGIN_KEY=vYe;ve.SETTING_KEYS=!0;function bYe(){tt(fEe),tt(xEe),tt(QEe),tt(z0e),tt(fTe),tt(O2),tt(Nke),tt(yPe),tt(L2),tt(gAe),tt(WAe),tt(e1e),tt(X2),tt(oIe),tt(eHe),tt(eLe),tt(RLe),tt(XLe),tt(bje),tt(lFe),tt(pFe),tt(aBe),tt(mBe),tt(yVe),tt(NVe),tt(qVe),tt(_2e),tt(YUe),tt(fze),tt($ze),tt(Wze),tt(tYe),tt(ve)}function CYe(){_Oe(),LOe(),eRe(),mRe(),bYe()}export{YW as H,CYe as r};
